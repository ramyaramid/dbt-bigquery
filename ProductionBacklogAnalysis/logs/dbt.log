[0m17:28:21.366038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4B4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4D85BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4D85BCD0>]}


============================== 17:28:21.372063 | 70c361de-b51e-462d-9ad1-4636248dabc8 ==============================
[0m17:28:21.372063 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:28:21.373052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:28:21.375056 [info ] [MainThread]: dbt version: 1.5.1
[0m17:28:21.376056 [info ] [MainThread]: python version: 3.10.11
[0m17:28:21.378482 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m17:28:21.380488 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m17:28:21.381483 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m17:28:21.382483 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m17:28:21.384480 [info ] [MainThread]: Configuration:
[0m17:28:21.463380 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:28:21.487365 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:28:21.489365 [info ] [MainThread]: Required dependencies:
[0m17:28:21.490367 [debug] [MainThread]: Executing "git --help"
[0m17:28:21.559608 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:28:21.560636 [debug] [MainThread]: STDERR: "b''"
[0m17:28:21.561609 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:28:21.561609 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:28:21.562615 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "instagrid", target "dev" invalid: ['dbname'] is not of type 'string'


[0m17:28:21.566097 [debug] [MainThread]: Command `dbt debug` failed at 17:28:21.566097 after 0.23 seconds
[0m17:28:21.567097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4B4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4D979B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4D97B7F0>]}
[0m17:28:21.568088 [debug] [MainThread]: Flushing usage events
[0m17:29:25.631887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213692F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136B67BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136B67BC70>]}


============================== 17:29:25.636899 | 9622f3ee-ed4a-4941-8117-79418fedf0dd ==============================
[0m17:29:25.636899 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:29:25.638837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:29:25.640914 [warn ] [MainThread]: [OpenCommand]: Unable to parse dict {'open_cmd': 'start', 'profiles_dir': WindowsPath('C:/Users/Acer/.dbt')}
[0m17:29:25.643240 [info ] [MainThread]: To view your profiles.yml file, run:

 
[0m17:29:25.646708 [debug] [MainThread]: Command `dbt debug` succeeded at 17:29:25.646708 after 0.04 seconds
[0m17:29:25.649054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213692F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136B67BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002136B678460>]}
[0m17:29:25.651458 [debug] [MainThread]: Flushing usage events
[0m17:31:01.658703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D182F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1A657FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1A657CD0>]}


============================== 17:31:01.664705 | 5824392e-1824-4834-aee1-2cf5900c6be5 ==============================
[0m17:31:01.664705 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:31:01.666710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:01.669138 [info ] [MainThread]: dbt version: 1.5.1
[0m17:31:01.670152 [info ] [MainThread]: python version: 3.10.11
[0m17:31:01.671156 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m17:31:01.673275 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m17:31:01.675616 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m17:31:01.676640 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m17:31:01.679016 [info ] [MainThread]: Configuration:
[0m17:31:01.792909 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:31:01.825982 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:31:01.829976 [info ] [MainThread]: Required dependencies:
[0m17:31:01.831974 [debug] [MainThread]: Executing "git --help"
[0m17:31:01.912205 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:31:01.912205 [debug] [MainThread]: STDERR: "b''"
[0m17:31:01.913214 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:31:01.915376 [info ] [MainThread]: Connection:
[0m17:31:01.917375 [info ] [MainThread]:   host: localhost
[0m17:31:01.918369 [info ] [MainThread]:   port: 5435
[0m17:31:01.920369 [info ] [MainThread]:   user: postgres
[0m17:31:01.922560 [info ] [MainThread]:   database: instagrid
[0m17:31:01.925570 [info ] [MainThread]:   schema: public
[0m17:31:01.928559 [info ] [MainThread]:   search_path: None
[0m17:31:01.930558 [info ] [MainThread]:   keepalives_idle: 0
[0m17:31:01.932561 [info ] [MainThread]:   sslmode: None
[0m17:31:01.934558 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:31:01.935560 [debug] [MainThread]: Using postgres connection "debug"
[0m17:31:01.936555 [debug] [MainThread]: On debug: select 1 as id
[0m17:31:01.940581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:02.042564 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:31:02.043563 [debug] [MainThread]: On debug: Close
[0m17:31:02.044569 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:31:02.046566 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:31:02.050002 [debug] [MainThread]: Command `dbt debug` succeeded at 17:31:02.048998 after 0.42 seconds
[0m17:31:02.050002 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:31:02.050998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D182F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D186768C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1A767640>]}
[0m17:31:02.051999 [debug] [MainThread]: Flushing usage events
[0m17:34:50.925241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E25BECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E27FC04C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E27FC02B0>]}


============================== 17:34:50.930260 | 32dff30f-a3f4-45af-b465-0bf9c011770c ==============================
[0m17:34:50.930260 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:34:50.932266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:34:51.039488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32dff30f-a3f4-45af-b465-0bf9c011770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E27F5BF10>]}
[0m17:34:51.054101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32dff30f-a3f4-45af-b465-0bf9c011770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28083730>]}
[0m17:34:51.068123 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m17:34:51.070089 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:34:51.072076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32dff30f-a3f4-45af-b465-0bf9c011770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28095030>]}
[0m17:34:51.737014 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m17:34:51.751535 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m17:34:51.756536 [debug] [MainThread]: 1699: static parser successfully parsed staging\manufactured_units.sql
[0m17:34:51.850951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32dff30f-a3f4-45af-b465-0bf9c011770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28546710>]}
[0m17:34:51.864343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32dff30f-a3f4-45af-b465-0bf9c011770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28547F70>]}
[0m17:34:51.866352 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:34:51.867341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32dff30f-a3f4-45af-b465-0bf9c011770c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28546110>]}
[0m17:34:51.870345 [info ] [MainThread]: 
[0m17:34:51.871345 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:34:51.873347 [debug] [MainThread]: Command end result
[0m17:34:51.884776 [debug] [MainThread]: Command `cli test` succeeded at 17:34:51.883342 after 0.98 seconds
[0m17:34:51.885788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E25BECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28083730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E28545CF0>]}
[0m17:34:51.886793 [debug] [MainThread]: Flushing usage events
[0m17:37:50.154366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AED4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEF857E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEF857D00>]}


============================== 17:37:50.159676 | e34e5557-60d1-403d-8c66-60971da14f64 ==============================
[0m17:37:50.159676 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:37:50.161672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:37:50.163758 [info ] [MainThread]: dbt version: 1.5.1
[0m17:37:50.164777 [info ] [MainThread]: python version: 3.10.11
[0m17:37:50.165776 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m17:37:50.168088 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m17:37:50.170368 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m17:37:50.171379 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m17:37:50.174693 [info ] [MainThread]: Configuration:
[0m17:37:50.258278 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:37:50.281922 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:37:50.283929 [info ] [MainThread]: Required dependencies:
[0m17:37:50.286447 [debug] [MainThread]: Executing "git --help"
[0m17:37:50.367193 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:37:50.367193 [debug] [MainThread]: STDERR: "b''"
[0m17:37:50.369208 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:37:50.371718 [info ] [MainThread]: Connection:
[0m17:37:50.373721 [info ] [MainThread]:   host: localhost
[0m17:37:50.376720 [info ] [MainThread]:   port: 5435
[0m17:37:50.380717 [info ] [MainThread]:   user: postgres
[0m17:37:50.381719 [info ] [MainThread]:   database: instagrid
[0m17:37:50.383823 [info ] [MainThread]:   schema: public
[0m17:37:50.387159 [info ] [MainThread]:   search_path: None
[0m17:37:50.395270 [info ] [MainThread]:   keepalives_idle: 0
[0m17:37:50.400266 [info ] [MainThread]:   sslmode: None
[0m17:37:50.403277 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:37:50.405274 [debug] [MainThread]: Using postgres connection "debug"
[0m17:37:50.407270 [debug] [MainThread]: On debug: select 1 as id
[0m17:37:50.409276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:50.471506 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:37:50.472516 [debug] [MainThread]: On debug: Close
[0m17:37:50.473513 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:37:50.475509 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:37:50.479085 [debug] [MainThread]: Command `dbt debug` succeeded at 17:37:50.478061 after 0.35 seconds
[0m17:37:50.480080 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:37:50.481086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AED4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEDB91840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEF967640>]}
[0m17:37:50.482082 [debug] [MainThread]: Flushing usage events
[0m11:46:10.780072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA606F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA62A6BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA62A6BD00>]}


============================== 11:46:10.802760 | ca7d0420-9dc7-4dae-b5cb-765a18f3bf6d ==============================
[0m11:46:10.802760 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:46:10.804772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:10.806353 [info ] [MainThread]: dbt version: 1.5.1
[0m11:46:10.807297 [info ] [MainThread]: python version: 3.10.11
[0m11:46:10.808295 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m11:46:10.810534 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m11:46:10.811536 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m11:46:10.812536 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m11:46:10.814535 [info ] [MainThread]: Configuration:
[0m11:46:11.013404 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:46:11.048050 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:46:11.049032 [info ] [MainThread]: Required dependencies:
[0m11:46:11.050034 [debug] [MainThread]: Executing "git --help"
[0m11:46:11.110277 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:46:11.111297 [debug] [MainThread]: STDERR: "b''"
[0m11:46:11.112288 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:46:11.113853 [info ] [MainThread]: Connection:
[0m11:46:11.115399 [info ] [MainThread]:   host: localhost
[0m11:46:11.117946 [info ] [MainThread]:   port: 5435
[0m11:46:11.119947 [info ] [MainThread]:   user: postgres
[0m11:46:11.120943 [info ] [MainThread]:   database: instagrid
[0m11:46:11.122949 [info ] [MainThread]:   schema: public
[0m11:46:11.124465 [info ] [MainThread]:   search_path: None
[0m11:46:11.127010 [info ] [MainThread]:   keepalives_idle: 0
[0m11:46:11.132012 [info ] [MainThread]:   sslmode: None
[0m11:46:11.133009 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:46:11.135545 [debug] [MainThread]: Using postgres connection "debug"
[0m11:46:11.137078 [debug] [MainThread]: On debug: select 1 as id
[0m11:46:11.138079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:11.248749 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:46:11.249754 [debug] [MainThread]: On debug: Close
[0m11:46:11.250753 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:46:11.254746 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:46:11.256679 [debug] [MainThread]: Command `dbt debug` succeeded at 11:46:11.256679 after 0.60 seconds
[0m11:46:11.257674 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:46:11.259074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA606F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA60D91A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA62B96350>]}
[0m11:46:11.260092 [debug] [MainThread]: Flushing usage events
[0m11:46:33.092897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB20ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB45B8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB45B8280>]}


============================== 11:46:33.097928 | 292b0355-0a48-4c45-86ab-5ba9ab67c7e6 ==============================
[0m11:46:33.097928 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:46:33.099934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:46:33.193755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '292b0355-0a48-4c45-86ab-5ba9ab67c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB454BE20>]}
[0m11:46:33.218552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '292b0355-0a48-4c45-86ab-5ba9ab67c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB46673A0>]}
[0m11:46:33.235112 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:46:33.244586 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:46:33.246623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '292b0355-0a48-4c45-86ab-5ba9ab67c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB467BE50>]}
[0m11:46:33.263324 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading instagrid: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables: 
    7  |       - name: production_plan
    8  |       - name: manufactured_units
    9  |        columns:
    10 |       - name: date
    11 |         data_type: Date
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 9, column 8
[0m11:46:33.266432 [debug] [MainThread]: Command `cli test` failed at 11:46:33.265391 after 0.20 seconds
[0m11:46:33.267992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB20ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB47A7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FB47A7F10>]}
[0m11:46:33.268994 [debug] [MainThread]: Flushing usage events
[0m11:48:12.442964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F87ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FABB0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FABB0250>]}


============================== 11:48:12.448040 | f455d23f-fe16-4e18-a59f-11a361a30c06 ==============================
[0m11:48:12.448040 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:48:12.449031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:48:12.569019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f455d23f-fe16-4e18-a59f-11a361a30c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FAB4FE20>]}
[0m11:48:12.592692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f455d23f-fe16-4e18-a59f-11a361a30c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FAC65210>]}
[0m11:48:12.610890 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:48:12.619930 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:48:12.620933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f455d23f-fe16-4e18-a59f-11a361a30c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FAC77370>]}
[0m11:48:12.638429 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading instagrid: sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |     tables: 
    7  |       - name: production_plan
    8  |       - name: manufactured_units
    9  |       columns:
    10 |       - name: date
    11 |         data_type: Date
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 7, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 9, column 7
[0m11:48:12.640449 [debug] [MainThread]: Command `cli test` failed at 11:48:12.640449 after 0.23 seconds
[0m11:48:12.643502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F87ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FADAFA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198FADAFF10>]}
[0m11:48:12.644514 [debug] [MainThread]: Flushing usage events
[0m11:48:55.396925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B04ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B28C44C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B28C42B0>]}


============================== 11:48:55.402055 | 3ff2ddf0-4ee1-4c4a-9c25-e3b23e4e2beb ==============================
[0m11:48:55.402055 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:48:55.403063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:48:55.511489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff2ddf0-4ee1-4c4a-9c25-e3b23e4e2beb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B2857F10>]}
[0m11:48:55.530882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ff2ddf0-4ee1-4c4a-9c25-e3b23e4e2beb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B29829E0>]}
[0m11:48:55.550651 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:48:55.654548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:55.655522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:55.656522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.instagrid.manufactured_units
[0m11:48:55.693864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ff2ddf0-4ee1-4c4a-9c25-e3b23e4e2beb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B2E18C10>]}
[0m11:48:55.707896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ff2ddf0-4ee1-4c4a-9c25-e3b23e4e2beb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B2AFDC60>]}
[0m11:48:55.708916 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:48:55.709932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ff2ddf0-4ee1-4c4a-9c25-e3b23e4e2beb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B2AFDCF0>]}
[0m11:48:55.711933 [info ] [MainThread]: 
[0m11:48:55.712929 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:48:55.714935 [debug] [MainThread]: Command end result
[0m11:48:55.730539 [debug] [MainThread]: Command `cli test` succeeded at 11:48:55.730539 after 0.36 seconds
[0m11:48:55.731539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B04ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B29829E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1B2AFD7E0>]}
[0m11:48:55.732535 [debug] [MainThread]: Flushing usage events
[0m11:49:24.290594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002856DFECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285703B0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285703B0250>]}


============================== 11:49:24.296098 | 9260222c-0b76-458f-bae4-6f640d109026 ==============================
[0m11:49:24.296098 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:49:24.297647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:49:24.386564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9260222c-0b76-458f-bae4-6f640d109026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002857034BE20>]}
[0m11:49:24.406209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9260222c-0b76-458f-bae4-6f640d109026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285704638B0>]}
[0m11:49:24.420589 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:49:24.430696 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:49:24.431667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9260222c-0b76-458f-bae4-6f640d109026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028570477AF0>]}
[0m11:49:25.148794 [debug] [MainThread]: 1699: static parser successfully parsed staging\manufactured_units.sql
[0m11:49:25.162580 [debug] [MainThread]: 1699: static parser successfully parsed staging\production_plan.sql
[0m11:49:25.168908 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m11:49:25.230928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9260222c-0b76-458f-bae4-6f640d109026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028570517760>]}
[0m11:49:25.240088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9260222c-0b76-458f-bae4-6f640d109026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028570860F70>]}
[0m11:49:25.240961 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:49:25.242961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9260222c-0b76-458f-bae4-6f640d109026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028570475BD0>]}
[0m11:49:25.245959 [info ] [MainThread]: 
[0m11:49:25.246962 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:49:25.248474 [debug] [MainThread]: Command end result
[0m11:49:25.301577 [debug] [MainThread]: Command `cli test` succeeded at 11:49:25.300403 after 1.04 seconds
[0m11:49:25.301577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002856DFECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002856F1AC2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285703B1390>]}
[0m11:49:25.302597 [debug] [MainThread]: Flushing usage events
[0m11:50:03.974288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240343ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240367B44C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240367B42B0>]}


============================== 11:50:03.981342 | ce8a0d2b-c9e0-497e-ad62-4846c2d737c3 ==============================
[0m11:50:03.981342 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:50:03.983345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:50:04.106879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce8a0d2b-c9e0-497e-ad62-4846c2d737c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002403674FF10>]}
[0m11:50:04.127972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce8a0d2b-c9e0-497e-ad62-4846c2d737c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240368653F0>]}
[0m11:50:04.149417 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:50:04.161690 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:50:04.162689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce8a0d2b-c9e0-497e-ad62-4846c2d737c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024036878CD0>]}
[0m11:50:05.033289 [debug] [MainThread]: 1699: static parser successfully parsed staging\manufactured_units.sql
[0m11:50:05.048496 [debug] [MainThread]: 1699: static parser successfully parsed staging\production_plan.sql
[0m11:50:05.055191 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m11:50:05.122550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.instagrid.manufactured_units
[0m11:50:05.130609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce8a0d2b-c9e0-497e-ad62-4846c2d737c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240369AB070>]}
[0m11:50:05.139726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce8a0d2b-c9e0-497e-ad62-4846c2d737c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024036C64F70>]}
[0m11:50:05.141181 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:50:05.142614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce8a0d2b-c9e0-497e-ad62-4846c2d737c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024036C64FD0>]}
[0m11:50:05.146031 [info ] [MainThread]: 
[0m11:50:05.147034 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:50:05.148540 [debug] [MainThread]: Command end result
[0m11:50:05.237777 [debug] [MainThread]: Command `cli test` succeeded at 11:50:05.236781 after 1.30 seconds
[0m11:50:05.238800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240343ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240357EBD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024034743940>]}
[0m11:50:05.239961 [debug] [MainThread]: Flushing usage events
[0m11:55:31.134055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E60ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E85B8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E85B8280>]}


============================== 11:55:31.140056 | 6f581f48-79d9-428a-9bbd-a20a37bfac1b ==============================
[0m11:55:31.140056 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:55:31.141058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:31.251097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f581f48-79d9-428a-9bbd-a20a37bfac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E854BE20>]}
[0m11:55:31.266084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f581f48-79d9-428a-9bbd-a20a37bfac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E86673A0>]}
[0m11:55:31.279594 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:55:31.384866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:31.385844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:31.386841 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.instagrid.manufactured_units
[0m11:55:31.396133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f581f48-79d9-428a-9bbd-a20a37bfac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E8A18BB0>]}
[0m11:55:31.407836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f581f48-79d9-428a-9bbd-a20a37bfac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E87DDB10>]}
[0m11:55:31.408834 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:55:31.409837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f581f48-79d9-428a-9bbd-a20a37bfac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E87DDD50>]}
[0m11:55:31.413837 [info ] [MainThread]: 
[0m11:55:31.414837 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:55:31.415838 [debug] [MainThread]: Command end result
[0m11:55:31.428324 [debug] [MainThread]: Command `cli test` succeeded at 11:55:31.427326 after 0.32 seconds
[0m11:55:31.429327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E60ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E87DD720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E87DD750>]}
[0m11:55:31.430323 [debug] [MainThread]: Flushing usage events
[0m12:00:10.989273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA86F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAAB57FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAAB57EE0>]}


============================== 12:00:10.994284 | a798fd1c-0eea-4a37-a325-e06726a6a255 ==============================
[0m12:00:10.994284 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:00:10.996280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:00:11.106444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAAB57F40>]}
[0m12:00:11.121960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAAC65AE0>]}
[0m12:00:11.135991 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:00:11.217899 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:00:11.218903 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\warehouse\dim_manufactured_units.sql
[0m12:00:11.224878 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.instagrid.manufactured_units
[0m12:00:11.239864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAB024550>]}
[0m12:00:11.255886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAADE1720>]}
[0m12:00:11.257871 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:00:11.258870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAADE1960>]}
[0m12:00:11.262870 [info ] [MainThread]: 
[0m12:00:11.264869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:11.280030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:00:11.300044 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:00:11.303078 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:00:11.304044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:11.364276 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:00:11.366269 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:00:11.370269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:00:11.377267 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:00:11.378269 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:00:11.379271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:11.528200 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:00:11.528200 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:00:11.529198 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:00:11.547277 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:00:11.549273 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:00:11.551277 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:00:11.562279 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:11.563278 [debug] [MainThread]: On master: BEGIN
[0m12:00:11.564514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:11.615712 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:00:11.616717 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:11.617728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:11.632731 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:00:11.634755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAB067880>]}
[0m12:00:11.635759 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:11.636736 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:11.637731 [debug] [MainThread]: On master: BEGIN
[0m12:00:11.638730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:00:11.639737 [debug] [MainThread]: On master: COMMIT
[0m12:00:11.640730 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:11.640730 [debug] [MainThread]: On master: COMMIT
[0m12:00:11.642730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:00:11.642730 [debug] [MainThread]: On master: Close
[0m12:00:11.644732 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:00:11.646733 [info ] [MainThread]: 
[0m12:00:11.670730 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m12:00:11.670730 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m12:00:11.671755 [info ] [Thread-1 (]: 1 of 2 START sql view model public.manufactured_units .......................... [RUN]
[0m12:00:11.676731 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m12:00:11.673737 [info ] [Thread-2 (]: 2 of 2 START sql view model public.production_plan ............................. [RUN]
[0m12:00:11.677911 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m12:00:11.679922 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m12:00:11.686065 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m12:00:11.687054 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m12:00:11.693060 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 12:00:11.679922 => 12:00:11.692054
[0m12:00:11.702086 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m12:00:11.704077 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m12:00:11.751526 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 12:00:11.694063 => 12:00:11.751526
[0m12:00:11.768523 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m12:00:11.769525 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m12:00:11.778743 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m12:00:11.781925 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:00:11.782924 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:00:11.783924 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m12:00:11.784927 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m12:00:11.787927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:11.785928 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:00:11.850480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:00:11.851490 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:00:11.852482 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  create view "instagrid"."public"."manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select * from source
  );
[0m12:00:11.860415 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:00:11.861419 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:00:11.862415 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  create view "instagrid"."public"."production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select * from source
  );
[0m12:00:11.868724 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:00:11.875746 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:00:11.876723 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:00:11.880721 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:00:11.881540 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m12:00:11.882570 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m12:00:11.884575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:11.884575 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:11.888581 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:00:11.892575 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:00:11.893598 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m12:00:11.894573 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m12:00:11.896573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:11.897582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:11.916112 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m12:00:11.919136 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m12:00:11.920110 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:00:11.921111 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:00:11.922110 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m12:00:11.923117 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m12:00:11.925636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:00:11.926637 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:00:11.934634 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:00:11.937661 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:00:11.938635 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m12:00:11.939636 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m12:00:11.949533 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:00:11.950541 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:00:11.952550 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 12:00:11.771520 => 12:00:11.952550
[0m12:00:11.956727 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 12:00:11.706420 => 12:00:11.955705
[0m12:00:11.957709 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m12:00:11.958701 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m12:00:11.960707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA8CDE740>]}
[0m12:00:11.963084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a798fd1c-0eea-4a37-a325-e06726a6a255', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAB0059C0>]}
[0m12:00:11.964596 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.production_plan ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m12:00:11.966831 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.manufactured_units ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m12:00:11.969217 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m12:00:11.970241 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m12:00:11.975722 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:11.976723 [debug] [MainThread]: On master: BEGIN
[0m12:00:11.978718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:12.041889 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:00:12.041889 [debug] [MainThread]: On master: COMMIT
[0m12:00:12.042915 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:12.043910 [debug] [MainThread]: On master: COMMIT
[0m12:00:12.044888 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:00:12.044888 [debug] [MainThread]: On master: Close
[0m12:00:12.047369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:12.048382 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:00:12.049400 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:00:12.050396 [debug] [MainThread]: Connection 'model.instagrid.manufactured_units' was properly closed.
[0m12:00:12.051392 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m12:00:12.052720 [info ] [MainThread]: 
[0m12:00:12.054732 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:00:12.056740 [debug] [MainThread]: Command end result
[0m12:00:12.068736 [info ] [MainThread]: 
[0m12:00:12.070738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:12.072740 [info ] [MainThread]: 
[0m12:00:12.073735 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:00:12.084975 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:12.084975 after 1.12 seconds
[0m12:00:12.086089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA86F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAB0059C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAB0A9960>]}
[0m12:00:12.088112 [debug] [MainThread]: Flushing usage events
[0m12:04:36.706418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D55F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D797BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D797BE50>]}


============================== 12:04:36.706418 | 746f7df6-48fb-4491-912a-28674f71c994 ==============================
[0m12:04:36.706418 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:04:36.715237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:04:36.816473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D797BF10>]}
[0m12:04:36.830930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7A94C40>]}
[0m12:04:36.833331 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:04:36.927272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:36.927272 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:36.930979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7F14370>]}
[0m12:04:36.930979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7EE53C0>]}
[0m12:04:36.930979 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:04:36.947797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7EE5450>]}
[0m12:04:36.950983 [info ] [MainThread]: 
[0m12:04:36.954850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:04:36.957993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:04:36.978028 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:04:36.979037 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:04:36.982204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:37.041388 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:04:37.043415 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:04:37.046391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:04:37.047389 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:04:37.047389 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:04:37.047389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:37.094612 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:04:37.094612 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:04:37.094612 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:04:37.094612 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:04:37.094612 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:04:37.094612 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:04:37.112871 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:37.112871 [debug] [MainThread]: On master: BEGIN
[0m12:04:37.112871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:37.158301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:37.158301 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:37.158301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:04:37.173314 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:04:37.173314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7F57850>]}
[0m12:04:37.173314 [debug] [MainThread]: On master: ROLLBACK
[0m12:04:37.173314 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:37.181320 [debug] [MainThread]: On master: BEGIN
[0m12:04:37.182690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:37.182690 [debug] [MainThread]: On master: COMMIT
[0m12:04:37.182690 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:37.182690 [debug] [MainThread]: On master: COMMIT
[0m12:04:37.182690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:04:37.182690 [debug] [MainThread]: On master: Close
[0m12:04:37.188301 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:04:37.190834 [info ] [MainThread]: 
[0m12:04:37.203625 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m12:04:37.203625 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m12:04:37.205625 [info ] [Thread-1 (]: 1 of 2 START sql view model public.manufactured_units .......................... [RUN]
[0m12:04:37.207630 [info ] [Thread-2 (]: 2 of 2 START sql view model public.production_plan ............................. [RUN]
[0m12:04:37.209629 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m12:04:37.214633 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m12:04:37.212645 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m12:04:37.221650 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m12:04:37.222650 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m12:04:37.230906 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m12:04:37.233903 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 12:04:37.216632 => 12:04:37.233903
[0m12:04:37.235908 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m12:04:37.288589 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m12:04:37.288589 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 12:04:37.224628 => 12:04:37.288589
[0m12:04:37.291114 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m12:04:37.298153 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m12:04:37.299328 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:04:37.301344 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m12:04:37.302344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:04:37.303346 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:04:37.304629 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m12:04:37.305642 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:04:37.353407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:37.356071 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:04:37.356071 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  create view "instagrid"."public"."manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select * from source
  );
[0m12:04:37.361010 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.manufactured_units" does not exist
LINE 10:     select * from  "instagrid"."public"."manufactured_units"
                            ^

[0m12:04:37.361837 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: ROLLBACK
[0m12:04:37.361837 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 12:04:37.236911 => 12:04:37.361837
[0m12:04:37.361837 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m12:04:37.361837 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:37.361837 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:04:37.361837 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  create view "instagrid"."public"."production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select * from source
  );
[0m12:04:37.371129 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.production_plan" does not exist
LINE 10:     select * from  "instagrid"."public"."production_plan"
                            ^

[0m12:04:37.371129 [debug] [Thread-2 (]: On model.instagrid.production_plan: ROLLBACK
[0m12:04:37.371129 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 12:04:37.292115 => 12:04:37.371129
[0m12:04:37.371129 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m12:04:37.464808 [debug] [Thread-1 (]: Database Error in model manufactured_units (models\staging\manufactured_units.sql)
  relation "public.manufactured_units" does not exist
  LINE 10:     select * from  "instagrid"."public"."manufactured_units"
                              ^
  compiled Code at target\run\instagrid\models\staging\manufactured_units.sql
[0m12:04:37.464808 [debug] [Thread-2 (]: Database Error in model production_plan (models\staging\production_plan.sql)
  relation "public.production_plan" does not exist
  LINE 10:     select * from  "instagrid"."public"."production_plan"
                              ^
  compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m12:04:37.464808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7FB3B20>]}
[0m12:04:37.464808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '746f7df6-48fb-4491-912a-28674f71c994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7FA2590>]}
[0m12:04:37.464808 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.manufactured_units ................. [[31mERROR[0m in 0.26s]
[0m12:04:37.464808 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model public.production_plan .................... [[31mERROR[0m in 0.25s]
[0m12:04:37.464808 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m12:04:37.464808 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m12:04:37.476091 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:37.476091 [debug] [MainThread]: On master: BEGIN
[0m12:04:37.476091 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:37.543343 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:37.544343 [debug] [MainThread]: On master: COMMIT
[0m12:04:37.545347 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:37.546345 [debug] [MainThread]: On master: COMMIT
[0m12:04:37.547344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:04:37.549527 [debug] [MainThread]: On master: Close
[0m12:04:37.551525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:37.552519 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:04:37.553521 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:04:37.554517 [debug] [MainThread]: Connection 'model.instagrid.manufactured_units' was properly closed.
[0m12:04:37.555515 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m12:04:37.556520 [info ] [MainThread]: 
[0m12:04:37.558517 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m12:04:37.560522 [debug] [MainThread]: Command end result
[0m12:04:37.572518 [info ] [MainThread]: 
[0m12:04:37.574516 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:04:37.575520 [info ] [MainThread]: 
[0m12:04:37.577791 [error] [MainThread]: [33mDatabase Error in model manufactured_units (models\staging\manufactured_units.sql)[0m
[0m12:04:37.579794 [error] [MainThread]:   relation "public.manufactured_units" does not exist
[0m12:04:37.582789 [error] [MainThread]:   LINE 10:     select * from  "instagrid"."public"."manufactured_units"
[0m12:04:37.584789 [error] [MainThread]:                               ^
[0m12:04:37.586836 [error] [MainThread]:   compiled Code at target\run\instagrid\models\staging\manufactured_units.sql
[0m12:04:37.589253 [info ] [MainThread]: 
[0m12:04:37.592025 [error] [MainThread]: [33mDatabase Error in model production_plan (models\staging\production_plan.sql)[0m
[0m12:04:37.593044 [error] [MainThread]:   relation "public.production_plan" does not exist
[0m12:04:37.596041 [error] [MainThread]:   LINE 10:     select * from  "instagrid"."public"."production_plan"
[0m12:04:37.599045 [error] [MainThread]:                               ^
[0m12:04:37.601200 [error] [MainThread]:   compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m12:04:37.602488 [info ] [MainThread]: 
[0m12:04:37.604877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m12:04:37.611361 [debug] [MainThread]: Command `dbt run` failed at 12:04:37.611361 after 0.93 seconds
[0m12:04:37.613384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D55F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7ECFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4D7FB3640>]}
[0m12:04:37.615539 [debug] [MainThread]: Flushing usage events
[0m12:06:47.708752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30A6F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CA5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CA5BE80>]}


============================== 12:06:47.714761 | 923f195e-e404-42ec-b8b8-f24af350a352 ==============================
[0m12:06:47.714761 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:06:47.717245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:47.816390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CA5BF40>]}
[0m12:06:47.831386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CB65EA0>]}
[0m12:06:47.845405 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:06:47.926805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:47.927809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:47.936101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CF143A0>]}
[0m12:06:47.949028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CEE53F0>]}
[0m12:06:47.952040 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:06:47.956049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CEE5480>]}
[0m12:06:47.961864 [info ] [MainThread]: 
[0m12:06:47.967143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:06:47.970156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:06:47.986170 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:06:47.988158 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:06:47.990160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:48.052699 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:06:48.054701 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:06:48.058704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:06:48.065720 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:06:48.066728 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:06:48.067700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:48.218239 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:06:48.219268 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:06:48.219268 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:06:48.228242 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:06:48.230241 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:06:48.231244 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:06:48.239129 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:48.240109 [debug] [MainThread]: On master: BEGIN
[0m12:06:48.241103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:48.281435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:48.281435 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:48.282465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:48.295436 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:06:48.297437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CEDA770>]}
[0m12:06:48.298433 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:48.299436 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:48.300437 [debug] [MainThread]: On master: BEGIN
[0m12:06:48.301437 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:48.301437 [debug] [MainThread]: On master: COMMIT
[0m12:06:48.302444 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:48.303456 [debug] [MainThread]: On master: COMMIT
[0m12:06:48.304434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:06:48.305434 [debug] [MainThread]: On master: Close
[0m12:06:48.307434 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:06:48.308830 [info ] [MainThread]: 
[0m12:06:48.318842 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m12:06:48.318842 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m12:06:48.319841 [info ] [Thread-1 (]: 1 of 2 START sql view model public.manufactured_units .......................... [RUN]
[0m12:06:48.322846 [info ] [Thread-2 (]: 2 of 2 START sql view model public.production_plan ............................. [RUN]
[0m12:06:48.325973 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m12:06:48.329000 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m12:06:48.329987 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m12:06:48.330987 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m12:06:48.337030 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m12:06:48.342024 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m12:06:48.346007 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 12:06:48.338004 => 12:06:48.345012
[0m12:06:48.348004 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m12:06:48.349518 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 12:06:48.332989 => 12:06:48.349005
[0m12:06:48.404464 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m12:06:48.404464 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m12:06:48.410680 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m12:06:48.412683 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:06:48.413839 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m12:06:48.414853 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:06:48.414853 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:06:48.416242 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m12:06:48.418254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:06:48.470305 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:48.475302 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:06:48.477583 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  create view "instagrid"."public"."production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select * from source
  );
[0m12:06:48.488237 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:48.498246 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:06:48.499253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:48.500245 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m12:06:48.502237 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:06:48.503501 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  create view "instagrid"."public"."manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m12:06:48.504514 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:48.510589 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:06:48.511925 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m12:06:48.513945 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:48.542356 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m12:06:48.543347 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:48.544344 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:06:48.549152 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:06:48.550165 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m12:06:48.551164 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m12:06:48.553170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:48.554164 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:48.559187 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:06:48.569168 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:06:48.572500 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m12:06:48.570173 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m12:06:48.573492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:48.578811 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m12:06:48.579810 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:06:48.581116 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:06:48.582132 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m12:06:48.584534 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 12:06:48.350028 => 12:06:48.584534
[0m12:06:48.586528 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m12:06:48.587523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:48.589528 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CFB7E50>]}
[0m12:06:48.595025 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:06:48.596024 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.production_plan ........................ [[32mCREATE VIEW[0m in 0.26s]
[0m12:06:48.598372 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m12:06:48.600152 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m12:06:48.610330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:06:48.612343 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 12:06:48.405439 => 12:06:48.612343
[0m12:06:48.614341 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m12:06:48.616349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923f195e-e404-42ec-b8b8-f24af350a352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CFA8400>]}
[0m12:06:48.618353 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.manufactured_units ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m12:06:48.620408 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m12:06:48.623841 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:48.625861 [debug] [MainThread]: On master: BEGIN
[0m12:06:48.627113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:48.687677 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:48.688695 [debug] [MainThread]: On master: COMMIT
[0m12:06:48.689695 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:48.690691 [debug] [MainThread]: On master: COMMIT
[0m12:06:48.691691 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:06:48.692691 [debug] [MainThread]: On master: Close
[0m12:06:48.693690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:48.694688 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:06:48.695695 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:06:48.696694 [debug] [MainThread]: Connection 'model.instagrid.manufactured_units' was properly closed.
[0m12:06:48.697691 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m12:06:48.698691 [info ] [MainThread]: 
[0m12:06:48.700695 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:06:48.702697 [debug] [MainThread]: Command end result
[0m12:06:48.712185 [info ] [MainThread]: 
[0m12:06:48.714188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:48.716282 [info ] [MainThread]: 
[0m12:06:48.719398 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:06:48.721399 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:48.721399 after 1.05 seconds
[0m12:06:48.722393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30A6F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CFB7E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30CECFF10>]}
[0m12:06:48.724399 [debug] [MainThread]: Flushing usage events
[0m12:09:50.974901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED2F104A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3155BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3155BE50>]}


============================== 12:09:50.979855 | c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe ==============================
[0m12:09:50.979855 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:09:50.981797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:09:51.091609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3155BF10>]}
[0m12:09:51.105608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED31667610>]}
[0m12:09:51.120610 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:09:51.129639 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:09:51.131617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3167E4D0>]}
[0m12:09:51.827319 [debug] [MainThread]: 1699: static parser successfully parsed staging\manufactured_units.sql
[0m12:09:51.843591 [debug] [MainThread]: 1699: static parser successfully parsed staging\production_plan.sql
[0m12:09:51.863757 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m12:09:51.921119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED31713D00>]}
[0m12:09:51.931130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED31704070>]}
[0m12:09:51.932137 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:09:51.934130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED317B3850>]}
[0m12:09:51.937131 [info ] [MainThread]: 
[0m12:09:51.942138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:51.945129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:09:51.963702 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:09:51.964698 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:09:51.965716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:52.027430 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:09:52.029430 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:09:52.033434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:09:52.073629 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:09:52.074611 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:09:52.075607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:52.112893 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:09:52.112893 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:09:52.112893 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:09:52.129025 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:09:52.129025 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:09:52.129025 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:09:52.143025 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:52.145262 [debug] [MainThread]: On master: BEGIN
[0m12:09:52.146259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:52.320108 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:52.320773 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:52.320773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:52.335989 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:09:52.337014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED3167C6A0>]}
[0m12:09:52.338014 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:52.338993 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:52.339993 [debug] [MainThread]: On master: BEGIN
[0m12:09:52.340995 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:52.341994 [debug] [MainThread]: On master: COMMIT
[0m12:09:52.342993 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:52.343991 [debug] [MainThread]: On master: COMMIT
[0m12:09:52.344990 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:52.344990 [debug] [MainThread]: On master: Close
[0m12:09:52.347005 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:09:52.349010 [info ] [MainThread]: 
[0m12:09:52.361010 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m12:09:52.361539 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m12:09:52.362579 [info ] [Thread-1 (]: 1 of 2 START sql table model public.manufactured_units ......................... [RUN]
[0m12:09:52.366552 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m12:09:52.364552 [info ] [Thread-2 (]: 2 of 2 START sql table model public.production_plan ............................ [RUN]
[0m12:09:52.370888 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m12:09:52.372907 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m12:09:52.378927 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m12:09:52.379909 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m12:09:52.384671 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 12:09:52.374912 => 12:09:52.383646
[0m12:09:52.390090 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m12:09:52.392108 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m12:09:52.445755 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 12:09:52.385663 => 12:09:52.445755
[0m12:09:52.449768 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m12:09:52.450768 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m12:09:52.459369 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m12:09:52.461877 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:09:52.462890 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:09:52.463890 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m12:09:52.463890 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m12:09:52.465180 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:52.466214 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:52.519116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:52.520128 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:09:52.521120 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m12:09:52.533119 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m12:09:52.546546 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:09:52.547556 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m12:09:52.548561 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:09:52.549557 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:09:52.550564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:52.551561 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  
    

  create  table "instagrid"."public"."production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select * from source
  );
  
[0m12:09:52.558109 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:09:52.560127 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m12:09:52.561641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:52.585982 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m12:09:52.597983 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m12:09:52.603975 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:09:52.604976 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:09:52.606980 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m12:09:52.607976 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m12:09:52.609975 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:52.616998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:52.615974 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:09:52.623975 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m12:09:52.624977 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m12:09:52.625986 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m12:09:52.627973 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:09:52.632131 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m12:09:52.634597 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:09:52.635933 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m12:09:52.639950 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:09:52.642944 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 12:09:52.393104 => 12:09:52.642944
[0m12:09:52.643943 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:09:52.644952 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m12:09:52.652971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED317156C0>]}
[0m12:09:52.650968 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m12:09:52.664497 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m12:09:52.671497 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:09:52.674500 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 12:09:52.452851 => 12:09:52.674500
[0m12:09:52.676504 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m12:09:52.677501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0e6f40b-6014-43bc-92dd-aaf7e2e99dfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED31A2B430>]}
[0m12:09:52.653970 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.29s]
[0m12:09:52.679500 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.production_plan ....................... [[32mSELECT 104[0m in 0.31s]
[0m12:09:52.687816 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m12:09:52.689818 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m12:09:52.693827 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:52.694822 [debug] [MainThread]: On master: BEGIN
[0m12:09:52.695818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:52.810990 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:09:52.812015 [debug] [MainThread]: On master: COMMIT
[0m12:09:52.812993 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:52.812993 [debug] [MainThread]: On master: COMMIT
[0m12:09:52.813994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:09:52.814993 [debug] [MainThread]: On master: Close
[0m12:09:52.816994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:52.817991 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:09:52.818996 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:09:52.820143 [debug] [MainThread]: Connection 'model.instagrid.manufactured_units' was properly closed.
[0m12:09:52.821157 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m12:09:52.822252 [info ] [MainThread]: 
[0m12:09:52.823263 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m12:09:52.825616 [debug] [MainThread]: Command end result
[0m12:09:52.837401 [info ] [MainThread]: 
[0m12:09:52.839397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:52.840398 [info ] [MainThread]: 
[0m12:09:52.842401 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:09:52.845441 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:52.845441 after 1.90 seconds
[0m12:09:52.846450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED2F104A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED31704070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED2F71C940>]}
[0m12:09:52.847467 [debug] [MainThread]: Flushing usage events
[0m14:01:04.471691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015B4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015D877FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015D877EB0>]}


============================== 14:01:04.481743 | fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2 ==============================
[0m14:01:04.481743 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:01:04.484920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:01:04.635657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015D877F10>]}
[0m14:01:04.651222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015D990B80>]}
[0m14:01:04.668406 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:01:04.778493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:04.780497 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:04.789356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DE17FD0>]}
[0m14:01:04.800412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DB158A0>]}
[0m14:01:04.801413 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:01:04.805476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DB15A80>]}
[0m14:01:04.808014 [info ] [MainThread]: 
[0m14:01:04.813047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:04.817967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:01:04.837083 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:01:04.838081 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:01:04.841695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:04.918359 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:01:04.919389 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:01:04.923969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:01:04.931018 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:01:04.932023 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:01:04.932994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:04.973818 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:01:04.974851 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:01:04.975940 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:01:04.988379 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:01:04.990381 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:01:04.991381 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:01:05.001213 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.002218 [debug] [MainThread]: On master: BEGIN
[0m14:01:05.003196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:05.062112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:05.063636 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.064150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:05.081801 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:01:05.083337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DE4D090>]}
[0m14:01:05.083880 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:05.085416 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.086429 [debug] [MainThread]: On master: BEGIN
[0m14:01:05.087428 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:05.087428 [debug] [MainThread]: On master: COMMIT
[0m14:01:05.088431 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.089434 [debug] [MainThread]: On master: COMMIT
[0m14:01:05.090430 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:05.091433 [debug] [MainThread]: On master: Close
[0m14:01:05.091433 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:01:05.094470 [info ] [MainThread]: 
[0m14:01:05.107889 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m14:01:05.108889 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m14:01:05.109910 [info ] [Thread-1 (]: 1 of 3 START sql table model public.manufactured_units ......................... [RUN]
[0m14:01:05.116967 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m14:01:05.118957 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m14:01:05.125047 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m14:01:05.110889 [info ] [Thread-2 (]: 2 of 3 START sql view model public.production_plan ............................. [RUN]
[0m14:01:05.128067 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m14:01:05.130080 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m14:01:05.137457 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m14:01:05.139460 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 14:01:05.119954 => 14:01:05.138465
[0m14:01:05.140456 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m14:01:05.141455 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 14:01:05.131362 => 14:01:05.141455
[0m14:01:05.215851 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m14:01:05.216861 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m14:01:05.239133 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m14:01:05.241135 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:05.242139 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m14:01:05.243651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:01:05.244163 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:05.246193 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m14:01:05.248197 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:01:05.306743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:05.307743 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:05.308744 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m14:01:05.309792 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:05.310803 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:05.311801 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  create view "instagrid"."public"."production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select  
right(week,1) as year_week,
pn,
plan 
from source
  );
[0m14:01:05.322219 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:01:05.330754 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:05.330754 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:01:05.331737 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m14:01:05.335532 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:05.337530 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m14:01:05.337530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:05.341539 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:05.343077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:05.343077 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m14:01:05.348283 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:05.349258 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m14:01:05.350262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:05.374929 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:01:05.374929 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:05.375929 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:05.379931 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m14:01:05.380930 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:01:05.381234 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:05.383248 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m14:01:05.383758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:05.390774 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:05.391775 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:05.391775 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m14:01:05.396997 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:05.398974 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m14:01:05.401979 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:05.403689 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 14:01:05.141455 => 14:01:05.403689
[0m14:01:05.404811 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m14:01:05.407107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DEB3FD0>]}
[0m14:01:05.410122 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:05.410122 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.29s]
[0m14:01:05.416015 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 14:01:05.217853 => 14:01:05.415016
[0m14:01:05.419021 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m14:01:05.420018 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m14:01:05.422137 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:01:05.424161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DF0C700>]}
[0m14:01:05.425709 [info ] [Thread-1 (]: 3 of 3 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m14:01:05.430729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:01:05.431724 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:01:05.438084 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:01:05.427722 [info ] [Thread-2 (]: 2 of 3 OK created sql view model public.production_plan ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m14:01:05.442084 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m14:01:05.448157 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:01:05.433791 => 14:01:05.445249
[0m14:01:05.449161 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:01:05.463104 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:01:05.468673 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:05.469659 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:01:05.471660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:05.542947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:05.544471 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:05.545486 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(month from date) as month,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."manufactured_units"
  );
[0m14:01:05.557054 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:01:05.563060 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:05.564085 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:01:05.566105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:05.570098 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:01:05.571102 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:05.573100 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:01:05.575663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:05.580201 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:05.581201 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:01:05.583200 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:01:05.586257 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:01:05.453657 => 14:01:05.585254
[0m14:01:05.587253 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:01:05.589260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6e5f48-175b-4ccd-bbf0-2db7f43ce3c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DF028C0>]}
[0m14:01:05.590253 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:01:05.593250 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:01:05.598723 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.600708 [debug] [MainThread]: On master: BEGIN
[0m14:01:05.601708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:05.726052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:05.727054 [debug] [MainThread]: On master: COMMIT
[0m14:01:05.728058 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:05.729057 [debug] [MainThread]: On master: COMMIT
[0m14:01:05.730052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:05.731056 [debug] [MainThread]: On master: Close
[0m14:01:05.733569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:05.734083 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:01:05.735097 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:01:05.736103 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:01:05.737109 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m14:01:05.738095 [info ] [MainThread]: 
[0m14:01:05.740097 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m14:01:05.743098 [debug] [MainThread]: Command end result
[0m14:01:05.756729 [info ] [MainThread]: 
[0m14:01:05.758735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:05.759733 [info ] [MainThread]: 
[0m14:01:05.761732 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:01:05.764941 [debug] [MainThread]: Command `dbt run` succeeded at 14:01:05.764298 after 1.33 seconds
[0m14:01:05.766316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015B4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DEB3FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015DEA44F0>]}
[0m14:01:05.767316 [debug] [MainThread]: Flushing usage events
[0m14:01:37.595412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC0FF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3367FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3367E80>]}


============================== 14:01:37.603890 | df078e62-5f9e-4e58-bda7-839d45cd6a9d ==============================
[0m14:01:37.603890 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:01:37.605902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:01:37.720798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3367F40>]}
[0m14:01:37.736455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3483F40>]}
[0m14:01:37.752054 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:01:37.786537 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:01:37.819519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC349AF80>]}
[0m14:01:38.966960 [debug] [MainThread]: 1699: static parser successfully parsed staging\manufactured_units.sql
[0m14:01:38.981732 [debug] [MainThread]: 1699: static parser successfully parsed staging\production_plan.sql
[0m14:01:38.988841 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m14:01:38.994875 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_production_plan.sql
[0m14:01:39.055097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC34FED10>]}
[0m14:01:39.069489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC396D390>]}
[0m14:01:39.071503 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:01:39.076700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC349B040>]}
[0m14:01:39.083681 [info ] [MainThread]: 
[0m14:01:39.086227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:39.088720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:01:39.153877 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:01:39.154889 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:01:39.155905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:39.212268 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:01:39.213843 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:01:39.217259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:01:39.226752 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:01:39.227759 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:01:39.228747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:39.279425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.280430 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:01:39.281436 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:01:39.289891 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:01:39.291911 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:01:39.292901 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:01:39.300769 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:39.300769 [debug] [MainThread]: On master: BEGIN
[0m14:01:39.301769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:39.346409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.347411 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:39.348409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:39.363045 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m14:01:39.365916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC34FEDD0>]}
[0m14:01:39.366927 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:39.367928 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:39.369931 [debug] [MainThread]: On master: BEGIN
[0m14:01:39.370929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.371929 [debug] [MainThread]: On master: COMMIT
[0m14:01:39.372930 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:39.374166 [debug] [MainThread]: On master: COMMIT
[0m14:01:39.375178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:39.375178 [debug] [MainThread]: On master: Close
[0m14:01:39.377620 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:01:39.378619 [info ] [MainThread]: 
[0m14:01:39.390739 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m14:01:39.390739 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m14:01:39.392014 [info ] [Thread-1 (]: 1 of 3 START sql table model public.manufactured_units ......................... [RUN]
[0m14:01:39.397100 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m14:01:39.394054 [info ] [Thread-2 (]: 2 of 3 START sql table model public.production_plan ............................ [RUN]
[0m14:01:39.398098 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m14:01:39.400103 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m14:01:39.408657 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m14:01:39.409666 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m14:01:39.415738 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m14:01:39.418738 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 14:01:39.401099 => 14:01:39.417736
[0m14:01:39.419740 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m14:01:39.422664 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 14:01:39.411657 => 14:01:39.421758
[0m14:01:39.487776 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m14:01:39.488876 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m14:01:39.500086 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m14:01:39.501093 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:39.503093 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m14:01:39.504108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:01:39.505131 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:39.508457 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m14:01:39.509458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:01:39.579811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.580814 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:39.582817 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m14:01:39.592909 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:01:39.605706 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:39.606709 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m14:01:39.607857 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.609383 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:01:39.610397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:39.611398 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  
    

  create  table "instagrid"."public"."production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select  
right(week,1) as year_week,
pn,
plan 
from source
  );
  
[0m14:01:39.615991 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:39.617985 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m14:01:39.618978 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.production_plan" does not exist
LINE 15:     select * from  "instagrid"."public"."production_plan"
                            ^

[0m14:01:39.619982 [debug] [Thread-2 (]: On model.instagrid.production_plan: ROLLBACK
[0m14:01:39.620983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:39.622979 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 14:01:39.490895 => 14:01:39.621983
[0m14:01:39.647672 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:01:39.648671 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m14:01:39.649668 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:39.651952 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:01:39.654998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:39.662923 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:01:39.663967 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m14:01:39.668038 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:39.671046 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 14:01:39.423712 => 14:01:39.671046
[0m14:01:39.672042 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m14:01:39.675081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ABE640D60>]}
[0m14:01:39.677079 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.28s]
[0m14:01:39.680800 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m14:01:39.685882 [debug] [Thread-2 (]: Database Error in model production_plan (models\staging\production_plan.sql)
  relation "public.production_plan" does not exist
  LINE 15:     select * from  "instagrid"."public"."production_plan"
                              ^
  compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m14:01:39.686867 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:01:39.687869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3A07BE0>]}
[0m14:01:39.689871 [info ] [Thread-1 (]: 3 of 3 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:01:39.695848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:01:39.692264 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.production_plan ................... [[31mERROR[0m in 0.29s]
[0m14:01:39.696828 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:01:39.698261 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m14:01:39.703339 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:01:39.705862 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:01:39.699274 => 14:01:39.705862
[0m14:01:39.706865 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:01:39.715230 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:01:39.718589 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:39.720764 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:01:39.725242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:39.777428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.777428 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:39.778429 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    select
date,
extract(month from date) as month,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."manufactured_units"
  );
  
[0m14:01:39.792120 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:01:39.797148 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:39.798149 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:01:39.800536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:01:39.804106 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:01:39.805306 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:39.806309 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:01:39.811579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:01:39.816638 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:01:39.818641 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:01:39.819748 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:01:39.821758 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:01:39.708862 => 14:01:39.821758
[0m14:01:39.823855 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:01:39.825353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df078e62-5f9e-4e58-bda7-839d45cd6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3499AE0>]}
[0m14:01:39.827840 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 334[0m in 0.13s]
[0m14:01:39.829852 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:01:39.835117 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:39.836130 [debug] [MainThread]: On master: BEGIN
[0m14:01:39.837135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:39.893907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:01:39.894922 [debug] [MainThread]: On master: COMMIT
[0m14:01:39.895921 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:39.896920 [debug] [MainThread]: On master: COMMIT
[0m14:01:39.897915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:01:39.898917 [debug] [MainThread]: On master: Close
[0m14:01:39.900373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:39.901390 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:01:39.903096 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:01:39.903620 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:01:39.904131 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m14:01:39.905673 [info ] [MainThread]: 
[0m14:01:39.907693 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m14:01:39.910689 [debug] [MainThread]: Command end result
[0m14:01:39.929080 [info ] [MainThread]: 
[0m14:01:39.931078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:01:39.933590 [info ] [MainThread]: 
[0m14:01:39.935114 [error] [MainThread]: [33mDatabase Error in model production_plan (models\staging\production_plan.sql)[0m
[0m14:01:39.936126 [error] [MainThread]:   relation "public.production_plan" does not exist
[0m14:01:39.938639 [error] [MainThread]:   LINE 15:     select * from  "instagrid"."public"."production_plan"
[0m14:01:39.939652 [error] [MainThread]:                               ^
[0m14:01:39.941833 [error] [MainThread]:   compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m14:01:39.944372 [info ] [MainThread]: 
[0m14:01:39.946387 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:01:39.950516 [debug] [MainThread]: Command `dbt run` failed at 14:01:39.950516 after 2.40 seconds
[0m14:01:39.954508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC0FF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3992DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC3993700>]}
[0m14:01:39.956918 [debug] [MainThread]: Flushing usage events
[0m14:02:25.693610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D1E8F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20C67F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20C67EE0>]}


============================== 14:02:25.701146 | 128a2a44-7d04-464e-9380-b4310d6adb45 ==============================
[0m14:02:25.701146 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:02:25.704167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:02:25.875884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20C67FA0>]}
[0m14:02:25.895917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20D85480>]}
[0m14:02:25.915559 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:02:26.005842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:26.006853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:26.016746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D2121BF40>]}
[0m14:02:26.025809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20F098D0>]}
[0m14:02:26.027811 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:02:26.033322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20F09AB0>]}
[0m14:02:26.038876 [info ] [MainThread]: 
[0m14:02:26.040874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:26.043894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:02:26.060953 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:02:26.062959 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:02:26.064158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:26.253933 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:02:26.255459 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:02:26.261131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:02:26.273102 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:02:26.274633 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:02:26.275645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:26.323711 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.324733 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:02:26.325780 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:02:26.333775 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:02:26.336812 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:02:26.337785 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:02:26.344854 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:26.345896 [debug] [MainThread]: On master: BEGIN
[0m14:02:26.346865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:26.391788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.391788 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:26.393860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:02:26.410718 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:02:26.411723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D212510C0>]}
[0m14:02:26.413234 [debug] [MainThread]: On master: ROLLBACK
[0m14:02:26.413760 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:26.414772 [debug] [MainThread]: On master: BEGIN
[0m14:02:26.415773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.416772 [debug] [MainThread]: On master: COMMIT
[0m14:02:26.417772 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:26.418771 [debug] [MainThread]: On master: COMMIT
[0m14:02:26.419774 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:02:26.420773 [debug] [MainThread]: On master: Close
[0m14:02:26.421770 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:02:26.423806 [info ] [MainThread]: 
[0m14:02:26.437085 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m14:02:26.438086 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m14:02:26.439085 [info ] [Thread-1 (]: 1 of 3 START sql table model public.manufactured_units ......................... [RUN]
[0m14:02:26.443595 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m14:02:26.441087 [info ] [Thread-2 (]: 2 of 3 START sql table model public.production_plan ............................ [RUN]
[0m14:02:26.444105 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m14:02:26.447328 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m14:02:26.454672 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m14:02:26.455683 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m14:02:26.461959 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m14:02:26.464534 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 14:02:26.448322 => 14:02:26.464007
[0m14:02:26.470211 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m14:02:26.511038 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 14:02:26.457688 => 14:02:26.511038
[0m14:02:26.539765 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m14:02:26.540765 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m14:02:26.547336 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m14:02:26.549333 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:02:26.550335 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m14:02:26.552332 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:02:26.552332 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:02:26.554944 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m14:02:26.556868 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:02:26.623949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.625049 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:02:26.626964 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m14:02:26.641915 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:02:26.642915 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.650535 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:02:26.651537 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:02:26.653046 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m14:02:26.654074 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  
    

  create  table "instagrid"."public"."production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select  
right(week,1) as year_week,
pn,
plan 
from source
  );
  
[0m14:02:26.655081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:02:26.661087 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:02:26.662086 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m14:02:26.664102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:02:26.680313 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m14:02:26.690902 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:02:26.694922 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:02:26.696944 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:02:26.697962 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m14:02:26.698962 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:02:26.700966 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:02:26.706990 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:02:26.707999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:02:26.708987 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m14:02:26.717009 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:02:26.718011 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m14:02:26.719011 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:02:26.723532 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m14:02:26.725144 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:02:26.726072 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m14:02:26.727071 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:02:26.730071 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 14:02:26.471508 => 14:02:26.730071
[0m14:02:26.730071 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:02:26.731075 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m14:02:26.735161 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:02:26.737167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D212B7EE0>]}
[0m14:02:26.738164 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m14:02:26.739161 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.29s]
[0m14:02:26.743676 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m14:02:26.746944 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:02:26.748940 [info ] [Thread-1 (]: 3 of 3 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:02:26.751394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:02:26.754449 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:02:26.762979 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:02:26.762979 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:02:26.767039 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 14:02:26.541763 => 14:02:26.766017
[0m14:02:26.768017 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m14:02:26.769027 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:02:26.755462 => 14:02:26.769027
[0m14:02:26.771020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20F17D90>]}
[0m14:02:26.772220 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:02:26.773763 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.production_plan ....................... [[32mSELECT 104[0m in 0.32s]
[0m14:02:26.784744 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:02:26.787049 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m14:02:26.793067 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:02:26.795118 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:02:26.796133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:26.857680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.857680 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:02:26.858680 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    select
date,
extract(month from date) as month,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."manufactured_units"
  );
  
[0m14:02:26.871639 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:02:26.875903 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:02:26.876912 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:02:26.879430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:02:26.882970 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:02:26.884001 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:02:26.885290 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:02:26.887301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:02:26.890298 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:02:26.891300 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:02:26.892300 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:02:26.895837 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:02:26.775779 => 14:02:26.894823
[0m14:02:26.895837 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:02:26.897836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '128a2a44-7d04-464e-9380-b4310d6adb45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D21333E20>]}
[0m14:02:26.899838 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 334[0m in 0.15s]
[0m14:02:26.901839 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:02:26.906907 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:26.907904 [debug] [MainThread]: On master: BEGIN
[0m14:02:26.909955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:26.968284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:02:26.969263 [debug] [MainThread]: On master: COMMIT
[0m14:02:26.970255 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:26.970255 [debug] [MainThread]: On master: COMMIT
[0m14:02:26.971257 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:02:26.972259 [debug] [MainThread]: On master: Close
[0m14:02:26.973766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:26.974781 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:02:26.975795 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:02:26.976796 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:02:26.977456 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m14:02:26.978466 [info ] [MainThread]: 
[0m14:02:26.980480 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m14:02:26.982992 [debug] [MainThread]: Command end result
[0m14:02:26.997008 [info ] [MainThread]: 
[0m14:02:26.998012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:27.000012 [info ] [MainThread]: 
[0m14:02:27.003531 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:02:27.006084 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:27.006084 after 1.37 seconds
[0m14:02:27.007079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D1E8F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D2124BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D212F5600>]}
[0m14:02:27.008087 [debug] [MainThread]: Flushing usage events
[0m14:03:49.953613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA741ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA765BC4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA765BC2B0>]}


============================== 14:03:49.960151 | a8a135be-251c-495e-943d-970864a5dc69 ==============================
[0m14:03:49.960151 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:03:49.962151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:03:50.078056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8a135be-251c-495e-943d-970864a5dc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA7654FF10>]}
[0m14:03:50.097147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8a135be-251c-495e-943d-970864a5dc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA766621D0>]}
[0m14:03:50.116777 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:03:50.240749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:50.241797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:50.253993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8a135be-251c-495e-943d-970864a5dc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA76A18CA0>]}
[0m14:03:50.264044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8a135be-251c-495e-943d-970864a5dc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA76751C60>]}
[0m14:03:50.265060 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:03:50.266056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8a135be-251c-495e-943d-970864a5dc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA76751E40>]}
[0m14:03:50.269059 [info ] [MainThread]: 
[0m14:03:50.270058 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:03:50.272060 [debug] [MainThread]: Command end result
[0m14:03:50.292451 [debug] [MainThread]: Command `cli test` succeeded at 14:03:50.291443 after 0.37 seconds
[0m14:03:50.293448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA741ECA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA76751810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA76751840>]}
[0m14:03:50.299592 [debug] [MainThread]: Flushing usage events
[0m14:19:44.000099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D032F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D0565BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D0565BE80>]}


============================== 14:19:44.007380 | d582f242-54ef-41c0-92dc-9160f347fe81 ==============================
[0m14:19:44.007380 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:19:44.026046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:19:44.260891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D0565BF40>]}
[0m14:19:44.275900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05767F40>]}
[0m14:19:44.291565 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:19:44.399778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:44.399778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:44.415429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05B1BF40>]}
[0m14:19:44.431067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05AE9870>]}
[0m14:19:44.431067 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:19:44.431067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05AE99F0>]}
[0m14:19:44.445581 [info ] [MainThread]: 
[0m14:19:44.448582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:44.452598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:19:44.474329 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:19:44.476325 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:19:44.477330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:44.548313 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:19:44.551336 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:19:44.557339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:19:44.568990 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:19:44.569985 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:19:44.571995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:44.644196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:19:44.646193 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:19:44.647196 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:19:44.664203 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:19:44.667740 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:19:44.669736 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:19:44.674113 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:44.674113 [debug] [MainThread]: On master: BEGIN
[0m14:19:44.674113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:44.737847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:44.737847 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:44.737847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:19:44.752505 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:19:44.752505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05B511E0>]}
[0m14:19:44.766026 [debug] [MainThread]: On master: ROLLBACK
[0m14:19:44.767049 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:44.767049 [debug] [MainThread]: On master: BEGIN
[0m14:19:44.767049 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:44.771470 [debug] [MainThread]: On master: COMMIT
[0m14:19:44.771470 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:44.771470 [debug] [MainThread]: On master: COMMIT
[0m14:19:44.771470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:44.771470 [debug] [MainThread]: On master: Close
[0m14:19:44.771470 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:19:44.771470 [info ] [MainThread]: 
[0m14:19:44.796252 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m14:19:44.796252 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m14:19:44.797258 [info ] [Thread-1 (]: 1 of 4 START sql table model public.manufactured_units ......................... [RUN]
[0m14:19:44.804263 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m14:19:44.799258 [info ] [Thread-2 (]: 2 of 4 START sql table model public.production_plan ............................ [RUN]
[0m14:19:44.806663 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m14:19:44.809690 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m14:19:44.810738 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m14:19:44.810738 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m14:19:44.822255 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 14:19:44.810738 => 14:19:44.821255
[0m14:19:44.828252 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m14:19:44.830359 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m14:19:44.898862 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m14:19:44.900867 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 14:19:44.823278 => 14:19:44.899860
[0m14:19:44.903865 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m14:19:44.911875 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m14:19:44.912873 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:19:44.913382 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m14:19:44.914401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:19:44.915400 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:19:44.917397 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m14:19:44.918407 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:19:44.981562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:19:44.981562 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:19:44.981562 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m14:19:44.999925 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:19:45.000638 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:19:45.011026 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m14:19:45.011026 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:19:45.011026 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:19:45.013539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:45.013539 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  
    

  create  table "instagrid"."public"."production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select  
right(week,1) as year_week,
pn,
plan 
from source
  );
  
[0m14:19:45.017026 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:19:45.017026 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m14:19:45.021957 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "week" does not exist
LINE 19: right(week,1) as year_week,
               ^

[0m14:19:45.023038 [debug] [Thread-2 (]: On model.instagrid.production_plan: ROLLBACK
[0m14:19:45.023038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:45.026087 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 14:19:44.904865 => 14:19:45.026087
[0m14:19:45.044713 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:19:45.044713 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m14:19:45.044713 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:19:45.044713 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:19:45.061646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:19:45.067172 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:19:45.067172 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m14:19:45.079126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:19:45.081067 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 14:19:44.832374 => 14:19:45.081067
[0m14:19:45.081067 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m14:19:45.081067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05BACFD0>]}
[0m14:19:45.081067 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.28s]
[0m14:19:45.090296 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m14:19:45.093631 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:19:45.097896 [debug] [Thread-2 (]: Database Error in model production_plan (models\staging\production_plan.sql)
  column "week" does not exist
  LINE 19: right(week,1) as year_week,
                 ^
  compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m14:19:45.095631 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:19:45.101906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:19:45.099898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05BACB50>]}
[0m14:19:45.102905 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:19:45.112003 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:19:45.104901 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model public.production_plan ................... [[31mERROR[0m in 0.29s]
[0m14:19:45.115009 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m14:19:45.118001 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:19:45.106914 => 14:19:45.117005
[0m14:19:45.120009 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:19:45.119005 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m14:19:45.130996 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:19:45.133081 [info ] [Thread-2 (]: 4 of 4 SKIP relation public.dim_production_plan ................................ [[33mSKIP[0m]
[0m14:19:45.136099 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m14:19:45.137102 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:19:45.140098 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:19:45.142117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:45.212737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:19:45.213759 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:19:45.213759 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    select
date,
extract(month from date) as month,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."manufactured_units"
  );
  
[0m14:19:45.228735 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:19:45.233739 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:19:45.234741 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m14:19:45.236735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:45.241739 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:19:45.242739 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:19:45.244737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:45.248759 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:19:45.249743 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:19:45.250731 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:19:45.252891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:19:45.255895 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:19:45.256892 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:19:45.266188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:19:45.267693 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:19:45.121005 => 14:19:45.267693
[0m14:19:45.267693 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:19:45.267693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd582f242-54ef-41c0-92dc-9160f347fe81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05E99120>]}
[0m14:19:45.272158 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 334[0m in 0.17s]
[0m14:19:45.275021 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:19:45.278408 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:45.279424 [debug] [MainThread]: On master: BEGIN
[0m14:19:45.282940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:45.342006 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:45.343007 [debug] [MainThread]: On master: COMMIT
[0m14:19:45.344005 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:45.344005 [debug] [MainThread]: On master: COMMIT
[0m14:19:45.345489 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:45.346503 [debug] [MainThread]: On master: Close
[0m14:19:45.348499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:45.348499 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:19:45.350957 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:19:45.352233 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:19:45.352233 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m14:19:45.354715 [info ] [MainThread]: 
[0m14:19:45.356069 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m14:19:45.363104 [debug] [MainThread]: Command end result
[0m14:19:45.374667 [info ] [MainThread]: 
[0m14:19:45.380797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:45.383838 [info ] [MainThread]: 
[0m14:19:45.386844 [error] [MainThread]: [33mDatabase Error in model production_plan (models\staging\production_plan.sql)[0m
[0m14:19:45.388841 [error] [MainThread]:   column "week" does not exist
[0m14:19:45.390960 [error] [MainThread]:   LINE 19: right(week,1) as year_week,
[0m14:19:45.392340 [error] [MainThread]:                  ^
[0m14:19:45.394360 [error] [MainThread]:   compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m14:19:45.398381 [info ] [MainThread]: 
[0m14:19:45.401359 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:19:45.404356 [debug] [MainThread]: Command `dbt run` failed at 14:19:45.404356 after 1.52 seconds
[0m14:19:45.405375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D032F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05E981F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013D05E87A90>]}
[0m14:19:45.406356 [debug] [MainThread]: Flushing usage events
[0m14:21:07.271731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AB0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD55BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD55BE80>]}


============================== 14:21:07.276731 | 67f7d16a-a8c7-4185-ab7e-36297f1d95c7 ==============================
[0m14:21:07.276731 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:21:07.278736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:21:07.387130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD55BF40>]}
[0m14:21:07.402130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD667F40>]}
[0m14:21:07.417442 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:21:07.521520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:07.522671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:07.533683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ADA17F40>]}
[0m14:21:07.580249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD7E58D0>]}
[0m14:21:07.581267 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:21:07.583282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD7E5AB0>]}
[0m14:21:07.586283 [info ] [MainThread]: 
[0m14:21:07.590790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:21:07.634272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:21:07.659314 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:21:07.661317 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:21:07.662316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:07.883008 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:21:07.886011 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:21:07.894971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:21:07.904980 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:21:07.905993 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:21:07.906998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:07.952286 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:21:07.953285 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:21:07.953285 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:21:07.962211 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:21:07.963192 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:21:07.964189 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:21:07.972994 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:07.973983 [debug] [MainThread]: On master: BEGIN
[0m14:21:07.974982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:08.016276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:21:08.017171 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:08.018169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:21:08.032548 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:21:08.033547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ADA4D0C0>]}
[0m14:21:08.034546 [debug] [MainThread]: On master: ROLLBACK
[0m14:21:08.035805 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:08.036820 [debug] [MainThread]: On master: BEGIN
[0m14:21:08.037820 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:21:08.038818 [debug] [MainThread]: On master: COMMIT
[0m14:21:08.039816 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:08.040816 [debug] [MainThread]: On master: COMMIT
[0m14:21:08.041815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:21:08.042834 [debug] [MainThread]: On master: Close
[0m14:21:08.043819 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:21:08.046335 [info ] [MainThread]: 
[0m14:21:08.055437 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m14:21:08.056445 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m14:21:08.057449 [info ] [Thread-1 (]: 1 of 4 START sql table model public.manufactured_units ......................... [RUN]
[0m14:21:08.061484 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m14:21:08.062477 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m14:21:08.059461 [info ] [Thread-2 (]: 2 of 4 START sql table model public.production_plan ............................ [RUN]
[0m14:21:08.070271 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m14:21:08.072286 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m14:21:08.075289 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m14:21:08.079771 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m14:21:08.080772 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 14:21:08.064483 => 14:21:08.080772
[0m14:21:08.082772 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m14:21:08.084770 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 14:21:08.075289 => 14:21:08.084770
[0m14:21:08.147190 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m14:21:08.148191 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m14:21:08.154211 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m14:21:08.156213 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:21:08.157212 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:21:08.158211 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m14:21:08.159214 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m14:21:08.160212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:21:08.161211 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:21:08.216706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:21:08.217708 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:21:08.218705 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m14:21:08.229649 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:21:08.236647 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:21:08.236647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:21:08.237649 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m14:21:08.238649 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m14:21:08.240786 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  
    

  create  table "instagrid"."public"."production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select  
right(week,1) as year_week,
pn,
plan 
from source
  );
  
[0m14:21:08.241788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:21:08.246795 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:21:08.247782 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "week" does not exist
LINE 19: right(week,1) as year_week,
               ^

[0m14:21:08.247782 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m14:21:08.248781 [debug] [Thread-2 (]: On model.instagrid.production_plan: ROLLBACK
[0m14:21:08.250785 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 14:21:08.149214 => 14:21:08.250785
[0m14:21:08.251798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:21:08.252804 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m14:21:08.277380 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:21:08.279369 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:21:08.280367 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m14:21:08.283364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:21:08.290521 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m14:21:08.292495 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m14:21:08.295860 [debug] [Thread-2 (]: Database Error in model production_plan (models\staging\production_plan.sql)
  column "week" does not exist
  LINE 19: right(week,1) as year_week,
                 ^
  compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m14:21:08.295860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:21:08.296861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ADA15030>]}
[0m14:21:08.298861 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 14:21:08.086764 => 14:21:08.298861
[0m14:21:08.299865 [error] [Thread-2 (]: 2 of 4 ERROR creating sql table model public.production_plan ................... [[31mERROR[0m in 0.23s]
[0m14:21:08.301859 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m14:21:08.302858 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m14:21:08.304859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ADA4F040>]}
[0m14:21:08.309000 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m14:21:08.307993 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.24s]
[0m14:21:08.310988 [info ] [Thread-2 (]: 3 of 4 SKIP relation public.dim_production_plan ................................ [[33mSKIP[0m]
[0m14:21:08.313993 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m14:21:08.314989 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m14:21:08.316988 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:21:08.318989 [info ] [Thread-1 (]: 4 of 4 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:21:08.320989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:21:08.320989 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:21:08.327993 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:21:08.330991 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:21:08.322990 => 14:21:08.329991
[0m14:21:08.331997 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:21:08.341318 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:21:08.344304 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:21:08.345717 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:21:08.347055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:08.400535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:21:08.401554 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:21:08.401554 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    select
date,
extract(month from date) as month,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."manufactured_units"
  );
  
[0m14:21:08.413454 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m14:21:08.418481 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:21:08.419476 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m14:21:08.421455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:21:08.426458 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:21:08.427458 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:21:08.428451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:21:08.432476 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:21:08.432476 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:21:08.433478 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:21:08.435795 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:21:08.439808 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:21:08.440814 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:21:08.446294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:21:08.448325 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:21:08.332998 => 14:21:08.448325
[0m14:21:08.449316 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:21:08.451308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f7d16a-a8c7-4185-ab7e-36297f1d95c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ADAFBAC0>]}
[0m14:21:08.452327 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 334[0m in 0.13s]
[0m14:21:08.454826 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:21:08.458830 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:08.459824 [debug] [MainThread]: On master: BEGIN
[0m14:21:08.461254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:21:08.541612 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:21:08.542647 [debug] [MainThread]: On master: COMMIT
[0m14:21:08.543638 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:08.545618 [debug] [MainThread]: On master: COMMIT
[0m14:21:08.546618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:21:08.547614 [debug] [MainThread]: On master: Close
[0m14:21:08.548615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:08.549615 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:21:08.550705 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:21:08.552083 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:21:08.553097 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m14:21:08.554096 [info ] [MainThread]: 
[0m14:21:08.556095 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m14:21:08.559192 [debug] [MainThread]: Command end result
[0m14:21:08.569957 [info ] [MainThread]: 
[0m14:21:08.573958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:21:08.575960 [info ] [MainThread]: 
[0m14:21:08.579954 [error] [MainThread]: [33mDatabase Error in model production_plan (models\staging\production_plan.sql)[0m
[0m14:21:08.582953 [error] [MainThread]:   column "week" does not exist
[0m14:21:08.588767 [error] [MainThread]:   LINE 19: right(week,1) as year_week,
[0m14:21:08.591942 [error] [MainThread]:                  ^
[0m14:21:08.594945 [error] [MainThread]:   compiled Code at target\run\instagrid\models\staging\production_plan.sql
[0m14:21:08.597938 [info ] [MainThread]: 
[0m14:21:08.603409 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:21:08.609402 [debug] [MainThread]: Command `dbt run` failed at 14:21:08.608415 after 1.36 seconds
[0m14:21:08.610404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AB0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD667F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ADB87250>]}
[0m14:21:08.611402 [debug] [MainThread]: Flushing usage events
[0m15:42:38.113743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E91F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EB65BEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EB65BF10>]}


============================== 15:42:38.118754 | 9292e1a8-cf65-48f6-bfb6-83e8d59ed132 ==============================
[0m15:42:38.118754 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:42:38.125348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:42:38.233026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EB65BFA0>]}
[0m15:42:38.248074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EB765DE0>]}
[0m15:42:38.263720 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:42:38.349846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:38.349846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:38.364857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBB109A0>]}
[0m15:42:38.380506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBAE5960>]}
[0m15:42:38.380506 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:42:38.380506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBAE5B40>]}
[0m15:42:38.392373 [info ] [MainThread]: 
[0m15:42:38.396386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:38.404387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:42:38.424927 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:42:38.425922 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:42:38.426922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.482945 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:42:38.482945 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:42:38.497956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:42:38.497956 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:42:38.497956 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:42:38.497956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.545267 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:42:38.545267 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:42:38.545267 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:42:38.560888 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:42:38.560888 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:42:38.560888 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:42:38.583833 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:38.584830 [debug] [MainThread]: On master: BEGIN
[0m15:42:38.585831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:38.727525 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:38.727525 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:38.743166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:38.758838 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:42:38.758838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBB4D150>]}
[0m15:42:38.758838 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:38.758838 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:38.758838 [debug] [MainThread]: On master: BEGIN
[0m15:42:38.758838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:38.758838 [debug] [MainThread]: On master: COMMIT
[0m15:42:38.758838 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:38.758838 [debug] [MainThread]: On master: COMMIT
[0m15:42:38.758838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:42:38.758838 [debug] [MainThread]: On master: Close
[0m15:42:38.758838 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:42:38.758838 [info ] [MainThread]: 
[0m15:42:38.788942 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m15:42:38.788942 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m15:42:38.790947 [info ] [Thread-1 (]: 1 of 2 START sql table model public.manufactured_units ......................... [RUN]
[0m15:42:38.796951 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m15:42:38.792948 [info ] [Thread-2 (]: 2 of 2 START sql view model public.production_plan ............................. [RUN]
[0m15:42:38.797943 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m15:42:38.799948 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m15:42:38.805969 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m15:42:38.806966 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m15:42:38.812973 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m15:42:38.815475 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 15:42:38.801979 => 15:42:38.814964
[0m15:42:38.817499 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 15:42:38.807963 => 15:42:38.816492
[0m15:42:38.818518 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m15:42:38.820496 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m15:42:38.881514 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m15:42:38.921211 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m15:42:38.924736 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:42:38.924736 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m15:42:38.924736 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:42:38.924736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:38.924736 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m15:42:38.924736 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:38.985318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:42:38.985318 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:42:38.985318 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m15:42:39.001889 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:42:39.001889 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:42:39.001889 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  create view "instagrid"."public"."production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 

replace(week,'W','') as year_week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m15:42:39.001889 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:42:39.015402 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:42:39.017541 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m15:42:39.017541 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:42:39.017541 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:42:39.017541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:39.017541 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m15:42:39.017541 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:42:39.017541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:39.017541 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m15:42:39.035514 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:42:39.035514 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m15:42:39.035514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:39.050528 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:42:39.067400 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m15:42:39.067400 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m15:42:39.067400 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:42:39.083031 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m15:42:39.067400 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:42:39.085700 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:42:39.085700 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m15:42:39.085700 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:42:39.085700 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m15:42:39.085700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:42:39.100540 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:42:39.100540 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m15:42:39.100540 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:42:39.100540 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 15:42:38.881514 => 15:42:39.100540
[0m15:42:39.116214 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m15:42:39.118250 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBC32230>]}
[0m15:42:39.119232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:42:39.121135 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.production_plan ........................ [[32mCREATE VIEW[0m in 0.32s]
[0m15:42:39.124987 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 15:42:38.821494 => 15:42:39.123965
[0m15:42:39.126984 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m15:42:39.127984 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m15:42:39.132981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9292e1a8-cf65-48f6-bfb6-83e8d59ed132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBBB3FD0>]}
[0m15:42:39.135980 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.34s]
[0m15:42:39.138981 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m15:42:39.141981 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:39.142982 [debug] [MainThread]: On master: BEGIN
[0m15:42:39.143982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:42:39.204991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:42:39.205995 [debug] [MainThread]: On master: COMMIT
[0m15:42:39.206990 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:39.207996 [debug] [MainThread]: On master: COMMIT
[0m15:42:39.208995 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:42:39.209995 [debug] [MainThread]: On master: Close
[0m15:42:39.211990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:39.212992 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:42:39.213991 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:42:39.213991 [debug] [MainThread]: Connection 'model.instagrid.manufactured_units' was properly closed.
[0m15:42:39.215505 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m15:42:39.216524 [info ] [MainThread]: 
[0m15:42:39.218522 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m15:42:39.220523 [debug] [MainThread]: Command end result
[0m15:42:39.231519 [info ] [MainThread]: 
[0m15:42:39.232524 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:39.234531 [info ] [MainThread]: 
[0m15:42:39.236527 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:42:39.238530 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:39.238530 after 1.17 seconds
[0m15:42:39.240529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278E91F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EB765DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278EBC3D1B0>]}
[0m15:42:39.241523 [debug] [MainThread]: Flushing usage events
[0m15:43:27.886947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B28CF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B057FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B057EB0>]}


============================== 15:43:27.893945 | a3c66098-b1cc-41aa-9ad8-86d20292a2f4 ==============================
[0m15:43:27.893945 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:43:27.895942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:43:28.024029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B057F70>]}
[0m15:43:28.045029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B1620E0>]}
[0m15:43:28.062119 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:43:28.156469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:28.158467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:28.166990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B51BEB0>]}
[0m15:43:28.182993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B4E98A0>]}
[0m15:43:28.183993 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:43:28.190990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B4E9A20>]}
[0m15:43:28.199470 [info ] [MainThread]: 
[0m15:43:28.202480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:28.204483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:43:28.227485 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:43:28.229481 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:43:28.230479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:28.299508 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:43:28.300510 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:43:28.305017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:43:28.313082 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:43:28.314082 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:43:28.315091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:28.366426 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:43:28.366426 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:43:28.367440 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:43:28.380934 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:43:28.382935 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:43:28.383940 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:43:28.393939 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.394937 [debug] [MainThread]: On master: BEGIN
[0m15:43:28.395935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:28.464811 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:28.465813 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.466815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:28.489912 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:43:28.492912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B554D90>]}
[0m15:43:28.493910 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:28.495914 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.496912 [debug] [MainThread]: On master: BEGIN
[0m15:43:28.497915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:28.498911 [debug] [MainThread]: On master: COMMIT
[0m15:43:28.499916 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.500915 [debug] [MainThread]: On master: COMMIT
[0m15:43:28.501915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:28.502915 [debug] [MainThread]: On master: Close
[0m15:43:28.504914 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:43:28.527916 [info ] [MainThread]: 
[0m15:43:28.556682 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_units
[0m15:43:28.559669 [debug] [Thread-2 (]: Began running node model.instagrid.production_plan
[0m15:43:28.561683 [info ] [Thread-1 (]: 1 of 2 START sql table model public.manufactured_units ......................... [RUN]
[0m15:43:28.565219 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.manufactured_units'
[0m15:43:28.567213 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_units
[0m15:43:28.563198 [info ] [Thread-2 (]: 2 of 2 START sql view model public.production_plan ............................. [RUN]
[0m15:43:28.573468 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_units"
[0m15:43:28.575486 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.production_plan'
[0m15:43:28.577482 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_plan
[0m15:43:28.583488 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_plan"
[0m15:43:28.585484 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (compile): 15:43:28.578485 => 15:43:28.585484
[0m15:43:28.586490 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (compile): 15:43:28.569212 => 15:43:28.586490
[0m15:43:28.587490 [debug] [Thread-2 (]: Began executing node model.instagrid.production_plan
[0m15:43:28.589485 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_units
[0m15:43:28.710514 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_plan"
[0m15:43:28.717515 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_units"
[0m15:43:28.719520 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:43:28.720517 [debug] [Thread-2 (]: On model.instagrid.production_plan: BEGIN
[0m15:43:28.721518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:43:28.723518 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:43:28.725522 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: BEGIN
[0m15:43:28.726515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:43:28.800142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:28.801144 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:43:28.803142 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */

  
    

  create  table "instagrid"."public"."manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m15:43:28.804621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:43:28.805632 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:43:28.806635 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */

  create view "instagrid"."public"."production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 

replace(week,'W','') as year_week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m15:43:28.814635 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:43:28.821658 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:43:28.822663 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:43:28.823635 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units" rename to "manufactured_units__dbt_backup"
[0m15:43:28.827638 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:43:28.829635 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan" rename to "production_plan__dbt_backup"
[0m15:43:28.830635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:28.831634 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:28.835633 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:43:28.840630 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:43:28.843079 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
alter table "instagrid"."public"."production_plan__dbt_tmp" rename to "production_plan"
[0m15:43:28.841669 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
alter table "instagrid"."public"."manufactured_units__dbt_tmp" rename to "manufactured_units"
[0m15:43:28.845091 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:28.868731 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m15:43:28.869733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:43:28.870753 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:43:28.881967 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m15:43:28.882966 [debug] [Thread-2 (]: On model.instagrid.production_plan: COMMIT
[0m15:43:28.883971 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:43:28.886012 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: COMMIT
[0m15:43:28.887027 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:28.895034 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_plan"
[0m15:43:28.896033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:43:28.897030 [debug] [Thread-2 (]: On model.instagrid.production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_plan"} */
drop table if exists "instagrid"."public"."production_plan__dbt_backup" cascade
[0m15:43:28.901430 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_units"
[0m15:43:28.903422 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_units"} */
drop table if exists "instagrid"."public"."manufactured_units__dbt_backup" cascade
[0m15:43:28.909913 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:28.913362 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_units (execute): 15:43:28.652020 => 15:43:28.912337
[0m15:43:28.913362 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:43:28.914353 [debug] [Thread-1 (]: On model.instagrid.manufactured_units: Close
[0m15:43:28.918351 [debug] [Thread-2 (]: Timing info for model.instagrid.production_plan (execute): 15:43:28.590484 => 15:43:28.917354
[0m15:43:28.919355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B54BDC0>]}
[0m15:43:28.920771 [debug] [Thread-2 (]: On model.instagrid.production_plan: Close
[0m15:43:28.924791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c66098-b1cc-41aa-9ad8-86d20292a2f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B5BBF70>]}
[0m15:43:28.922785 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.manufactured_units .................... [[32mSELECT 334[0m in 0.36s]
[0m15:43:28.927981 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_units
[0m15:43:28.925785 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.production_plan ........................ [[32mCREATE VIEW[0m in 0.35s]
[0m15:43:28.930998 [debug] [Thread-2 (]: Finished running node model.instagrid.production_plan
[0m15:43:28.936411 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.937404 [debug] [MainThread]: On master: BEGIN
[0m15:43:28.939609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:29.004755 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:43:29.004755 [debug] [MainThread]: On master: COMMIT
[0m15:43:29.005761 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:29.007243 [debug] [MainThread]: On master: COMMIT
[0m15:43:29.009253 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:43:29.010254 [debug] [MainThread]: On master: Close
[0m15:43:29.012257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:29.013260 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:43:29.014255 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:43:29.014255 [debug] [MainThread]: Connection 'model.instagrid.manufactured_units' was properly closed.
[0m15:43:29.016258 [debug] [MainThread]: Connection 'model.instagrid.production_plan' was properly closed.
[0m15:43:29.017255 [info ] [MainThread]: 
[0m15:43:29.018256 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m15:43:29.021259 [debug] [MainThread]: Command end result
[0m15:43:29.032257 [info ] [MainThread]: 
[0m15:43:29.034258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:29.035258 [info ] [MainThread]: 
[0m15:43:29.037257 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:43:29.040261 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:29.040261 after 1.19 seconds
[0m15:43:29.042274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B28CF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B292E4CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B2B54A6E0>]}
[0m15:43:29.043531 [debug] [MainThread]: Flushing usage events
[0m15:44:35.270858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD59EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C25BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C25BEB0>]}


============================== 15:44:35.276877 | 9921f07c-92be-4dbb-8b1a-b12c81ef06ff ==============================
[0m15:44:35.276877 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:44:35.278059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:44:35.386135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9921f07c-92be-4dbb-8b1a-b12c81ef06ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C25BF70>]}
[0m15:44:35.402448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9921f07c-92be-4dbb-8b1a-b12c81ef06ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C3660E0>]}
[0m15:44:35.418471 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:44:35.521657 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m15:44:35.522631 [debug] [MainThread]: Partial parsing: added file: instagrid://models\staging\sg_production_plan.sql
[0m15:44:35.523659 [debug] [MainThread]: Partial parsing: added file: instagrid://models\staging\sg_manufactured_units.sql
[0m15:44:35.524645 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\staging\manufactured_units.sql
[0m15:44:35.524645 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\staging\production_plan.sql
[0m15:44:35.551113 [debug] [MainThread]: 1699: static parser successfully parsed staging\sg_production_plan.sql
[0m15:44:35.568111 [debug] [MainThread]: 1699: static parser successfully parsed staging\sg_manufactured_units.sql
[0m15:44:35.572110 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m15:44:35.578112 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_production_plan.sql
[0m15:44:35.581112 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instagrid.dim_manufactured_units' (models\warehouse\dim_manufactured_units.sql) depends on a node named 'manufactured_units' which was not found
[0m15:44:35.587123 [debug] [MainThread]: Command `dbt run` failed at 15:44:35.587123 after 0.34 seconds
[0m15:44:35.589150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD59EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C6ECF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C6FCB80>]}
[0m15:44:35.591115 [debug] [MainThread]: Flushing usage events
[0m15:45:14.824842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA53AF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA55E57EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA55E57F10>]}


============================== 15:45:14.830850 | 33a13960-2ca8-43a4-bc10-ae58c1d11d85 ==============================
[0m15:45:14.830850 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:45:14.832843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:45:14.934849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA55E57FA0>]}
[0m15:45:14.951165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA55F65DE0>]}
[0m15:45:14.967695 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:45:15.058735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:15.059739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:15.068907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA563109A0>]}
[0m15:45:15.084125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA562E5960>]}
[0m15:45:15.085132 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:45:15.086131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA562E5B40>]}
[0m15:45:15.089482 [info ] [MainThread]: 
[0m15:45:15.096478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:15.101808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:45:15.119832 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:45:15.121832 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:45:15.123876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:15.192717 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:45:15.195716 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:45:15.199719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:45:15.206718 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:45:15.207719 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:45:15.208717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:15.253072 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:45:15.254080 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:45:15.254080 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:45:15.264070 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m15:45:15.266599 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:45:15.267610 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:45:15.276114 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:15.277143 [debug] [MainThread]: On master: BEGIN
[0m15:45:15.278149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:15.326498 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:45:15.327497 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:15.328497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:45:15.344889 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:45:15.346892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA56351150>]}
[0m15:45:15.347894 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:15.348897 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:15.349896 [debug] [MainThread]: On master: BEGIN
[0m15:45:15.350894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:45:15.351907 [debug] [MainThread]: On master: COMMIT
[0m15:45:15.352906 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:15.353906 [debug] [MainThread]: On master: COMMIT
[0m15:45:15.355905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:45:15.356908 [debug] [MainThread]: On master: Close
[0m15:45:15.357907 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:45:15.361221 [info ] [MainThread]: 
[0m15:45:15.375178 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:45:15.376197 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:45:15.377177 [info ] [Thread-1 (]: 1 of 2 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m15:45:15.382184 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:45:15.378179 [info ] [Thread-2 (]: 2 of 2 START sql view model public.sg_production_plan .......................... [RUN]
[0m15:45:15.385183 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:45:15.387248 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:45:15.392284 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:45:15.393264 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:45:15.400725 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:45:15.402712 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:45:15.388266 => 15:45:15.401718
[0m15:45:15.405086 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:45:15.406084 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:45:15.395261 => 15:45:15.406084
[0m15:45:15.435737 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:45:15.493085 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:45:15.496201 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:45:15.498221 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:45:15.499220 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:45:15.500221 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:15.502216 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:45:15.503222 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:45:15.504220 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:15.583644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:45:15.584647 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:45:15.585646 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m15:45:15.593643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:45:15.594650 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:45:15.594650 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:45:15.596645 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 

replace(week,'W','') as year_week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m15:45:15.605642 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:45:15.606642 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:45:15.608726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:15.623734 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:45:15.627767 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:45:15.631735 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:45:15.632736 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:45:15.633739 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:45:15.634737 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:45:15.635736 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:45:15.639022 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:45:15.639022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:45:15.640020 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:45:15.647010 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:45:15.648009 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:45:15.649014 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:45:15.651015 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:45:15.652028 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:45:15.654028 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:45:15.407085 => 15:45:15.654028
[0m15:45:15.659029 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:45:15.660028 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:45:15.662026 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:45:15.664029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA56330C10>]}
[0m15:45:15.665192 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:45:15.666701 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.28s]
[0m15:45:15.671081 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:45:15.482056 => 15:45:15.671081
[0m15:45:15.674077 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:45:15.676132 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:45:15.679385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33a13960-2ca8-43a4-bc10-ae58c1d11d85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA56346AA0>]}
[0m15:45:15.682047 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m15:45:15.685278 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:45:15.688775 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:15.689792 [debug] [MainThread]: On master: BEGIN
[0m15:45:15.690852 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:15.745499 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:45:15.746502 [debug] [MainThread]: On master: COMMIT
[0m15:45:15.748498 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:15.749497 [debug] [MainThread]: On master: COMMIT
[0m15:45:15.750495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:45:15.751505 [debug] [MainThread]: On master: Close
[0m15:45:15.752516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:15.753520 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:45:15.754520 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:45:15.755516 [debug] [MainThread]: Connection 'model.instagrid.sg_manufactured_units' was properly closed.
[0m15:45:15.756519 [debug] [MainThread]: Connection 'model.instagrid.sg_production_plan' was properly closed.
[0m15:45:15.757518 [info ] [MainThread]: 
[0m15:45:15.759518 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m15:45:15.762926 [debug] [MainThread]: Command end result
[0m15:45:15.773849 [info ] [MainThread]: 
[0m15:45:15.775853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:15.777852 [info ] [MainThread]: 
[0m15:45:15.780100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:45:15.784105 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:15.784105 after 0.99 seconds
[0m15:45:15.785098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA53AF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA562DB2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA563A4250>]}
[0m15:45:15.786107 [debug] [MainThread]: Flushing usage events
[0m16:42:07.172845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A3AF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A5F5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A5F5BEB0>]}


============================== 16:42:07.196884 | 8ec3d22c-e66a-4342-ac59-736f4f4c590a ==============================
[0m16:42:07.196884 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:42:07.198672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:42:07.425905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A5F5BF70>]}
[0m16:42:07.448831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A60660E0>]}
[0m16:42:07.464393 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:42:08.228611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:08.229945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:08.264655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A641BEB0>]}
[0m16:42:08.280148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A61E9900>]}
[0m16:42:08.282149 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:42:08.290201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A61E9AE0>]}
[0m16:42:08.300002 [info ] [MainThread]: 
[0m16:42:08.304517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:08.307483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:42:08.337082 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:42:08.339082 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:42:08.340085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:08.409652 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:42:08.412679 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:42:08.417221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:42:08.422246 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:42:08.425585 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:42:08.426658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:08.482710 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:08.483710 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:42:08.484492 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:42:08.497773 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:42:08.499776 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:42:08.501768 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:42:08.508659 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:08.508659 [debug] [MainThread]: On master: BEGIN
[0m16:42:08.513671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:08.570625 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:08.571623 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:08.572627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:08.612415 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m16:42:08.615614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A6451210>]}
[0m16:42:08.616471 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:08.618612 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:08.620625 [debug] [MainThread]: On master: BEGIN
[0m16:42:08.621627 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:08.623119 [debug] [MainThread]: On master: COMMIT
[0m16:42:08.623630 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:08.625972 [debug] [MainThread]: On master: COMMIT
[0m16:42:08.625972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:08.625972 [debug] [MainThread]: On master: Close
[0m16:42:08.625972 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:42:08.632443 [info ] [MainThread]: 
[0m16:42:08.652720 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m16:42:08.654766 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m16:42:08.656823 [info ] [Thread-1 (]: 1 of 4 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m16:42:08.665164 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m16:42:08.662104 [info ] [Thread-2 (]: 2 of 4 START sql view model public.sg_production_plan .......................... [RUN]
[0m16:42:08.666535 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m16:42:08.668554 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m16:42:08.675657 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m16:42:08.676677 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m16:42:08.685752 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m16:42:08.688768 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 16:42:08.669553 => 16:42:08.687797
[0m16:42:08.689772 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m16:42:08.690770 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 16:42:08.679679 => 16:42:08.689772
[0m16:42:08.770922 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m16:42:08.770922 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m16:42:08.781461 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m16:42:08.783458 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:08.784485 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m16:42:08.785605 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:08.786522 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:08.787521 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m16:42:08.789520 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:08.865129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:08.866161 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:08.866161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:08.867487 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m16:42:08.868505 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:08.870513 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 

replace(week,'W','') as year_week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m16:42:08.878896 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:08.878896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:08.885635 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:08.894353 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:08.895390 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m16:42:08.896375 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m16:42:08.898391 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:08.898391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:08.902394 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:08.906488 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:08.907470 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m16:42:08.909468 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m16:42:08.910468 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:08.911473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:08.933437 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:42:08.935699 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:42:08.935699 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:08.935699 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:08.935699 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:42:08.940208 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:42:08.944965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:08.944965 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:08.954633 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:08.958651 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:08.958651 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m16:42:08.958651 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m16:42:08.965421 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:08.965421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:08.965421 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 16:42:08.772926 => 16:42:08.965421
[0m16:42:08.965421 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 16:42:08.691929 => 16:42:08.965421
[0m16:42:08.965421 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m16:42:08.965421 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m16:42:08.975622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A649DBA0>]}
[0m16:42:08.977659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A6434B80>]}
[0m16:42:08.979762 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m16:42:08.981782 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.31s]
[0m16:42:08.983776 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m16:42:08.985401 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m16:42:08.988437 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m16:42:08.989413 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:42:08.991703 [info ] [Thread-2 (]: 3 of 4 START sql view model public.dim_production_plan ......................... [RUN]
[0m16:42:08.993722 [info ] [Thread-1 (]: 4 of 4 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m16:42:09.003526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m16:42:09.001521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m16:42:09.005077 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:42:09.008093 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m16:42:09.015687 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:42:09.019645 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m16:42:09.024177 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:42:09.009100 => 16:42:09.022660
[0m16:42:09.025696 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:42:09.038343 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:42:09.039316 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 16:42:09.016650 => 16:42:09.039316
[0m16:42:09.040318 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m16:42:09.051226 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m16:42:09.052736 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:09.053756 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:42:09.054785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:09.055874 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:09.056796 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m16:42:09.058798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:09.123466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:09.125627 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:09.125627 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m16:42:09.134710 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:09.134710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:09.134710 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:09.140641 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:09.141389 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
year_week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by week
  );
[0m16:42:09.142423 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:42:09.144453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:09.147467 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:42:09.148465 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:09.149465 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:42:09.151474 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "week" does not exist
LINE 13: group by week
                  ^

[0m16:42:09.152594 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: ROLLBACK
[0m16:42:09.154113 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 16:42:09.042319 => 16:42:09.153605
[0m16:42:09.154620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:09.155631 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m16:42:09.161052 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:09.163537 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:42:09.165633 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:09.168585 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:42:09.028726 => 16:42:09.168585
[0m16:42:09.169588 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:42:09.171591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A61DAE60>]}
[0m16:42:09.174809 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.17s]
[0m16:42:09.177795 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:42:09.310605 [debug] [Thread-2 (]: Database Error in model dim_production_plan (models\warehouse\dim_production_plan.sql)
  column "week" does not exist
  LINE 13: group by week
                    ^
  compiled Code at target\run\instagrid\models\warehouse\dim_production_plan.sql
[0m16:42:09.311606 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ec3d22c-e66a-4342-ac59-736f4f4c590a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A6533D90>]}
[0m16:42:09.313598 [error] [Thread-2 (]: 3 of 4 ERROR creating sql view model public.dim_production_plan ................ [[31mERROR[0m in 0.31s]
[0m16:42:09.316269 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m16:42:09.322843 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:09.324545 [debug] [MainThread]: On master: BEGIN
[0m16:42:09.326440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:09.396004 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:09.397020 [debug] [MainThread]: On master: COMMIT
[0m16:42:09.397020 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:09.397998 [debug] [MainThread]: On master: COMMIT
[0m16:42:09.399007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:09.399999 [debug] [MainThread]: On master: Close
[0m16:42:09.402003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:09.402787 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:42:09.403798 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:42:09.404344 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m16:42:09.405467 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m16:42:09.406488 [info ] [MainThread]: 
[0m16:42:09.408478 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m16:42:09.411685 [debug] [MainThread]: Command end result
[0m16:42:09.422745 [info ] [MainThread]: 
[0m16:42:09.426395 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:42:09.428503 [info ] [MainThread]: 
[0m16:42:09.430624 [error] [MainThread]: [33mDatabase Error in model dim_production_plan (models\warehouse\dim_production_plan.sql)[0m
[0m16:42:09.431628 [error] [MainThread]:   column "week" does not exist
[0m16:42:09.433626 [error] [MainThread]:   LINE 13: group by week
[0m16:42:09.435753 [error] [MainThread]:                     ^
[0m16:42:09.437129 [error] [MainThread]:   compiled Code at target\run\instagrid\models\warehouse\dim_production_plan.sql
[0m16:42:09.439146 [info ] [MainThread]: 
[0m16:42:09.441159 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:42:09.449922 [debug] [MainThread]: Command `dbt run` failed at 16:42:09.448435 after 2.41 seconds
[0m16:42:09.450934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A3AF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A60660E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A6451210>]}
[0m16:42:09.454494 [debug] [MainThread]: Flushing usage events
[0m16:42:55.036062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D2EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D527BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D527BE80>]}


============================== 16:42:55.044024 | fbda56d4-f96f-4df5-9671-89988ef9fb5b ==============================
[0m16:42:55.044024 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:42:55.047534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:42:55.246750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D527BF40>]}
[0m16:42:55.267301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D5397F40>]}
[0m16:42:55.291561 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:42:55.521132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:55.522139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:55.533703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D5817F40>]}
[0m16:42:55.549285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D55158D0>]}
[0m16:42:55.552692 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:42:55.556201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D5515AB0>]}
[0m16:42:55.556201 [info ] [MainThread]: 
[0m16:42:55.556201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:55.564748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:42:55.592575 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:42:55.593576 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:42:55.594597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:55.692835 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:42:55.695418 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:42:55.699000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:42:55.708574 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:42:55.709574 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:42:55.710576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:55.763729 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:55.764759 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:42:55.764759 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:42:55.779226 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:42:55.782228 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:42:55.783737 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:42:55.797320 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:55.797320 [debug] [MainThread]: On master: BEGIN
[0m16:42:55.798321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:55.845494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:55.845494 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:55.850518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:55.865665 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m16:42:55.869241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D584D0C0>]}
[0m16:42:55.870256 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:55.871262 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:55.872400 [debug] [MainThread]: On master: BEGIN
[0m16:42:55.874450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:55.875463 [debug] [MainThread]: On master: COMMIT
[0m16:42:55.876464 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:55.876464 [debug] [MainThread]: On master: COMMIT
[0m16:42:55.877463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:55.878462 [debug] [MainThread]: On master: Close
[0m16:42:55.880465 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:42:55.881766 [info ] [MainThread]: 
[0m16:42:55.894569 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m16:42:55.895837 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m16:42:55.896840 [info ] [Thread-1 (]: 1 of 4 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m16:42:55.898842 [info ] [Thread-2 (]: 2 of 4 START sql view model public.sg_production_plan .......................... [RUN]
[0m16:42:55.901006 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m16:42:55.907065 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m16:42:55.911067 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m16:42:55.909068 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m16:42:55.917150 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m16:42:55.925463 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m16:42:55.927481 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 16:42:55.912068 => 16:42:55.927481
[0m16:42:55.929479 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m16:42:55.931029 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 16:42:55.918180 => 16:42:55.929479
[0m16:42:55.990369 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m16:42:56.012347 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m16:42:56.017498 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m16:42:56.020596 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:56.021608 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m16:42:56.022610 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:56.023608 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:56.024626 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m16:42:56.026656 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:56.088520 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:56.088520 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:56.088520 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 

replace(week,'W','') as year_week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m16:42:56.110414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:56.111419 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:56.112416 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m16:42:56.112416 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:56.125757 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:56.126287 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:56.126287 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m16:42:56.131295 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:56.132295 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m16:42:56.132295 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:56.136251 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:56.136251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:56.136251 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m16:42:56.143776 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:56.145410 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:56.145410 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m16:42:56.174417 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:42:56.175448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:56.176427 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:56.180431 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:42:56.181435 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:42:56.181435 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:56.182876 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:42:56.184421 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:56.193552 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:42:56.194571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:56.194571 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m16:42:56.199585 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:42:56.201585 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m16:42:56.204609 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:56.208965 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 16:42:55.931556 => 16:42:56.208965
[0m16:42:56.209964 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:56.209964 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m16:42:56.213494 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 16:42:56.012347 => 16:42:56.211957
[0m16:42:56.215018 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D590B040>]}
[0m16:42:56.216030 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m16:42:56.219304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D5925AE0>]}
[0m16:42:56.217315 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m16:42:56.225919 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m16:42:56.224275 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.32s]
[0m16:42:56.230003 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m16:42:56.232129 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m16:42:56.233655 [info ] [Thread-2 (]: 3 of 4 START sql view model public.dim_production_plan ......................... [RUN]
[0m16:42:56.239198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m16:42:56.240195 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m16:42:56.241198 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:42:56.247245 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m16:42:56.248244 [info ] [Thread-1 (]: 4 of 4 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m16:42:56.256039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m16:42:56.259031 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:42:56.267756 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:42:56.271055 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 16:42:56.242197 => 16:42:56.270038
[0m16:42:56.273569 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:42:56.260257 => 16:42:56.273569
[0m16:42:56.275113 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m16:42:56.276129 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:42:56.288793 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m16:42:56.299330 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:42:56.302335 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:56.305445 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:42:56.304481 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:56.306461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:56.308463 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m16:42:56.311813 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:56.380755 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:56.381750 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:56.382752 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
year_week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by year_week
  );
[0m16:42:56.384776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:56.386212 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:56.387795 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m16:42:56.395471 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:56.400508 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:42:56.395471 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:56.406431 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:56.407437 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m16:42:56.408462 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:42:56.410437 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:56.410437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:56.414447 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m16:42:56.416463 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:42:56.417459 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:56.419099 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:56.419639 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m16:42:56.420886 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:42:56.423460 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:56.424485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:56.426385 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:42:56.426385 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:42:56.426385 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m16:42:56.434451 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:42:56.435694 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:56.438707 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 16:42:56.277129 => 16:42:56.438707
[0m16:42:56.438707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:42:56.439705 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m16:42:56.442706 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:42:56.290792 => 16:42:56.442706
[0m16:42:56.444435 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D58F1510>]}
[0m16:42:56.445505 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:42:56.449700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbda56d4-f96f-4df5-9671-89988ef9fb5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D58A42E0>]}
[0m16:42:56.447448 [info ] [Thread-2 (]: 3 of 4 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.21s]
[0m16:42:56.452719 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.19s]
[0m16:42:56.462129 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m16:42:56.463643 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:42:56.467181 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:56.470330 [debug] [MainThread]: On master: BEGIN
[0m16:42:56.472341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:56.546397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:56.546397 [debug] [MainThread]: On master: COMMIT
[0m16:42:56.547398 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:56.548402 [debug] [MainThread]: On master: COMMIT
[0m16:42:56.549535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:56.550554 [debug] [MainThread]: On master: Close
[0m16:42:56.551546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:56.553544 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:42:56.554573 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:42:56.556969 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m16:42:56.558244 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m16:42:56.559263 [info ] [MainThread]: 
[0m16:42:56.560262 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m16:42:56.563774 [debug] [MainThread]: Command end result
[0m16:42:56.575539 [info ] [MainThread]: 
[0m16:42:56.577542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:56.579542 [info ] [MainThread]: 
[0m16:42:56.583548 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:42:56.591937 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:56.590936 after 1.62 seconds
[0m16:42:56.591937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D2EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D5397F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2D550B2B0>]}
[0m16:42:56.593455 [debug] [MainThread]: Flushing usage events
[0m16:46:50.625859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5302F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C53265BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C53265BEE0>]}


============================== 16:46:50.630859 | 703c999f-463d-4817-a7d1-c1700eb63e61 ==============================
[0m16:46:50.630859 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:46:50.632861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:46:50.747773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C53265BF40>]}
[0m16:46:50.761742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C532776C20>]}
[0m16:46:50.776777 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:46:50.863601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:50.864599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:50.872882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C532C1BEB0>]}
[0m16:46:50.881883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5328F9930>]}
[0m16:46:50.883884 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:46:50.885392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5328F9B10>]}
[0m16:46:50.887411 [info ] [MainThread]: 
[0m16:46:50.890407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:50.898954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:46:50.918974 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:46:50.918974 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:46:50.919977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:51.093371 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:46:51.095376 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:46:51.100372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:46:51.107372 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:46:51.108373 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:46:51.108373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:51.151421 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:46:51.152420 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:46:51.152420 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:46:51.161422 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:46:51.163426 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:46:51.164420 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:46:51.172431 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:51.173433 [debug] [MainThread]: On master: BEGIN
[0m16:46:51.174430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:51.341494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:46:51.342497 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:51.343496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:51.361493 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m16:46:51.365492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C532C54DC0>]}
[0m16:46:51.366493 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:51.367615 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:51.367615 [debug] [MainThread]: On master: BEGIN
[0m16:46:51.370198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:46:51.370198 [debug] [MainThread]: On master: COMMIT
[0m16:46:51.372417 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:51.372417 [debug] [MainThread]: On master: COMMIT
[0m16:46:51.374418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:51.374418 [debug] [MainThread]: On master: Close
[0m16:46:51.376415 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:46:51.377619 [info ] [MainThread]: 
[0m16:46:51.392153 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:46:51.392153 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m16:46:51.394284 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m16:46:51.396306 [info ] [Thread-2 (]: 2 of 2 START sql view model public.dim_production_plan ......................... [RUN]
[0m16:46:51.399301 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_manufactured_units'
[0m16:46:51.401297 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.dim_production_plan'
[0m16:46:51.403301 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:46:51.404304 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m16:46:51.410964 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:46:51.416413 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m16:46:51.419470 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:46:51.405677 => 16:46:51.419470
[0m16:46:51.422480 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 16:46:51.411968 => 16:46:51.421472
[0m16:46:51.424479 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:46:51.426477 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m16:46:51.481994 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:46:51.486082 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m16:46:51.489094 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:46:51.490092 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:46:51.491094 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:46:51.492093 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m16:46:51.493096 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:51.494096 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:46:51.544578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:46:51.545572 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:46:51.546574 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m16:46:51.551662 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:46:51.552672 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:46:51.553675 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
year_week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by year_week
  );
[0m16:46:51.555673 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:46:51.565202 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:46:51.566204 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:46:51.566204 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m16:46:51.570471 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:46:51.572812 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m16:46:51.572812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:51.577810 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:46:51.578811 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:51.579809 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:46:51.584122 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:46:51.586665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:51.587667 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m16:46:51.606661 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:46:51.609031 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:46:51.609031 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:51.610028 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:46:51.613042 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m16:46:51.614036 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:46:51.615028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:51.616027 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m16:46:51.624052 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:46:51.625026 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:46:51.626027 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:51.631024 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:46:51.631024 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:51.633045 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m16:46:51.636206 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:46:51.427476 => 16:46:51.636206
[0m16:46:51.638207 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:46:51.638207 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:46:51.640206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C532D10520>]}
[0m16:46:51.644205 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 16:46:51.482565 => 16:46:51.643204
[0m16:46:51.645206 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:46:51.647205 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m16:46:51.649207 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:46:51.650322 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '703c999f-463d-4817-a7d1-c1700eb63e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C532D13B50>]}
[0m16:46:51.654343 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:46:51.656338 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m16:46:51.661596 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:51.662598 [debug] [MainThread]: On master: BEGIN
[0m16:46:51.663599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:51.716279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:46:51.716279 [debug] [MainThread]: On master: COMMIT
[0m16:46:51.717279 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:51.718276 [debug] [MainThread]: On master: COMMIT
[0m16:46:51.719269 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:51.720266 [debug] [MainThread]: On master: Close
[0m16:46:51.722270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:51.724272 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:46:51.725399 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:46:51.725399 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m16:46:51.726635 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m16:46:51.727650 [info ] [MainThread]: 
[0m16:46:51.728649 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m16:46:51.731652 [debug] [MainThread]: Command end result
[0m16:46:51.747036 [info ] [MainThread]: 
[0m16:46:51.749036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:51.751037 [info ] [MainThread]: 
[0m16:46:51.752035 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:46:51.755032 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:51.754030 after 1.16 seconds
[0m16:46:51.756037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5302F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5328EB2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5328F9A80>]}
[0m16:46:51.757037 [debug] [MainThread]: Flushing usage events
[0m22:15:38.678682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19BDF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E177FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E177E80>]}


============================== 22:15:38.703908 | 6fda540b-3c3a-4375-b34d-67bcefb2ffe2 ==============================
[0m22:15:38.703908 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:15:38.714073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:15:39.105719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E177EE0>]}
[0m22:15:39.120728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E297F40>]}
[0m22:15:39.136368 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m22:15:39.249310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:39.249310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:39.296556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E717F40>]}
[0m22:15:39.325133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E6E58D0>]}
[0m22:15:39.325133 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:15:39.327649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E6E5AB0>]}
[0m22:15:39.329838 [info ] [MainThread]: 
[0m22:15:39.335858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:39.347924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m22:15:39.377412 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m22:15:39.377412 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m22:15:39.384925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:39.481595 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m22:15:39.481595 [debug] [ThreadPool]: On list_instagrid: Close
[0m22:15:39.495257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m22:15:39.497428 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m22:15:39.497428 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m22:15:39.513118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:39.593739 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:15:39.593739 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m22:15:39.593739 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:15:39.624225 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:15:39.624225 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m22:15:39.624225 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m22:15:39.641094 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:39.641094 [debug] [MainThread]: On master: BEGIN
[0m22:15:39.641094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:39.719109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:39.724152 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:39.725852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:39.756869 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m22:15:39.756869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E74D210>]}
[0m22:15:39.756869 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:39.766886 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:39.766886 [debug] [MainThread]: On master: BEGIN
[0m22:15:39.769743 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:39.769743 [debug] [MainThread]: On master: COMMIT
[0m22:15:39.769743 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:39.769743 [debug] [MainThread]: On master: COMMIT
[0m22:15:39.776031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:15:39.777082 [debug] [MainThread]: On master: Close
[0m22:15:39.777742 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:15:39.783956 [info ] [MainThread]: 
[0m22:15:39.816825 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m22:15:39.816825 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m22:15:39.823840 [info ] [Thread-1 (]: 1 of 2 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m22:15:39.833820 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_manufactured_units'
[0m22:15:39.833820 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m22:15:39.823840 [info ] [Thread-2 (]: 2 of 2 START sql view model public.dim_production_plan ......................... [RUN]
[0m22:15:39.845322 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m22:15:39.845322 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.dim_production_plan'
[0m22:15:39.848851 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m22:15:39.857829 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m22:15:39.860487 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 22:15:39.833820 => 22:15:39.860487
[0m22:15:39.860487 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m22:15:39.873312 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 22:15:39.848851 => 22:15:39.873312
[0m22:15:39.889753 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m22:15:39.976930 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m22:15:39.976930 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m22:15:39.976930 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:39.976930 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m22:15:39.976930 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:39.986445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:39.986445 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m22:15:39.986445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:40.066092 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:40.066092 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:40.066092 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
year_week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by year_week
  );
[0m22:15:40.081787 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:40.097433 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:40.097433 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m22:15:40.097433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:40.097433 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:40.097433 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:40.107750 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m22:15:40.107750 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:40.114120 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m22:15:40.114120 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:40.129125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:40.130376 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m22:15:40.148056 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:40.148056 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:40.148056 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m22:15:40.148056 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m22:15:40.158094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:40.163182 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:40.167963 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:40.169347 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m22:15:40.177604 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:40.177604 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m22:15:40.177604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:40.186675 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m22:15:40.186675 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:40.186675 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:40.192688 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 22:15:39.930753 => 22:15:40.192688
[0m22:15:40.192688 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m22:15:40.192688 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m22:15:40.192688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E74AB30>]}
[0m22:15:40.192688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:40.211632 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:40.200617 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.35s]
[0m22:15:40.211632 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m22:15:40.216807 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m22:15:40.219821 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:40.226888 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 22:15:39.863773 => 22:15:40.225915
[0m22:15:40.227910 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m22:15:40.227910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fda540b-3c3a-4375-b34d-67bcefb2ffe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E82FAF0>]}
[0m22:15:40.232832 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.40s]
[0m22:15:40.235495 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m22:15:40.239984 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:40.241216 [debug] [MainThread]: On master: BEGIN
[0m22:15:40.243689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:40.328144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:40.329203 [debug] [MainThread]: On master: COMMIT
[0m22:15:40.330919 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:40.330919 [debug] [MainThread]: On master: COMMIT
[0m22:15:40.332928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:15:40.332928 [debug] [MainThread]: On master: Close
[0m22:15:40.332928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:40.332928 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m22:15:40.332928 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m22:15:40.340941 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m22:15:40.340941 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m22:15:40.340941 [info ] [MainThread]: 
[0m22:15:40.344191 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m22:15:40.347753 [debug] [MainThread]: Command end result
[0m22:15:40.358080 [info ] [MainThread]: 
[0m22:15:40.358928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:40.358928 [info ] [MainThread]: 
[0m22:15:40.358928 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:15:40.365944 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:40.365944 after 1.87 seconds
[0m22:15:40.365944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19BDF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E297F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B19E824940>]}
[0m22:15:40.365944 [debug] [MainThread]: Flushing usage events
[0m22:15:50.118343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF4EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7357FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7357EB0>]}


============================== 22:15:50.125729 | 9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7 ==============================
[0m22:15:50.125729 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:15:50.131069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:15:50.268683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7357F10>]}
[0m22:15:50.301258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7467F10>]}
[0m22:15:50.317046 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m22:15:50.427554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:50.427554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:50.443203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF781BEB0>]}
[0m22:15:50.459100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF75E58A0>]}
[0m22:15:50.459100 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:15:50.467311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF75E5A20>]}
[0m22:15:50.475594 [info ] [MainThread]: 
[0m22:15:50.475594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:15:50.485486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m22:15:50.510384 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m22:15:50.510384 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m22:15:50.510384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:50.598291 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m22:15:50.598291 [debug] [ThreadPool]: On list_instagrid: Close
[0m22:15:50.613419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m22:15:50.614583 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m22:15:50.629103 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m22:15:50.629103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:50.732912 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:15:50.732912 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m22:15:50.732912 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:15:50.739921 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m22:15:50.739921 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m22:15:50.739921 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m22:15:50.757135 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:50.757135 [debug] [MainThread]: On master: BEGIN
[0m22:15:50.757135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:50.821094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:50.821094 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:50.821094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:15:50.856901 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m22:15:50.866998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7851120>]}
[0m22:15:50.866998 [debug] [MainThread]: On master: ROLLBACK
[0m22:15:50.875764 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:50.875764 [debug] [MainThread]: On master: BEGIN
[0m22:15:50.880846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:50.881863 [debug] [MainThread]: On master: COMMIT
[0m22:15:50.881863 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:50.881863 [debug] [MainThread]: On master: COMMIT
[0m22:15:50.881863 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:15:50.889883 [debug] [MainThread]: On master: Close
[0m22:15:50.889883 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:15:50.899626 [info ] [MainThread]: 
[0m22:15:50.930526 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m22:15:50.930526 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m22:15:50.930526 [info ] [Thread-1 (]: 1 of 4 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m22:15:50.938546 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m22:15:50.930526 [info ] [Thread-2 (]: 2 of 4 START sql view model public.sg_production_plan .......................... [RUN]
[0m22:15:50.942704 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m22:15:50.942704 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m22:15:50.972446 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m22:15:50.979498 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m22:15:50.955029 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m22:15:50.991339 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 22:15:50.972446 => 22:15:50.991339
[0m22:15:50.995875 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m22:15:50.995875 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 22:15:50.946722 => 22:15:50.995875
[0m22:15:51.077364 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m22:15:51.134086 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m22:15:51.143786 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m22:15:51.143786 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:15:51.143786 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m22:15:51.150301 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:15:51.150301 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:51.150301 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m22:15:51.150301 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:51.218287 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:51.218287 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:15:51.222882 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m22:15:51.229581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:51.229581 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:15:51.229581 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:51.229581 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m22:15:51.245250 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:15:51.245250 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m22:15:51.245250 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:51.245250 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:15:51.245250 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m22:15:51.245250 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:51.260264 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:51.260264 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:15:51.275914 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m22:15:51.275914 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m22:15:51.275914 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:15:51.289515 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m22:15:51.290524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:51.292778 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:15:51.292778 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m22:15:51.292778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:51.302463 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:51.307010 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m22:15:51.308022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:15:51.308022 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:15:51.308022 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m22:15:51.322136 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m22:15:51.326722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:51.326722 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:51.326722 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:15:51.340241 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 22:15:50.998845 => 22:15:51.326722
[0m22:15:51.340241 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m22:15:51.340241 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m22:15:51.340241 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF79206D0>]}
[0m22:15:51.348231 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:51.348231 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.40s]
[0m22:15:51.353605 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 22:15:51.118051 => 22:15:51.353605
[0m22:15:51.353605 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m22:15:51.361803 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m22:15:51.361803 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m22:15:51.366322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF78F5ED0>]}
[0m22:15:51.366322 [info ] [Thread-2 (]: 3 of 4 START sql view model public.dim_production_plan ......................... [RUN]
[0m22:15:51.369923 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.44s]
[0m22:15:51.378036 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m22:15:51.369923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m22:15:51.381340 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m22:15:51.389643 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m22:15:51.390662 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 22:15:51.381340 => 22:15:51.390662
[0m22:15:51.394679 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m22:15:51.394679 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m22:15:51.410729 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m22:15:51.410729 [info ] [Thread-1 (]: 4 of 4 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m22:15:51.418700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m22:15:51.418700 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:51.418700 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m22:15:51.422769 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m22:15:51.432504 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m22:15:51.432504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:15:51.435020 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 22:15:51.426790 => 22:15:51.435020
[0m22:15:51.438225 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m22:15:51.452393 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m22:15:51.452393 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:51.460877 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m22:15:51.464096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:51.539021 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:51.539021 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:15:51.539021 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
year_week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by year_week
  );
[0m22:15:51.544179 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "year_week" does not exist
LINE 8: year_week,
        ^

[0m22:15:51.544179 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: ROLLBACK
[0m22:15:51.549990 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 22:15:51.394679 => 22:15:51.544179
[0m22:15:51.549990 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m22:15:51.566538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:15:51.566538 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:51.566538 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m22:15:51.583255 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:15:51.583255 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:51.583255 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m22:15:51.590633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:15:51.591155 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m22:15:51.591155 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:51.591155 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m22:15:51.598180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:15:51.604280 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:15:51.606317 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m22:15:51.607819 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:15:51.609819 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 22:15:51.438225 => 22:15:51.609819
[0m22:15:51.613840 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m22:15:51.613840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF786E7A0>]}
[0m22:15:51.613840 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.20s]
[0m22:15:51.622677 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m22:15:51.737290 [debug] [Thread-2 (]: Database Error in model dim_production_plan (models\warehouse\dim_production_plan.sql)
  column "year_week" does not exist
  LINE 8: year_week,
          ^
  compiled Code at target\run\instagrid\models\warehouse\dim_production_plan.sql
[0m22:15:51.737290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cfe6cb2-f01e-4f3c-9f29-898131b6b2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF792BE50>]}
[0m22:15:51.737290 [error] [Thread-2 (]: 3 of 4 ERROR creating sql view model public.dim_production_plan ................ [[31mERROR[0m in 0.37s]
[0m22:15:51.750500 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m22:15:51.758527 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.763077 [debug] [MainThread]: On master: BEGIN
[0m22:15:51.764789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:51.848329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:15:51.850228 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.850228 [debug] [MainThread]: Using postgres connection "master"
[0m22:15:51.851360 [debug] [MainThread]: On master: COMMIT
[0m22:15:51.852794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:15:51.852794 [debug] [MainThread]: On master: Close
[0m22:15:51.854750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:51.857973 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m22:15:51.859369 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m22:15:51.859369 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m22:15:51.862114 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m22:15:51.863912 [info ] [MainThread]: 
[0m22:15:51.864922 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m22:15:51.864922 [debug] [MainThread]: Command end result
[0m22:15:51.883056 [info ] [MainThread]: 
[0m22:15:51.883056 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:15:51.895595 [info ] [MainThread]: 
[0m22:15:51.899820 [error] [MainThread]: [33mDatabase Error in model dim_production_plan (models\warehouse\dim_production_plan.sql)[0m
[0m22:15:51.907495 [error] [MainThread]:   column "year_week" does not exist
[0m22:15:51.931092 [error] [MainThread]:   LINE 8: year_week,
[0m22:15:51.935359 [error] [MainThread]:           ^
[0m22:15:51.938014 [error] [MainThread]:   compiled Code at target\run\instagrid\models\warehouse\dim_production_plan.sql
[0m22:15:51.943449 [info ] [MainThread]: 
[0m22:15:51.946037 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:15:51.948067 [debug] [MainThread]: Command `dbt run` failed at 22:15:51.948067 after 1.87 seconds
[0m22:15:51.948067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF4EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF7357F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AF75E5210>]}
[0m22:15:51.948067 [debug] [MainThread]: Flushing usage events
[0m22:16:21.897383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172624F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264857FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264857EB0>]}


============================== 22:16:21.897383 | 2f7d1150-24c7-4b52-8a2b-4f0712903a88 ==============================
[0m22:16:21.897383 [info ] [MainThread]: Running with dbt=1.5.1
[0m22:16:21.897383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:16:22.048190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264857F70>]}
[0m22:16:22.061276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172649660E0>]}
[0m22:16:22.079133 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m22:16:22.203113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:22.203113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:22.218753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264D17EB0>]}
[0m22:16:22.218753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264CE5900>]}
[0m22:16:22.218753 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m22:16:22.232920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264CE5AE0>]}
[0m22:16:22.244143 [info ] [MainThread]: 
[0m22:16:22.249168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:16:22.252135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m22:16:22.272922 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m22:16:22.272922 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m22:16:22.272922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:22.378532 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m22:16:22.378532 [debug] [ThreadPool]: On list_instagrid: Close
[0m22:16:22.393848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m22:16:22.410457 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m22:16:22.410457 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m22:16:22.410457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:22.522654 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:16:22.522654 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m22:16:22.522654 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m22:16:22.544148 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m22:16:22.548722 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m22:16:22.552631 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m22:16:22.561136 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:22.561136 [debug] [MainThread]: On master: BEGIN
[0m22:16:22.569395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:22.642077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:16:22.642077 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:22.642077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:16:22.672050 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m22:16:22.687658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264D4D120>]}
[0m22:16:22.687658 [debug] [MainThread]: On master: ROLLBACK
[0m22:16:22.687658 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:22.687658 [debug] [MainThread]: On master: BEGIN
[0m22:16:22.687658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:16:22.703672 [debug] [MainThread]: On master: COMMIT
[0m22:16:22.703672 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:22.703672 [debug] [MainThread]: On master: COMMIT
[0m22:16:22.703672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:16:22.703672 [debug] [MainThread]: On master: Close
[0m22:16:22.703672 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m22:16:22.722384 [info ] [MainThread]: 
[0m22:16:22.744004 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m22:16:22.744004 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m22:16:22.748521 [info ] [Thread-1 (]: 1 of 4 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m22:16:22.760274 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m22:16:22.760274 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m22:16:22.770239 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m22:16:22.776402 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 22:16:22.760274 => 22:16:22.772380
[0m22:16:22.776402 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m22:16:22.756745 [info ] [Thread-2 (]: 2 of 4 START sql view model public.sg_production_plan .......................... [RUN]
[0m22:16:22.865824 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m22:16:22.874323 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m22:16:22.874323 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m22:16:22.882718 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m22:16:22.887372 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:16:22.890891 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m22:16:22.890891 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 22:16:22.874323 => 22:16:22.890891
[0m22:16:22.890891 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:22.890891 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m22:16:22.907174 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m22:16:22.915836 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:16:22.915836 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m22:16:22.923365 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:16:22.980582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:16:22.980582 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:16:22.987741 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m22:16:22.995846 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:16:22.995846 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:16:22.995846 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m22:16:23.008423 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:16:23.008423 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:16:23.008423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:16:23.010977 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m22:16:23.012709 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:16:23.020568 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m22:16:23.020568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:16:23.042325 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:16:23.042325 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m22:16:23.048925 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:16:23.048925 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:16:23.048925 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m22:16:23.056550 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m22:16:23.059726 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:16:23.069082 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:16:23.069082 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m22:16:23.069082 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:16:23.074593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:16:23.076513 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m22:16:23.085396 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m22:16:23.085396 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:16:23.098917 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m22:16:23.098917 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m22:16:23.098917 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:16:23.098917 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:16:23.114570 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m22:16:23.119519 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 22:16:22.776402 => 22:16:23.119519
[0m22:16:23.119519 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m22:16:23.119519 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m22:16:23.130550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264DE1D20>]}
[0m22:16:23.135769 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:16:23.138847 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.37s]
[0m22:16:23.142639 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 22:16:22.890891 => 22:16:23.142639
[0m22:16:23.151330 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m22:16:23.151330 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m22:16:23.157427 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m22:16:23.162064 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264DCC6D0>]}
[0m22:16:23.162064 [info ] [Thread-1 (]: 3 of 4 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m22:16:23.167190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m22:16:23.167190 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.29s]
[0m22:16:23.167190 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m22:16:23.175208 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m22:16:23.184036 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m22:16:23.191555 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m22:16:23.191555 [info ] [Thread-2 (]: 4 of 4 START sql view model public.dim_production_plan ......................... [RUN]
[0m22:16:23.191555 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m22:16:23.199585 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 22:16:23.175208 => 22:16:23.199585
[0m22:16:23.199585 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m22:16:23.203974 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m22:16:23.210192 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m22:16:23.223186 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m22:16:23.226627 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:16:23.226627 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m22:16:23.226627 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 22:16:23.205211 => 22:16:23.226627
[0m22:16:23.232616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:23.232616 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m22:16:23.252407 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m22:16:23.252407 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:16:23.257424 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m22:16:23.260463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:16:23.355243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:16:23.355243 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:16:23.355243 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m22:16:23.355243 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
extract(week from date) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m22:16:23.355243 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:16:23.355243 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by week
  );
[0m22:16:23.369284 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:16:23.369284 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:16:23.369284 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:16:23.369284 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m22:16:23.380043 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:16:23.385902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:16:23.385902 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m22:16:23.385902 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m22:16:23.385902 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:16:23.385902 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:16:23.385902 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m22:16:23.395424 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m22:16:23.395424 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:16:23.395424 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m22:16:23.402110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:16:23.411128 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m22:16:23.413528 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m22:16:23.420004 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m22:16:23.427043 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m22:16:23.427043 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m22:16:23.427043 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:16:23.433786 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:16:23.435533 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 22:16:23.210192 => 22:16:23.435533
[0m22:16:23.435533 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 22:16:23.235374 => 22:16:23.435533
[0m22:16:23.435533 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m22:16:23.443057 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m22:16:23.444690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264DA4BB0>]}
[0m22:16:23.447086 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7d1150-24c7-4b52-8a2b-4f0712903a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264E38760>]}
[0m22:16:23.449600 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.28s]
[0m22:16:23.451000 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.26s]
[0m22:16:23.453673 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m22:16:23.453673 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m22:16:23.460921 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:23.463448 [debug] [MainThread]: On master: BEGIN
[0m22:16:23.463448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:16:23.534151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:16:23.534151 [debug] [MainThread]: On master: COMMIT
[0m22:16:23.542189 [debug] [MainThread]: Using postgres connection "master"
[0m22:16:23.542189 [debug] [MainThread]: On master: COMMIT
[0m22:16:23.542189 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:16:23.542189 [debug] [MainThread]: On master: Close
[0m22:16:23.549705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:23.551653 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m22:16:23.551653 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m22:16:23.551653 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m22:16:23.556187 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m22:16:23.557193 [info ] [MainThread]: 
[0m22:16:23.557193 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m22:16:23.562747 [debug] [MainThread]: Command end result
[0m22:16:23.585765 [info ] [MainThread]: 
[0m22:16:23.585765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:23.585765 [info ] [MainThread]: 
[0m22:16:23.585765 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:16:23.593759 [debug] [MainThread]: Command `dbt run` succeeded at 22:16:23.593759 after 1.73 seconds
[0m22:16:23.593759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172624F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172649660E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017264D986D0>]}
[0m22:16:23.597367 [debug] [MainThread]: Flushing usage events
[0m23:15:19.221943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191064F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001910885BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001910885BE80>]}


============================== 23:15:19.234720 | 7d9bd052-9cdd-449f-b2e6-b178ade9b19b ==============================
[0m23:15:19.234720 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:15:19.242634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:15:19.396574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001910885BF40>]}
[0m23:15:19.412866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108967F40>]}
[0m23:15:19.421736 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:15:19.562865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:15:19.562865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:15:19.579899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108D14D90>]}
[0m23:15:19.594916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108C61D50>]}
[0m23:15:19.594916 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:15:19.594916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108C61F30>]}
[0m23:15:19.600320 [info ] [MainThread]: 
[0m23:15:19.613188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:15:19.620705 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m23:15:19.645008 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m23:15:19.653087 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m23:15:19.655160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:19.766642 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:15:19.771977 [debug] [ThreadPool]: On list_instagrid: Close
[0m23:15:19.781364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m23:15:19.797026 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m23:15:19.797026 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m23:15:19.815113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:15:19.892532 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:15:19.892532 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m23:15:19.892532 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:15:19.909549 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:15:19.909549 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m23:15:19.909549 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m23:15:19.924146 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:19.924146 [debug] [MainThread]: On master: BEGIN
[0m23:15:19.924146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:15:19.987397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:15:19.987397 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:19.987397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:15:20.021218 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:15:20.021218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108D5D420>]}
[0m23:15:20.021218 [debug] [MainThread]: On master: ROLLBACK
[0m23:15:20.021218 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:20.021218 [debug] [MainThread]: On master: BEGIN
[0m23:15:20.033774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:15:20.033774 [debug] [MainThread]: On master: COMMIT
[0m23:15:20.038422 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:20.039587 [debug] [MainThread]: On master: COMMIT
[0m23:15:20.039587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:15:20.039587 [debug] [MainThread]: On master: Close
[0m23:15:20.039587 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:15:20.046951 [info ] [MainThread]: 
[0m23:15:20.064810 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m23:15:20.064810 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m23:15:20.064810 [info ] [Thread-1 (]: 1 of 4 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m23:15:20.075020 [info ] [Thread-2 (]: 2 of 4 START sql view model public.sg_production_plan .......................... [RUN]
[0m23:15:20.075020 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m23:15:20.081058 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m23:15:20.081058 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m23:15:20.081058 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m23:15:20.089249 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m23:15:20.097719 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m23:15:20.097719 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 23:15:20.081058 => 23:15:20.097719
[0m23:15:20.105752 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m23:15:20.137372 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 23:15:20.093696 => 23:15:20.137372
[0m23:15:20.194338 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m23:15:20.194338 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m23:15:20.204626 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m23:15:20.204626 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:15:20.218645 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:15:20.220700 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m23:15:20.221222 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m23:15:20.224247 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:15:20.224247 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:15:20.329456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:15:20.329456 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:15:20.329456 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m23:15:20.340933 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:15:20.345448 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:15:20.345448 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:15:20.345448 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m23:15:20.345448 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:15:20.361116 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m23:15:20.364186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:15:20.375157 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:15:20.377170 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:15:20.377896 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m23:15:20.385854 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:15:20.388495 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m23:15:20.388495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:15:20.409164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:15:20.409892 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m23:15:20.421410 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:15:20.424953 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:15:20.424953 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m23:15:20.424953 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m23:15:20.424953 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:15:20.438392 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m23:15:20.440913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:15:20.440913 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:15:20.456425 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:15:20.456425 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m23:15:20.456425 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m23:15:20.463445 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:15:20.472271 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:15:20.472271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:15:20.472271 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m23:15:20.479812 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 23:15:20.105752 => 23:15:20.479812
[0m23:15:20.488435 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m23:15:20.488435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108DF3EB0>]}
[0m23:15:20.494795 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:15:20.497233 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.41s]
[0m23:15:20.506356 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 23:15:20.199462 => 23:15:20.504809
[0m23:15:20.507499 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m23:15:20.513502 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m23:15:20.521566 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108DF1450>]}
[0m23:15:20.521566 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m23:15:20.521566 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.45s]
[0m23:15:20.528588 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m23:15:20.528588 [info ] [Thread-1 (]: 3 of 4 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m23:15:20.536621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m23:15:20.536621 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m23:15:20.544615 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m23:15:20.549916 [info ] [Thread-2 (]: 4 of 4 START sql view model public.dim_production_plan ......................... [RUN]
[0m23:15:20.553906 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m23:15:20.553906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m23:15:20.561434 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m23:15:20.564631 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 23:15:20.551544 => 23:15:20.564631
[0m23:15:20.571266 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m23:15:20.572628 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m23:15:20.587711 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m23:15:20.587711 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 23:15:20.564631 => 23:15:20.587711
[0m23:15:20.594247 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m23:15:20.594247 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:15:20.610457 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m23:15:20.610457 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m23:15:20.615291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:15:20.617702 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:15:20.618719 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m23:15:20.618719 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:15:20.683365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:15:20.683365 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:15:20.699009 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m23:15:20.706161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:15:20.706161 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:15:20.706161 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:15:20.706161 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
week,
sum(case when pn='product1' then plan else 0 end) as product1,
sum(case when pn='product2' then plan else 0 end) as product2
from 
"instagrid"."public"."sg_production_plan"
group by week
  );
[0m23:15:20.714679 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:15:20.714679 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m23:15:20.721695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:15:20.721695 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m23:15:20.721695 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:15:20.721695 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m23:15:20.721695 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:15:20.731840 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:15:20.731840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:15:20.731840 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m23:15:20.731840 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:15:20.731840 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m23:15:20.731840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:15:20.746354 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m23:15:20.746354 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:15:20.746354 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:15:20.755733 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 23:15:20.576127 => 23:15:20.755733
[0m23:15:20.755733 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m23:15:20.755733 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m23:15:20.762249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108DF1450>]}
[0m23:15:20.762249 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:15:20.762249 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.23s]
[0m23:15:20.774188 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:15:20.779445 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m23:15:20.779445 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m23:15:20.782681 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:15:20.788110 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 23:15:20.594247 => 23:15:20.788110
[0m23:15:20.788110 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m23:15:20.795133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9bd052-9cdd-449f-b2e6-b178ade9b19b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108D5DED0>]}
[0m23:15:20.795133 [info ] [Thread-2 (]: 4 of 4 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.23s]
[0m23:15:20.795133 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m23:15:20.803202 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:20.803202 [debug] [MainThread]: On master: BEGIN
[0m23:15:20.803202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:15:20.885214 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:15:20.885214 [debug] [MainThread]: On master: COMMIT
[0m23:15:20.885214 [debug] [MainThread]: Using postgres connection "master"
[0m23:15:20.885214 [debug] [MainThread]: On master: COMMIT
[0m23:15:20.885214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:15:20.893331 [debug] [MainThread]: On master: Close
[0m23:15:20.893331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:15:20.896122 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m23:15:20.896122 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m23:15:20.896122 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m23:15:20.899794 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m23:15:20.910035 [info ] [MainThread]: 
[0m23:15:20.912633 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m23:15:20.918155 [debug] [MainThread]: Command end result
[0m23:15:20.942747 [info ] [MainThread]: 
[0m23:15:20.942747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:15:20.950773 [info ] [MainThread]: 
[0m23:15:20.950773 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:15:20.950773 [debug] [MainThread]: Command `dbt run` succeeded at 23:15:20.950773 after 1.77 seconds
[0m23:15:20.959476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191064F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108967F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019108D4B220>]}
[0m23:15:20.961400 [debug] [MainThread]: Flushing usage events
[0m23:36:53.531227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0987F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AB5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AB5BE80>]}


============================== 23:36:53.534610 | ed574638-8f69-4012-a4b2-1ec23a6c3fd9 ==============================
[0m23:36:53.534610 [info ] [MainThread]: Running with dbt=1.5.1
[0m23:36:53.546434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:36:53.671455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AB5BEE0>]}
[0m23:36:53.684087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AC67F40>]}
[0m23:36:53.708717 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m23:36:53.860827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:53.871390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:53.889047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B015390>]}
[0m23:36:53.903587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AD62350>]}
[0m23:36:53.903587 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m23:36:53.915889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AD62530>]}
[0m23:36:53.915889 [info ] [MainThread]: 
[0m23:36:53.927047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:53.936184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m23:36:53.956215 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m23:36:53.956215 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m23:36:53.956215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:54.061029 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m23:36:54.071547 [debug] [ThreadPool]: On list_instagrid: Close
[0m23:36:54.082981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m23:36:54.102687 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m23:36:54.102687 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m23:36:54.102687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:54.187823 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:54.187823 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m23:36:54.187823 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m23:36:54.202467 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m23:36:54.202467 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m23:36:54.202467 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m23:36:54.233799 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:54.234733 [debug] [MainThread]: On master: BEGIN
[0m23:36:54.234733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:54.313868 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:54.313868 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:54.313868 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:54.345924 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m23:36:54.352827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B055960>]}
[0m23:36:54.352827 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:54.352827 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:54.352827 [debug] [MainThread]: On master: BEGIN
[0m23:36:54.352827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:54.358401 [debug] [MainThread]: On master: COMMIT
[0m23:36:54.360921 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:54.360921 [debug] [MainThread]: On master: COMMIT
[0m23:36:54.360921 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:54.360921 [debug] [MainThread]: On master: Close
[0m23:36:54.369773 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m23:36:54.377044 [info ] [MainThread]: 
[0m23:36:54.400912 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m23:36:54.408940 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m23:36:54.408940 [info ] [Thread-1 (]: 1 of 6 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m23:36:54.408940 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m23:36:54.416939 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m23:36:54.423011 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m23:36:54.408940 [info ] [Thread-2 (]: 2 of 6 START sql view model public.sg_production_plan .......................... [RUN]
[0m23:36:54.425035 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m23:36:54.425035 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 23:36:54.416939 => 23:36:54.425035
[0m23:36:54.436423 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m23:36:54.437473 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m23:36:54.441490 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m23:36:54.514551 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m23:36:54.514551 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 23:36:54.441490 => 23:36:54.514551
[0m23:36:54.522567 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m23:36:54.522567 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:36:54.539362 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m23:36:54.539362 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m23:36:54.539362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:54.539362 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:36:54.539362 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m23:36:54.547637 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:54.631221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:54.631221 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:36:54.631221 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m23:36:54.636079 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:54.636079 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:36:54.636079 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m23:36:54.658732 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:54.658732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:54.658732 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:36:54.674792 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:36:54.674792 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m23:36:54.674792 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m23:36:54.682070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:54.682070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:54.691992 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:36:54.702608 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:36:54.706636 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m23:36:54.706636 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m23:36:54.715179 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:54.722768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:54.761420 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m23:36:54.761420 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m23:36:54.761420 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:36:54.761420 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:36:54.769435 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m23:36:54.769435 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m23:36:54.777469 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:54.777469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:54.785736 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m23:36:54.785736 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m23:36:54.801365 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m23:36:54.802016 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m23:36:54.802016 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:54.817028 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 23:36:54.522567 => 23:36:54.802016
[0m23:36:54.817028 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m23:36:54.819851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B128790>]}
[0m23:36:54.824782 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:54.824782 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.39s]
[0m23:36:54.828497 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 23:36:54.441490 => 23:36:54.828497
[0m23:36:54.837393 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m23:36:54.838485 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m23:36:54.845006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AD60B20>]}
[0m23:36:54.845006 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m23:36:54.853044 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.44s]
[0m23:36:54.853044 [info ] [Thread-2 (]: 3 of 6 START sql view model public.dim_production_plan ......................... [RUN]
[0m23:36:54.853044 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m23:36:54.861049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m23:36:54.865346 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m23:36:54.865346 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m23:36:54.877591 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m23:36:54.880479 [info ] [Thread-1 (]: 4 of 6 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m23:36:54.881987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m23:36:54.886006 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m23:36:54.886006 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 23:36:54.865346 => 23:36:54.886006
[0m23:36:54.894722 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m23:36:54.894722 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m23:36:54.910266 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m23:36:54.910266 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 23:36:54.886006 => 23:36:54.910266
[0m23:36:54.915140 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m23:36:54.915140 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:36:54.928317 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m23:36:54.928317 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m23:36:54.928317 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:54.934832 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:36:54.939369 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m23:36:54.943221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:55.033831 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:55.033831 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:36:55.033831 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m23:36:55.041774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:55.041774 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:36:55.041774 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m23:36:55.041774 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:55.048791 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:36:55.048791 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m23:36:55.048791 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:55.048791 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:36:55.048791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:55.048791 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m23:36:55.065076 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m23:36:55.065076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:55.065076 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:36:55.065076 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m23:36:55.073093 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m23:36:55.073093 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:36:55.073093 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m23:36:55.073093 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:55.073093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:55.081022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m23:36:55.085995 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m23:36:55.085995 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m23:36:55.085995 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m23:36:55.085995 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:55.085995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:55.096009 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 23:36:54.901355 => 23:36:55.096009
[0m23:36:55.102679 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 23:36:54.918657 => 23:36:55.102679
[0m23:36:55.102679 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m23:36:55.102679 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m23:36:55.102679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B06F070>]}
[0m23:36:55.113691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B143B50>]}
[0m23:36:55.111704 [info ] [Thread-2 (]: 3 of 6 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.24s]
[0m23:36:55.115996 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.23s]
[0m23:36:55.120017 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m23:36:55.120017 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m23:36:55.126933 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m23:36:55.128451 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m23:36:55.128451 [info ] [Thread-2 (]: 5 of 6 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m23:36:55.128451 [info ] [Thread-1 (]: 6 of 6 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m23:36:55.128451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m23:36:55.136471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m23:36:55.136471 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m23:36:55.136471 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m23:36:55.146796 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.161001 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.161001 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 23:36:55.146796 => 23:36:55.161001
[0m23:36:55.173231 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 23:36:55.136471 => 23:36:55.170706
[0m23:36:55.173231 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m23:36:55.177766 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m23:36:55.186243 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.196010 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.196010 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.203055 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m23:36:55.205166 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:55.205166 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.211509 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m23:36:55.211509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:55.291964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:55.293394 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.295068 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
)

select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m23:36:55.302580 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:55.302580 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.302580 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m23:36:55.310272 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:55.311230 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.311230 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m23:36:55.318865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:55.318865 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m23:36:55.318865 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:55.318865 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.318865 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.318865 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m23:36:55.318865 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m23:36:55.332953 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:55.332953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:55.335886 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m23:36:55.335886 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m23:36:55.335886 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.335886 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m23:36:55.335886 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m23:36:55.345417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:55.347168 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 23:36:55.177766 => 23:36:55.347168
[0m23:36:55.350187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:55.350788 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m23:36:55.352289 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m23:36:55.352289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B0FD9F0>]}
[0m23:36:55.352289 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m23:36:55.352289 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:55.352289 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.22s]
[0m23:36:55.368399 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 23:36:55.188097 => 23:36:55.368399
[0m23:36:55.374594 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m23:36:55.374594 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m23:36:55.374594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed574638-8f69-4012-a4b2-1ec23a6c3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B039300>]}
[0m23:36:55.382639 [info ] [Thread-2 (]: 5 of 6 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.25s]
[0m23:36:55.391027 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m23:36:55.394742 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.394742 [debug] [MainThread]: On master: BEGIN
[0m23:36:55.394742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:55.465230 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:55.473780 [debug] [MainThread]: On master: COMMIT
[0m23:36:55.475277 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:55.475277 [debug] [MainThread]: On master: COMMIT
[0m23:36:55.475277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:55.475277 [debug] [MainThread]: On master: Close
[0m23:36:55.475277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:55.482291 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m23:36:55.482291 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m23:36:55.486737 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m23:36:55.486737 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m23:36:55.490759 [info ] [MainThread]: 
[0m23:36:55.492399 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m23:36:55.498858 [debug] [MainThread]: Command end result
[0m23:36:55.514927 [info ] [MainThread]: 
[0m23:36:55.514927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:55.522924 [info ] [MainThread]: 
[0m23:36:55.526988 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m23:36:55.531150 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:55.531150 after 2.05 seconds
[0m23:36:55.532368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0987F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AC67F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09B099C00>]}
[0m23:36:55.534071 [debug] [MainThread]: Flushing usage events
[0m10:30:14.704130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05C6F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EB57FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EB57E50>]}


============================== 10:30:14.715290 | 689c640a-703d-4b78-b246-a8d3cba69a3d ==============================
[0m10:30:14.715290 [info ] [MainThread]: Running with dbt=1.5.1
[0m10:30:14.719328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m10:30:14.950148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EB57F10>]}
[0m10:30:14.985049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EC67F40>]}
[0m10:30:15.014895 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m10:30:15.195106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:30:15.197173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:30:15.214872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F0198A0>]}
[0m10:30:15.239407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EDF2800>]}
[0m10:30:15.242336 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m10:30:15.245631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EDF2980>]}
[0m10:30:15.251366 [info ] [MainThread]: 
[0m10:30:15.253398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:15.255368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m10:30:15.283282 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m10:30:15.287333 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m10:30:15.289358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:15.378311 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m10:30:15.381684 [debug] [ThreadPool]: On list_instagrid: Close
[0m10:30:15.384574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m10:30:15.393727 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m10:30:15.394765 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m10:30:15.395577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:15.551923 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:30:15.552965 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m10:30:15.553962 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:30:15.568754 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m10:30:15.568754 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m10:30:15.568754 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m10:30:15.583063 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:15.584075 [debug] [MainThread]: On master: BEGIN
[0m10:30:15.585046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:15.630632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:15.632640 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:15.634632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:15.660276 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m10:30:15.665847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F059D80>]}
[0m10:30:15.667395 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:15.668448 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:15.669454 [debug] [MainThread]: On master: BEGIN
[0m10:30:15.670449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:15.671453 [debug] [MainThread]: On master: COMMIT
[0m10:30:15.672453 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:15.673454 [debug] [MainThread]: On master: COMMIT
[0m10:30:15.674453 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:15.677408 [debug] [MainThread]: On master: Close
[0m10:30:15.678961 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:30:15.680941 [info ] [MainThread]: 
[0m10:30:15.694740 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m10:30:15.694740 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m10:30:15.696275 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m10:30:15.697798 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m10:30:15.699652 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m10:30:15.701650 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m10:30:15.702649 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m10:30:15.704650 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m10:30:15.710580 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m10:30:15.719160 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m10:30:15.723176 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 10:30:15.705820 => 10:30:15.722170
[0m10:30:15.725242 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 10:30:15.713978 => 10:30:15.724085
[0m10:30:15.727301 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m10:30:15.728318 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m10:30:15.772591 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m10:30:15.780325 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m10:30:15.784733 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m10:30:15.786260 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m10:30:15.786260 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m10:30:15.787276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:30:15.788581 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m10:30:15.790545 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:30:15.862065 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:15.862065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:15.863388 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m10:30:15.863983 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m10:30:15.865495 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m10:30:15.866527 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m10:30:15.888220 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:15.889133 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:15.897144 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m10:30:15.897144 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m10:30:15.897144 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m10:30:15.897144 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m10:30:15.906219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:15.907274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:15.913068 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m10:30:15.917185 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m10:30:15.917185 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m10:30:15.918689 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m10:30:15.920703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:15.920703 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:15.948323 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m10:30:15.952334 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m10:30:15.953334 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m10:30:15.954342 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m10:30:15.958485 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m10:30:15.955335 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m10:30:15.963780 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:15.964784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:15.973838 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m10:30:15.978249 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m10:30:15.979074 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m10:30:15.980153 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m10:30:15.989214 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:15.989214 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:15.992218 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 10:30:15.772591 => 10:30:15.992218
[0m10:30:15.997270 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 10:30:15.729343 => 10:30:15.997270
[0m10:30:15.998355 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m10:30:15.998355 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m10:30:16.001037 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F12BEE0>]}
[0m10:30:16.003256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F114070>]}
[0m10:30:16.004947 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:30:16.006504 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.30s]
[0m10:30:16.009065 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m10:30:16.012628 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m10:30:16.012628 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m10:30:16.014836 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m10:30:16.016350 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m10:30:16.018490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m10:30:16.017906 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m10:30:16.020623 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m10:30:16.022082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m10:30:16.027840 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m10:30:16.028852 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m10:30:16.034427 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m10:30:16.038889 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 10:30:16.022599 => 10:30:16.037559
[0m10:30:16.040520 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m10:30:16.045510 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 10:30:16.031169 => 10:30:16.044516
[0m10:30:16.055313 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m10:30:16.058533 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m10:30:16.066329 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m10:30:16.098300 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m10:30:16.099112 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m10:30:16.108665 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m10:30:16.110708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:16.105117 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m10:30:16.114718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:30:16.228438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:16.228438 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m10:30:16.232861 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m10:30:16.232861 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:16.235905 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m10:30:16.237449 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m10:30:16.245686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:16.247213 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:16.250795 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m10:30:16.255489 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m10:30:16.256998 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m10:30:16.257508 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m10:30:16.260275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:16.260275 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:16.262226 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m10:30:16.267354 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m10:30:16.268438 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m10:30:16.268438 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m10:30:16.268438 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m10:30:16.268438 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m10:30:16.274684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:16.275697 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:16.279267 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m10:30:16.284260 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m10:30:16.285259 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m10:30:16.287105 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m10:30:16.289116 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:16.289116 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:16.293583 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 10:30:16.059067 => 10:30:16.292566
[0m10:30:16.295597 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 10:30:16.045510 => 10:30:16.295597
[0m10:30:16.296577 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m10:30:16.297091 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m10:30:16.299663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F143F40>]}
[0m10:30:16.300662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F0F72E0>]}
[0m10:30:16.303161 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.28s]
[0m10:30:16.307315 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m10:30:16.310525 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m10:30:16.304265 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:30:16.312519 [info ] [Thread-1 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m10:30:16.320592 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m10:30:16.322590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m10:30:16.324878 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m10:30:16.329501 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m10:30:16.340379 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.344870 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 10:30:16.333520 => 10:30:16.344870
[0m10:30:16.346383 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m10:30:16.362275 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.330610 [info ] [Thread-2 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m10:30:16.374356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m10:30:16.377387 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m10:30:16.384768 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.387822 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.390025 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 10:30:16.378644 => 10:30:16.388834
[0m10:30:16.395241 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m10:30:16.397261 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m10:30:16.399288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:16.417262 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.420797 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.422049 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m10:30:16.423060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:30:16.516264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:16.517300 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.517913 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m10:30:16.517913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:16.521743 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.521743 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
)

select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m10:30:16.534374 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:16.539423 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.540420 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:16.541832 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m10:30:16.548541 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.549558 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m10:30:16.550951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:16.555780 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m10:30:16.556287 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:16.557957 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.562696 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m10:30:16.564493 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m10:30:16.566530 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.568807 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m10:30:16.587395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:16.588931 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:16.597203 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m10:30:16.599123 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m10:30:16.604642 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m10:30:16.606282 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m10:30:16.608006 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:16.610912 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 10:30:16.347909 => 10:30:16.610912
[0m10:30:16.612323 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:16.613345 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m10:30:16.616347 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 10:30:16.400285 => 10:30:16.616347
[0m10:30:16.618512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F06E200>]}
[0m10:30:16.619395 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m10:30:16.623397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F161D20>]}
[0m10:30:16.621392 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.30s]
[0m10:30:16.627416 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m10:30:16.629681 [debug] [Thread-1 (]: Began running node model.instagrid.obt_trend
[0m10:30:16.625394 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.25s]
[0m10:30:16.631701 [info ] [Thread-1 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m10:30:16.634006 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m10:30:16.635483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m10:30:16.640093 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_trend
[0m10:30:16.647908 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m10:30:16.650923 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_trend (compile): 10:30:16.642596 => 10:30:16.650923
[0m10:30:16.651925 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_trend
[0m10:30:16.672112 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m10:30:16.675590 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m10:30:16.678120 [debug] [Thread-1 (]: On model.instagrid.obt_trend: BEGIN
[0m10:30:16.680133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:16.772671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:16.774642 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m10:30:16.775155 [debug] [Thread-1 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m10:30:16.787358 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:16.794033 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m10:30:16.796560 [debug] [Thread-1 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m10:30:16.800441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:16.803445 [debug] [Thread-1 (]: On model.instagrid.obt_trend: COMMIT
[0m10:30:16.805732 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m10:30:16.807259 [debug] [Thread-1 (]: On model.instagrid.obt_trend: COMMIT
[0m10:30:16.812460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:16.819610 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m10:30:16.819610 [debug] [Thread-1 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m10:30:16.819610 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:16.826843 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_trend (execute): 10:30:16.653425 => 10:30:16.826307
[0m10:30:16.828467 [debug] [Thread-1 (]: On model.instagrid.obt_trend: Close
[0m10:30:16.830784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '689c640a-703d-4b78-b246-a8d3cba69a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F16F430>]}
[0m10:30:16.832274 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m10:30:16.835292 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_trend
[0m10:30:16.840744 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:16.844132 [debug] [MainThread]: On master: BEGIN
[0m10:30:16.847122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:16.932395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:16.933411 [debug] [MainThread]: On master: COMMIT
[0m10:30:16.934922 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:16.934922 [debug] [MainThread]: On master: COMMIT
[0m10:30:16.936436 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:16.938549 [debug] [MainThread]: On master: Close
[0m10:30:16.939824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:16.941278 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m10:30:16.942294 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m10:30:16.943290 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m10:30:16.944292 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m10:30:16.945542 [info ] [MainThread]: 
[0m10:30:16.948189 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m10:30:16.952206 [debug] [MainThread]: Command end result
[0m10:30:16.966627 [info ] [MainThread]: 
[0m10:30:16.968165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:16.970183 [info ] [MainThread]: 
[0m10:30:16.972182 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:30:16.975255 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:16.975255 after 2.34 seconds
[0m10:30:16.977798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05C6F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05EC67F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B05F0FE020>]}
[0m10:30:16.979810 [debug] [MainThread]: Flushing usage events
[0m11:54:56.425679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CCCF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF057FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF057EB0>]}


============================== 11:54:56.448070 | 5184b1ae-9554-43d6-b9fb-194e951ed11a ==============================
[0m11:54:56.448070 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:54:56.449835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:54:56.675389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF057F10>]}
[0m11:54:56.691365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF1660E0>]}
[0m11:54:56.707403 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:54:56.817120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:54:56.819124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:54:56.844892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF50DF60>]}
[0m11:54:56.855393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF4F6FE0>]}
[0m11:54:56.856397 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:54:56.858394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF4F7040>]}
[0m11:54:56.863393 [info ] [MainThread]: 
[0m11:54:56.867396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:54:56.869395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m11:54:56.887404 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m11:54:56.889394 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m11:54:56.891401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:56.953959 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:54:56.955946 [debug] [ThreadPool]: On list_instagrid: Close
[0m11:54:56.958937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m11:54:56.967040 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:54:56.968038 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m11:54:56.969178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:57.011643 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.012671 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:54:57.013646 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:54:57.024144 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:54:57.026180 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m11:54:57.027157 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m11:54:57.037292 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:57.038695 [debug] [MainThread]: On master: BEGIN
[0m11:54:57.039706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:57.086875 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.086875 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:57.087869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:57.111120 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:54:57.114117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF55E320>]}
[0m11:54:57.115122 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:57.116127 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:57.118077 [debug] [MainThread]: On master: BEGIN
[0m11:54:57.119089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.120091 [debug] [MainThread]: On master: COMMIT
[0m11:54:57.121088 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:57.122094 [debug] [MainThread]: On master: COMMIT
[0m11:54:57.124216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:54:57.125230 [debug] [MainThread]: On master: Close
[0m11:54:57.126229 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:54:57.128371 [info ] [MainThread]: 
[0m11:54:57.155009 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m11:54:57.156011 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m11:54:57.158016 [info ] [Thread-1 (]: 1 of 8 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m11:54:57.161016 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m11:54:57.163191 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m11:54:57.159022 [info ] [Thread-2 (]: 2 of 8 START sql view model public.sg_production_plan .......................... [RUN]
[0m11:54:57.171191 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m11:54:57.174188 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m11:54:57.176187 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m11:54:57.181192 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m11:54:57.184187 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 11:54:57.164196 => 11:54:57.183188
[0m11:54:57.185189 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 11:54:57.177189 => 11:54:57.185189
[0m11:54:57.186297 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m11:54:57.187312 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m11:54:57.244010 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m11:54:57.248985 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m11:54:57.253500 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:54:57.254675 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:54:57.254675 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m11:54:57.256691 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m11:54:57.257684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:54:57.258687 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:54:57.312473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.313475 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:54:57.314475 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m11:54:57.317474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.318476 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:54:57.319477 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m11:54:57.328475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:57.340693 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:57.341692 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:54:57.345856 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:54:57.346875 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m11:54:57.347902 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m11:54:57.350902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:57.351903 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:57.355428 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:54:57.360454 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:54:57.361423 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m11:54:57.362231 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m11:54:57.363245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:57.364634 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:57.383671 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:54:57.386647 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:54:57.387647 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:54:57.388656 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:54:57.389648 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:54:57.390644 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:54:57.393644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:57.394644 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:57.400645 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:54:57.403670 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:54:57.404672 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m11:54:57.406028 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m11:54:57.410053 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:57.411043 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:57.413041 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 11:54:57.245010 => 11:54:57.413041
[0m11:54:57.416048 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 11:54:57.188315 => 11:54:57.415039
[0m11:54:57.416048 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m11:54:57.417039 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m11:54:57.420048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF5C66B0>]}
[0m11:54:57.422044 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF5FBA30>]}
[0m11:54:57.423293 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.26s]
[0m11:54:57.427813 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m11:54:57.425308 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m11:54:57.430816 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m11:54:57.432812 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m11:54:57.434978 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m11:54:57.435994 [info ] [Thread-1 (]: 3 of 8 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m11:54:57.438000 [info ] [Thread-2 (]: 4 of 8 START sql view model public.dim_production_plan ......................... [RUN]
[0m11:54:57.441054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m11:54:57.442072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m11:54:57.443481 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m11:54:57.444494 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m11:54:57.453150 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m11:54:57.460500 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m11:54:57.471471 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 11:54:57.445594 => 11:54:57.470474
[0m11:54:57.472477 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m11:54:57.482479 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m11:54:57.484478 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 11:54:57.454175 => 11:54:57.483479
[0m11:54:57.487474 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m11:54:57.497334 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m11:54:57.500349 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:54:57.503636 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m11:54:57.504632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:57.502636 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:54:57.508144 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m11:54:57.513571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:54:57.764162 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.766184 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:54:57.767179 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m11:54:57.780233 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:57.787239 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:54:57.789237 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m11:54:57.791243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:57.793237 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:57.795233 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:54:57.799038 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:54:57.800064 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m11:54:57.801318 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:54:57.803762 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:54:57.813783 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:57.820826 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:54:57.823783 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m11:54:57.825776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:57.829782 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:54:57.830781 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:54:57.831782 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:54:57.861872 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:57.862868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:57.867879 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:54:57.874315 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:54:57.875314 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m11:54:57.877314 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m11:54:57.879320 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:57.880318 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:57.884424 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 11:54:57.487474 => 11:54:57.883412
[0m11:54:57.888435 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 11:54:57.474477 => 11:54:57.888435
[0m11:54:57.890430 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m11:54:57.891428 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m11:54:57.893437 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF503DF0>]}
[0m11:54:57.895432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF57D7E0>]}
[0m11:54:57.897432 [info ] [Thread-2 (]: 4 of 8 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.45s]
[0m11:54:57.899424 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.46s]
[0m11:54:57.901707 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m11:54:57.903725 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m11:54:57.906719 [debug] [Thread-2 (]: Began running node model.instagrid.dim_combines
[0m11:54:57.907726 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m11:54:57.908728 [info ] [Thread-2 (]: 5 of 8 START sql table model public.dim_combines ............................... [RUN]
[0m11:54:57.910726 [info ] [Thread-1 (]: 6 of 8 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m11:54:57.912833 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.dim_combines)
[0m11:54:57.914839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m11:54:57.916838 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_combines
[0m11:54:57.917835 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m11:54:57.924844 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_combines"
[0m11:54:57.933835 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:57.936834 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_combines (compile): 11:54:57.918838 => 11:54:57.936834
[0m11:54:57.937831 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_combines
[0m11:54:57.938831 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 11:54:57.926837 => 11:54:57.938831
[0m11:54:57.995541 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_combines"
[0m11:54:57.997536 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m11:54:58.014348 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:58.016363 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_combines"
[0m11:54:58.017365 [debug] [Thread-2 (]: On model.instagrid.dim_combines: BEGIN
[0m11:54:58.019366 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:58.020588 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:54:58.021100 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m11:54:58.023277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:58.120924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:58.121927 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_combines"
[0m11:54:58.122927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:58.124929 [debug] [Thread-2 (]: On model.instagrid.dim_combines: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_combines"} */

  
    

  create  table "instagrid"."public"."dim_combines__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select week,pn,plan,date,year_week,month_name,concat('product1-',product1) as product_type
from
"instagrid"."public"."dim_production_plan" as prodplan
 join
"instagrid"."public"."dim_manufactured_units" as manufactured_units
on manufactured_units.year_week=prodplan.week
union all
select week,pn,plan,date,year_week,month_name,concat('product2-',product2) as product_type
from
"instagrid"."public"."dim_production_plan" as prodplan
 join
"instagrid"."public"."dim_manufactured_units" as manufactured_units
on manufactured_units.year_week=prodplan.week
)

select week,pn,plan,date,year_week,month_name,

SPLIT_PART(product_type,'-',2) as plan

from final
  );
  
[0m11:54:58.125922 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:58.128794 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m11:54:58.145950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:58.153284 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:58.154804 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "plan" specified more than once

[0m11:54:58.157191 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m11:54:58.159211 [debug] [Thread-2 (]: On model.instagrid.dim_combines: ROLLBACK
[0m11:54:58.161209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:58.162350 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_combines (execute): 11:54:57.939843 => 11:54:58.162350
[0m11:54:58.166369 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:54:58.167372 [debug] [Thread-2 (]: On model.instagrid.dim_combines: Close
[0m11:54:58.169738 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:58.172054 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:54:58.196466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:58.202690 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:54:58.204710 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m11:54:58.209199 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:58.219082 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 11:54:57.999533 => 11:54:58.218081
[0m11:54:58.220082 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m11:54:58.226310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF5795A0>]}
[0m11:54:58.229331 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.31s]
[0m11:54:58.232692 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m11:54:58.233692 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m11:54:58.235134 [info ] [Thread-1 (]: 7 of 8 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m11:54:58.239161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_manufactured_units_perweek)
[0m11:54:58.241554 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m11:54:58.251112 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.260457 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 11:54:58.242588 => 11:54:58.260457
[0m11:54:58.262456 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m11:54:58.270634 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.275640 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.276637 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m11:54:58.277642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:58.389650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:58.391681 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.392653 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
),

cte as
(
select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
)

select week,product_type,cte.plan as manufactured_units,prodplan.plan as planned_units
from "instagrid"."public"."dim_production_plan"  as prodplan
left join cte on cte.year_week=prodplan.week
  );
[0m11:54:58.407285 [debug] [Thread-2 (]: Database Error in model dim_combines (models\warehouse\dim_combines.sql)
  column "plan" specified more than once
  compiled Code at target\run\instagrid\models\warehouse\dim_combines.sql
[0m11:54:58.410289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:58.412647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF5F5FF0>]}
[0m11:54:58.419171 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.424173 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m11:54:58.421167 [error] [Thread-2 (]: 5 of 8 ERROR creating sql table model public.dim_combines ...................... [[31mERROR[0m in 0.50s]
[0m11:54:58.428306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:58.429474 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_combines
[0m11:54:58.433869 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:54:58.434866 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m11:54:58.435863 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.439294 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:54:58.436862 [info ] [Thread-2 (]: 8 of 8 START sql view model public.obt_trend ................................... [RUN]
[0m11:54:58.443501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:58.445503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_combines, now model.instagrid.obt_trend)
[0m11:54:58.453222 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:54:58.454734 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m11:54:58.457752 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m11:54:58.466142 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m11:54:58.468141 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:58.471564 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 11:54:58.262456 => 11:54:58.471564
[0m11:54:58.473561 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m11:54:58.474562 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 11:54:58.458746 => 11:54:58.473561
[0m11:54:58.476563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF63E440>]}
[0m11:54:58.477564 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m11:54:58.481128 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.24s]
[0m11:54:58.497637 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m11:54:58.500641 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m11:54:58.504048 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:54:58.507565 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m11:54:58.509559 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:54:58.595752 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:54:58.597752 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:54:58.598751 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m11:54:58.612783 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:54:58.616780 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:54:58.618788 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m11:54:58.620173 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:54:58.625189 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m11:54:58.626185 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:54:58.627186 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m11:54:58.630607 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:54:58.635619 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:54:58.636621 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m11:54:58.638626 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:54:58.643803 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 11:54:58.483327 => 11:54:58.643803
[0m11:54:58.646199 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m11:54:58.648752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5184b1ae-9554-43d6-b9fb-194e951ed11a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF55F400>]}
[0m11:54:58.649773 [info ] [Thread-2 (]: 8 of 8 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.20s]
[0m11:54:58.653559 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m11:54:58.660087 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:58.662082 [debug] [MainThread]: On master: BEGIN
[0m11:54:58.663081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:58.753279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:54:58.754651 [debug] [MainThread]: On master: COMMIT
[0m11:54:58.755663 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:58.757671 [debug] [MainThread]: On master: COMMIT
[0m11:54:58.759682 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:54:58.761677 [debug] [MainThread]: On master: Close
[0m11:54:58.763671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:58.764670 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m11:54:58.766065 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m11:54:58.767076 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m11:54:58.768082 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m11:54:58.770079 [info ] [MainThread]: 
[0m11:54:58.771328 [info ] [MainThread]: Finished running 7 view models, 1 table model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m11:54:58.778346 [debug] [MainThread]: Command end result
[0m11:54:58.792685 [info ] [MainThread]: 
[0m11:54:58.796682 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:54:58.802184 [info ] [MainThread]: 
[0m11:54:58.804583 [error] [MainThread]: [33mDatabase Error in model dim_combines (models\warehouse\dim_combines.sql)[0m
[0m11:54:58.810578 [error] [MainThread]:   column "plan" specified more than once
[0m11:54:58.814582 [error] [MainThread]:   compiled Code at target\run\instagrid\models\warehouse\dim_combines.sql
[0m11:54:58.816578 [info ] [MainThread]: 
[0m11:54:58.819579 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m11:54:58.822574 [debug] [MainThread]: Command `dbt run` failed at 11:54:58.821579 after 2.52 seconds
[0m11:54:58.823967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CCCF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF1660E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1CF5F5FF0>]}
[0m11:54:58.825990 [debug] [MainThread]: Flushing usage events
[0m11:55:56.958163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C29EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C277FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C277E80>]}


============================== 11:55:56.964166 | b7aede4e-4694-4224-a0b6-5f7ae5840b81 ==============================
[0m11:55:56.964166 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:55:56.967326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:57.088841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C277F40>]}
[0m11:55:57.105847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C3920B0>]}
[0m11:55:57.123845 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:55:57.227378 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m11:55:57.228369 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\warehouse\dim_combines.sql
[0m11:55:57.247880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C82DAB0>]}
[0m11:55:57.259899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C522EC0>]}
[0m11:55:57.261892 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:55:57.266125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C522F20>]}
[0m11:55:57.273324 [info ] [MainThread]: 
[0m11:55:57.276322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:57.279171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m11:55:57.297186 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m11:55:57.299667 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m11:55:57.301691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:57.367019 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:55:57.370046 [debug] [ThreadPool]: On list_instagrid: Close
[0m11:55:57.373418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m11:55:57.381796 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:55:57.382803 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m11:55:57.383808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:57.430589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:55:57.431588 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:55:57.431588 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:55:57.443568 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:55:57.445559 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m11:55:57.446543 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m11:55:57.455317 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:57.456322 [debug] [MainThread]: On master: BEGIN
[0m11:55:57.457317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:57.507149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:57.508164 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:57.509152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:57.530638 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:55:57.534677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C869F30>]}
[0m11:55:57.535982 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:57.536995 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:57.537999 [debug] [MainThread]: On master: BEGIN
[0m11:55:57.539994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:57.540996 [debug] [MainThread]: On master: COMMIT
[0m11:55:57.540996 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:57.541997 [debug] [MainThread]: On master: COMMIT
[0m11:55:57.542998 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:57.545299 [debug] [MainThread]: On master: Close
[0m11:55:57.546838 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:55:57.548868 [info ] [MainThread]: 
[0m11:55:57.561317 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m11:55:57.562328 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m11:55:57.563328 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m11:55:57.567335 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m11:55:57.568336 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m11:55:57.573330 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m11:55:57.565333 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m11:55:57.577332 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m11:55:57.579331 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m11:55:57.580332 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 11:55:57.568336 => 11:55:57.580332
[0m11:55:57.586336 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m11:55:57.588341 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m11:55:57.637926 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 11:55:57.582337 => 11:55:57.636921
[0m11:55:57.661159 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m11:55:57.661159 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m11:55:57.671996 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m11:55:57.674003 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:55:57.675003 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m11:55:57.676002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:57.676999 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:55:57.678996 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m11:55:57.679995 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:55:57.746083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:57.746083 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:57.747086 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:55:57.748082 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:55:57.749209 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m11:55:57.750205 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m11:55:57.758533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:57.759531 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:57.771548 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:55:57.778540 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:55:57.779535 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m11:55:57.780536 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m11:55:57.782533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:57.789535 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:55:57.790532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:57.791530 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m11:55:57.797550 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:55:57.799536 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m11:55:57.799536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:57.809537 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:57.827750 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:55:57.830788 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:55:57.832762 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:55:57.833779 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:55:57.834774 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:55:57.835772 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:55:57.838774 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:57.839774 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:57.847319 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:55:57.850548 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:55:57.852533 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m11:55:57.852533 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m11:55:57.857836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:57.860863 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 11:55:57.592345 => 11:55:57.860863
[0m11:55:57.861834 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:57.862836 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m11:55:57.865838 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 11:55:57.663140 => 11:55:57.865838
[0m11:55:57.867843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C8693F0>]}
[0m11:55:57.868835 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m11:55:57.872841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C8B39A0>]}
[0m11:55:57.870837 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.30s]
[0m11:55:57.875188 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.30s]
[0m11:55:57.877189 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m11:55:57.881354 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m11:55:57.883796 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m11:55:57.885967 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m11:55:57.886982 [info ] [Thread-1 (]: 3 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m11:55:57.888987 [info ] [Thread-2 (]: 4 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m11:55:57.891981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m11:55:57.893978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m11:55:57.894986 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m11:55:57.897456 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m11:55:57.904962 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m11:55:57.909954 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m11:55:57.913182 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 11:55:57.898745 => 11:55:57.912180
[0m11:55:57.914179 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 11:55:57.905952 => 11:55:57.914179
[0m11:55:57.915402 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m11:55:57.916414 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m11:55:57.928811 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m11:55:57.940078 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m11:55:57.943074 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:55:57.945076 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m11:55:57.946077 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:55:57.947141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:57.949170 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m11:55:57.952179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:58.019232 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:58.020233 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:55:58.021233 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m11:55:58.029473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:58.029473 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:58.030655 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:55:58.037079 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:55:58.039072 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m11:55:58.040504 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m11:55:58.043034 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:58.047035 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:55:58.048551 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:55:58.049563 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:55:58.052582 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:58.053594 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:58.057620 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:55:58.065595 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:55:58.066594 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m11:55:58.067594 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m11:55:58.069600 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:58.069600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:58.072596 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 11:55:57.929814 => 11:55:58.072596
[0m11:55:58.075603 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:55:58.076604 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m11:55:58.077606 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:55:58.080598 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C94FF40>]}
[0m11:55:58.080598 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:55:58.083218 [info ] [Thread-2 (]: 4 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:55:58.086236 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m11:55:58.087237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:58.093236 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:55:58.096235 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m11:55:58.098231 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:58.101653 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 11:55:57.918564 => 11:55:58.101653
[0m11:55:58.103681 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m11:55:58.108046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C940B80>]}
[0m11:55:58.109045 [info ] [Thread-1 (]: 3 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.22s]
[0m11:55:58.112050 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m11:55:58.114483 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m11:55:58.115502 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m11:55:58.117506 [info ] [Thread-2 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m11:55:58.124503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m11:55:58.121499 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m11:55:58.125503 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m11:55:58.128504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m11:55:58.136530 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.137534 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m11:55:58.144528 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.147528 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 11:55:58.130499 => 11:55:58.146530
[0m11:55:58.150074 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m11:55:58.159112 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.161117 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 11:55:58.139529 => 11:55:58.160120
[0m11:55:58.162113 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m11:55:58.173111 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.174111 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.192743 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m11:55:58.193747 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.194742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:58.195744 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m11:55:58.201030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:58.262536 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:58.263538 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.265539 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m11:55:58.275538 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:58.281990 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.283004 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m11:55:58.284005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:58.285005 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.286006 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:58.287007 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
),

cte as
(
select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
)

select week,product_type,cte.plan as manufactured_units,prodplan.plan as planned_units
from "instagrid"."public"."dim_production_plan"  as prodplan
left join cte on cte.year_week=prodplan.week
  );
[0m11:55:58.290014 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:55:58.292007 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.293009 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:55:58.296237 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:58.301473 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:55:58.302473 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:58.303473 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m11:55:58.308853 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.309838 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:58.310858 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m11:55:58.313895 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 11:55:58.151097 => 11:55:58.313895
[0m11:55:58.315874 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m11:55:58.316872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:58.320914 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:55:58.323104 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C8EDD20>]}
[0m11:55:58.323104 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.326103 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:55:58.325103 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.20s]
[0m11:55:58.329161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:58.331181 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m11:55:58.338718 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:55:58.339751 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m11:55:58.341733 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m11:55:58.343731 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m11:55:58.345738 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:58.350285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m11:55:58.355273 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 11:55:58.163117 => 11:55:58.355273
[0m11:55:58.356273 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m11:55:58.358271 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m11:55:58.363269 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m11:55:58.366273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C8F5150>]}
[0m11:55:58.370629 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 11:55:58.359271 => 11:55:58.369639
[0m11:55:58.368629 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.24s]
[0m11:55:58.371629 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m11:55:58.373634 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m11:55:58.394227 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m11:55:58.398228 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:55:58.400237 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m11:55:58.402592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:58.472411 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:55:58.472411 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:55:58.473423 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m11:55:58.485405 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:55:58.491895 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:55:58.492893 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m11:55:58.494890 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:55:58.498891 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m11:55:58.499890 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:55:58.500888 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m11:55:58.503070 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:55:58.508086 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m11:55:58.510084 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m11:55:58.511085 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:55:58.514089 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 11:55:58.374631 => 11:55:58.514089
[0m11:55:58.516354 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m11:55:58.518355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7aede4e-4694-4224-a0b6-5f7ae5840b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C806830>]}
[0m11:55:58.519356 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m11:55:58.522357 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m11:55:58.526359 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:58.527357 [debug] [MainThread]: On master: BEGIN
[0m11:55:58.529356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:58.621733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:55:58.621733 [debug] [MainThread]: On master: COMMIT
[0m11:55:58.622734 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:58.624179 [debug] [MainThread]: On master: COMMIT
[0m11:55:58.625670 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:55:58.626689 [debug] [MainThread]: On master: Close
[0m11:55:58.629099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:58.630120 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m11:55:58.631119 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m11:55:58.632117 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m11:55:58.633122 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m11:55:58.634121 [info ] [MainThread]: 
[0m11:55:58.636264 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m11:55:58.641423 [debug] [MainThread]: Command end result
[0m11:55:58.650990 [info ] [MainThread]: 
[0m11:55:58.653011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:58.660009 [info ] [MainThread]: 
[0m11:55:58.668514 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:55:58.671512 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:58.671512 after 1.74 seconds
[0m11:55:58.673517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C29EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C3920B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2C9ABEB0>]}
[0m11:55:58.674519 [debug] [MainThread]: Flushing usage events
[0m12:03:50.790977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600BEF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E25BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E25BE80>]}


============================== 12:03:50.817485 | 69364f92-4aa3-4618-ac44-49537a3ca54e ==============================
[0m12:03:50.817485 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:03:50.821544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:03:51.015043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E25BEE0>]}
[0m12:03:51.034550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E3660E0>]}
[0m12:03:51.049556 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:03:51.397537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:51.398536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:51.416553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E719930>]}
[0m12:03:51.430752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E6F2890>]}
[0m12:03:51.432756 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:03:51.435952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E6F2A10>]}
[0m12:03:51.439956 [info ] [MainThread]: 
[0m12:03:51.444954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:51.447952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:03:51.470481 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:03:51.473812 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:03:51.474826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:51.578896 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:03:51.582897 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:03:51.589529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:03:51.600526 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:03:51.601527 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:03:51.603532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:51.647677 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:03:51.648692 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:03:51.649706 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:03:51.667722 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m12:03:51.672788 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:03:51.674949 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:03:51.688815 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:51.689787 [debug] [MainThread]: On master: BEGIN
[0m12:03:51.690801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:51.734668 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:51.735699 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:51.736661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:51.771327 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m12:03:51.779328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E759E10>]}
[0m12:03:51.781328 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:51.782327 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:51.783351 [debug] [MainThread]: On master: BEGIN
[0m12:03:51.785336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:51.786330 [debug] [MainThread]: On master: COMMIT
[0m12:03:51.787332 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:51.788332 [debug] [MainThread]: On master: COMMIT
[0m12:03:51.790328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:03:51.791362 [debug] [MainThread]: On master: Close
[0m12:03:51.793331 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:03:51.794554 [info ] [MainThread]: 
[0m12:03:51.847310 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m12:03:51.847310 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m12:03:51.849308 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m12:03:51.851315 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m12:03:51.853313 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m12:03:51.855321 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m12:03:51.856311 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m12:03:51.872105 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m12:03:51.879260 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m12:03:51.886556 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m12:03:51.890215 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 12:03:51.874242 => 12:03:51.890215
[0m12:03:51.892235 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 12:03:51.881292 => 12:03:51.891232
[0m12:03:51.893232 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m12:03:51.894231 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m12:03:51.962211 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m12:03:51.965580 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m12:03:51.967589 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:03:51.969701 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m12:03:51.969701 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:03:51.970716 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:03:51.971716 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m12:03:51.973717 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:03:52.026638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.028147 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:03:52.029158 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m12:03:52.035839 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.036852 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:03:52.037850 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m12:03:52.080218 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.081233 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.100648 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:03:52.111632 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:03:52.113487 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m12:03:52.115490 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m12:03:52.135346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.136339 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.144343 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:03:52.154343 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:03:52.155335 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m12:03:52.157335 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m12:03:52.158334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.167816 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.188828 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:03:52.190815 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:03:52.192815 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:03:52.194820 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:03:52.195811 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:03:52.196813 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:03:52.242523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.259554 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:03:52.259554 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.261557 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m12:03:52.269544 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:03:52.271542 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m12:03:52.294492 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.299473 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 12:03:51.936209 => 12:03:52.298480
[0m12:03:52.300473 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m12:03:52.302458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E7393F0>]}
[0m12:03:52.304502 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.45s]
[0m12:03:52.306928 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m12:03:52.308928 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m12:03:52.309935 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m12:03:52.314099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m12:03:52.315104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.316092 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m12:03:52.328945 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 12:03:51.895361 => 12:03:52.328945
[0m12:03:52.333938 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m12:03:52.334943 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m12:03:52.337245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E835150>]}
[0m12:03:52.340242 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 12:03:52.329952 => 12:03:52.340242
[0m12:03:52.339243 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.48s]
[0m12:03:52.342247 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m12:03:52.343244 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m12:03:52.360097 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m12:03:52.363343 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m12:03:52.365361 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m12:03:52.367443 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:03:52.368968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m12:03:52.372977 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m12:03:52.369986 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m12:03:52.378983 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m12:03:52.379983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:52.381981 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 12:03:52.373984 => 12:03:52.381981
[0m12:03:52.383982 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m12:03:52.395255 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m12:03:52.397251 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:03:52.398249 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m12:03:52.400247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:52.463924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.465216 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.466048 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:03:52.466634 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:03:52.467646 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m12:03:52.468644 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m12:03:52.475818 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.480795 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:03:52.481808 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.482785 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m12:03:52.486792 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:03:52.488787 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m12:03:52.489791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.492304 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:03:52.493327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.494339 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:03:52.496676 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:03:52.497713 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:03:52.498730 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:03:52.500726 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:03:52.512446 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.518402 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:03:52.518402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.519394 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m12:03:52.523398 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:03:52.524951 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m12:03:52.528907 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.529922 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.531918 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 12:03:52.384985 => 12:03:52.530916
[0m12:03:52.533924 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 12:03:52.344242 => 12:03:52.533924
[0m12:03:52.534918 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m12:03:52.535921 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m12:03:52.538139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E7B04F0>]}
[0m12:03:52.540135 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E76D840>]}
[0m12:03:52.541528 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.17s]
[0m12:03:52.545839 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m12:03:52.543547 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:03:52.548331 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m12:03:52.554340 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m12:03:52.552340 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m12:03:52.556674 [info ] [Thread-2 (]: 6 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m12:03:52.560692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_trend)
[0m12:03:52.558689 [info ] [Thread-1 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m12:03:52.562692 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m12:03:52.564689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m12:03:52.574697 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m12:03:52.576693 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m12:03:52.584897 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.588915 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 12:03:52.577693 => 12:03:52.587920
[0m12:03:52.590920 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m12:03:52.591919 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 12:03:52.567703 => 12:03:52.590920
[0m12:03:52.602911 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.603911 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m12:03:52.616266 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m12:03:52.618262 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.619268 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m12:03:52.621274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:52.624742 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:03:52.625738 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m12:03:52.626740 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:52.683934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.684936 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.685934 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:03:52.695595 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.699602 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.700598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.701594 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m12:03:52.702597 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:03:52.703595 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:03:52.704599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.707601 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:03:52.708599 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.709599 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:03:52.713068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.716534 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:03:52.717536 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m12:03:52.718847 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.720025 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.724056 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:03:52.726056 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 12:03:52.592916 => 12:03:52.726056
[0m12:03:52.727063 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m12:03:52.728037 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m12:03:52.730063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E719AE0>]}
[0m12:03:52.731153 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.732610 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.17s]
[0m12:03:52.736627 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:03:52.746573 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m12:03:52.747084 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:03:52.748284 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m12:03:52.749527 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:03:52.751538 [info ] [Thread-1 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m12:03:52.754949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_manufactured_units_perweek)
[0m12:03:52.755951 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m12:03:52.763164 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.766156 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 12:03:52.756959 => 12:03:52.765180
[0m12:03:52.767153 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.768686 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m12:03:52.777496 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:03:52.783052 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.784038 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m12:03:52.786230 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.794863 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 12:03:52.607244 => 12:03:52.793863
[0m12:03:52.796954 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.797971 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m12:03:52.801205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E837370>]}
[0m12:03:52.798973 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m12:03:52.806358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:52.803325 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.24s]
[0m12:03:52.811739 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m12:03:52.866910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:52.867942 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.868913 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
),

cte as
(
select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
)

select week,product_type,cte.plan as manufactured_units,prodplan.plan as planned_units
from "instagrid"."public"."dim_production_plan"  as prodplan
left join cte on cte.year_week=prodplan.week
  );
[0m12:03:52.880912 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:03:52.883911 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.885917 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m12:03:52.887916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:52.892571 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:03:52.892571 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.893579 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:03:52.907260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:52.912320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:03:52.913321 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m12:03:52.916335 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:03:52.921338 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 12:03:52.778508 => 12:03:52.921338
[0m12:03:52.923357 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m12:03:52.926335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69364f92-4aa3-4618-ac44-49537a3ca54e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E871000>]}
[0m12:03:52.927341 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.17s]
[0m12:03:52.931866 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m12:03:52.936154 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:52.937188 [debug] [MainThread]: On master: BEGIN
[0m12:03:52.939152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:53.000255 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:53.001255 [debug] [MainThread]: On master: COMMIT
[0m12:03:53.002254 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:53.002254 [debug] [MainThread]: On master: COMMIT
[0m12:03:53.004528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:03:53.004528 [debug] [MainThread]: On master: Close
[0m12:03:53.006531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:53.007904 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:03:53.008922 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:03:53.008922 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m12:03:53.011294 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m12:03:53.018280 [info ] [MainThread]: 
[0m12:03:53.020269 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m12:03:53.023274 [debug] [MainThread]: Command end result
[0m12:03:53.042847 [info ] [MainThread]: 
[0m12:03:53.043859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:53.052857 [info ] [MainThread]: 
[0m12:03:53.063122 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:03:53.068117 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:53.067111 after 2.39 seconds
[0m12:03:53.069115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600BEF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E3660E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002600E6F29E0>]}
[0m12:03:53.071116 [debug] [MainThread]: Flushing usage events
[0m12:06:45.310100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238090F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B45BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B45BEB0>]}


============================== 12:06:45.320338 | 9d3dffef-0e41-47d5-9861-f459b0b6a98a ==============================
[0m12:06:45.320338 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:06:45.323846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:45.473165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B45BF70>]}
[0m12:06:45.494170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B5660E0>]}
[0m12:06:45.515226 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:06:45.630359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:45.631386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:45.640366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B915960>]}
[0m12:06:45.650367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B8F28C0>]}
[0m12:06:45.651375 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:06:45.653893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B8F2A40>]}
[0m12:06:45.657148 [info ] [MainThread]: 
[0m12:06:45.661162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:06:45.665287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:06:45.688253 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:06:45.689244 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:06:45.693259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:45.777136 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:06:45.779138 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:06:45.784140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:06:45.792133 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:06:45.793136 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:06:45.794254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:45.836839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:06:45.837839 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:06:45.838843 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:06:45.849284 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m12:06:45.851293 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:06:45.852293 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:06:45.863310 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:45.864319 [debug] [MainThread]: On master: BEGIN
[0m12:06:45.865313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:45.918422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:45.918422 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:45.919417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:45.937065 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m12:06:45.941049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B959E40>]}
[0m12:06:45.942112 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:45.943057 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:45.944053 [debug] [MainThread]: On master: BEGIN
[0m12:06:45.945065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:45.946054 [debug] [MainThread]: On master: COMMIT
[0m12:06:45.947055 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:45.948052 [debug] [MainThread]: On master: COMMIT
[0m12:06:45.949054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:06:45.949054 [debug] [MainThread]: On master: Close
[0m12:06:45.951058 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:06:45.952236 [info ] [MainThread]: 
[0m12:06:45.968047 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m12:06:45.969052 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m12:06:45.970050 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m12:06:45.974053 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m12:06:45.971049 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m12:06:45.977055 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m12:06:45.979134 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m12:06:45.985704 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m12:06:45.986701 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m12:06:45.992705 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m12:06:45.996829 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 12:06:45.980632 => 12:06:45.994700
[0m12:06:45.999184 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m12:06:46.049732 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m12:06:46.050734 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 12:06:45.987701 => 12:06:46.050734
[0m12:06:46.052733 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m12:06:46.060451 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m12:06:46.061427 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:06:46.063490 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:06:46.064503 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m12:06:46.065505 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m12:06:46.066503 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:06:46.067504 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:06:46.123319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.124322 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:06:46.125322 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m12:06:46.126323 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.127417 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:06:46.128749 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m12:06:46.143582 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.143582 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.151608 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:06:46.156112 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:06:46.157105 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m12:06:46.158107 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m12:06:46.160107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.161105 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.166105 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:06:46.170104 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:06:46.170549 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m12:06:46.171586 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m12:06:46.173585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.173585 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.194580 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:06:46.196970 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:06:46.198678 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:06:46.199680 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:06:46.200678 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:06:46.201681 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:06:46.204684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.205684 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.212676 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:06:46.215677 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:06:46.216681 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m12:06:46.217679 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m12:06:46.223794 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.225807 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 12:06:46.053741 => 12:06:46.225807
[0m12:06:46.226810 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.226810 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m12:06:46.229809 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 12:06:46.000731 => 12:06:46.228806
[0m12:06:46.230804 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B939420>]}
[0m12:06:46.231943 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m12:06:46.233956 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m12:06:46.236472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380BA27CA0>]}
[0m12:06:46.238929 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m12:06:46.239930 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.26s]
[0m12:06:46.244342 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m12:06:46.246330 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m12:06:46.248324 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m12:06:46.249329 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m12:06:46.253863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m12:06:46.251334 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m12:06:46.256091 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m12:06:46.257149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m12:06:46.269166 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m12:06:46.270166 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m12:06:46.277164 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m12:06:46.280174 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 12:06:46.258163 => 12:06:46.279173
[0m12:06:46.281165 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m12:06:46.291163 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m12:06:46.293162 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:06:46.300161 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m12:06:46.297172 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 12:06:46.271161 => 12:06:46.296164
[0m12:06:46.301164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:06:46.302171 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m12:06:46.312536 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m12:06:46.314533 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:06:46.316947 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m12:06:46.317948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:46.373334 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.374340 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:06:46.375338 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m12:06:46.382792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.383787 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:06:46.384790 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.385788 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m12:06:46.393785 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:06:46.395794 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m12:06:46.398867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.402324 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:06:46.404740 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:06:46.405740 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.406740 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:06:46.410773 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:06:46.412743 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m12:06:46.413745 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.414745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.418740 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:06:46.422299 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:06:46.422691 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m12:06:46.423730 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:06:46.425726 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:06:46.425726 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.429726 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 12:06:46.284167 => 12:06:46.428724
[0m12:06:46.429726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.430728 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m12:06:46.434750 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:06:46.435722 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m12:06:46.436723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380BA04340>]}
[0m12:06:46.439161 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.443409 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 12:06:46.304162 => 12:06:46.443409
[0m12:06:46.440173 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:06:46.444426 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m12:06:46.447434 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m12:06:46.451436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B99E1A0>]}
[0m12:06:46.454952 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:06:46.457961 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m12:06:46.459702 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m12:06:46.459702 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m12:06:46.460714 [info ] [Thread-2 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m12:06:46.464730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m12:06:46.462715 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m12:06:46.467722 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m12:06:46.469714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m12:06:46.474719 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.476720 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m12:06:46.488725 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.490720 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 12:06:46.470720 => 12:06:46.490720
[0m12:06:46.491722 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m12:06:46.492719 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 12:06:46.479727 => 12:06:46.492719
[0m12:06:46.502224 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m12:06:46.501229 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.510227 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.513227 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.514230 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m12:06:46.515229 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.516227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:06:46.518302 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m12:06:46.520305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:46.586975 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.587977 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.588976 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:06:46.595005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.597320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.599319 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
),

cte as
(
select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
)

select week,product_type,cast(cte.plan as integer) as manufactured_units,prodplan.plan as planned_units
from "instagrid"."public"."dim_production_plan"  as prodplan
left join cte on cte.year_week=prodplan.week
  );
[0m12:06:46.601320 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.608703 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.609702 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m12:06:46.611706 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.612712 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.616699 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.619705 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:06:46.620707 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m12:06:46.621704 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.623707 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:06:46.623707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.628059 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:06:46.629076 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.631075 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.635091 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:06:46.636070 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:06:46.637075 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m12:06:46.639080 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.639080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.642096 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 12:06:46.493888 => 12:06:46.642096
[0m12:06:46.644983 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:06:46.645891 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m12:06:46.647928 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m12:06:46.649928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B977910>]}
[0m12:06:46.650930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.656934 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 12:06:46.503227 => 12:06:46.655494
[0m12:06:46.652970 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.19s]
[0m12:06:46.658943 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m12:06:46.659945 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m12:06:46.660945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B8FA680>]}
[0m12:06:46.663403 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m12:06:46.665143 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.19s]
[0m12:06:46.671157 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m12:06:46.668165 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m12:06:46.674382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m12:06:46.675401 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m12:06:46.679394 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m12:06:46.682400 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 12:06:46.676399 => 12:06:46.682400
[0m12:06:46.683401 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m12:06:46.691722 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m12:06:46.694717 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:06:46.696894 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m12:06:46.698913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:06:46.757040 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.757040 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:06:46.758041 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:06:46.767068 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:06:46.772094 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:06:46.773096 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m12:06:46.775067 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:06:46.778070 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:06:46.780364 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:06:46.781769 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:06:46.785785 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.788805 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:06:46.789801 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m12:06:46.791781 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:06:46.793781 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 12:06:46.684404 => 12:06:46.793781
[0m12:06:46.794813 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m12:06:46.796784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d3dffef-0e41-47d5-9861-f459b0b6a98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380BA24B80>]}
[0m12:06:46.797785 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m12:06:46.800785 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m12:06:46.805789 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:46.807794 [debug] [MainThread]: On master: BEGIN
[0m12:06:46.808813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:46.861818 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:06:46.861818 [debug] [MainThread]: On master: COMMIT
[0m12:06:46.862827 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:46.864020 [debug] [MainThread]: On master: COMMIT
[0m12:06:46.866034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:06:46.867036 [debug] [MainThread]: On master: Close
[0m12:06:46.869035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:46.871050 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:06:46.872031 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:06:46.873033 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m12:06:46.874032 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m12:06:46.876033 [info ] [MainThread]: 
[0m12:06:46.877035 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m12:06:46.882057 [debug] [MainThread]: Command end result
[0m12:06:46.895366 [info ] [MainThread]: 
[0m12:06:46.898356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:46.900348 [info ] [MainThread]: 
[0m12:06:46.902351 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:06:46.905353 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:46.905353 after 1.65 seconds
[0m12:06:46.906356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238090F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B5660E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380B8F2A10>]}
[0m12:06:46.908350 [debug] [MainThread]: Flushing usage events
[0m12:34:15.488377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C69CF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C057E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C057DC0>]}


============================== 12:34:15.494198 | eac4f30e-8c8d-463f-9219-30db3bbc84f2 ==============================
[0m12:34:15.494198 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:34:15.494198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:34:15.619832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C057F70>]}
[0m12:34:15.635836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C174D00>]}
[0m12:34:15.643128 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:34:15.739961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:34:15.752627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:34:15.754472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C619870>]}
[0m12:34:15.767988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C302860>]}
[0m12:34:15.780669 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:34:15.783605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C302950>]}
[0m12:34:15.787766 [info ] [MainThread]: 
[0m12:34:15.793426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:34:15.798417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:34:15.816425 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:34:15.819420 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:34:15.820423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:15.885328 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:34:15.886313 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:34:15.890772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:34:15.897800 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:34:15.897800 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:34:15.899686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:15.940586 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:34:15.940586 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:34:15.940586 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:34:15.946923 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m12:34:15.946923 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:34:15.946923 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:34:15.962650 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:15.962650 [debug] [MainThread]: On master: BEGIN
[0m12:34:15.962650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:16.017261 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.017261 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:16.017261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:34:16.042350 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m12:34:16.042350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C659D50>]}
[0m12:34:16.042350 [debug] [MainThread]: On master: ROLLBACK
[0m12:34:16.042350 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:16.042350 [debug] [MainThread]: On master: BEGIN
[0m12:34:16.042350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.042350 [debug] [MainThread]: On master: COMMIT
[0m12:34:16.042350 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:16.042350 [debug] [MainThread]: On master: COMMIT
[0m12:34:16.058358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.059361 [debug] [MainThread]: On master: Close
[0m12:34:16.061570 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:34:16.065052 [info ] [MainThread]: 
[0m12:34:16.083378 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m12:34:16.083378 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m12:34:16.085377 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m12:34:16.090374 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m12:34:16.092841 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m12:34:16.101282 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m12:34:16.086380 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m12:34:16.105281 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m12:34:16.107274 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 12:34:16.094864 => 12:34:16.106276
[0m12:34:16.108268 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m12:34:16.109268 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m12:34:16.118277 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m12:34:16.178843 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m12:34:16.179819 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 12:34:16.112271 => 12:34:16.179819
[0m12:34:16.181818 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m12:34:16.188818 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m12:34:16.190820 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:34:16.191821 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m12:34:16.192819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:34:16.193822 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:34:16.194828 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m12:34:16.195825 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:34:16.245551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.245551 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:34:16.250563 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m12:34:16.250563 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.250563 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:34:16.250563 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m12:34:16.263973 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.263973 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:34:16.263973 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.263973 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m12:34:16.277513 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:34:16.277513 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m12:34:16.280133 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.280133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.286893 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:34:16.286893 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:34:16.294312 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m12:34:16.296216 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m12:34:16.296913 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.298501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.311632 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:34:16.325953 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:34:16.325953 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:34:16.325953 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:34:16.325953 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:34:16.325953 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:34:16.331720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.331720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.331720 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:34:16.341236 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:34:16.341236 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m12:34:16.341236 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m12:34:16.349347 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.349347 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 12:34:16.182817 => 12:34:16.349347
[0m12:34:16.349347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.349347 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m12:34:16.358242 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 12:34:16.119273 => 12:34:16.358242
[0m12:34:16.358242 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C731000>]}
[0m12:34:16.358242 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m12:34:16.362324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C6C20B0>]}
[0m12:34:16.362324 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m12:34:16.368596 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m12:34:16.371593 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m12:34:16.362324 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.27s]
[0m12:34:16.376791 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m12:34:16.374764 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m12:34:16.378792 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m12:34:16.381080 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m12:34:16.382086 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m12:34:16.384087 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m12:34:16.386087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m12:34:16.395136 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m12:34:16.395929 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m12:34:16.402954 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m12:34:16.403945 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 12:34:16.386087 => 12:34:16.403945
[0m12:34:16.407291 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 12:34:16.398944 => 12:34:16.405946
[0m12:34:16.410742 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m12:34:16.412744 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m12:34:16.424219 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m12:34:16.429263 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m12:34:16.436715 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:34:16.438750 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m12:34:16.439722 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:34:16.441233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:16.442245 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m12:34:16.444245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:34:16.514854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.514854 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:34:16.514854 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m12:34:16.520075 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.520075 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:34:16.520075 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m12:34:16.528083 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.528083 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.528083 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:34:16.535115 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:34:16.535115 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m12:34:16.535115 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m12:34:16.541134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.541134 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.544171 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:34:16.544171 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:34:16.544171 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:34:16.544171 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:34:16.550452 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:34:16.550452 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:34:16.550452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.550452 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.550452 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:34:16.559965 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:34:16.559965 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m12:34:16.559965 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m12:34:16.559965 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.559965 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.559965 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 12:34:16.414740 => 12:34:16.559965
[0m12:34:16.559965 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 12:34:16.425213 => 12:34:16.559965
[0m12:34:16.559965 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m12:34:16.571226 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m12:34:16.571226 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C638CA0>]}
[0m12:34:16.575741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C30E710>]}
[0m12:34:16.576910 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:34:16.579606 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.19s]
[0m12:34:16.582228 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m12:34:16.584227 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m12:34:16.588220 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m12:34:16.589220 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m12:34:16.591250 [info ] [Thread-2 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m12:34:16.594267 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m12:34:16.597271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m12:34:16.604392 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m12:34:16.602363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m12:34:16.617054 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.619045 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m12:34:16.630412 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.639429 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 12:34:16.609677 => 12:34:16.635420
[0m12:34:16.641019 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 12:34:16.622369 => 12:34:16.640507
[0m12:34:16.642030 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m12:34:16.643101 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m12:34:16.657930 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.662943 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.669167 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.670166 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.671165 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m12:34:16.673307 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m12:34:16.673975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:16.674982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:34:16.750697 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.752001 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.753112 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:34:16.754809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.754809 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.757234 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
),

cte as
(
select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
)

select distinct(week),product_type,cast(cte.plan as integer) as manufactured_units,prodplan.plan as planned_units,
sum(cast(cte.plan as integer)) over(order by CAST(SUBSTRING(week FROM 2) AS INTEGER)) as running_total
from "instagrid"."public"."dim_production_plan"  as prodplan
left join cte on cte.year_week=prodplan.week and cte.product_type=prodplan.pn
where product_type='product1'
  );
[0m12:34:16.765838 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.769873 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.769873 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.769873 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m12:34:16.776314 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.776314 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m12:34:16.780803 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.780803 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:34:16.780803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.780803 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.787058 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:34:16.787058 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:34:16.787058 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.787058 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:34:16.792832 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.792832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.792832 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:34:16.792832 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:34:16.792832 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m12:34:16.792832 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m12:34:16.792832 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.792832 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.792832 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 12:34:16.644413 => 12:34:16.792832
[0m12:34:16.807851 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 12:34:16.658925 => 12:34:16.807851
[0m12:34:16.807851 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m12:34:16.807851 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m12:34:16.807851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C748E20>]}
[0m12:34:16.814699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C6B5030>]}
[0m12:34:16.818263 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.21s]
[0m12:34:16.818263 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.21s]
[0m12:34:16.823949 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m12:34:16.826187 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m12:34:16.828223 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m12:34:16.831851 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m12:34:16.835078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m12:34:16.836111 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m12:34:16.842215 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m12:34:16.848213 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 12:34:16.837092 => 12:34:16.846221
[0m12:34:16.849400 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m12:34:16.858423 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m12:34:16.861414 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:34:16.862414 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m12:34:16.866416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:34:16.919915 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:34:16.920921 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:34:16.921915 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:34:16.929364 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:34:16.934395 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:34:16.936365 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m12:34:16.938370 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:34:16.940368 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:34:16.941382 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:34:16.941895 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:34:16.944908 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:34:16.947647 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:34:16.947647 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m12:34:16.947647 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:34:16.955557 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 12:34:16.850416 => 12:34:16.955557
[0m12:34:16.955557 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m12:34:16.955557 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac4f30e-8c8d-463f-9219-30db3bbc84f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C728700>]}
[0m12:34:16.958736 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m12:34:16.963448 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m12:34:16.966667 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:16.968668 [debug] [MainThread]: On master: BEGIN
[0m12:34:16.970663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:17.024840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:34:17.025866 [debug] [MainThread]: On master: COMMIT
[0m12:34:17.025866 [debug] [MainThread]: Using postgres connection "master"
[0m12:34:17.026879 [debug] [MainThread]: On master: COMMIT
[0m12:34:17.027881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:34:17.028875 [debug] [MainThread]: On master: Close
[0m12:34:17.029879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:17.030880 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:34:17.033127 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:34:17.035134 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m12:34:17.035134 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m12:34:17.037537 [info ] [MainThread]: 
[0m12:34:17.039536 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m12:34:17.043148 [debug] [MainThread]: Command end result
[0m12:34:17.054229 [info ] [MainThread]: 
[0m12:34:17.057704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:17.060711 [info ] [MainThread]: 
[0m12:34:17.064704 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:34:17.068702 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:17.067700 after 1.61 seconds
[0m12:34:17.069708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C69CF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6A287E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C6C760A00>]}
[0m12:34:17.071702 [debug] [MainThread]: Flushing usage events
[0m12:40:57.526455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3168F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318C57F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318C57EE0>]}


============================== 12:40:57.536973 | b2d95375-9012-4bc1-9507-420da8bd9a3a ==============================
[0m12:40:57.536973 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:40:57.542089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:40:57.660689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318C57FA0>]}
[0m12:40:57.679994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A318D65480>]}
[0m12:40:57.693399 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:40:57.780004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:57.788027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:57.788660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319119990>]}
[0m12:40:57.803670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3190F28F0>]}
[0m12:40:57.803670 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:40:57.811107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3190F2A70>]}
[0m12:40:57.815125 [info ] [MainThread]: 
[0m12:40:57.819121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:57.823322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:40:57.849817 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:40:57.853236 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:40:57.853236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:57.909973 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:40:57.911985 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:40:57.916260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:40:57.922297 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:40:57.923300 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:40:57.924279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:57.960845 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:40:57.960845 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:40:57.960845 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:40:57.975598 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m12:40:57.980124 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:40:57.980124 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:40:57.984271 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:57.991286 [debug] [MainThread]: On master: BEGIN
[0m12:40:57.991286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:58.038532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.038532 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:58.038532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:58.070742 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m12:40:58.072115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319141E70>]}
[0m12:40:58.072115 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:58.077546 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:58.078929 [debug] [MainThread]: On master: BEGIN
[0m12:40:58.080441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.080441 [debug] [MainThread]: On master: COMMIT
[0m12:40:58.080441 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:58.080441 [debug] [MainThread]: On master: COMMIT
[0m12:40:58.080441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.080441 [debug] [MainThread]: On master: Close
[0m12:40:58.086299 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:40:58.092731 [info ] [MainThread]: 
[0m12:40:58.110725 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m12:40:58.111920 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m12:40:58.113966 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m12:40:58.118974 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m12:40:58.120971 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m12:40:58.134105 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m12:40:58.114966 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m12:40:58.136100 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m12:40:58.137472 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m12:40:58.138497 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 12:40:58.121971 => 12:40:58.138497
[0m12:40:58.143998 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m12:40:58.146801 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m12:40:58.164550 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 12:40:58.139499 => 12:40:58.164550
[0m12:40:58.168585 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m12:40:58.213816 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m12:40:58.218793 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m12:40:58.220795 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:40:58.222799 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m12:40:58.223798 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:40:58.223798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:58.225792 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m12:40:58.226791 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:40:58.313053 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.313053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.313053 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:40:58.313053 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:40:58.313053 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m12:40:58.313053 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m12:40:58.328681 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.340196 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.328681 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:40:58.345717 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:40:58.345717 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m12:40:58.345717 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m12:40:58.345717 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.345717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.345717 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:40:58.357299 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:40:58.357299 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m12:40:58.357299 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m12:40:58.357299 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.357299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.381086 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:40:58.381086 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:40:58.381086 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:40:58.388101 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:40:58.388101 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:40:58.388101 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:40:58.388101 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.394751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.395832 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:40:58.403843 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:40:58.403843 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m12:40:58.403843 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m12:40:58.409876 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:58.409876 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 12:40:58.214789 => 12:40:58.409876
[0m12:40:58.409876 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:58.409876 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m12:40:58.409876 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 12:40:58.148826 => 12:40:58.409876
[0m12:40:58.409876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3190DE620>]}
[0m12:40:58.420406 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m12:40:58.424063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3191FF190>]}
[0m12:40:58.421816 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m12:40:58.424063 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.30s]
[0m12:40:58.429030 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m12:40:58.430031 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m12:40:58.434061 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m12:40:58.436031 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m12:40:58.438024 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m12:40:58.439025 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m12:40:58.445144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m12:40:58.446282 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m12:40:58.443029 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m12:40:58.455303 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m12:40:58.456359 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m12:40:58.456359 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 12:40:58.447301 => 12:40:58.456359
[0m12:40:58.464832 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m12:40:58.466874 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m12:40:58.476848 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m12:40:58.478852 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 12:40:58.456359 => 12:40:58.477850
[0m12:40:58.479848 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m12:40:58.489372 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m12:40:58.490372 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:40:58.492358 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m12:40:58.493584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:58.493584 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:40:58.496164 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m12:40:58.499175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:58.557249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.558442 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:40:58.559849 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m12:40:58.567732 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.567732 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:40:58.567732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.567732 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m12:40:58.567732 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:40:58.567732 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m12:40:58.576745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.577735 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:40:58.581249 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:40:58.581249 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.581249 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:40:58.581249 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:40:58.581249 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m12:40:58.581249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.581249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.592770 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:40:58.596831 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:40:58.597828 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m12:40:58.598826 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:40:58.600831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:58.601830 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:40:58.604836 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 12:40:58.468863 => 12:40:58.603833
[0m12:40:58.605828 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m12:40:58.606829 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.608836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3191398D0>]}
[0m12:40:58.615213 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:40:58.616210 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.16s]
[0m12:40:58.618215 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m12:40:58.620212 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m12:40:58.621635 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:58.622653 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m12:40:58.626657 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 12:40:58.479848 => 12:40:58.625658
[0m12:40:58.627650 [info ] [Thread-1 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m12:40:58.629651 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m12:40:58.630653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m12:40:58.634651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3191B6320>]}
[0m12:40:58.636657 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m12:40:58.639664 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.19s]
[0m12:40:58.646659 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.649655 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m12:40:58.653142 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m12:40:58.654138 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 12:40:58.641653 => 12:40:58.653142
[0m12:40:58.655139 [info ] [Thread-2 (]: 6 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m12:40:58.658205 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m12:40:58.661202 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_trend)
[0m12:40:58.674290 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.675290 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m12:40:58.685323 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m12:40:58.686574 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.688595 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m12:40:58.689589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:58.690588 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 12:40:58.677287 => 12:40:58.690588
[0m12:40:58.694213 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m12:40:58.703232 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m12:40:58.710248 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:40:58.714231 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m12:40:58.715231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:58.793371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.794372 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.795597 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:40:58.812239 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.813255 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:40:58.814256 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m12:40:58.824152 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.825678 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.830369 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.835376 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:40:58.836375 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m12:40:58.837369 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m12:40:58.839374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.840374 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.842373 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:40:58.845371 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:40:58.846373 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.848189 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:40:58.849200 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:40:58.850201 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m12:40:58.853567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.854568 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:58.858566 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:40:58.863957 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m12:40:58.863957 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m12:40:58.866597 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m12:40:58.867782 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:58.867782 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:58.870039 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 12:40:58.663204 => 12:40:58.870039
[0m12:40:58.870039 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 12:40:58.695229 => 12:40:58.870039
[0m12:40:58.870039 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m12:40:58.870039 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m12:40:58.876774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319245390>]}
[0m12:40:58.879290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319139A20>]}
[0m12:40:58.880084 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.25s]
[0m12:40:58.884972 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m12:40:58.885997 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m12:40:58.881595 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.22s]
[0m12:40:58.891989 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m12:40:58.888991 [info ] [Thread-1 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m12:40:58.896989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_manufactured_units_perweek)
[0m12:40:58.897988 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m12:40:58.903986 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:58.907993 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 12:40:58.898988 => 12:40:58.906990
[0m12:40:58.910107 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m12:40:58.920130 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:58.922130 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:58.925516 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m12:40:58.928509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:58.979997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:58.981509 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:58.982519 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with final as
(
select year_week,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
union all 
select year_week,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by year_week
),

cte as
(
select year_week,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
)

select distinct(week),product_type,cast(cte.plan as integer) as manufactured_units,prodplan.plan as planned_units,
sum(cast(cte.plan as integer)) over(partition by product_type order by CAST(SUBSTRING(week FROM 2) AS INTEGER)) as running_total
from "instagrid"."public"."dim_production_plan"  as prodplan
left join cte on cte.year_week=prodplan.week and cte.product_type=prodplan.pn
  );
[0m12:40:58.991518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:40:58.995634 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:58.995634 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m12:40:58.995634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:40:58.995634 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:40:58.995634 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:58.995634 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:40:59.007250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:40:59.010266 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:40:59.010266 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m12:40:59.010266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:40:59.013853 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 12:40:58.911155 => 12:40:59.013853
[0m12:40:59.013853 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m12:40:59.013853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d95375-9012-4bc1-9507-420da8bd9a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319263F10>]}
[0m12:40:59.013853 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.12s]
[0m12:40:59.020684 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m12:40:59.027021 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:59.028026 [debug] [MainThread]: On master: BEGIN
[0m12:40:59.030025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:59.085808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:59.086814 [debug] [MainThread]: On master: COMMIT
[0m12:40:59.087812 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:59.087812 [debug] [MainThread]: On master: COMMIT
[0m12:40:59.088811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:40:59.089808 [debug] [MainThread]: On master: Close
[0m12:40:59.090806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:59.091810 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:40:59.092809 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:40:59.093808 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m12:40:59.095811 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m12:40:59.097145 [info ] [MainThread]: 
[0m12:40:59.098156 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m12:40:59.105406 [debug] [MainThread]: Command end result
[0m12:40:59.117404 [info ] [MainThread]: 
[0m12:40:59.119400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:59.123404 [info ] [MainThread]: 
[0m12:40:59.127397 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:40:59.131396 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:59.131396 after 1.62 seconds
[0m12:40:59.132406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3168F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319239870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A319263F10>]}
[0m12:40:59.133403 [debug] [MainThread]: Flushing usage events
[0m14:06:39.893028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213385F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133A957F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133A957E20>]}


============================== 14:06:39.907547 | 199ac941-efb3-44b3-8971-a470f4d03a99 ==============================
[0m14:06:39.907547 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:06:39.910255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:06:40.021855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133A957EE0>]}
[0m14:06:40.037501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AA67F10>]}
[0m14:06:40.054184 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:06:40.137768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:40.137768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:40.153628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AE1DC90>]}
[0m14:06:40.166077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133ABF6C80>]}
[0m14:06:40.169584 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:06:40.171936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133ABF6D70>]}
[0m14:06:40.176559 [info ] [MainThread]: 
[0m14:06:40.180121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:40.183218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:06:40.201346 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:06:40.202354 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:06:40.203362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:40.263551 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:06:40.265548 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:06:40.269552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:06:40.276551 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:06:40.277549 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:06:40.277549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:40.308311 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.308311 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:06:40.308311 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:06:40.320845 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m14:06:40.320845 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:06:40.320845 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:06:40.336974 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:40.336974 [debug] [MainThread]: On master: BEGIN
[0m14:06:40.336974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:40.378039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.378039 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:40.384547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:40.401881 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m14:06:40.406857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AE5E080>]}
[0m14:06:40.408367 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:40.408367 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:40.408367 [debug] [MainThread]: On master: BEGIN
[0m14:06:40.408367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.408367 [debug] [MainThread]: On master: COMMIT
[0m14:06:40.408367 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:40.408367 [debug] [MainThread]: On master: COMMIT
[0m14:06:40.408367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:40.416378 [debug] [MainThread]: On master: Close
[0m14:06:40.416378 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:06:40.416378 [info ] [MainThread]: 
[0m14:06:40.436580 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m14:06:40.436580 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m14:06:40.438579 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m14:06:40.440712 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m14:06:40.445183 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m14:06:40.447615 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m14:06:40.450696 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m14:06:40.448633 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m14:06:40.456292 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m14:06:40.461304 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m14:06:40.464309 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 14:06:40.450696 => 14:06:40.463302
[0m14:06:40.465308 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 14:06:40.457303 => 14:06:40.465308
[0m14:06:40.466307 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m14:06:40.467772 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m14:06:40.548676 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m14:06:40.553654 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m14:06:40.556667 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:06:40.557686 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m14:06:40.558681 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:06:40.559684 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:40.560702 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m14:06:40.562683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:40.611093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.612611 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:06:40.612611 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m14:06:40.612611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.617405 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:06:40.617405 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m14:06:40.627305 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:40.636321 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:06:40.637323 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:40.637323 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m14:06:40.640320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:06:40.640320 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m14:06:40.640320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:40.640320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:40.640320 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:06:40.640320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:06:40.655330 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m14:06:40.656850 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m14:06:40.657546 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:40.659395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:40.671423 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m14:06:40.671423 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m14:06:40.671423 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:06:40.671423 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:06:40.671423 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m14:06:40.671423 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m14:06:40.687066 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:40.687066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:40.690152 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:06:40.690152 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:06:40.690152 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m14:06:40.690152 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m14:06:40.708822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:40.708822 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 14:06:40.549682 => 14:06:40.708822
[0m14:06:40.708822 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:40.708822 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m14:06:40.708822 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 14:06:40.467772 => 14:06:40.708822
[0m14:06:40.708822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AE3CE50>]}
[0m14:06:40.717332 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m14:06:40.720283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AF0E5C0>]}
[0m14:06:40.719039 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.26s]
[0m14:06:40.720283 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:06:40.724995 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m14:06:40.727013 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m14:06:40.730470 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:06:40.731469 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m14:06:40.732467 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m14:06:40.733471 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m14:06:40.736479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_manufactured_units)
[0m14:06:40.737473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_production_plan)
[0m14:06:40.739470 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m14:06:40.738469 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:06:40.748477 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m14:06:40.753472 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:06:40.756475 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 14:06:40.741492 => 14:06:40.755474
[0m14:06:40.758473 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m14:06:40.764476 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m14:06:40.765470 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:06:40.749474 => 14:06:40.764476
[0m14:06:40.767470 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:06:40.773103 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m14:06:40.770570 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:06:40.775111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:40.784301 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:06:40.786707 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:06:40.787708 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:06:40.788706 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:40.840029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.840029 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:06:40.840029 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m14:06:40.847477 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:40.847477 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:06:40.847477 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:40.847477 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m14:06:40.856678 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:06:40.856678 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m14:06:40.856678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:40.856678 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:06:40.856678 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:06:40.856678 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:06:40.856678 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:40.871224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:40.856678 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:06:40.871224 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:06:40.871224 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:06:40.871224 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m14:06:40.871224 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:40.871224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:40.871224 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:06:40.871224 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 14:06:40.758473 => 14:06:40.871224
[0m14:06:40.871224 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:06:40.871224 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m14:06:40.871224 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:06:40.887423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AEF3EB0>]}
[0m14:06:40.887423 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:06:40.892664 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m14:06:40.895004 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:40.902001 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:06:40.903000 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:06:40.905000 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:40.907999 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:06:40.776104 => 14:06:40.907000
[0m14:06:40.907999 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:06:40.910541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AE03F70>]}
[0m14:06:40.911533 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:06:40.914534 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:06:40.918646 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m14:06:40.919641 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m14:06:40.922115 [info ] [Thread-1 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m14:06:40.925109 [info ] [Thread-2 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m14:06:40.927115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m14:06:40.929116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m14:06:40.930112 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m14:06:40.931111 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m14:06:40.938120 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:40.949113 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m14:06:40.953548 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 14:06:40.940107 => 14:06:40.953548
[0m14:06:40.954567 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m14:06:40.967072 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m14:06:40.968064 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 14:06:40.931111 => 14:06:40.967072
[0m14:06:40.969055 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m14:06:40.978329 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:06:40.980322 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:40.981325 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m14:06:40.982323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:40.985330 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:40.986334 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m14:06:40.987333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:41.040027 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:41.040027 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:06:41.041925 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    select year_week,product_type,sum(plan) as running_total
from "instagrid"."public"."dim_manufactured_units"
  );
[0m14:06:41.041925 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "product_type" does not exist
LINE 7:     select year_week,product_type,sum(plan) as running_total
                             ^

[0m14:06:41.041925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:41.041925 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: ROLLBACK
[0m14:06:41.041925 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:41.041925 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 14:06:40.955566 => 14:06:41.041925
[0m14:06:41.049929 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m14:06:41.049929 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m14:06:41.059641 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:41.059641 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:41.059641 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m14:06:41.059641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:41.059641 [debug] [Thread-2 (]: Database Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)
  column "product_type" does not exist
  LINE 7:     select year_week,product_type,sum(plan) as running_total
                               ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m14:06:41.072049 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m14:06:41.072049 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AF5C250>]}
[0m14:06:41.072049 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:41.072049 [error] [Thread-2 (]: 6 of 7 ERROR creating sql view model public.obt_manufactured_units_perweek ..... [[31mERROR[0m in 0.14s]
[0m14:06:41.072049 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m14:06:41.077468 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m14:06:41.079751 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m14:06:41.080747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:41.089893 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:06:41.082747 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m14:06:41.090889 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m14:06:41.092890 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_perweek, now model.instagrid.obt_trend)
[0m14:06:41.093889 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:41.094903 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m14:06:41.096901 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 14:06:40.970056 => 14:06:41.096901
[0m14:06:41.104112 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m14:06:41.105119 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m14:06:41.108118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AE5F610>]}
[0m14:06:41.110653 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 14:06:41.097907 => 14:06:41.110653
[0m14:06:41.109632 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.18s]
[0m14:06:41.111649 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m14:06:41.114089 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m14:06:41.127103 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m14:06:41.133187 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:06:41.135182 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m14:06:41.136187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:41.191244 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:41.192251 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:06:41.193240 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m14:06:41.200247 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:41.204276 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:06:41.205249 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m14:06:41.206251 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:41.208248 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m14:06:41.209759 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:06:41.210770 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m14:06:41.212773 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:41.215787 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:06:41.216806 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m14:06:41.217772 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:41.220782 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 14:06:41.115094 => 14:06:41.219787
[0m14:06:41.220782 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m14:06:41.222772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199ac941-efb3-44b3-8971-a470f4d03a99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AFDBD30>]}
[0m14:06:41.223519 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m14:06:41.226879 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m14:06:41.231317 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:41.232312 [debug] [MainThread]: On master: BEGIN
[0m14:06:41.233321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:41.400996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:41.400996 [debug] [MainThread]: On master: COMMIT
[0m14:06:41.410007 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:41.410007 [debug] [MainThread]: On master: COMMIT
[0m14:06:41.410007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:41.410007 [debug] [MainThread]: On master: Close
[0m14:06:41.410007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:41.414556 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:06:41.414556 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:06:41.415986 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m14:06:41.417001 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m14:06:41.418480 [info ] [MainThread]: 
[0m14:06:41.418480 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m14:06:41.425213 [debug] [MainThread]: Command end result
[0m14:06:41.439262 [info ] [MainThread]: 
[0m14:06:41.441797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:41.444787 [info ] [MainThread]: 
[0m14:06:41.447781 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)[0m
[0m14:06:41.449782 [error] [MainThread]:   column "product_type" does not exist
[0m14:06:41.452782 [error] [MainThread]:   LINE 7:     select year_week,product_type,sum(plan) as running_total
[0m14:06:41.454778 [error] [MainThread]:                                ^
[0m14:06:41.456783 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m14:06:41.459781 [info ] [MainThread]: 
[0m14:06:41.463076 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:06:41.465071 [debug] [MainThread]: Command `dbt run` failed at 14:06:41.465071 after 1.60 seconds
[0m14:06:41.467079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213385F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AA66C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133AF67CD0>]}
[0m14:06:41.468073 [debug] [MainThread]: Flushing usage events
[0m14:07:44.958940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178033F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780575BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780575BEB0>]}


============================== 14:07:44.962045 | 65310ec2-7fe6-43aa-b7b7-96c2bf2522c7 ==============================
[0m14:07:44.962045 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:07:44.966728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:07:45.064522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001780575BF70>]}
[0m14:07:45.080153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178058660E0>]}
[0m14:07:45.102382 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:07:45.174552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:45.174552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:45.190540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805C1DD20>]}
[0m14:07:45.190540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178059F6C80>]}
[0m14:07:45.206864 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:07:45.208880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178059F6E00>]}
[0m14:07:45.213176 [info ] [MainThread]: 
[0m14:07:45.218387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:45.222361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:07:45.236587 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:07:45.238589 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:07:45.238589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:45.302847 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:07:45.303850 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:07:45.307845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:07:45.314489 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:07:45.314489 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:07:45.314489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:45.346286 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:07:45.346286 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:07:45.346286 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:07:45.361927 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m14:07:45.361927 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:07:45.361927 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:07:45.371993 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:45.371993 [debug] [MainThread]: On master: BEGIN
[0m14:07:45.371993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:45.524819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:07:45.524819 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:45.524819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:45.540689 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m14:07:45.540689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805C62110>]}
[0m14:07:45.556331 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:45.561663 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:45.561663 [debug] [MainThread]: On master: BEGIN
[0m14:07:45.561663 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:07:45.561663 [debug] [MainThread]: On master: COMMIT
[0m14:07:45.572177 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:45.572177 [debug] [MainThread]: On master: COMMIT
[0m14:07:45.572177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:07:45.572177 [debug] [MainThread]: On master: Close
[0m14:07:45.572177 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:07:45.584663 [info ] [MainThread]: 
[0m14:07:45.593413 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m14:07:45.593413 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m14:07:45.594422 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m14:07:45.598425 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m14:07:45.600724 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m14:07:45.606742 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m14:07:45.596427 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m14:07:45.610269 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m14:07:45.611270 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m14:07:45.611270 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 14:07:45.601779 => 14:07:45.611270
[0m14:07:45.618040 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m14:07:45.620290 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m14:07:45.637311 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 14:07:45.612563 => 14:07:45.636317
[0m14:07:45.638315 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m14:07:45.705002 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m14:07:45.705984 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m14:07:45.707739 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:07:45.709253 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m14:07:45.710266 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:07:45.711269 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:45.711269 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m14:07:45.713718 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:45.762546 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:45.764209 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:07:45.764209 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m14:07:45.769429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:45.769429 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:45.769429 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:07:45.778477 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:07:45.778477 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m14:07:45.778477 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m14:07:45.778477 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:45.794568 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:07:45.794568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:45.794568 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m14:07:45.794568 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:07:45.794568 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m14:07:45.794568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:45.810660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:45.810660 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m14:07:45.826309 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:07:45.826309 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:07:45.826309 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m14:07:45.826309 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m14:07:45.826309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:45.826309 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m14:07:45.826309 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:45.826309 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:07:45.841999 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:07:45.841999 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m14:07:45.841999 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m14:07:45.841999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:45.841999 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:07:45.841999 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:45.841999 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m14:07:45.841999 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 14:07:45.639316 => 14:07:45.841999
[0m14:07:45.841999 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m14:07:45.857642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805D351B0>]}
[0m14:07:45.857642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:45.861173 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:07:45.864897 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 14:07:45.622306 => 14:07:45.864381
[0m14:07:45.866913 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m14:07:45.869341 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m14:07:45.871357 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m14:07:45.872370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805CB2410>]}
[0m14:07:45.874372 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m14:07:45.876373 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.27s]
[0m14:07:45.878370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m14:07:45.879371 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m14:07:45.880370 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m14:07:45.883379 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:07:45.888465 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m14:07:45.889444 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m14:07:45.893448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:07:45.894459 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:07:45.895460 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 14:07:45.884430 => 14:07:45.894459
[0m14:07:45.901469 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:07:45.903462 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m14:07:45.906461 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:07:45.895460 => 14:07:45.906461
[0m14:07:45.913999 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m14:07:45.916018 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:07:45.925012 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:07:45.925999 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:07:45.927004 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m14:07:45.928000 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:45.928999 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:07:45.931217 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:07:45.934225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:45.995563 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:45.996574 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:07:45.997582 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m14:07:46.004571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:46.005596 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:46.006232 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:07:46.010360 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:07:46.011467 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m14:07:46.012291 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m14:07:46.014307 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:46.015403 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:07:46.015403 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:07:46.015403 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:07:46.015403 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:46.015403 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:07:46.015403 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:46.015403 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:07:46.031370 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:07:46.031370 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m14:07:46.031370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:46.031370 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:46.031370 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:07:46.031370 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 14:07:45.907469 => 14:07:46.031370
[0m14:07:46.031370 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:07:46.031370 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m14:07:46.041939 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:07:46.041939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805D04F10>]}
[0m14:07:46.046448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:46.041939 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:07:46.053212 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:07:46.055233 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m14:07:46.056222 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:07:46.058209 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:46.060210 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:07:45.918003 => 14:07:46.060210
[0m14:07:46.061219 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:07:46.063215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805C9EE60>]}
[0m14:07:46.065367 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:07:46.067367 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:07:46.069361 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m14:07:46.070368 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m14:07:46.071364 [info ] [Thread-2 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m14:07:46.073369 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m14:07:46.077378 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m14:07:46.080364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m14:07:46.082382 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m14:07:46.083365 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m14:07:46.088374 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.096398 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m14:07:46.099556 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 14:07:46.084369 => 14:07:46.098541
[0m14:07:46.100556 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m14:07:46.102558 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 14:07:46.089365 => 14:07:46.101561
[0m14:07:46.111923 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.111923 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m14:07:46.121944 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m14:07:46.122946 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.124924 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m14:07:46.125921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:46.125921 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:07:46.127931 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m14:07:46.130157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:46.175642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:46.175642 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.179654 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m14:07:46.185195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:46.185195 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:07:46.185195 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    select year_week,product_type,sum(plan) as running_total
from "instagrid"."public"."dim_manufactured_units"
  );
[0m14:07:46.185195 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:46.192392 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.192392 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_type" does not exist
LINE 7:     select year_week,product_type,sum(plan) as running_total
                             ^

[0m14:07:46.195403 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m14:07:46.195403 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: ROLLBACK
[0m14:07:46.198314 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 14:07:46.113921 => 14:07:46.198314
[0m14:07:46.198314 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:46.198314 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m14:07:46.198314 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m14:07:46.198314 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.198314 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m14:07:46.209114 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:46.211166 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:07:46.211166 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m14:07:46.213927 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:46.215769 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 14:07:46.104377 => 14:07:46.215769
[0m14:07:46.215769 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m14:07:46.215769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805C60C10>]}
[0m14:07:46.215769 [debug] [Thread-1 (]: Database Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)
  column "product_type" does not exist
  LINE 7:     select year_week,product_type,sum(plan) as running_total
                               ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m14:07:46.215769 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.14s]
[0m14:07:46.215769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805878CA0>]}
[0m14:07:46.227130 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m14:07:46.232594 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m14:07:46.230410 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model public.obt_manufactured_units_perweek ..... [[31mERROR[0m in 0.14s]
[0m14:07:46.234593 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m14:07:46.237587 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m14:07:46.238588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m14:07:46.240588 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m14:07:46.246058 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m14:07:46.250228 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 14:07:46.241594 => 14:07:46.249233
[0m14:07:46.252235 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m14:07:46.261389 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m14:07:46.264808 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:07:46.267827 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m14:07:46.269236 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:46.317588 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:07:46.318580 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:07:46.318580 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m14:07:46.326600 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:07:46.329576 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:07:46.331007 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m14:07:46.331671 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:07:46.331671 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m14:07:46.331671 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:07:46.331671 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m14:07:46.337465 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:07:46.337465 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:07:46.337465 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m14:07:46.337465 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:07:46.346490 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 14:07:46.253230 => 14:07:46.337465
[0m14:07:46.346490 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m14:07:46.346490 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65310ec2-7fe6-43aa-b7b7-96c2bf2522c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805CB2410>]}
[0m14:07:46.349841 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:07:46.351540 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m14:07:46.358029 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:46.359036 [debug] [MainThread]: On master: BEGIN
[0m14:07:46.361028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:46.414072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:07:46.415099 [debug] [MainThread]: On master: COMMIT
[0m14:07:46.416072 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:46.416072 [debug] [MainThread]: On master: COMMIT
[0m14:07:46.417073 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:07:46.418078 [debug] [MainThread]: On master: Close
[0m14:07:46.419074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:46.420075 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:07:46.421158 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:07:46.422171 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m14:07:46.423171 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m14:07:46.424169 [info ] [MainThread]: 
[0m14:07:46.425169 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:07:46.430171 [debug] [MainThread]: Command end result
[0m14:07:46.445743 [info ] [MainThread]: 
[0m14:07:46.449246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:07:46.453246 [info ] [MainThread]: 
[0m14:07:46.456615 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)[0m
[0m14:07:46.459635 [error] [MainThread]:   column "product_type" does not exist
[0m14:07:46.461635 [error] [MainThread]:   LINE 7:     select year_week,product_type,sum(plan) as running_total
[0m14:07:46.463629 [error] [MainThread]:                                ^
[0m14:07:46.466629 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m14:07:46.467631 [info ] [MainThread]: 
[0m14:07:46.470743 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:07:46.472738 [debug] [MainThread]: Command `dbt run` failed at 14:07:46.472738 after 1.54 seconds
[0m14:07:46.474742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178033F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805DFA1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017805DFA9E0>]}
[0m14:07:46.475740 [debug] [MainThread]: Flushing usage events
[0m14:07:59.438154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB60F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8457EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8457DF0>]}


============================== 14:07:59.438154 | b2d08916-037e-46ab-b5d4-b77a815b6f65 ==============================
[0m14:07:59.438154 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:07:59.444166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:07:59.541166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8457FD0>]}
[0m14:07:59.545909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB85610F0>]}
[0m14:07:59.561931 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:07:59.655670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:59.655670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:59.671286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8919C60>]}
[0m14:07:59.671286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB88F2BC0>]}
[0m14:07:59.671286 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:07:59.686170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB88F2D40>]}
[0m14:07:59.690186 [info ] [MainThread]: 
[0m14:07:59.693650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:59.696941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:07:59.712350 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:07:59.714357 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:07:59.715359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:59.775937 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:07:59.776936 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:07:59.781481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:07:59.787491 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:07:59.788496 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:07:59.789701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:59.826535 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:07:59.831568 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:07:59.831568 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:07:59.832828 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m14:07:59.832828 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:07:59.842340 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:07:59.846594 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:59.846594 [debug] [MainThread]: On master: BEGIN
[0m14:07:59.846594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:59.889560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:07:59.889560 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:59.889560 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:59.905507 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m14:07:59.905507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB895A050>]}
[0m14:07:59.905507 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:59.905507 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:59.905507 [debug] [MainThread]: On master: BEGIN
[0m14:07:59.905507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:07:59.923094 [debug] [MainThread]: On master: COMMIT
[0m14:07:59.923094 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:59.924106 [debug] [MainThread]: On master: COMMIT
[0m14:07:59.925106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:07:59.926107 [debug] [MainThread]: On master: Close
[0m14:07:59.927106 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:07:59.929107 [info ] [MainThread]: 
[0m14:07:59.939997 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m14:07:59.940999 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m14:07:59.940999 [info ] [Thread-1 (]: 1 of 7 START sql view model public.sg_manufactured_units ....................... [RUN]
[0m14:07:59.942999 [info ] [Thread-2 (]: 2 of 7 START sql view model public.sg_production_plan .......................... [RUN]
[0m14:07:59.945184 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m14:07:59.946198 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m14:07:59.948199 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m14:07:59.949202 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m14:07:59.954214 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m14:07:59.959218 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m14:07:59.963200 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 14:07:59.950201 => 14:07:59.962203
[0m14:07:59.964203 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m14:07:59.965202 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 14:07:59.956200 => 14:07:59.965202
[0m14:07:59.997709 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m14:08:00.025913 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m14:08:00.032446 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m14:08:00.035449 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:08:00.036449 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m14:08:00.037449 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:08:00.037449 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:00.039451 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m14:08:00.044002 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:00.100186 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.100186 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:08:00.100186 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  create view "instagrid"."public"."sg_production_plan__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
[0m14:08:00.100186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.110220 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.110220 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:08:00.124736 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:08:00.124736 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  create view "instagrid"."public"."sg_manufactured_units__dbt_tmp"
    
    
  as (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
[0m14:08:00.131768 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m14:08:00.131768 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.140668 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:08:00.140668 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m14:08:00.140668 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.140668 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:08:00.140668 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.140668 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m14:08:00.171478 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m14:08:00.171478 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:08:00.171478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.171478 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m14:08:00.171478 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:08:00.171478 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m14:08:00.171478 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.187093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.187093 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m14:08:00.187093 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m14:08:00.187093 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m14:08:00.187093 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:08:00.193971 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m14:08:00.193971 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.193971 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 14:08:00.025913 => 14:08:00.193971
[0m14:08:00.193971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.193971 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m14:08:00.202982 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m14:08:00.202982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8A28640>]}
[0m14:08:00.202982 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m14:08:00.210327 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.sg_production_plan ..................... [[32mCREATE VIEW[0m in 0.26s]
[0m14:08:00.213280 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m14:08:00.215303 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.217319 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m14:08:00.221318 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 14:07:59.966197 => 14:08:00.221318
[0m14:08:00.222287 [info ] [Thread-2 (]: 3 of 7 START sql view model public.dim_production_plan ......................... [RUN]
[0m14:08:00.223302 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m14:08:00.224650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m14:08:00.226666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8A30970>]}
[0m14:08:00.227665 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m14:08:00.230174 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.sg_manufactured_units .................. [[32mCREATE VIEW[0m in 0.28s]
[0m14:08:00.235710 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m14:08:00.237708 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m14:08:00.239969 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 14:08:00.231692 => 14:08:00.239969
[0m14:08:00.241963 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:08:00.243964 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m14:08:00.245957 [info ] [Thread-1 (]: 4 of 7 START sql view model public.dim_manufactured_units ...................... [RUN]
[0m14:08:00.254960 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m14:08:00.255957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m14:08:00.258964 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:08:00.267069 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:08:00.269075 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:08:00.260970 => 14:08:00.269075
[0m14:08:00.271072 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:08:00.283069 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:08:00.285070 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:00.287067 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:00.288067 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m14:08:00.289065 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:08:00.290065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:00.291134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:00.353454 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.353454 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:00.353454 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m14:08:00.366315 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.366315 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:00.366315 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m14:08:00.373320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.373320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:00.373320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.373320 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  create view "instagrid"."public"."dim_manufactured_units__dbt_tmp"
    
    
  as (
    select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
product1,
product2
 from
"instagrid"."public"."sg_manufactured_units"
  );
[0m14:08:00.378317 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:08:00.378317 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:00.378317 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:08:00.382945 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.382945 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:00.382945 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.382945 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m14:08:00.382945 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:00.393456 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.393456 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:08:00.397667 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 14:08:00.247960 => 14:08:00.397667
[0m14:08:00.397667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.397667 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m14:08:00.397667 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:08:00.397667 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8A287C0>]}
[0m14:08:00.405276 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:00.406889 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:08:00.406889 [info ] [Thread-2 (]: 3 of 7 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.17s]
[0m14:08:00.410180 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m14:08:00.414578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.420583 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:00.421583 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:08:00.422583 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.425593 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:08:00.271072 => 14:08:00.425593
[0m14:08:00.426585 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:08:00.428582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB89FFB20>]}
[0m14:08:00.432107 [info ] [Thread-1 (]: 4 of 7 OK created sql view model public.dim_manufactured_units ................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:08:00.435128 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:08:00.437383 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m14:08:00.438381 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m14:08:00.439384 [info ] [Thread-2 (]: 5 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m14:08:00.441386 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m14:08:00.443381 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m14:08:00.445381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_perweek)
[0m14:08:00.446383 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m14:08:00.448383 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m14:08:00.455564 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.460567 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.464860 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 14:08:00.450382 => 14:08:00.463568
[0m14:08:00.466886 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m14:08:00.475890 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.477886 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 14:08:00.456559 => 14:08:00.477886
[0m14:08:00.479508 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m14:08:00.488079 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.490076 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.491078 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m14:08:00.493076 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:00.495077 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.497083 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m14:08:00.500086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:00.555765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.556765 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.557765 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m14:08:00.563114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.563114 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.563114 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    select *
from "instagrid"."public"."dim_manufactured_units"
  );
[0m14:08:00.567818 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.567818 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.567818 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m14:08:00.567818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.567818 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.579965 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.579965 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m14:08:00.579965 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m14:08:00.579965 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.579965 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m14:08:00.579965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.579965 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m14:08:00.579965 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.579965 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.593474 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m14:08:00.593474 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m14:08:00.593474 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m14:08:00.593474 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.593474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.593474 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 14:08:00.467897 => 14:08:00.593474
[0m14:08:00.593474 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m14:08:00.593474 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m14:08:00.593474 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m14:08:00.609112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB896DB10>]}
[0m14:08:00.609112 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.617116 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 14:08:00.479508 => 14:08:00.616094
[0m14:08:00.612568 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.17s]
[0m14:08:00.618111 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m14:08:00.620490 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m14:08:00.622511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB89FE4D0>]}
[0m14:08:00.624502 [debug] [Thread-2 (]: Began running node model.instagrid.obt_trend
[0m14:08:00.626535 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.18s]
[0m14:08:00.628550 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_trend ................................... [RUN]
[0m14:08:00.630551 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m14:08:00.632066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m14:08:00.633082 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_trend
[0m14:08:00.639085 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m14:08:00.645180 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (compile): 14:08:00.634081 => 14:08:00.643156
[0m14:08:00.646777 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_trend
[0m14:08:00.656784 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m14:08:00.660782 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:08:00.662795 [debug] [Thread-2 (]: On model.instagrid.obt_trend: BEGIN
[0m14:08:00.664780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:00.713473 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.714488 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:08:00.715473 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  create view "instagrid"."public"."obt_trend__dbt_tmp"
    
    
  as (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
[0m14:08:00.724221 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:00.728242 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:08:00.729059 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
alter table "instagrid"."public"."obt_trend__dbt_tmp" rename to "obt_trend"
[0m14:08:00.730179 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:00.732339 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m14:08:00.732339 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:08:00.732339 [debug] [Thread-2 (]: On model.instagrid.obt_trend: COMMIT
[0m14:08:00.732339 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.732339 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_trend"
[0m14:08:00.732339 [debug] [Thread-2 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */
drop view if exists "instagrid"."public"."obt_trend__dbt_backup" cascade
[0m14:08:00.732339 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:00.744350 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_trend (execute): 14:08:00.647781 => 14:08:00.744350
[0m14:08:00.744350 [debug] [Thread-2 (]: On model.instagrid.obt_trend: Close
[0m14:08:00.744350 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2d08916-037e-46ab-b5d4-b77a815b6f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8A6EE90>]}
[0m14:08:00.744350 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_trend .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:08:00.751749 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_trend
[0m14:08:00.755774 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:00.756774 [debug] [MainThread]: On master: BEGIN
[0m14:08:00.758774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:00.809515 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:08:00.810519 [debug] [MainThread]: On master: COMMIT
[0m14:08:00.811517 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:00.812965 [debug] [MainThread]: On master: COMMIT
[0m14:08:00.813983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:08:00.815443 [debug] [MainThread]: On master: Close
[0m14:08:00.816976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:00.817977 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:08:00.818976 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:08:00.819974 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m14:08:00.820976 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m14:08:00.821982 [info ] [MainThread]: 
[0m14:08:00.823982 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m14:08:00.828974 [debug] [MainThread]: Command end result
[0m14:08:00.841886 [info ] [MainThread]: 
[0m14:08:00.843914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:00.846932 [info ] [MainThread]: 
[0m14:08:00.849939 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:08:00.852117 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:00.852117 after 1.44 seconds
[0m14:08:00.853132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB60F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB85610F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFB8A6C190>]}
[0m14:08:00.854134 [debug] [MainThread]: Flushing usage events
[0m14:08:50.441314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C12AF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C14F5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C14F5BEB0>]}


============================== 14:08:50.442824 | b752e1ed-41ae-495e-a6c9-01b8944bc3cc ==============================
[0m14:08:50.442824 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:08:50.449587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:08:50.555959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C14F5BF10>]}
[0m14:08:50.571751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C150660E0>]}
[0m14:08:50.571751 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:08:50.666662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:50.666662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:50.682302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1541DD80>]}
[0m14:08:50.697923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C151F6D70>]}
[0m14:08:50.700138 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:08:50.702590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C151F6E60>]}
[0m14:08:50.707045 [info ] [MainThread]: 
[0m14:08:50.711035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:50.714031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:08:50.728033 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:08:50.730028 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:08:50.731028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:50.795771 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:08:50.797777 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:08:50.802203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:08:50.805893 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:08:50.805893 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:08:50.805893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:50.853918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:08:50.853918 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:08:50.853918 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:08:50.856697 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m14:08:50.856697 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:08:50.856697 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:08:50.868718 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.868718 [debug] [MainThread]: On master: BEGIN
[0m14:08:50.868718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:50.917031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:08:50.917031 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.917031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:50.932790 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:08:50.932790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1545A170>]}
[0m14:08:50.932790 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:50.947800 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.947800 [debug] [MainThread]: On master: BEGIN
[0m14:08:50.947800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:08:50.947800 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.947800 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:50.947800 [debug] [MainThread]: On master: COMMIT
[0m14:08:50.947800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:08:50.947800 [debug] [MainThread]: On master: Close
[0m14:08:50.947800 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:08:50.958192 [info ] [MainThread]: 
[0m14:08:50.970534 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:08:50.971547 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m14:08:50.972536 [info ] [Thread-1 (]: 1 of 2 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:08:50.976541 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_manufactured_units'
[0m14:08:50.974540 [info ] [Thread-2 (]: 2 of 2 START sql view model public.dim_production_plan ......................... [RUN]
[0m14:08:50.983538 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:08:50.985544 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.dim_production_plan'
[0m14:08:50.995558 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:08:50.996561 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m14:08:51.002571 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m14:08:51.005119 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:08:50.988545 => 14:08:51.004096
[0m14:08:51.007351 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:08:51.043672 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 14:08:50.997560 => 14:08:51.043672
[0m14:08:51.067207 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:08:51.067207 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m14:08:51.088182 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m14:08:51.088910 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:51.091333 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:51.091333 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:08:51.092707 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m14:08:51.092707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:51.092707 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:51.151672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:51.153364 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:51.154774 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m14:08:51.158773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:08:51.158773 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:51.158773 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m14:08:51.170759 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:08:51.170759 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m14:08:51.173318 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:51.173318 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:51.183863 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m14:08:51.183863 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m14:08:51.183863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:51.183863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:51.183863 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:51.183863 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:51.183863 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m14:08:51.197103 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:08:51.197103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:51.215625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:08:51.215625 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:08:51.215625 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:08:51.229302 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:51.228302 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:51.231302 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:08:51.232299 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:08:51.237579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:51.238576 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:08:51.246045 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:08:51.252039 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:08:51.254039 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop view if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:08:51.255039 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m14:08:51.258036 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:51.261038 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 14:08:51.068353 => 14:08:51.261038
[0m14:08:51.262036 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:08:51.262036 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m14:08:51.265454 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:08:51.008348 => 14:08:51.265454
[0m14:08:51.267473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C15470910>]}
[0m14:08:51.268824 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:08:51.270299 [info ] [Thread-2 (]: 2 of 2 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.28s]
[0m14:08:51.272313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b752e1ed-41ae-495e-a6c9-01b8944bc3cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C1553BD60>]}
[0m14:08:51.274313 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m14:08:51.276313 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.30s]
[0m14:08:51.280323 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:08:51.283312 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:51.284314 [debug] [MainThread]: On master: BEGIN
[0m14:08:51.284314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:51.360365 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:08:51.361372 [debug] [MainThread]: On master: COMMIT
[0m14:08:51.361372 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:51.362365 [debug] [MainThread]: On master: COMMIT
[0m14:08:51.363371 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:08:51.365371 [debug] [MainThread]: On master: Close
[0m14:08:51.366374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:51.367373 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:08:51.368370 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:08:51.369366 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:08:51.370367 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m14:08:51.371366 [info ] [MainThread]: 
[0m14:08:51.373370 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m14:08:51.375368 [debug] [MainThread]: Command end result
[0m14:08:51.383367 [info ] [MainThread]: 
[0m14:08:51.385754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:51.386768 [info ] [MainThread]: 
[0m14:08:51.389193 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:08:51.391204 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:51.391204 after 0.97 seconds
[0m14:08:51.392204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C12AF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C150660E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C15472F80>]}
[0m14:08:51.393199 [debug] [MainThread]: Flushing usage events
[0m14:09:25.807930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5B7F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5DB57EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5DB57F10>]}


============================== 14:09:25.812937 | b6d71ae3-04a2-4210-a696-5cc134890104 ==============================
[0m14:09:25.812937 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:09:25.815943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:09:25.923637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5DB57F70>]}
[0m14:09:25.934610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5DC61DE0>]}
[0m14:09:25.949687 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:09:26.028492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:26.028492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:26.044145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E019DE0>]}
[0m14:09:26.058822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5DDF2D40>]}
[0m14:09:26.060848 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:09:26.063684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5DDF2EC0>]}
[0m14:09:26.067115 [info ] [MainThread]: 
[0m14:09:26.071884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:09:26.074041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:09:26.095641 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:09:26.096651 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:09:26.097649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:26.163977 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:09:26.165975 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:09:26.168580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:09:26.168580 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:09:26.168580 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:09:26.168580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:26.214530 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.214530 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:09:26.214530 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:09:26.220695 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m14:09:26.220695 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:09:26.231404 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:09:26.231404 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:26.231404 [debug] [MainThread]: On master: BEGIN
[0m14:09:26.231404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:26.277330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.277330 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:26.277330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:09:26.296494 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m14:09:26.309011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E0561D0>]}
[0m14:09:26.309011 [debug] [MainThread]: On master: ROLLBACK
[0m14:09:26.309011 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:26.309011 [debug] [MainThread]: On master: BEGIN
[0m14:09:26.309011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.309011 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.309011 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:26.309011 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.309011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:09:26.309011 [debug] [MainThread]: On master: Close
[0m14:09:26.309011 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:09:26.324929 [info ] [MainThread]: 
[0m14:09:26.337763 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m14:09:26.338767 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:09:26.339771 [info ] [Thread-1 (]: 1 of 3 START sql table model public.dim_date ................................... [RUN]
[0m14:09:26.345126 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m14:09:26.347616 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m14:09:26.352284 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m14:09:26.342107 [info ] [Thread-2 (]: 2 of 3 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:09:26.356302 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.dim_manufactured_units'
[0m14:09:26.358305 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:09:26.359299 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 14:09:26.348774 => 14:09:26.358305
[0m14:09:26.364857 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:09:26.365856 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m14:09:26.418859 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:09:26.359299 => 14:09:26.417855
[0m14:09:26.446919 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m14:09:26.447916 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:09:26.453919 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:09:26.454930 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:09:26.456920 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m14:09:26.457921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:26.457921 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:09:26.459360 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:09:26.461376 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:09:26.501878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.501878 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:09:26.501878 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m14:09:26.514385 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m14:09:26.514385 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:09:26.514385 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:09:26.530673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:09:26.545735 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m14:09:26.545735 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:09:26.545735 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m14:09:26.555171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:09:26.561685 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:09:26.561685 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m14:09:26.561685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:09:26.568331 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 14:09:26.368141 => 14:09:26.568331
[0m14:09:26.568331 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m14:09:26.571303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E0C2050>]}
[0m14:09:26.571303 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.23s]
[0m14:09:26.575378 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m14:09:26.576393 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m14:09:26.577392 [info ] [Thread-1 (]: 3 of 3 START sql view model public.dim_production_plan ......................... [RUN]
[0m14:09:26.580399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_production_plan)
[0m14:09:26.581398 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m14:09:26.588404 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m14:09:26.592396 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 14:09:26.583402 => 14:09:26.590414
[0m14:09:26.593420 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m14:09:26.631592 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m14:09:26.636775 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:09:26.640792 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m14:09:26.642788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:26.643785 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.645790 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:09:26.646983 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m14:09:26.665917 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m14:09:26.671924 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:09:26.672918 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m14:09:26.674951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:09:26.680929 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:09:26.681917 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:09:26.684573 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:09:26.690463 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:09:26.690463 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:09:26.690463 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:09:26.697023 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:09:26.699628 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:09:26.699628 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:09:26.699628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.699628 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:09:26.699628 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  create view "instagrid"."public"."dim_production_plan__dbt_tmp"
    
    
  as (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
[0m14:09:26.699628 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:09:26.699628 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:09:26.448918 => 14:09:26.699628
[0m14:09:26.699628 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:09:26.699628 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:09:26.715862 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E115DB0>]}
[0m14:09:26.718557 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:09:26.718557 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.36s]
[0m14:09:26.718557 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m14:09:26.726027 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:09:26.728432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:09:26.734600 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:09:26.735698 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m14:09:26.738626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:09:26.741609 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:09:26.742610 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:09:26.742610 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:09:26.745972 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:09:26.748980 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:09:26.750978 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m14:09:26.754988 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:09:26.756987 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 14:09:26.594399 => 14:09:26.756987
[0m14:09:26.758994 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m14:09:26.761509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d71ae3-04a2-4210-a696-5cc134890104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E113EE0>]}
[0m14:09:26.764059 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.dim_production_plan .................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:09:26.767052 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m14:09:26.771996 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:26.773396 [debug] [MainThread]: On master: BEGIN
[0m14:09:26.775527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:26.829209 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:26.829209 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.830218 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:26.831198 [debug] [MainThread]: On master: COMMIT
[0m14:09:26.832209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:09:26.833274 [debug] [MainThread]: On master: Close
[0m14:09:26.835197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:26.837199 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:09:26.838414 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:09:26.839428 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m14:09:26.840617 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:09:26.840617 [info ] [MainThread]: 
[0m14:09:26.842647 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m14:09:26.847651 [debug] [MainThread]: Command end result
[0m14:09:26.862251 [info ] [MainThread]: 
[0m14:09:26.866717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:26.869720 [info ] [MainThread]: 
[0m14:09:26.871717 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:09:26.874719 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:26.874719 after 1.09 seconds
[0m14:09:26.875717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5B7F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E076890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A5E0C2050>]}
[0m14:09:26.876718 [debug] [MainThread]: Flushing usage events
[0m14:10:42.095360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DF4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1857FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1857EB0>]}


============================== 14:10:42.095360 | 185f7efd-5995-44bc-bc70-311b571d8de2 ==============================
[0m14:10:42.095360 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:10:42.107216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:10:42.224622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1857F70>]}
[0m14:10:42.240262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1966500>]}
[0m14:10:42.256365 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:10:42.272050 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:10:42.285412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E197AFE0>]}
[0m14:10:43.003385 [debug] [MainThread]: 1699: static parser successfully parsed Analystics-OBT\obt_manufactured_units_permonth.sql
[0m14:10:43.019022 [debug] [MainThread]: 1699: static parser successfully parsed Analystics-OBT\obt_manufactured_units_perweek.sql
[0m14:10:43.019022 [debug] [MainThread]: 1699: static parser successfully parsed Analystics-OBT\obt_trend.sql
[0m14:10:43.019022 [debug] [MainThread]: 1699: static parser successfully parsed staging\sg_manufactured_units.sql
[0m14:10:43.035017 [debug] [MainThread]: 1699: static parser successfully parsed staging\sg_production_plan.sql
[0m14:10:43.035017 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_date.sql
[0m14:10:43.035017 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m14:10:43.050659 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_production_plan.sql
[0m14:10:43.113474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1D52D40>]}
[0m14:10:43.157359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E08D3070>]}
[0m14:10:43.160874 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m14:10:43.164764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E18C1B40>]}
[0m14:10:43.168798 [info ] [MainThread]: 
[0m14:10:43.171799 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:43.173797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m14:10:43.193004 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m14:10:43.194999 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m14:10:43.196006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:43.251584 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:10:43.253612 [debug] [ThreadPool]: On list_instagrid: Close
[0m14:10:43.257591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m14:10:43.264607 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:10:43.265587 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m14:10:43.266589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:43.399367 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:10:43.399367 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m14:10:43.399367 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:10:43.419691 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m14:10:43.421691 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m14:10:43.422690 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m14:10:43.432023 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:43.432023 [debug] [MainThread]: On master: BEGIN
[0m14:10:43.433019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:43.583149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:10:43.583149 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:43.583149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:10:43.608186 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m14:10:43.608186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1C1A890>]}
[0m14:10:43.608186 [debug] [MainThread]: On master: ROLLBACK
[0m14:10:43.614199 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:43.615110 [debug] [MainThread]: On master: BEGIN
[0m14:10:43.615110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:10:43.615110 [debug] [MainThread]: On master: COMMIT
[0m14:10:43.615110 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:43.615110 [debug] [MainThread]: On master: COMMIT
[0m14:10:43.620856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:10:43.620856 [debug] [MainThread]: On master: Close
[0m14:10:43.620856 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m14:10:43.624928 [info ] [MainThread]: 
[0m14:10:43.639591 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m14:10:43.641666 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m14:10:43.642681 [info ] [Thread-1 (]: 1 of 3 START sql table model public.dim_date ................................... [RUN]
[0m14:10:43.648683 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m14:10:43.649683 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m14:10:43.645683 [info ] [Thread-2 (]: 2 of 3 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m14:10:43.658414 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.dim_manufactured_units'
[0m14:10:43.659529 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m14:10:43.655165 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m14:10:43.665977 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m14:10:43.668501 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 14:10:43.660542 => 14:10:43.668501
[0m14:10:43.670686 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m14:10:43.672696 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 14:10:43.651146 => 14:10:43.671691
[0m14:10:43.693608 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m14:10:43.741157 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m14:10:43.741157 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m14:10:43.756173 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:10:43.756173 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:10:43.758473 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m14:10:43.758473 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m14:10:43.758473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:43.758473 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:10:43.805302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:10:43.805302 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:10:43.805302 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m14:10:43.821978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:10:43.821978 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:10:43.834038 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m14:10:43.834038 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m14:10:43.834038 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:10:43.849674 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m14:10:43.849674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:43.852300 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m14:10:43.853435 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:10:43.853435 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:10:43.853435 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:10:43.853435 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m14:10:43.864661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:43.865675 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:43.882858 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m14:10:43.882858 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:10:43.897368 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:10:43.897368 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m14:10:43.897368 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m14:10:43.897368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:43.905868 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:10:43.905868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:10:43.905868 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:10:43.913049 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m14:10:43.913049 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m14:10:43.913049 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m14:10:43.913049 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:10:43.913049 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m14:10:43.913049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:10:43.913049 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m14:10:43.928717 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 14:10:43.694615 => 14:10:43.913049
[0m14:10:43.929467 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m14:10:43.929467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E2030040>]}
[0m14:10:43.933849 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:10:43.929467 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.28s]
[0m14:10:43.938921 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 14:10:43.673740 => 14:10:43.937919
[0m14:10:43.940914 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m14:10:43.942920 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m14:10:43.944917 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m14:10:43.946920 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1D59150>]}
[0m14:10:43.947914 [info ] [Thread-1 (]: 3 of 3 START sql table model public.dim_production_plan ........................ [RUN]
[0m14:10:43.949918 [info ] [Thread-2 (]: 2 of 3 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.29s]
[0m14:10:43.952379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_production_plan)
[0m14:10:43.953390 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m14:10:43.954393 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m14:10:43.960391 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m14:10:43.963430 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 14:10:43.955389 => 14:10:43.962437
[0m14:10:43.964433 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m14:10:43.973024 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m14:10:43.975012 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:10:43.978005 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m14:10:43.979005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:44.032915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:10:44.032915 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:10:44.033919 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
  
[0m14:10:44.045995 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m14:10:44.051018 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:10:44.051999 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m14:10:44.053005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:44.057001 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:10:44.057820 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m14:10:44.059547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:10:44.059547 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:10:44.059547 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:10:44.059547 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m14:10:44.065352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:10:44.065352 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m14:10:44.065352 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop view if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m14:10:44.073391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:10:44.073391 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 14:10:43.965432 => 14:10:44.073391
[0m14:10:44.073391 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m14:10:44.073391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '185f7efd-5995-44bc-bc70-311b571d8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E20385E0>]}
[0m14:10:44.073391 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.12s]
[0m14:10:44.082410 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m14:10:44.086183 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:44.087187 [debug] [MainThread]: On master: BEGIN
[0m14:10:44.088217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:44.152530 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:10:44.152530 [debug] [MainThread]: On master: COMMIT
[0m14:10:44.153558 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:44.154529 [debug] [MainThread]: On master: COMMIT
[0m14:10:44.155529 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:10:44.156530 [debug] [MainThread]: On master: Close
[0m14:10:44.157742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:44.158748 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m14:10:44.159745 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m14:10:44.160745 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m14:10:44.161744 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m14:10:44.161744 [info ] [MainThread]: 
[0m14:10:44.164124 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:10:44.167129 [debug] [MainThread]: Command end result
[0m14:10:44.178642 [info ] [MainThread]: 
[0m14:10:44.179645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:10:44.182204 [info ] [MainThread]: 
[0m14:10:44.183220 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:10:44.186238 [debug] [MainThread]: Command `dbt run` succeeded at 14:10:44.185235 after 2.11 seconds
[0m14:10:44.187238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DF4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E1966500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E19743A0>]}
[0m14:10:44.188238 [debug] [MainThread]: Flushing usage events
[0m18:41:47.584513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36ADF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D16BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D16BE80>]}


============================== 18:41:47.592005 | 590dac93-1bcf-4dce-8ca3-da9080c41b97 ==============================
[0m18:41:47.592005 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:41:47.592005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:41:47.731552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D16BEE0>]}
[0m18:41:47.745579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D284B50>]}
[0m18:41:47.767254 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:41:47.887157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:47.887157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:47.902943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D71DDB0>]}
[0m18:41:47.916939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D6F6D10>]}
[0m18:41:47.918942 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:41:47.919938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D6F6E90>]}
[0m18:41:47.925174 [info ] [MainThread]: 
[0m18:41:47.929191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:41:47.932188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:41:47.948210 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:41:47.949189 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:41:47.951192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:48.120747 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:41:48.120747 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:41:48.126453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:41:48.126453 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:41:48.136469 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:41:48.136469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:48.188678 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.188678 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:41:48.193017 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:41:48.200029 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:41:48.207161 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:41:48.207161 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:41:48.216339 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.216339 [debug] [MainThread]: On master: BEGIN
[0m18:41:48.216339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:48.269198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.270203 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.271197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:41:48.278357 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:41:48.278357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D74E1A0>]}
[0m18:41:48.278357 [debug] [MainThread]: On master: ROLLBACK
[0m18:41:48.293983 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.293983 [debug] [MainThread]: On master: BEGIN
[0m18:41:48.293983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.293983 [debug] [MainThread]: On master: COMMIT
[0m18:41:48.293983 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:48.293983 [debug] [MainThread]: On master: COMMIT
[0m18:41:48.293983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:48.293983 [debug] [MainThread]: On master: Close
[0m18:41:48.293983 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:41:48.302769 [info ] [MainThread]: 
[0m18:41:48.320009 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:41:48.321024 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:41:48.321720 [info ] [Thread-1 (]: 1 of 8 START sql table model public.dim_date ................................... [RUN]
[0m18:41:48.327745 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:41:48.323732 [info ] [Thread-2 (]: 2 of 8 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:41:48.328746 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:41:48.331739 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:41:48.334734 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:41:48.336734 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:41:48.344743 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:41:48.347732 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:41:48.332733 => 18:41:48.347732
[0m18:41:48.349738 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:41:48.355999 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:41:48.337732 => 18:41:48.355999
[0m18:41:48.416153 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:41:48.417152 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:41:48.423546 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:41:48.425542 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:41:48.426552 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:41:48.427544 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:41:48.428550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:41:48.429573 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:41:48.431585 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:41:48.477704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.477704 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:41:48.477704 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:41:48.489836 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.489836 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:41:48.489836 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:41:48.504733 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:41:48.504733 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:41:48.504733 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:41:48.504733 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:41:48.520968 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:41:48.520968 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:41:48.520968 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.525333 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:41:48.525333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.525333 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:41:48.525333 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:41:48.525333 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:41:48.525333 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.552401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.552401 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:41:48.552401 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:41:48.552401 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:41:48.552401 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:41:48.552401 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:41:48.552401 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:41:48.568036 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:48.568036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:48.573236 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:41:48.577746 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:41:48.577746 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop view if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:41:48.577746 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:41:48.583759 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:48.583759 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:41:48.418532 => 18:41:48.583759
[0m18:41:48.583759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:48.583759 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:41:48.583759 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:41:48.350740 => 18:41:48.583759
[0m18:41:48.583759 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D6DED40>]}
[0m18:41:48.583759 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:41:48.599863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D81AA40>]}
[0m18:41:48.598848 [info ] [Thread-2 (]: 2 of 8 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.25s]
[0m18:41:48.603762 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:41:48.605763 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:41:48.602746 [info ] [Thread-1 (]: 1 of 8 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.27s]
[0m18:41:48.609765 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:41:48.607763 [info ] [Thread-2 (]: 3 of 8 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:41:48.611761 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:41:48.613766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:41:48.615762 [info ] [Thread-1 (]: 4 of 8 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:41:48.616760 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:41:48.618763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:41:48.624760 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:41:48.625762 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:41:48.631758 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:41:48.633761 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:41:48.619762 => 18:41:48.632756
[0m18:41:48.634758 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:41:48.642761 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:41:48.643785 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:41:48.627762 => 18:41:48.643785
[0m18:41:48.645764 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:41:48.657964 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:41:48.659971 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:41:48.663004 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:41:48.663989 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:41:48.664994 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:48.665991 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:41:48.667987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:48.730471 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.731477 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:41:48.732471 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:41:48.737470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.738473 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:41:48.740478 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:41:48.748034 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:41:48.753031 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:41:48.755036 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:41:48.757034 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.757034 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:41:48.758124 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:41:48.758124 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:41:48.758124 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:41:48.758124 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:41:48.758124 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.769568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.769568 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:41:48.776595 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:41:48.777591 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:41:48.778099 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:41:48.779111 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:41:48.781114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.782113 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:48.785109 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:41:48.789108 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:41:48.790112 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:41:48.791110 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop view if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:41:48.792109 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:41:48.794112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:48.795117 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:48.799110 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:41:48.801139 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:41:48.635761 => 18:41:48.801139
[0m18:41:48.802111 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:41:48.803114 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:41:48.807114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D859570>]}
[0m18:41:48.808347 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:48.813330 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:41:48.647760 => 18:41:48.812045
[0m18:41:48.808347 [info ] [Thread-2 (]: 3 of 8 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.19s]
[0m18:41:48.813330 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:41:48.815680 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:41:48.815680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D883490>]}
[0m18:41:48.815680 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:41:48.815680 [info ] [Thread-1 (]: 4 of 8 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.20s]
[0m18:41:48.815680 [info ] [Thread-2 (]: 5 of 8 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:41:48.828272 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:41:48.830265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:41:48.832259 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:41:48.833260 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:41:48.834260 [info ] [Thread-1 (]: 6 of 8 START sql table model public.obt_manufactured_units_permonth ............ [RUN]
[0m18:41:48.838287 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:41:48.840257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:41:48.842261 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:41:48.846267 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:41:48.848266 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:41:48.835260 => 18:41:48.847261
[0m18:41:48.849267 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:41:48.858263 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:41:48.860261 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:41:48.843267 => 18:41:48.859262
[0m18:41:48.861265 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:41:48.863282 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:41:48.871652 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:41:48.873340 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:41:48.876359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:48.882299 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:41:48.883296 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:41:48.884295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:48.940368 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.941472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:48.941472 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:41:48.941472 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:41:48.941472 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
  
[0m18:41:48.941472 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  
    

  create  table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
  
[0m18:41:48.947079 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product1" does not exist
LINE 14: select month_name,concat('product1-',sum(product1)) as produ...
                                                  ^

[0m18:41:48.947079 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: ROLLBACK
[0m18:41:48.950177 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:41:48.863282 => 18:41:48.947079
[0m18:41:48.950177 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:41:48.959619 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:41:48.959619 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:41:48.959619 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:41:48.959619 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.959619 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:41:48.959619 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:41:48.973795 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:48.977683 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:41:48.977683 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:41:48.977683 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:41:48.980848 [debug] [Thread-1 (]: Database Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)
  column "product1" does not exist
  LINE 14: select month_name,concat('product1-',sum(product1)) as produ...
                                                    ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:41:48.980848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:48.980848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D856710>]}
[0m18:41:48.980848 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:41:48.980848 [error] [Thread-1 (]: 6 of 8 ERROR creating sql table model public.obt_manufactured_units_permonth ... [[31mERROR[0m in 0.14s]
[0m18:41:48.988861 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:41:48.989694 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:41:48.993081 [debug] [Thread-1 (]: Began running node model.instagrid.obt_trend
[0m18:41:48.998097 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:41:49.002097 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:41:48.851264 => 18:41:49.001098
[0m18:41:48.997113 [info ] [Thread-1 (]: 7 of 8 START sql table model public.obt_trend .................................. [RUN]
[0m18:41:49.003099 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:41:49.004095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_trend)
[0m18:41:49.007098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D84EE30>]}
[0m18:41:49.008104 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_trend
[0m18:41:49.010099 [info ] [Thread-2 (]: 5 of 8 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.18s]
[0m18:41:49.019337 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_trend"
[0m18:41:49.020399 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:41:49.023170 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:41:49.025189 [info ] [Thread-2 (]: 8 of 8 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:41:49.029194 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:41:49.031186 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_trend (compile): 18:41:49.012097 => 18:41:49.029194
[0m18:41:49.032187 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:41:49.033188 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_trend
[0m18:41:49.039639 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.041844 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_trend"
[0m18:41:49.051344 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:41:49.034183 => 18:41:49.051344
[0m18:41:49.051344 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m18:41:49.051344 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:41:49.051344 [debug] [Thread-1 (]: On model.instagrid.obt_trend: BEGIN
[0m18:41:49.059510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:49.104833 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.106832 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.108835 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:41:49.109833 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:41:49.124180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.125181 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_trend"
[0m18:41:49.127183 [debug] [Thread-1 (]: On model.instagrid.obt_trend: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_trend"} */

  
    

  create  table "instagrid"."public"."obt_trend__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
union all 
select date,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by date
)

select date,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
  
[0m18:41:49.129179 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product1" does not exist
LINE 14: select date,concat('product1-',sum(product1)) as product
                                            ^

[0m18:41:49.130436 [debug] [Thread-1 (]: On model.instagrid.obt_trend: ROLLBACK
[0m18:41:49.131524 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_trend (execute): 18:41:49.040634 => 18:41:49.131524
[0m18:41:49.132539 [debug] [Thread-1 (]: On model.instagrid.obt_trend: Close
[0m18:41:49.136594 [debug] [Thread-1 (]: Database Error in model obt_trend (models\Analystics-OBT\obt_trend.sql)
  column "product1" does not exist
  LINE 14: select date,concat('product1-',sum(product1)) as product
                                              ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_trend.sql
[0m18:41:49.138712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D926140>]}
[0m18:41:49.140205 [error] [Thread-1 (]: 7 of 8 ERROR creating sql table model public.obt_trend ......................... [[31mERROR[0m in 0.13s]
[0m18:41:49.141306 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_trend
[0m18:41:49.176600 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.178113 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.180127 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select manufactured_units.year_week,product_type, manufactured_units,plan as production_plan
from manufactured_units
join
"instagrid"."public"."dim_production_plan"   as production_plan
on production_plan.week=manufactured_units.year_week
  );
[0m18:41:49.192511 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:41:49.197937 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.198942 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m18:41:49.201099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:41:49.203108 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:41:49.204099 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.205102 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:41:49.207254 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:41:49.210263 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:41:49.211266 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m18:41:49.212682 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:41:49.214699 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:41:49.051344 => 18:41:49.214699
[0m18:41:49.215693 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:41:49.216694 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590dac93-1bcf-4dce-8ca3-da9080c41b97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D883040>]}
[0m18:41:49.219152 [info ] [Thread-2 (]: 8 of 8 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.19s]
[0m18:41:49.221631 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:41:49.227355 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.228370 [debug] [MainThread]: On master: BEGIN
[0m18:41:49.229369 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:49.297939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:41:49.298942 [debug] [MainThread]: On master: COMMIT
[0m18:41:49.299944 [debug] [MainThread]: Using postgres connection "master"
[0m18:41:49.299944 [debug] [MainThread]: On master: COMMIT
[0m18:41:49.300942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:41:49.301941 [debug] [MainThread]: On master: Close
[0m18:41:49.302942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:49.303942 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:41:49.304943 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:41:49.306424 [debug] [MainThread]: Connection 'model.instagrid.obt_trend' was properly closed.
[0m18:41:49.307439 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:41:49.309808 [info ] [MainThread]: 
[0m18:41:49.311280 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m18:41:49.314294 [debug] [MainThread]: Command end result
[0m18:41:49.324298 [info ] [MainThread]: 
[0m18:41:49.326295 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:41:49.328295 [info ] [MainThread]: 
[0m18:41:49.330294 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)[0m
[0m18:41:49.331294 [error] [MainThread]:   column "product1" does not exist
[0m18:41:49.334291 [error] [MainThread]:   LINE 14: select month_name,concat('product1-',sum(product1)) as produ...
[0m18:41:49.337474 [error] [MainThread]:                                                     ^
[0m18:41:49.340010 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:41:49.342350 [info ] [MainThread]: 
[0m18:41:49.344528 [error] [MainThread]: [33mDatabase Error in model obt_trend (models\Analystics-OBT\obt_trend.sql)[0m
[0m18:41:49.346697 [error] [MainThread]:   column "product1" does not exist
[0m18:41:49.348714 [error] [MainThread]:   LINE 14: select date,concat('product1-',sum(product1)) as product
[0m18:41:49.350715 [error] [MainThread]:                                               ^
[0m18:41:49.353058 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_trend.sql
[0m18:41:49.355377 [info ] [MainThread]: 
[0m18:41:49.356903 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m18:41:49.359901 [debug] [MainThread]: Command `dbt run` failed at 18:41:49.359901 after 1.81 seconds
[0m18:41:49.361904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36ADF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36B3E8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D36D6F68F0>]}
[0m18:41:49.362900 [debug] [MainThread]: Flushing usage events
[0m18:42:27.902630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D96F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBA5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBA5BE80>]}


============================== 18:42:27.910686 | 71e48fb8-289c-4e92-aaea-d71de9f56990 ==============================
[0m18:42:27.910686 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:42:27.915752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:42:28.022714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBA5BF40>]}
[0m18:42:28.034683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBB65D50>]}
[0m18:42:28.050346 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:42:28.129467 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m18:42:28.129467 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\obt_trend.sql
[0m18:42:28.147646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBF29A20>]}
[0m18:42:28.161158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBEF6D40>]}
[0m18:42:28.164878 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:42:28.167209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBEF6E60>]}
[0m18:42:28.173259 [info ] [MainThread]: 
[0m18:42:28.176224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:42:28.178507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:42:28.193545 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:42:28.194545 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:42:28.195521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:28.273990 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:42:28.275985 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:42:28.278977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:42:28.285322 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:42:28.285322 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:42:28.285322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:28.316264 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.316264 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:42:28.316264 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:42:28.331990 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:42:28.331990 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:42:28.331990 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:42:28.346937 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:28.346937 [debug] [MainThread]: On master: BEGIN
[0m18:42:28.346937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:42:28.395094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.395094 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:28.395094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:42:28.418583 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:42:28.418583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBF6DE40>]}
[0m18:42:28.418583 [debug] [MainThread]: On master: ROLLBACK
[0m18:42:28.424682 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:28.426197 [debug] [MainThread]: On master: BEGIN
[0m18:42:28.426197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.428490 [debug] [MainThread]: On master: COMMIT
[0m18:42:28.428490 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:28.428490 [debug] [MainThread]: On master: COMMIT
[0m18:42:28.428490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:42:28.428490 [debug] [MainThread]: On master: Close
[0m18:42:28.428490 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:42:28.435579 [info ] [MainThread]: 
[0m18:42:28.450139 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:42:28.453156 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:42:28.452149 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:42:28.456615 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:42:28.458606 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:42:28.465629 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:42:28.454593 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:42:28.469609 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:42:28.460611 => 18:42:28.468610
[0m18:42:28.470891 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:42:28.472914 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:42:28.473915 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:42:28.543258 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:42:28.566660 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:42:28.573097 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:42:28.538077 => 18:42:28.573097
[0m18:42:28.573097 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:42:28.573097 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:42:28.573097 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:42:28.573097 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:42:28.582612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:42:28.585132 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:42:28.585132 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:42:28.587113 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:42:28.643393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.643393 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.645904 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:42:28.646489 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:42:28.646489 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:42:28.646489 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:42:28.646489 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:42:28.668407 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:42:28.668407 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:42:28.668407 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:42:28.673079 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:42:28.676571 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:42:28.678660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.684762 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:42:28.684762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.686770 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:42:28.695983 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:42:28.697305 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:42:28.697305 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.709844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.735056 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:42:28.735056 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:42:28.735056 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:42:28.741569 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:42:28.742392 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:42:28.742392 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:42:28.745141 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:42:28.745141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:42:28.745141 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:42:28.745141 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:42:28.745141 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:42:28.757650 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:42:28.758304 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:42:28.758304 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:42:28.573097 => 18:42:28.758304
[0m18:42:28.758304 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:42:28.758304 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:42:28.758304 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:42:28.474916 => 18:42:28.758304
[0m18:42:28.758304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBF4CB20>]}
[0m18:42:28.770670 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:42:28.773716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D9CEA260>]}
[0m18:42:28.770670 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.29s]
[0m18:42:28.777856 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:42:28.775377 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.32s]
[0m18:42:28.779858 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:42:28.781952 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:42:28.786079 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:42:28.785100 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:42:28.787078 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:42:28.795089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:42:28.797507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:42:28.799516 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:42:28.798509 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:42:28.808084 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:42:28.813097 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:42:28.817206 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:42:28.801979 => 18:42:28.816106
[0m18:42:28.818229 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:42:28.821232 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:42:28.809125 => 18:42:28.820232
[0m18:42:28.830228 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:42:28.831480 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:42:28.843144 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:42:28.845159 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:42:28.846165 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:42:28.847163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:28.848164 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:42:28.850159 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:42:28.851160 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:42:28.906499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.910578 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:42:28.910578 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:42:28.926527 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:28.926527 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:42:28.926527 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:42:28.926527 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:42:28.932455 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:42:28.932455 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:42:28.932455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.946913 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:42:28.946913 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:42:28.950043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.954023 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:42:28.954023 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:42:28.954023 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:42:28.954023 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:42:28.954023 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:42:28.954023 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:42:28.963852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.963852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:42:28.963852 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:42:28.963852 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:42:28.963852 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:42:28.963852 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:42:28.963852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:28.979495 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:42:28.979495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:42:28.979495 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:42:28.985029 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:42:28.821232 => 18:42:28.985029
[0m18:42:28.985029 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:42:28.985029 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:42:28.985029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DC07A8C0>]}
[0m18:42:28.985029 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:42:28.985029 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.19s]
[0m18:42:28.997978 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:42:28.999986 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:42:29.000974 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:42:29.004933 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:42:29.006170 [info ] [Thread-1 (]: 5 of 7 START sql table model public.obt_manufactured_units_permonth ............ [RUN]
[0m18:42:29.009187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:42:29.010182 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:42:29.011183 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:42:29.014188 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:42:29.016392 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:42:28.834534 => 18:42:29.016392
[0m18:42:29.018393 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:42:29.020395 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:42:29.011183 => 18:42:29.019401
[0m18:42:29.021397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBF29120>]}
[0m18:42:29.022399 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:42:29.024397 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.23s]
[0m18:42:29.039150 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:42:29.041158 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:42:29.044142 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:42:29.046146 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:42:29.045145 [info ] [Thread-2 (]: 6 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:42:29.047142 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:42:29.049517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:42:29.050518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:29.051523 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:42:29.058800 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:42:29.060798 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:42:29.053520 => 18:42:29.060798
[0m18:42:29.061803 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:42:29.074205 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:42:29.076205 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:42:29.077208 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:42:29.079208 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:42:29.129659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:29.130657 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:42:29.131661 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  
    

  create  table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select month_name,concat('product1-',sum(product1)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
union all 
select month_name,concat('product2-',sum(product2)) as product
from
"instagrid"."public"."dim_manufactured_units"
group by month_name
)

select month_name,
SPLIT_PART(product,'-',1) as product_type,
SPLIT_PART(product,'-',2) as plan
from final
  );
  
[0m18:42:29.133658 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product1" does not exist
LINE 14: select month_name,concat('product1-',sum(product1)) as produ...
                                                  ^

[0m18:42:29.134660 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: ROLLBACK
[0m18:42:29.136844 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:42:29.026394 => 18:42:29.135659
[0m18:42:29.137864 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:42:29.144971 [debug] [Thread-1 (]: Database Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)
  column "product1" does not exist
  LINE 14: select month_name,concat('product1-',sum(product1)) as produ...
                                                    ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:42:29.145981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DC0A22C0>]}
[0m18:42:29.148225 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model public.obt_manufactured_units_permonth ... [[31mERROR[0m in 0.14s]
[0m18:42:29.150246 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:42:29.151376 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:29.153388 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:42:29.154812 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
  
[0m18:42:29.167396 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:42:29.173560 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:42:29.175553 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:42:29.177554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:29.183545 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:42:29.184545 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:42:29.186552 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:29.191608 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:42:29.193623 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:42:29.194608 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:42:29.196609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:42:29.200638 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:42:29.201613 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:42:29.208040 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:42:29.210044 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:42:29.063798 => 18:42:29.210044
[0m18:42:29.211044 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:42:29.213020 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBF6D1B0>]}
[0m18:42:29.214019 [info ] [Thread-2 (]: 6 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.16s]
[0m18:42:29.217019 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:42:29.219135 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:42:29.221156 [info ] [Thread-1 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:42:29.224152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.obt_manufactured_units_perweek)
[0m18:42:29.225151 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:42:29.231437 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.233424 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:42:29.226406 => 18:42:29.232438
[0m18:42:29.234428 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:42:29.264395 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.266393 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.269405 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:42:29.271720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:29.314934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:42:29.314934 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.315957 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select manufactured_units.year_week,product_type, manufactured_units,plan as production_plan
from manufactured_units
join
"instagrid"."public"."dim_production_plan"   as production_plan
on production_plan.week=manufactured_units.year_week
  );
[0m18:42:29.317930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:42:29.317930 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.317930 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m18:42:29.329518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:42:29.329518 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:42:29.333032 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.333032 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:42:29.333032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:42:29.333032 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:42:29.333032 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m18:42:29.333032 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:42:29.333032 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:42:29.235425 => 18:42:29.333032
[0m18:42:29.333032 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:42:29.333032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71e48fb8-289c-4e92-aaea-d71de9f56990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DC046500>]}
[0m18:42:29.348670 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.11s]
[0m18:42:29.351366 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:42:29.355382 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:29.356389 [debug] [MainThread]: On master: BEGIN
[0m18:42:29.357383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:42:29.409950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:42:29.409950 [debug] [MainThread]: On master: COMMIT
[0m18:42:29.410951 [debug] [MainThread]: Using postgres connection "master"
[0m18:42:29.411958 [debug] [MainThread]: On master: COMMIT
[0m18:42:29.412953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:42:29.413951 [debug] [MainThread]: On master: Close
[0m18:42:29.414950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:29.415951 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:42:29.416953 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:42:29.417954 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:42:29.418955 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m18:42:29.419952 [info ] [MainThread]: 
[0m18:42:29.421950 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m18:42:29.426037 [debug] [MainThread]: Command end result
[0m18:42:29.438062 [info ] [MainThread]: 
[0m18:42:29.440054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:42:29.441059 [info ] [MainThread]: 
[0m18:42:29.447777 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)[0m
[0m18:42:29.451379 [error] [MainThread]:   column "product1" does not exist
[0m18:42:29.453383 [error] [MainThread]:   LINE 14: select month_name,concat('product1-',sum(product1)) as produ...
[0m18:42:29.455389 [error] [MainThread]:                                                     ^
[0m18:42:29.457383 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:42:29.462387 [info ] [MainThread]: 
[0m18:42:29.464388 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:42:29.469195 [debug] [MainThread]: Command `dbt run` failed at 18:42:29.469195 after 1.59 seconds
[0m18:42:29.470212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256D96F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBB65D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DBEF6800>]}
[0m18:42:29.471232 [debug] [MainThread]: Flushing usage events
[0m18:44:27.323347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FBF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E31F67FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E31F67E80>]}


============================== 18:44:27.323347 | 6a2e143c-039e-4841-961d-68618ce77bed ==============================
[0m18:44:27.323347 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:44:27.332134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:44:27.435745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E31F67F40>]}
[0m18:44:27.451411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32085DB0>]}
[0m18:44:27.467035 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:44:27.546046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:27.546046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:27.552927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32515870>]}
[0m18:44:27.566549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E324F2860>]}
[0m18:44:27.569683 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:44:27.572657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E324F2A10>]}
[0m18:44:27.576173 [info ] [MainThread]: 
[0m18:44:27.580187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:27.582172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:44:27.600580 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:44:27.601594 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:44:27.603597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:27.663224 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:44:27.664246 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:44:27.669223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:44:27.676244 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:44:27.677223 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:44:27.678222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:27.719300 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:44:27.719300 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:44:27.719300 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:44:27.721338 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:44:27.721338 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:44:27.721338 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:44:27.734696 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:27.734696 [debug] [MainThread]: On master: BEGIN
[0m18:44:27.734696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:27.765838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:27.781499 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:27.782118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:27.797353 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:44:27.797353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32545D20>]}
[0m18:44:27.797353 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:27.797353 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:27.804031 [debug] [MainThread]: On master: BEGIN
[0m18:44:27.804031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:27.804031 [debug] [MainThread]: On master: COMMIT
[0m18:44:27.804031 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:27.804031 [debug] [MainThread]: On master: COMMIT
[0m18:44:27.804031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:27.804031 [debug] [MainThread]: On master: Close
[0m18:44:27.804031 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:44:27.804031 [info ] [MainThread]: 
[0m18:44:27.826179 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:44:27.826179 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:44:27.827181 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:44:27.830665 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:44:27.828178 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:44:27.831700 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:44:27.832680 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:44:27.836689 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:44:27.837684 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:44:27.839688 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:44:27.833679 => 18:44:27.839688
[0m18:44:27.845685 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:44:27.846685 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:44:27.907710 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:44:27.840690 => 18:44:27.907710
[0m18:44:27.912701 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:44:27.913581 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:44:27.919972 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:44:27.921989 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:27.922984 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:27.923986 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:44:27.924985 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:44:27.925987 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:27.926988 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:44:27.974787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:27.974787 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:27.974787 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:44:27.983519 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:27.983519 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:27.986451 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:44:27.990387 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:44:28.000545 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:28.000545 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:44:28.000545 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:44:28.000545 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:28.000545 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:44:28.000545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.000545 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:28.000545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.014554 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:44:28.016783 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:28.016783 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:44:28.016783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.030361 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.030361 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:44:28.046039 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:44:28.050801 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:28.050801 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:28.050801 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:44:28.050801 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:44:28.050801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.061846 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.061846 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:28.061846 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:28.061846 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:44:28.061846 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:44:28.069670 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:28.069670 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:44:27.914385 => 18:44:28.069670
[0m18:44:28.069670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:28.069670 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:44:28.078268 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:44:27.849891 => 18:44:28.078268
[0m18:44:28.078268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3261A980>]}
[0m18:44:28.082474 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:44:28.083949 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.25s]
[0m18:44:28.085856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3261A0E0>]}
[0m18:44:28.088892 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:44:28.090920 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.26s]
[0m18:44:28.093910 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:44:28.094971 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:44:28.096990 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:44:28.099089 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:44:28.100093 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:44:28.102105 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:44:28.105308 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:44:28.107385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:44:28.113407 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:44:28.115773 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:44:28.124900 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:44:28.125907 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:44:28.108406 => 18:44:28.124900
[0m18:44:28.127318 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:44:28.128330 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:44:28.118876 => 18:44:28.128330
[0m18:44:28.141779 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:44:28.143087 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:44:28.151495 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:44:28.152509 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:28.154523 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:44:28.155514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:44:28.163696 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:28.164698 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:44:28.165694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:28.219720 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:28.219720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:28.219720 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:28.219720 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:28.219720 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:44:28.219720 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:44:28.242323 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:44:28.243326 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:44:28.247339 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:28.251482 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:28.253081 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:44:28.253081 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:44:28.253081 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.253081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.258601 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:28.258601 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:28.258601 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:44:28.258601 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:44:28.267614 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.267614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.269475 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:44:28.269475 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:44:28.269475 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:28.269475 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:28.269475 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:44:28.269475 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:44:28.269475 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.286112 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:28.286112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.286112 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:44:28.286112 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:28.286112 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:44:28.296602 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:28.300455 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:44:28.129336 => 18:44:28.300455
[0m18:44:28.300455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:28.300455 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:44:28.300455 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:44:28.145108 => 18:44:28.300455
[0m18:44:28.300455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E325177F0>]}
[0m18:44:28.300455 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:44:28.309012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E325FC610>]}
[0m18:44:28.309012 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.20s]
[0m18:44:28.315333 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:44:28.313277 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.20s]
[0m18:44:28.318864 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:44:28.320864 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:44:28.321857 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:44:28.326176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:44:28.327181 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:44:28.333682 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:44:28.335665 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:44:28.327181 => 18:44:28.335665
[0m18:44:28.337667 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:44:28.343670 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:44:28.347667 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:28.350183 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:44:28.352171 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:44:28.399115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:28.400116 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:28.401114 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select 
*

from 
"instagrid"."public"."sg_production_plan"
  );
  
[0m18:44:28.413339 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:44:28.418989 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:28.419794 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:44:28.422038 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.422593 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:28.429006 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:44:28.429006 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.436155 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:44:28.436155 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:28.436155 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:44:28.436155 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.436155 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:28.436155 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:44:28.436155 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:28.436155 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:44:28.338677 => 18:44:28.436155
[0m18:44:28.450701 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:44:28.452649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E325FC610>]}
[0m18:44:28.453465 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.13s]
[0m18:44:28.456525 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:44:28.458796 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:44:28.459811 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:44:28.461223 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m18:44:28.463244 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:44:28.466242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:44:28.468235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:44:28.469476 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:44:28.470488 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:44:28.476710 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:28.482689 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.485681 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:44:28.471669 => 18:44:28.485681
[0m18:44:28.486680 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:44:28.515023 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:28.517030 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:44:28.477684 => 18:44:28.516025
[0m18:44:28.518554 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:44:28.519591 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:28.524610 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.525599 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:44:28.526970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:28.528482 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.529497 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:44:28.530643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:44:28.571759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:28.571759 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:28.571759 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by month_name,product_type

)

select month_name,product_type,manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
  );
[0m18:44:28.583296 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "monthy_production_planned" does not exist
LINE 15: select month_name,product_type,manufactured_units,monthy_pro...
                                                           ^

[0m18:44:28.583296 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:28.583296 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: ROLLBACK
[0m18:44:28.583296 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.583296 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:44:28.487685 => 18:44:28.583296
[0m18:44:28.583296 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select manufactured_units.year_week,product_type, manufactured_units,plan as production_plan
from manufactured_units
join
"instagrid"."public"."dim_production_plan"   as production_plan
on production_plan.week=manufactured_units.year_week
  );
[0m18:44:28.583296 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:44:28.595832 [debug] [Thread-1 (]: Database Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)
  column "monthy_production_planned" does not exist
  LINE 15: select month_name,product_type,manufactured_units,monthy_pro...
                                                             ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:44:28.599343 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:44:28.599343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3261A0E0>]}
[0m18:44:28.602751 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.602751 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model public.obt_manufactured_units_permonth .... [[31mERROR[0m in 0.13s]
[0m18:44:28.602751 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m18:44:28.612214 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:44:28.614229 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:28.620257 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:44:28.621256 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.623260 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:44:28.625262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.628261 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:28.629259 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m18:44:28.631257 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:44:28.634261 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:44:28.519591 => 18:44:28.633258
[0m18:44:28.634261 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:44:28.637260 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2e143c-039e-4841-961d-68618ce77bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E324F6290>]}
[0m18:44:28.638264 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.17s]
[0m18:44:28.641262 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:44:28.644489 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:28.645500 [debug] [MainThread]: On master: BEGIN
[0m18:44:28.647901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:28.817688 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:28.817688 [debug] [MainThread]: On master: COMMIT
[0m18:44:28.817688 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:28.817688 [debug] [MainThread]: On master: COMMIT
[0m18:44:28.817688 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:28.817688 [debug] [MainThread]: On master: Close
[0m18:44:28.817688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:28.817688 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:44:28.817688 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:44:28.833285 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m18:44:28.833285 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:44:28.833285 [info ] [MainThread]: 
[0m18:44:28.836224 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m18:44:28.841467 [debug] [MainThread]: Command end result
[0m18:44:28.851456 [info ] [MainThread]: 
[0m18:44:28.853829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:44:28.854826 [info ] [MainThread]: 
[0m18:44:28.857827 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)[0m
[0m18:44:28.859826 [error] [MainThread]:   column "monthy_production_planned" does not exist
[0m18:44:28.863117 [error] [MainThread]:   LINE 15: select month_name,product_type,manufactured_units,monthy_pro...
[0m18:44:28.865271 [error] [MainThread]:                                                              ^
[0m18:44:28.868257 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:44:28.870257 [info ] [MainThread]: 
[0m18:44:28.872255 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:44:28.875521 [debug] [MainThread]: Command `dbt run` failed at 18:44:28.875521 after 1.58 seconds
[0m18:44:28.877527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FBF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E32085DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3268FA90>]}
[0m18:44:28.881881 [debug] [MainThread]: Flushing usage events
[0m18:44:50.818396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179242F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926657FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926657EB0>]}


============================== 18:44:50.818396 | 2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1 ==============================
[0m18:44:50.818396 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:44:50.826348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:44:50.924624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926657F70>]}
[0m18:44:50.933700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926774CA0>]}
[0m18:44:50.950087 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:44:51.028064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:51.028064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:51.043914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926C15900>]}
[0m18:44:51.055316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179269028F0>]}
[0m18:44:51.059281 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:44:51.062422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926902AA0>]}
[0m18:44:51.068433 [info ] [MainThread]: 
[0m18:44:51.071432 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:51.074455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:44:51.087447 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:44:51.088449 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:44:51.090432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:51.152548 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:44:51.154569 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:44:51.157545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:44:51.165013 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:44:51.166846 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:44:51.167630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:51.209243 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.210266 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:44:51.210266 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:44:51.216398 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:44:51.216398 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:44:51.216398 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:44:51.226501 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:51.232015 [debug] [MainThread]: On master: BEGIN
[0m18:44:51.232015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:51.279401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.279401 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:51.279401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:51.295039 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:44:51.295039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926C45DB0>]}
[0m18:44:51.295039 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:51.295039 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:51.295039 [debug] [MainThread]: On master: BEGIN
[0m18:44:51.295039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.295039 [debug] [MainThread]: On master: COMMIT
[0m18:44:51.295039 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:51.295039 [debug] [MainThread]: On master: COMMIT
[0m18:44:51.295039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:51.295039 [debug] [MainThread]: On master: Close
[0m18:44:51.311226 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:44:51.313464 [info ] [MainThread]: 
[0m18:44:51.328700 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:44:51.329888 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:44:51.330697 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:44:51.338037 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:44:51.339037 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:44:51.333956 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:44:51.344549 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:44:51.346372 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:44:51.346372 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:44:51.356416 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:44:51.357416 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:44:51.340033 => 18:44:51.357416
[0m18:44:51.359412 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:44:51.419320 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:44:51.346372 => 18:44:51.419320
[0m18:44:51.424348 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:44:51.425347 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:44:51.431289 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:44:51.433293 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:51.434295 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:51.435310 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:44:51.436308 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:44:51.437445 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:44:51.438461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:44:51.487857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.487857 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:51.487857 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:44:51.501967 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.501967 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:51.501967 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:44:51.501967 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:44:51.501967 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:51.517609 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:44:51.517609 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:44:51.517609 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:51.517609 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:44:51.517609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.517609 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:51.517609 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.517609 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:44:51.534730 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:51.534730 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:44:51.534730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.537549 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.550282 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:44:51.565327 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:44:51.566859 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:51.566859 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:51.566859 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:44:51.566859 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:44:51.573457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:51.574615 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:51.581698 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:44:51.581698 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:44:51.581698 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:44:51.581698 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:44:51.593667 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:51.597201 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:44:51.426278 => 18:44:51.597201
[0m18:44:51.597201 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:51.597201 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:44:51.597201 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:44:51.359412 => 18:44:51.597201
[0m18:44:51.597201 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926D1A9E0>]}
[0m18:44:51.604528 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:44:51.608665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926D18FA0>]}
[0m18:44:51.606163 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.25s]
[0m18:44:51.610827 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.27s]
[0m18:44:51.613956 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:44:51.616984 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:44:51.618987 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:44:51.619975 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:44:51.621992 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:44:51.623010 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:44:51.630163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:44:51.634472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:44:51.635499 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:44:51.636514 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:44:51.643686 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:44:51.650912 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:44:51.653940 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:44:51.637671 => 18:44:51.653940
[0m18:44:51.655937 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:44:51.644689 => 18:44:51.654936
[0m18:44:51.659117 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:44:51.661118 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:44:51.675036 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:44:51.684082 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:44:51.687579 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:51.688579 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:44:51.689899 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:51.690913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:44:51.690913 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:44:51.693332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:51.752284 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.753292 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:51.755292 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:44:51.773654 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:44:51.773654 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:51.781171 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:44:51.781171 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.783205 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:51.783205 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:44:51.791345 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.797505 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:44:51.797505 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:51.797505 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:44:51.803337 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:51.807833 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:44:51.810856 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:44:51.817538 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:51.823042 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:44:51.662118 => 18:44:51.817538
[0m18:44:51.824317 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:44:51.824317 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926CFADD0>]}
[0m18:44:51.824317 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.20s]
[0m18:44:51.828831 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:44:51.832338 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:44:51.833336 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:44:51.837359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:44:51.839353 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:44:51.846540 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:44:51.850302 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:44:51.840357 => 18:44:51.849790
[0m18:44:51.851313 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:44:51.864532 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:44:51.867093 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:51.869109 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:44:51.870108 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:44:51.888112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.890109 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:51.891109 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:44:51.912333 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:44:51.918334 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:51.920324 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:44:51.921326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.928328 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:51.937637 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:44:51.939632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:51.951186 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:44:51.953192 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:51.954186 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:44:51.957188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:51.961991 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:44:51.963274 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:44:51.964331 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:51.967347 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:51.969354 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,month_name, sum(plan) over(partition by month_name) as monthy_production_planned
from cte
  );
  
[0m18:44:51.973298 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:51.977331 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:44:51.676035 => 18:44:51.977331
[0m18:44:51.978332 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:44:51.980669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926C4B100>]}
[0m18:44:51.982686 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.35s]
[0m18:44:51.984686 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:44:51.989137 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m18:44:51.996602 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:51.996602 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:44:51.999863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:52.006446 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:52.007445 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:44:52.010446 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:44:52.017903 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:44:52.018907 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:52.019974 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:44:52.024085 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:44:52.030108 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:44:52.032109 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:44:52.039662 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:44:52.043036 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:44:51.852312 => 18:44:52.043036
[0m18:44:52.044292 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:44:52.046726 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926CFA260>]}
[0m18:44:52.048733 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.21s]
[0m18:44:52.052270 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:44:52.054589 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:44:52.055608 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:44:52.057608 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m18:44:52.062868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:44:52.060854 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:44:52.063867 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:44:52.065869 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:44:52.072875 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:52.073870 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:44:52.077873 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:44:52.067887 => 18:44:52.076875
[0m18:44:52.091820 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:52.092815 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:44:52.096946 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:44:52.078881 => 18:44:52.095727
[0m18:44:52.144808 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:52.145810 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:44:52.148812 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:52.158347 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:52.159350 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:44:52.161533 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:52.163552 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:44:52.165550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:44:52.162556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:52.242517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:52.244533 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:44:52.244533 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select manufactured_units.year_week,product_type, manufactured_units,plan as production_plan
from manufactured_units
join
"instagrid"."public"."dim_production_plan"   as production_plan
on production_plan.week=manufactured_units.year_week
  );
[0m18:44:52.244533 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "plan" does not exist
LINE 15: ..._units.year_week,product_type, manufactured_units,plan as pr...
                                                              ^
HINT:  Perhaps you meant to reference the column "production_plan.pn".

[0m18:44:52.250551 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: ROLLBACK
[0m18:44:52.250551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:44:52.250551 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:44:52.151342 => 18:44:52.250551
[0m18:44:52.250551 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:44:52.255906 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:44:52.255906 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by month_name,product_type

)

select month_name,product_type,manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
  );
[0m18:44:52.261305 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "month_name" is ambiguous
LINE 15: select month_name,product_type,manufactured_units,monthy_pro...
                ^

[0m18:44:52.262319 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: ROLLBACK
[0m18:44:52.264615 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:44:52.097975 => 18:44:52.264615
[0m18:44:52.266911 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:44:52.271414 [debug] [Thread-2 (]: Database Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)
  column "plan" does not exist
  LINE 15: ..._units.year_week,product_type, manufactured_units,plan as pr...
                                                                ^
  HINT:  Perhaps you meant to reference the column "production_plan.pn".
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:44:52.273541 [debug] [Thread-1 (]: Database Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)
  column reference "month_name" is ambiguous
  LINE 15: select month_name,product_type,manufactured_units,monthy_pro...
                  ^
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:44:52.274543 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926CFB400>]}
[0m18:44:52.275544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2af60c05-574d-4ab0-aad2-9c7f7c4c5ea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926DABEB0>]}
[0m18:44:52.277003 [error] [Thread-2 (]: 7 of 7 ERROR creating sql view model public.obt_manufactured_units_perweek ..... [[31mERROR[0m in 0.21s]
[0m18:44:52.280118 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:44:52.279098 [error] [Thread-1 (]: 6 of 7 ERROR creating sql view model public.obt_manufactured_units_permonth .... [[31mERROR[0m in 0.21s]
[0m18:44:52.284383 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:44:52.289757 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:52.289757 [debug] [MainThread]: On master: BEGIN
[0m18:44:52.290774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:52.355604 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:44:52.356625 [debug] [MainThread]: On master: COMMIT
[0m18:44:52.357601 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:52.358610 [debug] [MainThread]: On master: COMMIT
[0m18:44:52.359601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:44:52.360606 [debug] [MainThread]: On master: Close
[0m18:44:52.361602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:52.362607 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:44:52.363842 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:44:52.365330 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m18:44:52.365330 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:44:52.366733 [info ] [MainThread]: 
[0m18:44:52.368748 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m18:44:52.372135 [debug] [MainThread]: Command end result
[0m18:44:52.382679 [info ] [MainThread]: 
[0m18:44:52.384016 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:44:52.386032 [info ] [MainThread]: 
[0m18:44:52.388038 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)[0m
[0m18:44:52.389033 [error] [MainThread]:   column "plan" does not exist
[0m18:44:52.391035 [error] [MainThread]:   LINE 15: ..._units.year_week,product_type, manufactured_units,plan as pr...
[0m18:44:52.400324 [error] [MainThread]:                                                                 ^
[0m18:44:52.402853 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "production_plan.pn".
[0m18:44:52.404851 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:44:52.406851 [info ] [MainThread]: 
[0m18:44:52.408853 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_permonth (models\Analystics-OBT\obt_manufactured_units_permonth.sql)[0m
[0m18:44:52.411947 [error] [MainThread]:   column reference "month_name" is ambiguous
[0m18:44:52.415151 [error] [MainThread]:   LINE 15: select month_name,product_type,manufactured_units,monthy_pro...
[0m18:44:52.418180 [error] [MainThread]:                   ^
[0m18:44:52.421170 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m18:44:52.422170 [info ] [MainThread]: 
[0m18:44:52.424166 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m18:44:52.426169 [debug] [MainThread]: Command `dbt run` failed at 18:44:52.426169 after 1.63 seconds
[0m18:44:52.427167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179242F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926D1A9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017926902440>]}
[0m18:44:52.428169 [debug] [MainThread]: Flushing usage events
[0m18:50:20.944157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ACEF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF25BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF25BEB0>]}


============================== 18:50:20.949165 | 83696d66-c90f-4ffe-bdc1-8b1e8fd772a2 ==============================
[0m18:50:20.949165 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:50:20.951973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:50:21.056206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF25BF70>]}
[0m18:50:21.071759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF366500>]}
[0m18:50:21.087429 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:50:21.198675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:21.198675 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:21.214313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF719900>]}
[0m18:50:21.229944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF6F2980>]}
[0m18:50:21.237149 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:50:21.241119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF6F29E0>]}
[0m18:50:21.247126 [info ] [MainThread]: 
[0m18:50:21.250133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:21.252128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:50:21.273677 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:50:21.274677 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:50:21.275675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:21.335018 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:50:21.337049 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:50:21.341021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:50:21.348027 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:50:21.349029 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:50:21.349029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:21.388316 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.388316 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:50:21.388316 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:50:21.388316 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:50:21.388316 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:50:21.388316 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:50:21.405470 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:21.405470 [debug] [MainThread]: On master: BEGIN
[0m18:50:21.405470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:21.453244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.453244 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:21.453244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:21.467266 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:50:21.467266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF745DB0>]}
[0m18:50:21.467266 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:21.467266 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:21.467266 [debug] [MainThread]: On master: BEGIN
[0m18:50:21.467266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.467266 [debug] [MainThread]: On master: COMMIT
[0m18:50:21.467266 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:21.467266 [debug] [MainThread]: On master: COMMIT
[0m18:50:21.482905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:21.484164 [debug] [MainThread]: On master: Close
[0m18:50:21.484164 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:50:21.490347 [info ] [MainThread]: 
[0m18:50:21.503608 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:50:21.503608 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:50:21.505609 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:50:21.511490 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:50:21.506749 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:50:21.512503 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:50:21.514506 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:50:21.518507 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:50:21.519510 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:50:21.528371 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:50:21.530388 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:50:21.515504 => 18:50:21.529371
[0m18:50:21.532374 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:50:21.533370 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:50:21.523355 => 18:50:21.533370
[0m18:50:21.591662 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:50:21.613658 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:50:21.622791 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:50:21.637302 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:21.645531 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:50:21.645531 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:21.645531 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:21.645531 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:50:21.645531 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:50:21.700659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.700659 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:21.700659 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:50:21.711467 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.714839 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:21.716349 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:50:21.719506 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:50:21.723446 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:21.723446 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:50:21.723446 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:50:21.733196 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:21.733196 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:50:21.737293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.739879 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:21.739879 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.739879 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:50:21.739879 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:21.748389 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:50:21.748389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.764286 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.779962 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:50:21.779962 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:50:21.779962 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:21.779962 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:21.779962 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:50:21.779962 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:50:21.790104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:21.790104 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:21.796429 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:21.796429 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:21.796429 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:50:21.796429 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:50:21.809026 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:21.811563 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:50:21.618656 => 18:50:21.811563
[0m18:50:21.811563 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:21.811563 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:50:21.811563 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:50:21.534603 => 18:50:21.811563
[0m18:50:21.811563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF803460>]}
[0m18:50:21.811563 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:50:21.820429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF816230>]}
[0m18:50:21.820429 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.30s]
[0m18:50:21.827394 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:50:21.825039 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.31s]
[0m18:50:21.830505 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:50:21.832713 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:50:21.833712 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:50:21.835722 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:50:21.836714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:50:21.837712 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:50:21.839714 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:50:21.840718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:50:21.850990 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:50:21.852987 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:50:21.861526 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:50:21.862546 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:50:21.841715 => 18:50:21.862546
[0m18:50:21.864547 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:50:21.873966 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:50:21.854995 => 18:50:21.873966
[0m18:50:21.877350 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:50:21.878382 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:50:21.885762 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:50:21.887745 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:21.888746 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:50:21.890738 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:50:21.892809 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:21.894831 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:50:21.896831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:21.945541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.945541 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:21.948117 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:50:21.949589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:21.954622 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:21.956029 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:50:21.961641 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:50:21.961641 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:21.961641 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:50:21.961641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.974304 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:21.974304 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:50:21.974304 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:50:21.974304 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:21.974304 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:50:21.974304 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.986316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.986316 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:50:21.986316 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:21.986316 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:21.986316 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:50:21.986316 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:50:21.986316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:21.986316 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:50:21.986316 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:21.986316 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:22.003751 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:22.003751 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:50:22.003751 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:50:22.003751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:22.003751 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:22.003751 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:22.003751 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:50:22.017774 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:50:21.865545 => 18:50:22.017774
[0m18:50:22.018536 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:50:22.018536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF7185E0>]}
[0m18:50:22.023057 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:22.023057 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.18s]
[0m18:50:22.028456 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:50:21.880350 => 18:50:22.028456
[0m18:50:22.030716 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:50:22.032712 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:50:22.034719 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:50:22.036715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF7FC850>]}
[0m18:50:22.037711 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:50:22.041587 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.20s]
[0m18:50:22.043580 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:50:22.044587 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:50:22.045797 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:50:22.053940 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:50:22.056939 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:50:22.046926 => 18:50:22.056939
[0m18:50:22.057948 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:50:22.067828 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:50:22.070846 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:22.073408 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:50:22.074414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:50:22.120831 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:22.120831 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:22.121839 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m18:50:22.135749 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m18:50:22.139460 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:22.139460 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:50:22.139460 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:22.139460 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:22.139460 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:50:22.139460 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:22.139460 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:50:22.139460 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:22.139460 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:50:22.155785 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:22.156615 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:22.156615 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:50:22.162133 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:22.162133 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:50:22.058945 => 18:50:22.162133
[0m18:50:22.162133 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:50:22.162133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF774F40>]}
[0m18:50:22.170143 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.12s]
[0m18:50:22.173598 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:50:22.176720 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:50:22.177736 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:50:22.178742 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m18:50:22.181751 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:50:22.183734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:50:22.184733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:50:22.185733 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:50:22.186739 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:50:22.191755 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.196735 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:22.200741 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:50:22.187734 => 18:50:22.199743
[0m18:50:22.202736 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:50:22.203735 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:50:22.192762 => 18:50:22.203735
[0m18:50:22.237527 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.238516 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:50:22.245512 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:22.246486 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.247501 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:50:22.249498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:22.250501 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:22.251761 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:50:22.252779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:50:22.288290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:22.288290 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.303930 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by month_name,product_type

)

select distinct manufactured_units.month_name,product_type,monthly_manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m18:50:22.309284 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:22.309284 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:22.309284 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select manufactured_units.year_week,product_type, manufactured_units,plan as production_plan
from manufactured_units
join
"instagrid"."public"."dim_production_plan"   as production_plan
on production_plan.week=manufactured_units.year_week
  );
[0m18:50:22.309284 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:22.316951 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.319970 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "plan" does not exist
LINE 15: ..._units.year_week,product_type, manufactured_units,plan as pr...
                                                              ^
HINT:  Perhaps you meant to reference the column "production_plan.pn".

[0m18:50:22.319970 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m18:50:22.319970 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: ROLLBACK
[0m18:50:22.319970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:22.323428 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:50:22.239487 => 18:50:22.323428
[0m18:50:22.323428 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:50:22.323428 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:50:22.323428 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.323428 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:50:22.332446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:22.335960 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:22.335960 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m18:50:22.335960 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:22.335960 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:50:22.204736 => 18:50:22.335960
[0m18:50:22.335960 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:50:22.335960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF80FDC0>]}
[0m18:50:22.346461 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.15s]
[0m18:50:22.349374 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:50:22.350389 [debug] [Thread-2 (]: Database Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)
  column "plan" does not exist
  LINE 15: ..._units.year_week,product_type, manufactured_units,plan as pr...
                                                                ^
  HINT:  Perhaps you meant to reference the column "production_plan.pn".
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:50:22.352688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83696d66-c90f-4ffe-bdc1-8b1e8fd772a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF6F0520>]}
[0m18:50:22.354703 [error] [Thread-2 (]: 7 of 7 ERROR creating sql view model public.obt_manufactured_units_perweek ..... [[31mERROR[0m in 0.17s]
[0m18:50:22.357925 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:50:22.360948 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:22.362464 [debug] [MainThread]: On master: BEGIN
[0m18:50:22.363474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:22.414530 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:22.415529 [debug] [MainThread]: On master: COMMIT
[0m18:50:22.416526 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:22.417529 [debug] [MainThread]: On master: COMMIT
[0m18:50:22.418532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:22.419535 [debug] [MainThread]: On master: Close
[0m18:50:22.420530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:22.421530 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:50:22.422531 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:50:22.424532 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m18:50:22.425531 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:50:22.426528 [info ] [MainThread]: 
[0m18:50:22.428529 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m18:50:22.434012 [debug] [MainThread]: Command end result
[0m18:50:22.449283 [info ] [MainThread]: 
[0m18:50:22.452286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:22.454107 [info ] [MainThread]: 
[0m18:50:22.456297 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)[0m
[0m18:50:22.458321 [error] [MainThread]:   column "plan" does not exist
[0m18:50:22.460321 [error] [MainThread]:   LINE 15: ..._units.year_week,product_type, manufactured_units,plan as pr...
[0m18:50:22.462321 [error] [MainThread]:                                                                 ^
[0m18:50:22.463848 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "production_plan.pn".
[0m18:50:22.465853 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:50:22.472085 [info ] [MainThread]: 
[0m18:50:22.474090 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:50:22.477090 [debug] [MainThread]: Command `dbt run` failed at 18:50:22.477090 after 1.56 seconds
[0m18:50:22.478090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150ACEF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF366500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150AF6DFE20>]}
[0m18:50:22.479093 [debug] [MainThread]: Flushing usage events
[0m18:50:46.992615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233880F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A457EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A457DF0>]}


============================== 18:50:46.992615 | 277ecfac-da15-4d1a-9fd6-52c62a36fa99 ==============================
[0m18:50:46.992615 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:50:46.999974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:50:47.116537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A457FD0>]}
[0m18:50:47.133532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A565E10>]}
[0m18:50:47.148538 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:50:47.234192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:47.236037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:47.238524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A915840>]}
[0m18:50:47.250039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A8F28C0>]}
[0m18:50:47.250039 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:50:47.260435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A8F2920>]}
[0m18:50:47.265832 [info ] [MainThread]: 
[0m18:50:47.267838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:47.272034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:50:47.297820 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:50:47.298834 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:50:47.300845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:47.359342 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:50:47.362357 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:50:47.366353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:50:47.370076 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:50:47.370076 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:50:47.370076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:47.400995 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.416639 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:50:47.416639 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:50:47.418196 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:50:47.418196 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:50:47.418196 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:50:47.432715 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:47.432715 [debug] [MainThread]: On master: BEGIN
[0m18:50:47.432715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:47.480032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.481327 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:47.481327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:47.499201 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:50:47.499201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A955CF0>]}
[0m18:50:47.505096 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:47.506360 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:47.506360 [debug] [MainThread]: On master: BEGIN
[0m18:50:47.507632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.507632 [debug] [MainThread]: On master: COMMIT
[0m18:50:47.507632 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:47.507632 [debug] [MainThread]: On master: COMMIT
[0m18:50:47.511647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:47.511647 [debug] [MainThread]: On master: Close
[0m18:50:47.511647 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:50:47.511647 [info ] [MainThread]: 
[0m18:50:47.529542 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:50:47.530544 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:50:47.531542 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:50:47.533544 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:50:47.539642 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:50:47.540639 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:50:47.535621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:50:47.547705 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:50:47.549203 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:50:47.552033 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:50:47.541640 => 18:50:47.550257
[0m18:50:47.558780 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:50:47.555785 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:50:47.621557 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:50:47.623560 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:50:47.552757 => 18:50:47.622559
[0m18:50:47.624563 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:50:47.625563 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:47.631563 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:50:47.632560 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:50:47.634875 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:50:47.636349 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:47.637369 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:50:47.639369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:47.686244 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.686244 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:47.686244 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:50:47.704615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.704615 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:47.704615 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:50:47.704615 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:50:47.717126 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:47.717126 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:50:47.717126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:47.740377 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:47.740377 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:50:47.740377 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:50:47.740377 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:47.749601 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:50:47.749601 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:47.749601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:47.780585 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:50:47.780585 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:47.780585 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:47.780585 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:50:47.780585 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:50:47.780585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:47.780585 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:47.780585 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:50:47.799820 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:50:47.799820 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:47.799820 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:50:47.803484 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:50:47.806437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:47.812264 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:50:47.812264 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:47.812264 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:50:47.812264 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:50:47.559777 => 18:50:47.812264
[0m18:50:47.812264 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:50:47.818607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338AA01C00>]}
[0m18:50:47.818607 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.28s]
[0m18:50:47.822734 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:47.823497 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:50:47.827746 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:50:47.626563 => 18:50:47.827746
[0m18:50:47.829753 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:50:47.831741 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:50:47.833735 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:50:47.836057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A578E50>]}
[0m18:50:47.837061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:50:47.841076 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:50:47.840077 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.30s]
[0m18:50:47.847099 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:50:47.849074 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:50:47.850483 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:50:47.851486 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:50:47.844058 => 18:50:47.851486
[0m18:50:47.854484 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:50:47.853482 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:50:47.865498 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:50:47.867243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:50:47.869255 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:50:47.875248 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:50:47.876244 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:47.878246 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:50:47.870243 => 18:50:47.877247
[0m18:50:47.879243 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:50:47.879243 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:50:47.881705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:50:47.895731 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:50:47.898725 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:47.900242 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:50:47.900754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:47.952687 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.955898 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:47.956600 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:50:47.959606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:47.961918 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:47.961918 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:50:47.974741 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:50:47.974741 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:47.974741 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:50:47.974741 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:50:47.984856 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:47.984856 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:47.984856 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:50:47.984856 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:47.984856 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:50:47.984856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:47.984856 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:47.999871 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:50:47.984856 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:48.003392 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:50:48.003392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:48.003392 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:48.003392 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:50:48.003392 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:50:48.003392 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:48.003392 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:50:48.003392 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:48.017026 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:50:48.017026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:48.017026 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:50:48.017026 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:50:48.017026 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:50:48.017026 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:48.031538 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:50:47.855485 => 18:50:48.031538
[0m18:50:48.031538 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:48.031538 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:50:48.036102 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:50:47.882709 => 18:50:48.036102
[0m18:50:48.036102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A9B0190>]}
[0m18:50:48.039908 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:50:48.041750 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.20s]
[0m18:50:48.044284 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:50:48.045304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338AA7FD30>]}
[0m18:50:48.047625 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:50:48.049642 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.18s]
[0m18:50:48.051644 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:50:48.055949 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:50:48.057944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:50:48.059948 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:50:48.065992 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:50:48.068005 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:50:48.060951 => 18:50:48.067015
[0m18:50:48.069046 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:50:48.076065 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:50:48.079065 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:48.080060 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:50:48.082064 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:50:48.133876 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:48.134904 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:48.134904 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m18:50:48.149584 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m18:50:48.153581 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:48.153656 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:50:48.155124 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:48.155124 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:48.155124 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:50:48.162344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:48.162344 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:50:48.162344 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:48.162344 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:50:48.170433 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:48.171058 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:50:48.171058 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:50:48.177630 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:50:48.177630 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:50:48.071058 => 18:50:48.177630
[0m18:50:48.185142 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:50:48.185142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338AA8E020>]}
[0m18:50:48.188369 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.13s]
[0m18:50:48.191100 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:50:48.193132 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:50:48.194133 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:50:48.196539 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m18:50:48.201155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:50:48.198626 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:50:48.202215 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:50:48.205229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:50:48.211603 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.213612 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:50:48.221014 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:48.224010 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:50:48.215602 => 18:50:48.223007
[0m18:50:48.226017 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:50:48.206584 => 18:50:48.225015
[0m18:50:48.227007 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:50:48.228009 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:50:48.255001 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:48.260005 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.262310 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:48.263311 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:50:48.264317 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.265311 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:50:48.266313 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:50:48.268489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:48.322584 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:48.325152 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:50:48.325152 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select year_week,product_type,manufactured_units,plan as production_plan
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m18:50:48.329493 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "plan" does not exist
LINE 15: select year_week,product_type,manufactured_units,plan as pro...
                                                          ^
HINT:  Perhaps you meant to reference the column "production_plan.pn".

[0m18:50:48.330135 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: ROLLBACK
[0m18:50:48.330135 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:50:48.229004 => 18:50:48.330135
[0m18:50:48.333649 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:50:48.335288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:50:48.337153 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.337153 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units


)

select distinct manufactured_units.month_name,product_type,monthly_manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m18:50:48.343980 [debug] [Thread-2 (]: Database Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)
  column "plan" does not exist
  LINE 15: select year_week,product_type,manufactured_units,plan as pro...
                                                            ^
  HINT:  Perhaps you meant to reference the column "production_plan.pn".
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:50:48.343980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338AAB7D60>]}
[0m18:50:48.343980 [error] [Thread-2 (]: 7 of 7 ERROR creating sql view model public.obt_manufactured_units_perweek ..... [[31mERROR[0m in 0.14s]
[0m18:50:48.343980 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:50:48.350978 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:50:48.356866 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.356866 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m18:50:48.356866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:50:48.356866 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:50:48.356866 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.356866 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:50:48.356866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:50:48.371303 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:50:48.373310 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m18:50:48.375465 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:48.378312 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:50:48.256013 => 18:50:48.377304
[0m18:50:48.378312 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:50:48.380388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277ecfac-da15-4d1a-9fd6-52c62a36fa99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A99EB90>]}
[0m18:50:48.381358 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.18s]
[0m18:50:48.383552 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:50:48.388013 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:48.389009 [debug] [MainThread]: On master: BEGIN
[0m18:50:48.390005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:48.445586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:48.446589 [debug] [MainThread]: On master: COMMIT
[0m18:50:48.447618 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:48.448595 [debug] [MainThread]: On master: COMMIT
[0m18:50:48.449595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:48.450593 [debug] [MainThread]: On master: Close
[0m18:50:48.451590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:48.452590 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:50:48.453594 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:50:48.454593 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m18:50:48.455590 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:50:48.456589 [info ] [MainThread]: 
[0m18:50:48.457590 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m18:50:48.462603 [debug] [MainThread]: Command end result
[0m18:50:48.473600 [info ] [MainThread]: 
[0m18:50:48.474595 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:50:48.476593 [info ] [MainThread]: 
[0m18:50:48.478596 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)[0m
[0m18:50:48.482686 [error] [MainThread]:   column "plan" does not exist
[0m18:50:48.485743 [error] [MainThread]:   LINE 15: select year_week,product_type,manufactured_units,plan as pro...
[0m18:50:48.487726 [error] [MainThread]:                                                             ^
[0m18:50:48.489866 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "production_plan.pn".
[0m18:50:48.492881 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:50:48.495964 [info ] [MainThread]: 
[0m18:50:48.497977 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:50:48.502515 [debug] [MainThread]: Command `dbt run` failed at 18:50:48.501514 after 1.54 seconds
[0m18:50:48.504514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233880F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A565E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002338A9B0190>]}
[0m18:50:48.506513 [debug] [MainThread]: Flushing usage events
[0m18:52:06.216275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C13F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3757FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3757EB0>]}


============================== 18:52:06.216275 | 7a3fbd89-6bfd-42d7-a86e-21b915a9d610 ==============================
[0m18:52:06.216275 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:52:06.226025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:52:06.334342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3757F70>]}
[0m18:52:06.345485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3876500>]}
[0m18:52:06.358031 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:52:06.445366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:06.445366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:06.452906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3D15900>]}
[0m18:52:06.452906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3CF2980>]}
[0m18:52:06.464782 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:52:06.467697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3CF29E0>]}
[0m18:52:06.470708 [info ] [MainThread]: 
[0m18:52:06.475286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:52:06.478287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:52:06.497300 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:52:06.498312 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:52:06.500318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:06.558728 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:52:06.560756 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:52:06.564747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:52:06.570772 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:52:06.571773 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:52:06.572754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:06.609563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:52:06.609563 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:52:06.609563 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:52:06.616096 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:52:06.623129 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:52:06.623129 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:52:06.630740 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:06.630740 [debug] [MainThread]: On master: BEGIN
[0m18:52:06.630740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:06.686552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:06.686552 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:06.686552 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:52:06.702579 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:52:06.702579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3D55DB0>]}
[0m18:52:06.702579 [debug] [MainThread]: On master: ROLLBACK
[0m18:52:06.702579 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:06.702579 [debug] [MainThread]: On master: BEGIN
[0m18:52:06.715737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:06.715737 [debug] [MainThread]: On master: COMMIT
[0m18:52:06.715737 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:06.718383 [debug] [MainThread]: On master: COMMIT
[0m18:52:06.718383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:06.718383 [debug] [MainThread]: On master: Close
[0m18:52:06.718383 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:52:06.726813 [info ] [MainThread]: 
[0m18:52:06.739826 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:52:06.739826 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:52:06.741832 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:52:06.746381 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:52:06.749382 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:52:06.750381 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:52:06.752380 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:52:06.753381 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:52:06.757382 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:52:06.763393 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:52:06.767382 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:52:06.758382 => 18:52:06.767382
[0m18:52:06.768383 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:52:06.788719 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:52:06.753381 => 18:52:06.787710
[0m18:52:06.818964 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:52:06.843383 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:52:06.847876 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:52:06.849878 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:52:06.855317 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:52:06.856320 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:52:06.859053 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:52:06.864742 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:52:06.864742 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:52:06.913575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:06.913575 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:52:06.913575 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:52:06.923725 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:06.923725 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:52:06.923725 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:52:06.929974 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:52:06.939433 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:52:06.939433 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:52:06.939433 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:52:06.945334 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:52:06.945334 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:52:06.945334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:06.945334 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:52:06.945334 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:06.954844 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:52:06.954844 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:52:06.954844 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:52:06.960729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:06.970857 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:06.970857 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:52:06.988638 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:52:06.988638 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:52:06.989882 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:52:06.990894 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:52:06.991894 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:52:06.993894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:52:06.994895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:52:07.000910 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:52:07.004023 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:52:07.004023 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:52:07.004023 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:52:07.014379 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:07.014379 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:52:06.769378 => 18:52:07.014379
[0m18:52:07.014379 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:07.014379 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:52:07.019897 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:52:06.844386 => 18:52:07.019897
[0m18:52:07.019897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3E07400>]}
[0m18:52:07.026281 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:52:07.027089 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.27s]
[0m18:52:07.030874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3E18CA0>]}
[0m18:52:07.033891 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:52:07.036093 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.28s]
[0m18:52:07.039091 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:52:07.040090 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:52:07.042092 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:52:07.044788 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:52:07.046432 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:52:07.047451 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:52:07.049451 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:52:07.051447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:52:07.056453 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:52:07.058450 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:52:07.064527 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:52:07.067524 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:52:07.059449 => 18:52:07.066526
[0m18:52:07.067524 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:52:07.052451 => 18:52:07.067524
[0m18:52:07.068526 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:52:07.069529 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:52:07.078677 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:52:07.086679 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:52:07.098781 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:52:07.100783 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:52:07.101790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:07.111789 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:52:07.113786 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:52:07.114783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:07.203224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:07.204581 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:52:07.205931 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:52:07.208947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:07.208947 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:52:07.208947 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:52:07.230442 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:52:07.236887 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:52:07.238170 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:52:07.238170 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:52:07.245708 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:52:07.247089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.247089 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:52:07.254551 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:52:07.256685 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:52:07.257285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.261443 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:52:07.261443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.261443 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:52:07.271436 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:52:07.272457 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:52:07.272457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.272457 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:52:07.276258 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:52:07.281887 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:52:07.281887 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:52:07.285604 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:52:07.286602 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:52:07.296532 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:52:07.302532 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:52:07.303532 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:52:07.305535 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:52:07.309255 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:07.309255 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:52:07.079675 => 18:52:07.309255
[0m18:52:07.309255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:07.318644 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:52:07.320621 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:52:07.070661 => 18:52:07.320621
[0m18:52:07.324633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3DFC280>]}
[0m18:52:07.324633 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:52:07.324633 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.28s]
[0m18:52:07.330329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3D14070>]}
[0m18:52:07.331340 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:52:07.333349 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.27s]
[0m18:52:07.337275 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:52:07.339273 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:52:07.341270 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:52:07.343317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:52:07.344323 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:52:07.350862 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:52:07.360978 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:52:07.345842 => 18:52:07.359976
[0m18:52:07.361978 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:52:07.376548 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:52:07.383564 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:52:07.387848 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:52:07.388846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:07.447650 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:07.447650 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:52:07.447650 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m18:52:07.467824 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m18:52:07.473578 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:52:07.473578 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:52:07.476741 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.476741 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:52:07.476741 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:52:07.476741 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.490741 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:52:07.490741 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:52:07.490741 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:52:07.490741 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:52:07.490741 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:52:07.490741 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:52:07.499458 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:52:07.505003 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:52:07.362978 => 18:52:07.505003
[0m18:52:07.505003 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:52:07.505003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3D14070>]}
[0m18:52:07.510739 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.16s]
[0m18:52:07.511734 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:52:07.514065 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:52:07.515065 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:52:07.516063 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m18:52:07.518069 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:52:07.520069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:52:07.521067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:52:07.523066 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:52:07.524069 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:52:07.531068 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.539419 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:52:07.542406 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:52:07.526063 => 18:52:07.541416
[0m18:52:07.543408 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:52:07.544909 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:52:07.532082 => 18:52:07.544909
[0m18:52:07.576452 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.577451 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:52:07.583447 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:52:07.584447 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.586450 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:52:07.586450 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:52:07.587452 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:52:07.588467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:07.589485 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:52:07.636031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:07.636031 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.640041 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units


)

select distinct manufactured_units.month_name,product_type,monthly_manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m18:52:07.646968 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:52:07.646968 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:52:07.646968 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.646968 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:52:07.655978 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m18:52:07.657409 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select year_week,product_type,manufactured_units,plan as production_plan
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m18:52:07.657409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:52:07.657409 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:52:07.657409 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "plan" does not exist
LINE 15: select year_week,product_type,manufactured_units,plan as pro...
                                                          ^
HINT:  Perhaps you meant to reference the column "production_plan.pn".

[0m18:52:07.657409 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.657409 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: ROLLBACK
[0m18:52:07.666457 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:52:07.666457 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:52:07.578446 => 18:52:07.666457
[0m18:52:07.666457 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:52:07.666457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:52:07.671970 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:52:07.671970 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m18:52:07.671970 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:52:07.680769 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:52:07.546437 => 18:52:07.680769
[0m18:52:07.680769 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:52:07.684197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3E30100>]}
[0m18:52:07.684197 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.16s]
[0m18:52:07.688236 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:52:07.691255 [debug] [Thread-2 (]: Database Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)
  column "plan" does not exist
  LINE 15: select year_week,product_type,manufactured_units,plan as pro...
                                                            ^
  HINT:  Perhaps you meant to reference the column "production_plan.pn".
  compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:52:07.692449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a3fbd89-6bfd-42d7-a86e-21b915a9d610', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3CF05B0>]}
[0m18:52:07.696546 [error] [Thread-2 (]: 7 of 7 ERROR creating sql view model public.obt_manufactured_units_perweek ..... [[31mERROR[0m in 0.17s]
[0m18:52:07.698895 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:52:07.700891 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:07.701892 [debug] [MainThread]: On master: BEGIN
[0m18:52:07.702895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:07.753272 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:52:07.754268 [debug] [MainThread]: On master: COMMIT
[0m18:52:07.755267 [debug] [MainThread]: Using postgres connection "master"
[0m18:52:07.756268 [debug] [MainThread]: On master: COMMIT
[0m18:52:07.757270 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:52:07.758270 [debug] [MainThread]: On master: Close
[0m18:52:07.760502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:07.761494 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:52:07.762492 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:52:07.763489 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m18:52:07.764490 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:52:07.765512 [info ] [MainThread]: 
[0m18:52:07.766489 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m18:52:07.772087 [debug] [MainThread]: Command end result
[0m18:52:07.790094 [info ] [MainThread]: 
[0m18:52:07.793095 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:52:07.795090 [info ] [MainThread]: 
[0m18:52:07.797094 [error] [MainThread]: [33mDatabase Error in model obt_manufactured_units_perweek (models\Analystics-OBT\obt_manufactured_units_perweek.sql)[0m
[0m18:52:07.800093 [error] [MainThread]:   column "plan" does not exist
[0m18:52:07.801091 [error] [MainThread]:   LINE 15: select year_week,product_type,manufactured_units,plan as pro...
[0m18:52:07.803091 [error] [MainThread]:                                                             ^
[0m18:52:07.806096 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "production_plan.pn".
[0m18:52:07.809111 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m18:52:07.811112 [info ] [MainThread]: 
[0m18:52:07.813093 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:52:07.816175 [debug] [MainThread]: Command `dbt run` failed at 18:52:07.816175 after 1.62 seconds
[0m18:52:07.817176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C13F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3876500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C3CF23E0>]}
[0m18:52:07.818176 [debug] [MainThread]: Flushing usage events
[0m18:54:03.448431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019959BF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995BF5BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995BF5BE50>]}


============================== 18:54:03.453429 | a5460830-fdf3-4b2e-9d9c-a0ef419be6a2 ==============================
[0m18:54:03.453429 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:54:03.455432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:54:03.604749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995BF5BF10>]}
[0m18:54:03.673851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C064B20>]}
[0m18:54:03.729962 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:54:03.937888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:03.938891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:03.950887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C4158A0>]}
[0m18:54:03.966839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C1F2920>]}
[0m18:54:03.968336 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:54:03.971542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C1F2980>]}
[0m18:54:03.975158 [info ] [MainThread]: 
[0m18:54:03.977660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:54:03.984358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:54:04.000314 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:54:04.001302 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:54:04.002310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:04.070572 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:54:04.072103 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:54:04.076371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:54:04.083514 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:54:04.084489 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:54:04.084489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:04.136416 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.137413 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:54:04.138414 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:54:04.149107 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:54:04.151109 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:54:04.151109 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:54:04.161680 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:04.162706 [debug] [MainThread]: On master: BEGIN
[0m18:54:04.163711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:04.213994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.213994 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:04.214994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:54:04.230518 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:54:04.230518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C455D50>]}
[0m18:54:04.230518 [debug] [MainThread]: On master: ROLLBACK
[0m18:54:04.230518 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:04.230518 [debug] [MainThread]: On master: BEGIN
[0m18:54:04.243798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.244310 [debug] [MainThread]: On master: COMMIT
[0m18:54:04.246323 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:04.247320 [debug] [MainThread]: On master: COMMIT
[0m18:54:04.248321 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:54:04.249325 [debug] [MainThread]: On master: Close
[0m18:54:04.250321 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:54:04.252320 [info ] [MainThread]: 
[0m18:54:04.267214 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:54:04.268215 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:54:04.269237 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m18:54:04.272746 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:54:04.270217 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:54:04.273747 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:54:04.275744 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:54:04.283745 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:54:04.282750 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:54:04.290161 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:54:04.293151 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:54:04.279743 => 18:54:04.292149
[0m18:54:04.300150 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:54:04.321986 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:54:04.284746 => 18:54:04.320984
[0m18:54:04.367839 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:54:04.381357 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:54:04.394788 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:54:04.397114 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:54:04.397114 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:54:04.397114 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:54:04.397114 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:54:04.413354 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:54:04.414360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:04.477474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.478491 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:54:04.479491 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m18:54:04.488489 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:54:04.497584 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:54:04.498585 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:54:04.499590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.501589 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:54:04.501589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.502768 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m18:54:04.506801 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:54:04.507785 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:54:04.510801 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.528815 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:54:04.528815 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:54:04.546285 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:54:04.546814 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:54:04.547540 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:54:04.548743 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:54:04.550568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.554570 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:54:04.554570 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:04.555814 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:54:04.563803 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:54:04.564787 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:54:04.565795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.570794 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:54:04.572314 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:54:04.573329 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:54:04.576335 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:54:04.386648 => 18:54:04.576335
[0m18:54:04.578801 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:54:04.579799 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:54:04.582799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C439120>]}
[0m18:54:04.583803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:04.585800 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.31s]
[0m18:54:04.594275 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:54:04.596289 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:54:04.598330 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:54:04.599307 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m18:54:04.601288 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:54:04.603289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m18:54:04.605287 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:54:04.605287 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:54:04.610593 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:54:04.614969 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:54:04.301157 => 18:54:04.613969
[0m18:54:04.615969 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:54:04.617973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C4BDF90>]}
[0m18:54:04.621972 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:54:04.606290 => 18:54:04.620975
[0m18:54:04.619971 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.35s]
[0m18:54:04.628008 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:54:04.623972 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m18:54:04.629975 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:54:04.654677 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:54:04.655679 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:54:04.658694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m18:54:04.659693 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:54:04.667028 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:54:04.669097 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:54:04.670445 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:54:04.660973 => 18:54:04.669097
[0m18:54:04.671856 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:54:04.673404 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:54:04.675422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:04.689877 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:54:04.695751 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:54:04.697749 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:54:04.699750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:04.760674 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.762078 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:54:04.762078 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m18:54:04.768421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.768421 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:54:04.772454 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m18:54:04.779314 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:54:04.784319 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:54:04.785319 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:54:04.787318 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.794312 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:54:04.795123 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:54:04.796522 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:54:04.798816 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:54:04.798816 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:54:04.798816 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.805889 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:54:04.805889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.805889 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:54:04.812909 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:54:04.813909 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:54:04.814857 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:54:04.817119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:04.818136 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:04.822128 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:54:04.828588 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:54:04.829594 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:54:04.830565 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:54:04.831563 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:54:04.835012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:04.840033 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:54:04.840033 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:54:04.841007 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:54:04.844715 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:54:04.630977 => 18:54:04.844715
[0m18:54:04.846954 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m18:54:04.846954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C54AD70>]}
[0m18:54:04.846954 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.24s]
[0m18:54:04.852366 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:54:04.854240 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m18:54:04.859720 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:54:04.675422 => 18:54:04.858492
[0m18:54:04.863999 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m18:54:04.865997 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:54:04.867995 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m18:54:04.870997 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m18:54:04.872512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C559120>]}
[0m18:54:04.873529 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m18:54:04.882639 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m18:54:04.874627 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.21s]
[0m18:54:04.885639 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:54:04.886638 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 18:54:04.875639 => 18:54:04.886638
[0m18:54:04.888639 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m18:54:04.900643 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m18:54:04.903639 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:54:04.905895 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m18:54:04.908061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:04.966488 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:04.967469 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:54:04.968469 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m18:54:04.991221 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m18:54:04.997623 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:54:04.998623 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m18:54:05.000611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:05.006616 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:54:05.008619 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m18:54:05.010616 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:05.016357 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:54:05.021771 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:54:05.022769 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m18:54:05.027792 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:05.028847 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m18:54:05.028847 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m18:54:05.028847 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:54:05.028847 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 18:54:04.889642 => 18:54:05.028847
[0m18:54:05.028847 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m18:54:05.046055 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C49D1E0>]}
[0m18:54:05.047034 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.17s]
[0m18:54:05.049835 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m18:54:05.053190 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m18:54:05.054189 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m18:54:05.056185 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m18:54:05.062331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m18:54:05.064323 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m18:54:05.058212 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m18:54:05.073251 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.083912 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 18:54:05.067720 => 18:54:05.082905
[0m18:54:05.085414 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m18:54:05.075271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m18:54:05.125669 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.128790 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m18:54:05.138813 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.139812 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.140814 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m18:54:05.142274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:05.144670 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 18:54:05.131818 => 18:54:05.143289
[0m18:54:05.147692 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m18:54:05.155996 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.163537 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.163537 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m18:54:05.168402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:54:05.214792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:05.216357 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.217796 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units


)

select distinct manufactured_units.month_name,product_type,monthly_manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m18:54:05.229291 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:54:05.229291 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.229291 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m18:54:05.239036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:05.239036 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:54:05.239036 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:05.244102 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.244593 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.247536 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m18:54:05.247536 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select year_week,product_type,manufactured_units,pn as production_plan
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m18:54:05.251580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:05.251580 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m18:54:05.251580 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m18:54:05.251580 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:54:05.262718 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 18:54:05.086430 => 18:54:05.262718
[0m18:54:05.262718 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:54:05.262718 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m18:54:05.262718 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.262718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C587E50>]}
[0m18:54:05.262718 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m18:54:05.277014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:05.282240 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:54:05.274077 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.20s]
[0m18:54:05.285234 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.287231 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m18:54:05.288232 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m18:54:05.291228 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:05.297371 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m18:54:05.299372 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m18:54:05.301525 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:54:05.303540 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 18:54:05.148972 => 18:54:05.303540
[0m18:54:05.304541 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m18:54:05.306541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5460830-fdf3-4b2e-9d9c-a0ef419be6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C477160>]}
[0m18:54:05.307539 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.23s]
[0m18:54:05.310681 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m18:54:05.316777 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.317785 [debug] [MainThread]: On master: BEGIN
[0m18:54:05.318780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:05.382866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:05.383864 [debug] [MainThread]: On master: COMMIT
[0m18:54:05.383864 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:05.384865 [debug] [MainThread]: On master: COMMIT
[0m18:54:05.385864 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:54:05.387055 [debug] [MainThread]: On master: Close
[0m18:54:05.388070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:05.390067 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:54:05.391067 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:54:05.391067 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m18:54:05.392068 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m18:54:05.394068 [info ] [MainThread]: 
[0m18:54:05.396660 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m18:54:05.400675 [debug] [MainThread]: Command end result
[0m18:54:05.411311 [info ] [MainThread]: 
[0m18:54:05.413312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:05.415309 [info ] [MainThread]: 
[0m18:54:05.418309 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:54:05.420315 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:05.420315 after 2.00 seconds
[0m18:54:05.422313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019959BF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995C5894B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001995A120940>]}
[0m18:54:05.424312 [debug] [MainThread]: Flushing usage events
[0m19:24:18.004703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619A8F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC57FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC57E50>]}


============================== 19:24:18.020425 | eba8dd9e-c184-4b08-9c58-bae4c077ef16 ==============================
[0m19:24:18.020425 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:24:18.027760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:24:18.150649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CC57F10>]}
[0m19:24:18.166398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619CD64B20>]}
[0m19:24:18.184160 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:24:18.293236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:18.293236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:18.308869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D1158A0>]}
[0m19:24:18.329827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D0F2890>]}
[0m19:24:18.329827 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:24:18.335903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D0F2A40>]}
[0m19:24:18.339055 [info ] [MainThread]: 
[0m19:24:18.344173 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:18.344173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:24:18.368631 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:24:18.370926 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:24:18.370926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:18.464715 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:24:18.466232 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:24:18.466232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:24:18.482020 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:24:18.482020 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:24:18.487398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:18.547776 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:18.547776 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:24:18.547776 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:24:18.577299 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:24:18.578366 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:24:18.578366 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:24:18.595144 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:18.595144 [debug] [MainThread]: On master: BEGIN
[0m19:24:18.595144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:18.657403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:18.657403 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:18.657403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:18.672444 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m19:24:18.688096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D145D50>]}
[0m19:24:18.688096 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:18.688096 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:18.688096 [debug] [MainThread]: On master: BEGIN
[0m19:24:18.688096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:18.688096 [debug] [MainThread]: On master: COMMIT
[0m19:24:18.688096 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:18.688096 [debug] [MainThread]: On master: COMMIT
[0m19:24:18.688096 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:18.688096 [debug] [MainThread]: On master: Close
[0m19:24:18.704376 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:24:18.704376 [info ] [MainThread]: 
[0m19:24:18.736325 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:24:18.728323 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:24:18.736325 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:24:18.744325 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:24:18.745822 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:24:18.752334 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:24:18.736325 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m19:24:18.755144 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:24:18.755144 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:24:18.745822 => 19:24:18.755144
[0m19:24:18.760688 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:24:18.760688 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:24:18.765227 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:24:18.787559 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:24:18.765227 => 19:24:18.787559
[0m19:24:18.833427 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:24:18.841433 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:24:18.850622 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:24:18.857634 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:18.857634 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:18.857634 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:24:18.857634 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:24:18.862303 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:24:18.862303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:18.936462 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:18.936462 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:18.936462 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m19:24:18.946085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:18.946085 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:18.946085 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m19:24:18.965614 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:24:18.977125 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:18.977125 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:24:18.977125 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:24:18.987284 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:18.992807 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:24:18.992807 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:18.995191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:18.995191 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:19.010521 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:19.010521 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:24:19.010521 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:24:19.010521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.010521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.065752 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:24:19.072275 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:24:19.072275 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:19.072275 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:19.078271 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:24:19.078271 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:24:19.083001 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:19.083001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:19.088018 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:19.103676 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:19.103676 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:24:19.103676 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:24:19.119336 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:19.121358 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:24:18.769460 => 19:24:19.121358
[0m19:24:19.121358 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:19.121358 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:24:19.121358 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:24:18.841433 => 19:24:19.121358
[0m19:24:19.136507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D211150>]}
[0m19:24:19.136507 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:24:19.136507 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.40s]
[0m19:24:19.144000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D213F70>]}
[0m19:24:19.147612 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:24:19.147612 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.39s]
[0m19:24:19.155667 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:24:19.163183 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:24:19.165829 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:24:19.167640 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:24:19.171660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m19:24:19.175292 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:24:19.178030 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:24:19.180048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m19:24:19.188109 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:24:19.188109 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:24:19.196138 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:24:19.196138 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:24:19.180048 => 19:24:19.196138
[0m19:24:19.204147 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:24:19.204147 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:24:19.188109 => 19:24:19.204147
[0m19:24:19.220527 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:24:19.220527 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:24:19.237116 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:24:19.237116 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:19.237116 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:24:19.245039 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:19.246970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:19.246970 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:24:19.246970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:19.302925 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:19.302925 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:19.308937 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m19:24:19.324622 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:24:19.340921 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:19.340921 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:24:19.351511 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.356039 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:19.356039 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:24:19.365559 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.372085 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:24:19.372085 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:19.372085 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:24:19.372085 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:19.387735 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:19.387735 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:24:19.403363 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:19.403363 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:24:19.204147 => 19:24:19.403363
[0m19:24:19.414674 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:24:19.416459 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D1F9270>]}
[0m19:24:19.420124 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.24s]
[0m19:24:19.420124 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:24:19.426992 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m19:24:19.426992 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:24:19.426992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:24:19.426992 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:24:19.435459 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:24:19.443478 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:24:19.433442 => 19:24:19.440462
[0m19:24:19.443478 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m19:24:19.465892 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:24:19.475931 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:19.478923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:19.478923 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:24:19.480490 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:19.481996 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:19.484385 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m19:24:19.508630 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:24:19.508630 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:19.516653 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:24:19.519085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.519085 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:19.519085 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:24:19.529413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.534904 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:24:19.536271 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:19.536271 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:24:19.538286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:19.538286 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:19.538286 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:24:19.552961 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:19.552961 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:24:19.227494 => 19:24:19.552961
[0m19:24:19.552961 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:24:19.552961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D176BF0>]}
[0m19:24:19.564694 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.37s]
[0m19:24:19.567925 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:24:19.590096 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:19.597116 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:19.598684 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m19:24:19.621662 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m19:24:19.629699 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:19.629699 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:24:19.629699 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.637795 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:19.645816 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:24:19.645816 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.645816 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:24:19.653813 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:19.653813 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:24:19.653813 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:19.661846 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:19.661846 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:24:19.685833 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:19.685833 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:24:19.447026 => 19:24:19.685833
[0m19:24:19.693845 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m19:24:19.693845 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D114B80>]}
[0m19:24:19.693845 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.27s]
[0m19:24:19.701844 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m19:24:19.704882 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m19:24:19.707618 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m19:24:19.710135 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m19:24:19.710135 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m19:24:19.715498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m19:24:19.715498 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m19:24:19.718512 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m19:24:19.718512 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m19:24:19.759198 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.759198 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 19:24:19.718512 => 19:24:19.759198
[0m19:24:19.759198 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m19:24:19.731929 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:19.815227 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.815227 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 19:24:19.726538 => 19:24:19.815227
[0m19:24:19.836417 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m19:24:19.846942 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.852929 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:19.852929 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m19:24:19.852929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:19.858398 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:19.860036 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m19:24:19.860036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:19.926128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:19.926128 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:19.926128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:19.926128 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select year_week,product_type,manufactured_units,plan as production_plan
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m19:24:19.926128 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.926128 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units


)

select distinct manufactured_units.month_name,product_type,monthly_manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m19:24:19.958290 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:19.958290 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:19.966834 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.969556 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:19.969556 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m19:24:19.969556 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m19:24:19.984359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.985608 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:19.986518 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m19:24:19.998542 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m19:24:19.998542 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.998542 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:19.998542 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m19:24:19.998542 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m19:24:19.998542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:20.014199 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:24:19.998542 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:20.014199 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m19:24:20.030488 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:24:20.036132 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:20.037298 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m19:24:20.037298 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 19:24:19.759198 => 19:24:20.037298
[0m19:24:20.045817 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:20.046966 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m19:24:20.053132 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 19:24:19.836417 => 19:24:20.046966
[0m19:24:20.053132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D2A7D90>]}
[0m19:24:20.053132 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m19:24:20.060380 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.34s]
[0m19:24:20.061897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba8dd9e-c184-4b08-9c58-bae4c077ef16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D0F0E20>]}
[0m19:24:20.066845 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m19:24:20.077695 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.35s]
[0m19:24:20.080482 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m19:24:20.080482 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:20.080482 [debug] [MainThread]: On master: BEGIN
[0m19:24:20.087002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:20.160239 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:20.160239 [debug] [MainThread]: On master: COMMIT
[0m19:24:20.160239 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:20.160239 [debug] [MainThread]: On master: COMMIT
[0m19:24:20.160239 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:20.166758 [debug] [MainThread]: On master: Close
[0m19:24:20.168279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:20.168279 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:24:20.174887 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:24:20.177025 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m19:24:20.177025 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m19:24:20.184506 [info ] [MainThread]: 
[0m19:24:20.187716 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m19:24:20.192819 [debug] [MainThread]: Command end result
[0m19:24:20.209041 [info ] [MainThread]: 
[0m19:24:20.217164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:20.217164 [info ] [MainThread]: 
[0m19:24:20.217164 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:24:20.226396 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:20.226396 after 2.25 seconds
[0m19:24:20.226396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619A8F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D2A7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619D254220>]}
[0m19:24:20.226396 [debug] [MainThread]: Flushing usage events
[0m19:27:33.172238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D61F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D855BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D855BE80>]}


============================== 19:27:33.172238 | e2317652-82a3-4973-bfa3-24492f3f624b ==============================
[0m19:27:33.172238 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:27:33.188194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:27:33.325358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D855BEE0>]}
[0m19:27:33.341377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8664B50>]}
[0m19:27:33.360980 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:27:33.563258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:33.563258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:33.579280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8A158D0>]}
[0m19:27:33.594552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D87F28C0>]}
[0m19:27:33.594552 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:27:33.615176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D87F2A70>]}
[0m19:27:33.621783 [info ] [MainThread]: 
[0m19:27:33.627659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:33.639486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:27:33.684139 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:27:33.684139 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:27:33.684139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:33.777389 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:27:33.777389 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:27:33.786236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:27:33.791401 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:27:33.791401 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:27:33.791401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:33.860900 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:33.860900 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:27:33.860900 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:27:33.876752 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:27:33.876752 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:27:33.876752 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:27:33.894129 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:33.894129 [debug] [MainThread]: On master: BEGIN
[0m19:27:33.894129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:33.956694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:33.956694 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:33.960572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:33.987762 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m19:27:33.987762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8A55D80>]}
[0m19:27:33.987762 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:34.003426 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:34.003426 [debug] [MainThread]: On master: BEGIN
[0m19:27:34.003426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:34.007123 [debug] [MainThread]: On master: COMMIT
[0m19:27:34.008421 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:34.008421 [debug] [MainThread]: On master: COMMIT
[0m19:27:34.010613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:34.012243 [debug] [MainThread]: On master: Close
[0m19:27:34.013595 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:27:34.020858 [info ] [MainThread]: 
[0m19:27:34.040930 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:27:34.042460 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:27:34.042460 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m19:27:34.042460 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:27:34.048976 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:27:34.052773 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:27:34.052773 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:27:34.055540 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:27:34.061969 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:27:34.065535 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:27:34.074381 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:27:34.061969 => 19:27:34.073065
[0m19:27:34.074381 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:27:34.055540 => 19:27:34.074381
[0m19:27:34.074381 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:27:34.077341 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:27:34.171360 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:27:34.181869 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:27:34.187406 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:27:34.187406 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:27:34.187406 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:27:34.187406 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:34.193523 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:27:34.196645 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:27:34.276261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:34.277198 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:27:34.279035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:34.279035 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m19:27:34.280743 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:27:34.282755 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m19:27:34.294293 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:27:34.304229 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:27:34.308748 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:27:34.308748 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:27:34.314391 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:27:34.318222 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:27:34.318222 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.318222 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:27:34.318222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.327388 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:27:34.331886 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:27:34.331886 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:27:34.331886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.346230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.378097 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:27:34.378097 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:27:34.378097 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:27:34.378097 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:27:34.378097 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:27:34.378097 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:27:34.394657 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:34.394657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:34.399295 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:27:34.410653 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:27:34.410653 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:27:34.417271 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:27:34.423020 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:34.427382 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:27:34.079121 => 19:27:34.425930
[0m19:27:34.427382 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:34.427382 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:27:34.431442 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:27:34.139040 => 19:27:34.431442
[0m19:27:34.433841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D86CCB50>]}
[0m19:27:34.433841 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:27:34.433841 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.38s]
[0m19:27:34.439472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8B07FD0>]}
[0m19:27:34.445119 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.39s]
[0m19:27:34.442877 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:27:34.449019 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:27:34.453991 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:27:34.454959 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:27:34.482961 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:27:34.499288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m19:27:34.500542 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:27:34.510244 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:27:34.514879 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:27:34.505054 => 19:27:34.514879
[0m19:27:34.515893 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:27:34.572841 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:27:34.491092 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:27:34.580829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m19:27:34.582688 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:27:34.583975 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:27:34.594959 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:27:34.589141 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:27:34.598606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:34.607595 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:27:34.583975 => 19:27:34.607595
[0m19:27:34.614692 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:27:34.627333 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:27:34.630695 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:27:34.631744 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:27:34.633614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:34.731375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:34.731375 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:27:34.734894 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m19:27:34.752748 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:27:34.752748 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:27:34.752748 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:27:34.764353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.768475 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:27:34.772608 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:27:34.774248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.780305 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:27:34.780305 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:27:34.782824 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:27:34.782824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:34.782824 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:27:34.794016 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:27:34.801864 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:34.808256 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:27:34.614692 => 19:27:34.801864
[0m19:27:34.809355 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:27:34.810826 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:34.811339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8B62B60>]}
[0m19:27:34.814217 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:27:34.815936 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m19:27:34.815936 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.23s]
[0m19:27:34.819933 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:27:34.833366 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:27:34.842118 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:27:34.843630 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:27:34.843630 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.848145 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:27:34.848145 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:27:34.856773 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:34.856773 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:27:34.864287 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:27:34.864287 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:27:34.864287 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:34.872310 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:27:34.879134 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:27:34.885012 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:34.893155 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:27:34.515893 => 19:27:34.893155
[0m19:27:34.894311 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:27:34.897367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8B80DC0>]}
[0m19:27:34.899568 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.40s]
[0m19:27:34.936466 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:27:34.937982 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m19:27:34.939973 [info ] [Thread-1 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:27:34.942431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.dim_production_plan)
[0m19:27:34.943951 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:27:34.952215 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:27:34.955469 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:27:34.946472 => 19:27:34.955469
[0m19:27:34.955469 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m19:27:34.966695 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:27:34.972933 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:27:34.979459 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:27:34.982480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:35.063805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:35.063805 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:27:35.063805 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m19:27:35.085518 [debug] [Thread-1 (]: SQL status: SELECT 126 in 0.0 seconds
[0m19:27:35.085518 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:27:35.094084 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:27:35.094084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:35.100606 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:27:35.100606 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:27:35.100606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:35.107531 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:27:35.107531 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:27:35.110790 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:27:35.114915 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:35.120383 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:27:35.120383 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:27:35.129035 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:35.133539 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:27:34.955469 => 19:27:35.133539
[0m19:27:35.134942 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m19:27:35.134942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8B53220>]}
[0m19:27:35.138563 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.19s]
[0m19:27:35.141522 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m19:27:35.146394 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m19:27:35.150608 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m19:27:35.153165 [info ] [Thread-2 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m19:27:35.153867 [info ] [Thread-1 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m19:27:35.162184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m19:27:35.162184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m19:27:35.170178 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m19:27:35.168088 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m19:27:35.177703 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.188429 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.192478 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 19:27:35.170178 => 19:27:35.189120
[0m19:27:35.193863 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m19:27:35.206459 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 19:27:35.179724 => 19:27:35.205934
[0m19:27:35.234269 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.234269 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m19:27:35.250315 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.250315 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.250315 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m19:27:35.258335 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.278593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:27:35.278593 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m19:27:35.290831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:35.353446 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:35.353446 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.353446 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units


)

select distinct manufactured_units.month_name,product_type,monthly_manufactured_units,monthy_production_planned
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m19:27:35.368716 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:35.368716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:35.368716 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.368716 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.368716 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m19:27:35.368716 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select year_week,product_type,manufactured_units,plan as production_plan
from manufactured_units
join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m19:27:35.382380 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:35.387096 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m19:27:35.388260 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.390404 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m19:27:35.393388 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:35.395604 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:27:35.395604 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:35.395604 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m19:27:35.400123 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.400123 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:35.407846 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m19:27:35.407846 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 19:27:35.243797 => 19:27:35.407846
[0m19:27:35.407846 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m19:27:35.407846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:35.417705 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m19:27:35.417705 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D87F7190>]}
[0m19:27:35.417705 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.417705 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m19:27:35.417705 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.26s]
[0m19:27:35.427449 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m19:27:35.427449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:35.437998 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:27:35.437998 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m19:27:35.443529 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:35.449549 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 19:27:35.196258 => 19:27:35.449549
[0m19:27:35.451983 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m19:27:35.452660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2317652-82a3-4973-bfa3-24492f3f624b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8BAB9A0>]}
[0m19:27:35.452660 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.29s]
[0m19:27:35.460146 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m19:27:35.466162 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:35.466162 [debug] [MainThread]: On master: BEGIN
[0m19:27:35.466162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:35.550715 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:35.550715 [debug] [MainThread]: On master: COMMIT
[0m19:27:35.550715 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:35.550715 [debug] [MainThread]: On master: COMMIT
[0m19:27:35.558731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:35.559877 [debug] [MainThread]: On master: Close
[0m19:27:35.560492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:35.560492 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:27:35.560492 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:27:35.560492 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m19:27:35.560492 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m19:27:35.567148 [info ] [MainThread]: 
[0m19:27:35.571178 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m19:27:35.594920 [debug] [MainThread]: Command end result
[0m19:27:35.616660 [info ] [MainThread]: 
[0m19:27:35.624675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:35.637056 [info ] [MainThread]: 
[0m19:27:35.639455 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:27:35.643672 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:35.643672 after 2.51 seconds
[0m19:27:35.643672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D61F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D8664B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244D87F28F0>]}
[0m19:27:35.649953 [debug] [MainThread]: Flushing usage events
[0m19:36:19.653251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACA3F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC857F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC857E20>]}


============================== 19:36:19.675771 | 5be584f1-d8d0-4ac6-b18a-30a9bc80eb04 ==============================
[0m19:36:19.675771 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:36:19.687864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:36:20.055863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC857EE0>]}
[0m19:36:20.143048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC967400>]}
[0m19:36:20.218538 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:36:20.693776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:36:20.695783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:36:20.743644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCD15870>]}
[0m19:36:20.788820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCCF28F0>]}
[0m19:36:20.792291 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:36:20.798254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCCF2950>]}
[0m19:36:20.804271 [info ] [MainThread]: 
[0m19:36:20.850850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:20.886446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:36:20.942401 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:36:20.946968 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:36:20.948504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:21.071299 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:36:21.077411 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:36:21.100714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:36:21.128268 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:36:21.132303 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:36:21.134300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:21.207345 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:36:21.209554 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:36:21.212561 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:36:21.232641 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:36:21.239324 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:36:21.242355 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:36:21.270314 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:21.274309 [debug] [MainThread]: On master: BEGIN
[0m19:36:21.275420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:21.351145 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:21.353145 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:21.356152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:21.404943 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m19:36:21.417158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCD59D20>]}
[0m19:36:21.419384 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:21.423416 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:21.425402 [debug] [MainThread]: On master: BEGIN
[0m19:36:21.427403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:21.428433 [debug] [MainThread]: On master: COMMIT
[0m19:36:21.431478 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:21.434481 [debug] [MainThread]: On master: COMMIT
[0m19:36:21.438036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:21.441052 [debug] [MainThread]: On master: Close
[0m19:36:21.446292 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:36:21.459861 [info ] [MainThread]: 
[0m19:36:21.500570 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:36:21.502573 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:36:21.505569 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m19:36:21.512141 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:36:21.510135 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:36:21.515140 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:36:21.519202 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:36:21.527240 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:36:21.530186 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:36:21.543310 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:36:21.546319 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:36:21.534187 => 19:36:21.546319
[0m19:36:21.549882 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:36:21.553883 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:36:21.521563 => 19:36:21.552878
[0m19:36:21.631933 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:36:21.859504 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:36:21.863047 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:36:21.870590 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:36:21.873588 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:36:21.875590 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:36:21.879462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:21.882466 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:36:21.886985 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:36:22.008446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:22.011769 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:36:22.013175 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:22.017203 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m19:36:22.020773 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:36:22.024766 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m19:36:22.038278 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:36:22.053116 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:36:22.063338 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:36:22.077369 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:36:22.078913 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:36:22.080936 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:36:22.086153 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.088696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.102919 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:36:22.115202 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:36:22.117749 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:36:22.119826 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:36:22.124287 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.161989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.276966 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:36:22.283044 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:36:22.286336 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:36:22.291895 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:36:22.288878 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:36:22.297187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:22.299202 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:36:22.320924 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:36:22.325123 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:36:22.326137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:22.342037 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:36:22.343055 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:22.345061 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:36:22.354623 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:36:21.554882 => 19:36:22.353619
[0m19:36:22.359188 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:36:22.361700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC97AEC0>]}
[0m19:36:22.365714 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:22.371986 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:36:21.693303 => 19:36:22.370987
[0m19:36:22.364722 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.84s]
[0m19:36:22.375121 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:36:22.378694 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:36:22.382718 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:36:22.381716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCE1F940>]}
[0m19:36:22.386053 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:36:22.389428 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.87s]
[0m19:36:22.392790 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m19:36:22.396071 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:36:22.397583 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:36:22.398996 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:36:22.412966 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:36:22.415965 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:36:22.421535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m19:36:22.424534 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:36:22.425873 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:36:22.402023 => 19:36:22.424534
[0m19:36:22.442627 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:36:22.445691 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:36:22.453769 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:36:22.427471 => 19:36:22.452230
[0m19:36:22.481191 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:36:22.483195 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:36:22.498716 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:36:22.502741 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:36:22.505745 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:36:22.509531 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:36:22.518129 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:36:22.522143 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:36:22.525131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:22.604231 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:22.606237 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:36:22.607738 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m19:36:22.637799 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:36:22.649484 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:36:22.652765 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:36:22.655055 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.671638 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:36:22.673638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:22.675628 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:36:22.677214 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:36:22.679364 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m19:36:22.681388 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.690955 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:36:22.693228 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:36:22.694752 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:36:22.698301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:22.710907 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:36:22.712903 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:36:22.715904 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:36:22.729054 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:36:22.734083 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:36:22.737600 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:22.739632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.747374 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:36:22.455772 => 19:36:22.745693
[0m19:36:22.768180 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:36:22.770214 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:36:22.774213 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:36:22.777778 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCE7A260>]}
[0m19:36:22.780802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:22.783885 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.39s]
[0m19:36:22.795195 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:36:22.797718 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:36:22.800453 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:36:22.803508 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m19:36:22.807110 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:36:22.810334 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:36:22.817856 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:36:22.819909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:22.821912 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:36:22.834106 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:36:22.845891 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:36:22.848696 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:36:22.855887 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:36:22.837135 => 19:36:22.853867
[0m19:36:22.859433 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m19:36:22.861432 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:22.881783 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:36:22.888330 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:36:22.486194 => 19:36:22.887420
[0m19:36:22.893107 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:36:22.896132 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:36:22.899137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCDF7AF0>]}
[0m19:36:22.901156 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:36:22.904178 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.48s]
[0m19:36:22.907168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:36:22.909718 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:36:22.982009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:22.984140 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:36:22.987693 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m19:36:23.009561 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m19:36:23.022199 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:36:23.025342 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:36:23.027867 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:23.041791 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:36:23.044740 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:36:23.049358 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:23.063456 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:36:23.065459 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:36:23.069019 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:36:23.074042 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:23.087210 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:36:23.091588 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:36:23.101554 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:23.110219 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:36:22.862940 => 19:36:23.109156
[0m19:36:23.111345 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m19:36:23.117376 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCE78D30>]}
[0m19:36:23.120937 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.30s]
[0m19:36:23.125344 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m19:36:23.129935 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m19:36:23.131943 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m19:36:23.134939 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m19:36:23.139173 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m19:36:23.144431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m19:36:23.147966 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m19:36:23.150962 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m19:36:23.152956 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m19:36:23.167573 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.179165 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.186960 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 19:36:23.153962 => 19:36:23.185429
[0m19:36:23.191029 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 19:36:23.169610 => 19:36:23.188992
[0m19:36:23.192015 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m19:36:23.195021 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m19:36:23.290224 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.309782 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.318342 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.320358 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m19:36:23.323368 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.326108 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:36:23.327664 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m19:36:23.331726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:23.431315 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:23.434320 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.437321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:23.438876 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m19:36:23.441893 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.444894 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units


)

select distinct production_plan.month_name,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
  );
[0m19:36:23.459405 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:23.473051 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.474054 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:23.476224 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m19:36:23.490406 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.493744 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m19:36:23.494817 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:23.498229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:23.507043 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m19:36:23.513986 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m19:36:23.517500 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.520121 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.523544 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m19:36:23.526409 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m19:36:23.530721 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:23.538922 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m19:36:23.540947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:23.542948 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m19:36:23.550565 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m19:36:23.555579 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:23.558138 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m19:36:23.565503 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 19:36:23.291215 => 19:36:23.565503
[0m19:36:23.570093 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:23.573097 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m19:36:23.581668 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 19:36:23.197546 => 19:36:23.579670
[0m19:36:23.585666 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCD6DA50>]}
[0m19:36:23.588427 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m19:36:23.590449 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.44s]
[0m19:36:23.594878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be584f1-d8d0-4ac6-b18a-30a9bc80eb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACCD6D990>]}
[0m19:36:23.601422 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m19:36:23.603422 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.45s]
[0m19:36:23.609801 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m19:36:23.614225 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:23.615228 [debug] [MainThread]: On master: BEGIN
[0m19:36:23.617733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:23.700350 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:23.703360 [debug] [MainThread]: On master: COMMIT
[0m19:36:23.707359 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:23.708908 [debug] [MainThread]: On master: COMMIT
[0m19:36:23.711911 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:23.712919 [debug] [MainThread]: On master: Close
[0m19:36:23.715907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:23.717411 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:36:23.719433 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:36:23.720433 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m19:36:23.722438 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m19:36:23.725435 [info ] [MainThread]: 
[0m19:36:23.729994 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m19:36:23.740006 [debug] [MainThread]: Command end result
[0m19:36:23.767523 [info ] [MainThread]: 
[0m19:36:23.796345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:36:23.802407 [info ] [MainThread]: 
[0m19:36:23.808958 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:36:23.817643 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:23.817132 after 4.29 seconds
[0m19:36:23.819074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACA3F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC97AEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027ACC965060>]}
[0m19:36:23.822594 [debug] [MainThread]: Flushing usage events
[0m20:19:35.206678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05CEF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F25BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F25BE20>]}


============================== 20:19:35.212689 | a79c97d3-6fa0-4d97-b65f-16063f67256d ==============================
[0m20:19:35.212689 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:19:35.220705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:19:35.358766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F25BE80>]}
[0m20:19:35.375212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F365810>]}
[0m20:19:35.391222 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:19:35.533861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:35.542002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:35.550089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F715870>]}
[0m20:19:35.565607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F6F2860>]}
[0m20:19:35.565607 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m20:19:35.570438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F6F2A10>]}
[0m20:19:35.575458 [info ] [MainThread]: 
[0m20:19:35.582183 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:19:35.582183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m20:19:35.606471 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m20:19:35.606471 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m20:19:35.614447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:35.687705 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m20:19:35.687705 [debug] [ThreadPool]: On list_instagrid: Close
[0m20:19:35.699769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m20:19:35.703796 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m20:19:35.703796 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m20:19:35.703796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:35.779742 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:19:35.779742 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m20:19:35.779742 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m20:19:35.810927 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m20:19:35.824952 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m20:19:35.824952 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m20:19:35.841632 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:35.856651 [debug] [MainThread]: On master: BEGIN
[0m20:19:35.856651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:35.920215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:19:35.920215 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:35.920215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:19:35.953217 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m20:19:35.953217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F755D20>]}
[0m20:19:35.953217 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:35.953217 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:35.953217 [debug] [MainThread]: On master: BEGIN
[0m20:19:35.963665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:19:35.963665 [debug] [MainThread]: On master: COMMIT
[0m20:19:35.963665 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:35.965777 [debug] [MainThread]: On master: COMMIT
[0m20:19:35.965777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:19:35.968346 [debug] [MainThread]: On master: Close
[0m20:19:35.968346 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m20:19:35.968346 [info ] [MainThread]: 
[0m20:19:36.001007 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m20:19:36.001007 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m20:19:36.001007 [info ] [Thread-1 (]: 1 of 7 START sql table model public.dim_date ................................... [RUN]
[0m20:19:36.009919 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m20:19:36.009919 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m20:19:36.017443 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m20:19:36.022001 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 20:19:36.009919 => 20:19:36.022001
[0m20:19:36.022001 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m20:19:36.001007 [info ] [Thread-2 (]: 2 of 7 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m20:19:36.067774 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m20:19:36.129525 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m20:19:36.129525 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m20:19:36.142268 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m20:19:36.142268 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m20:19:36.142268 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m20:19:36.155834 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 20:19:36.129525 => 20:19:36.155834
[0m20:19:36.155834 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:19:36.155834 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m20:19:36.172356 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m20:19:36.186379 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m20:19:36.190630 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m20:19:36.192939 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:19:36.263925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:36.265075 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m20:19:36.265075 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m20:19:36.271982 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:36.271982 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m20:19:36.271982 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m20:19:36.287582 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m20:19:36.287582 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m20:19:36.296171 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m20:19:36.296171 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m20:19:36.296171 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m20:19:36.296171 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m20:19:36.296171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.296171 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.313081 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m20:19:36.313081 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m20:19:36.313081 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m20:19:36.313081 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m20:19:36.327447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.327447 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.358164 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m20:19:36.375181 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m20:19:36.375181 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m20:19:36.375181 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m20:19:36.375181 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m20:19:36.375181 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m20:19:36.395891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:36.405421 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:36.405421 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m20:19:36.423164 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m20:19:36.423164 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m20:19:36.423164 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m20:19:36.436923 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:36.442626 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 20:19:36.155834 => 20:19:36.442626
[0m20:19:36.442626 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:36.445967 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m20:19:36.446902 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 20:19:36.025519 => 20:19:36.446902
[0m20:19:36.455218 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F82A9E0>]}
[0m20:19:36.455918 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m20:19:36.455918 [info ] [Thread-2 (]: 2 of 7 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.39s]
[0m20:19:36.462748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F829450>]}
[0m20:19:36.467999 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m20:19:36.471661 [info ] [Thread-1 (]: 1 of 7 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.45s]
[0m20:19:36.471661 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m20:19:36.477958 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m20:19:36.479470 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m20:19:36.479470 [info ] [Thread-2 (]: 3 of 7 START sql table model public.sg_production_plan ......................... [RUN]
[0m20:19:36.483246 [info ] [Thread-1 (]: 4 of 7 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m20:19:36.487546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m20:19:36.490418 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m20:19:36.487546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m20:19:36.497922 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m20:19:36.504456 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m20:19:36.504456 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m20:19:36.513456 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 20:19:36.490418 => 20:19:36.513456
[0m20:19:36.513456 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 20:19:36.504456 => 20:19:36.513456
[0m20:19:36.526361 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m20:19:36.529376 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m20:19:36.547117 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m20:19:36.555474 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m20:19:36.555474 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m20:19:36.564042 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m20:19:36.564042 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m20:19:36.567145 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m20:19:36.567145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:36.571275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:36.673322 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:36.674336 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m20:19:36.676368 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m20:19:36.682968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:36.684295 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m20:19:36.686352 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m20:19:36.703122 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:19:36.706135 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m20:19:36.706135 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m20:19:36.706135 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m20:19:36.722518 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m20:19:36.722518 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.727008 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m20:19:36.733644 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m20:19:36.733644 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m20:19:36.733644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.743268 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m20:19:36.745353 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.745353 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m20:19:36.749644 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m20:19:36.753658 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m20:19:36.753658 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m20:19:36.753658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.759779 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m20:19:36.763334 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:36.764453 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m20:19:36.772933 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m20:19:36.774307 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m20:19:36.774307 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m20:19:36.777245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:36.784164 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m20:19:36.785814 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:36.787055 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m20:19:36.787055 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 20:19:36.529376 => 20:19:36.787055
[0m20:19:36.787055 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m20:19:36.794071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F6F1720>]}
[0m20:19:36.797494 [info ] [Thread-2 (]: 3 of 7 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.31s]
[0m20:19:36.800030 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m20:19:36.800030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:36.802539 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m20:19:36.802539 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 20:19:36.547117 => 20:19:36.802539
[0m20:19:36.807619 [info ] [Thread-2 (]: 5 of 7 START sql table model public.dim_production_plan ........................ [RUN]
[0m20:19:36.807619 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m20:19:36.810635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m20:19:36.813242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F37B970>]}
[0m20:19:36.814347 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m20:19:36.816040 [info ] [Thread-1 (]: 4 of 7 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.33s]
[0m20:19:36.824586 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m20:19:36.828021 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m20:19:36.828021 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 20:19:36.818006 => 20:19:36.828021
[0m20:19:36.828021 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m20:19:36.837145 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m20:19:36.843681 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m20:19:36.843681 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m20:19:36.847235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:36.943215 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:36.943215 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m20:19:36.943215 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m20:19:36.962580 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m20:19:36.962580 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m20:19:36.962580 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m20:19:36.972409 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.974931 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m20:19:36.981067 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m20:19:36.981067 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:36.981067 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m20:19:36.990588 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m20:19:36.990588 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m20:19:36.990588 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:36.990588 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m20:19:36.990588 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m20:19:37.006901 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:19:37.006901 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 20:19:36.832702 => 20:19:37.006901
[0m20:19:37.006901 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m20:19:37.006901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F858BB0>]}
[0m20:19:37.016533 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.20s]
[0m20:19:37.019447 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m20:19:37.023450 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m20:19:37.024877 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m20:19:37.024877 [info ] [Thread-1 (]: 6 of 7 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m20:19:37.030393 [info ] [Thread-2 (]: 7 of 7 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m20:19:37.030393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt_manufactured_units_permonth)
[0m20:19:37.035936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m20:19:37.038452 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m20:19:37.038452 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m20:19:37.042464 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.047903 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.055424 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 20:19:37.042464 => 20:19:37.055424
[0m20:19:37.055424 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m20:19:37.063449 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 20:19:37.038452 => 20:19:37.063449
[0m20:19:37.095791 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m20:19:37.095791 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.103760 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.103760 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.111753 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.113102 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m20:19:37.113102 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m20:19:37.115039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:37.115039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:37.179646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:37.179646 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m20:19:37.179646 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.179646 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.179646 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select distinct month_name,product_type,monthly_manufactured_units,monthy_production_planned,
sum(monthly_manufactured_units) over(partition by product_type order by date) as monthy_manufactured_runningtotal from cte
order by monthy_manufactured_runningtotal
  );
[0m20:19:37.179646 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m20:19:37.208230 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:19:37.208230 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:19:37.208230 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.223903 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.223903 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m20:19:37.223903 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m20:19:37.223903 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:37.223903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:19:37.242856 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m20:19:37.242856 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m20:19:37.255378 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.256674 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.259970 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m20:19:37.260950 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m20:19:37.260950 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:37.260950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:19:37.271478 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m20:19:37.281366 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m20:19:37.288885 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m20:19:37.288885 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m20:19:37.288885 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:19:37.299572 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:19:37.296902 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 20:19:37.055424 => 20:19:37.296902
[0m20:19:37.300152 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 20:19:37.095791 => 20:19:37.300152
[0m20:19:37.305176 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m20:19:37.305176 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m20:19:37.306955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F6F6F20>]}
[0m20:19:37.306955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79c97d3-6fa0-4d97-b65f-16063f67256d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F7DEA40>]}
[0m20:19:37.311561 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.27s]
[0m20:19:37.313289 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.28s]
[0m20:19:37.316111 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m20:19:37.316111 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m20:19:37.321849 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:37.323053 [debug] [MainThread]: On master: BEGIN
[0m20:19:37.323053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:37.403090 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:19:37.403090 [debug] [MainThread]: On master: COMMIT
[0m20:19:37.403090 [debug] [MainThread]: Using postgres connection "master"
[0m20:19:37.411078 [debug] [MainThread]: On master: COMMIT
[0m20:19:37.411078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:19:37.413662 [debug] [MainThread]: On master: Close
[0m20:19:37.414983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:37.416776 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m20:19:37.416776 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m20:19:37.418143 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m20:19:37.419163 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m20:19:37.421596 [info ] [MainThread]: 
[0m20:19:37.423603 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m20:19:37.427325 [debug] [MainThread]: Command end result
[0m20:19:37.435617 [info ] [MainThread]: 
[0m20:19:37.443139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:37.443139 [info ] [MainThread]: 
[0m20:19:37.451306 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:19:37.467405 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:37.467405 after 2.30 seconds
[0m20:19:37.467405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05CEF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F365810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05F6F2890>]}
[0m20:19:37.467405 [debug] [MainThread]: Flushing usage events
[0m11:12:07.991851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DA704A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCB57FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCB57E80>]}


============================== 11:12:08.014553 | fc3e1560-fcd5-4f19-ab26-1b4897b5fd21 ==============================
[0m11:12:08.014553 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:12:08.016560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:12:08.229281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCB57EE0>]}
[0m11:12:08.244316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCC61D50>]}
[0m11:12:08.259263 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:12:08.347903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:08.348891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:08.371642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD026290>]}
[0m11:12:08.382650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCDFB280>]}
[0m11:12:08.383656 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:12:08.385651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCDFB430>]}
[0m11:12:08.390762 [info ] [MainThread]: 
[0m11:12:08.393757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:08.398764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m11:12:08.417754 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m11:12:08.419762 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m11:12:08.420754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:08.589861 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:12:08.591932 [debug] [ThreadPool]: On list_instagrid: Close
[0m11:12:08.597878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m11:12:08.604868 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:12:08.606873 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m11:12:08.607874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:08.660133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:12:08.661136 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:12:08.662135 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:12:08.677756 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:12:08.681752 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m11:12:08.682752 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m11:12:08.694289 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:08.695290 [debug] [MainThread]: On master: BEGIN
[0m11:12:08.697288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:08.743633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:08.744633 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:08.745839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:08.765674 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m11:12:08.768644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD05A560>]}
[0m11:12:08.769646 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:08.770650 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:08.771651 [debug] [MainThread]: On master: BEGIN
[0m11:12:08.772646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:08.773649 [debug] [MainThread]: On master: COMMIT
[0m11:12:08.774648 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:08.775628 [debug] [MainThread]: On master: COMMIT
[0m11:12:08.775628 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:08.776637 [debug] [MainThread]: On master: Close
[0m11:12:08.777649 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:12:08.780144 [info ] [MainThread]: 
[0m11:12:08.796521 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m11:12:08.796521 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m11:12:08.798526 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_date ................................... [RUN]
[0m11:12:08.800524 [info ] [Thread-2 (]: 2 of 9 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m11:12:08.803526 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m11:12:08.804528 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m11:12:08.806525 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m11:12:08.808919 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m11:12:08.812934 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m11:12:08.819941 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m11:12:08.824941 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 11:12:08.809942 => 11:12:08.823940
[0m11:12:08.827941 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 11:12:08.814939 => 11:12:08.826938
[0m11:12:08.828935 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m11:12:08.829935 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m11:12:08.884972 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m11:12:08.890434 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m11:12:08.894393 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:12:08.894393 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:12:08.895402 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m11:12:08.896390 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m11:12:08.897452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:08.898463 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:12:08.950044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:08.951045 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:12:08.953050 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m11:12:08.957380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:08.958407 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:12:08.959385 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m11:12:08.967384 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m11:12:08.980402 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:12:08.981406 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m11:12:08.982404 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m11:12:08.987406 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:12:08.988401 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m11:12:08.989896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:08.990912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:08.995905 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:12:08.999924 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:12:08.999924 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m11:12:09.001335 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:12:09.003350 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.004387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.029397 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:12:09.032405 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m11:12:09.033409 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:12:09.035401 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:12:09.035401 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:12:09.036399 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m11:12:09.038588 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.039604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.047602 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:12:09.052600 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:12:09.053600 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m11:12:09.054599 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m11:12:09.059600 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:09.061622 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 11:12:08.885915 => 11:12:09.061622
[0m11:12:09.061622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:09.062602 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m11:12:09.065605 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 11:12:08.830937 => 11:12:09.065605
[0m11:12:09.066601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD0CCA60>]}
[0m11:12:09.067835 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m11:12:09.071854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD0A6020>]}
[0m11:12:09.069846 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.26s]
[0m11:12:09.073850 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.27s]
[0m11:12:09.076861 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m11:12:09.080344 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m11:12:09.082347 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m11:12:09.083340 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m11:12:09.085342 [info ] [Thread-2 (]: 3 of 9 START sql table model public.sg_production_plan ......................... [RUN]
[0m11:12:09.086342 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m11:12:09.088422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m11:12:09.091466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m11:12:09.093469 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m11:12:09.095518 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m11:12:09.101535 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m11:12:09.105532 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m11:12:09.109533 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 11:12:09.102528 => 11:12:09.108535
[0m11:12:09.111688 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 11:12:09.096531 => 11:12:09.110536
[0m11:12:09.114381 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m11:12:09.113132 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m11:12:09.123403 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m11:12:09.128395 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m11:12:09.133427 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:12:09.135404 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:12:09.136398 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m11:12:09.137403 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m11:12:09.138871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:09.140219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:09.193245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.194246 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:12:09.195244 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m11:12:09.204648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.205648 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:12:09.206659 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m11:12:09.209654 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m11:12:09.215651 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:12:09.216657 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m11:12:09.217922 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.222939 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:12:09.222939 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m11:12:09.223936 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m11:12:09.229973 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:12:09.230971 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.231972 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m11:12:09.236995 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:12:09.237969 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:12:09.238975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.239969 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:12:09.243494 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:12:09.244472 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m11:12:09.245631 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.251137 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:12:09.251137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.252113 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m11:12:09.255711 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:12:09.257566 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:12:09.258564 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:12:09.260565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.261566 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:09.264566 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:12:09.268592 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 11:12:09.116405 => 11:12:09.267564
[0m11:12:09.268592 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m11:12:09.269764 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m11:12:09.271781 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD175360>]}
[0m11:12:09.273780 [info ] [Thread-2 (]: 3 of 9 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.18s]
[0m11:12:09.275794 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m11:12:09.277801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:09.279794 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m11:12:09.285047 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 11:12:09.124405 => 11:12:09.284022
[0m11:12:09.286059 [info ] [Thread-2 (]: 5 of 9 START sql table model public.dim_production_plan ........................ [RUN]
[0m11:12:09.287060 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m11:12:09.289406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m11:12:09.291437 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m11:12:09.297640 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m11:12:09.299659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD024E50>]}
[0m11:12:09.303635 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 11:12:09.291437 => 11:12:09.302641
[0m11:12:09.304634 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m11:12:09.316630 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m11:12:09.301637 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.21s]
[0m11:12:09.318637 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m11:12:09.320633 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:12:09.321637 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m11:12:09.322635 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:09.325634 [debug] [Thread-1 (]: Began running node model.instagrid.test
[0m11:12:09.327866 [info ] [Thread-1 (]: 6 of 9 START sql view model public.test ........................................ [RUN]
[0m11:12:09.330129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.test)
[0m11:12:09.333148 [debug] [Thread-1 (]: Began compiling node model.instagrid.test
[0m11:12:09.339229 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.test"
[0m11:12:09.343343 [debug] [Thread-1 (]: Timing info for model.instagrid.test (compile): 11:12:09.334129 => 11:12:09.342326
[0m11:12:09.344348 [debug] [Thread-1 (]: Began executing node model.instagrid.test
[0m11:12:09.399444 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.test"
[0m11:12:09.401446 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.402448 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:12:09.403452 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:12:09.404451 [debug] [Thread-1 (]: On model.instagrid.test: BEGIN
[0m11:12:09.405452 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m11:12:09.406445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:09.424135 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m11:12:09.431135 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:12:09.432142 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m11:12:09.434132 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.443135 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:12:09.444134 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m11:12:09.447130 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.453138 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:12:09.454134 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:12:09.455132 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:12:09.457137 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.462606 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:12:09.463605 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m11:12:09.465600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.466997 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:12:09.469015 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */

  create view "instagrid"."public"."test__dbt_tmp"
    
    
  as (
    select * from

"instagrid"."public"."dim_manufactured_units"
  );
[0m11:12:09.470209 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:09.473235 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 11:12:09.305638 => 11:12:09.472223
[0m11:12:09.474221 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m11:12:09.475223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD1ED510>]}
[0m11:12:09.478592 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:12:09.477237 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.19s]
[0m11:12:09.485614 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:12:09.487829 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m11:12:09.488837 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
alter table "instagrid"."public"."test__dbt_tmp" rename to "test"
[0m11:12:09.490347 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m11:12:09.492359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.491360 [info ] [Thread-2 (]: 7 of 9 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m11:12:09.495402 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m11:12:09.497400 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_permonth)
[0m11:12:09.500400 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:12:09.501824 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m11:12:09.502838 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m11:12:09.507048 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.510045 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.515869 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:12:09.516866 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 11:12:09.503837 => 11:12:09.516866
[0m11:12:09.518889 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
drop view if exists "instagrid"."public"."test__dbt_backup" cascade
[0m11:12:09.520256 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m11:12:09.527265 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.527265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:12:09.533611 [debug] [Thread-1 (]: Timing info for model.instagrid.test (execute): 11:12:09.345345 => 11:12:09.531606
[0m11:12:09.535610 [debug] [Thread-1 (]: On model.instagrid.test: Close
[0m11:12:09.536602 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.538032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD049210>]}
[0m11:12:09.540044 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m11:12:09.542049 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.test ................................... [[32mCREATE VIEW[0m in 0.21s]
[0m11:12:09.544046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:09.546045 [debug] [Thread-1 (]: Finished running node model.instagrid.test
[0m11:12:09.552047 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m11:12:09.553046 [info ] [Thread-1 (]: 8 of 9 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m11:12:09.556046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.test, now model.instagrid.obt_manufactured_units_perweek)
[0m11:12:09.558047 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m11:12:09.565559 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.568544 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 11:12:09.559045 => 11:12:09.568544
[0m11:12:09.569544 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m11:12:09.577793 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.585487 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.587486 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m11:12:09.588488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:09.639189 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.640189 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.642187 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select distinct month_name,product_type,monthly_manufactured_units,monthy_production_planned,
sum(monthly_manufactured_units) over(partition by product_type order by date) as monthy_manufactured_runningtotal from cte
order by monthy_manufactured_runningtotal
  );
[0m11:12:09.654786 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:12:09.660904 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.661903 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m11:12:09.663904 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.665914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.668907 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:12:09.669904 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.670901 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.671901 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m11:12:09.672901 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:12:09.675920 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.682921 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:12:09.683926 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m11:12:09.684919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:12:09.685918 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:12:09.688941 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.691463 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 11:12:09.521274 => 11:12:09.691463
[0m11:12:09.692475 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m11:12:09.693482 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m11:12:09.695458 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD407DF0>]}
[0m11:12:09.696574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.699047 [info ] [Thread-2 (]: 7 of 9 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.20s]
[0m11:12:09.703063 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:12:09.705060 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m11:12:09.706060 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.707058 [debug] [Thread-2 (]: Began running node model.instagrid.testprod
[0m11:12:09.708061 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:12:09.709086 [info ] [Thread-2 (]: 9 of 9 START sql view model public.testprod .................................... [RUN]
[0m11:12:09.712238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.testprod)
[0m11:12:09.713434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.714445 [debug] [Thread-2 (]: Began compiling node model.instagrid.testprod
[0m11:12:09.719451 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:12:09.724465 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.testprod"
[0m11:12:09.726469 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m11:12:09.728447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:12:09.732742 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 11:12:09.570824 => 11:12:09.732742
[0m11:12:09.733746 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (compile): 11:12:09.720449 => 11:12:09.733746
[0m11:12:09.734743 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m11:12:09.735743 [debug] [Thread-2 (]: Began executing node model.instagrid.testprod
[0m11:12:09.737745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD0585E0>]}
[0m11:12:09.748235 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.testprod"
[0m11:12:09.750236 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.18s]
[0m11:12:09.753234 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m11:12:09.755234 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:12:09.756232 [debug] [Thread-2 (]: On model.instagrid.testprod: BEGIN
[0m11:12:09.757231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:09.816748 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:09.817743 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:12:09.820173 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */

  create view "instagrid"."public"."testprod__dbt_tmp"
    
    
  as (
    select * from
"instagrid"."public"."dim_production_plan"
  );
[0m11:12:09.826179 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:12:09.829180 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:12:09.831181 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
alter table "instagrid"."public"."testprod__dbt_tmp" rename to "testprod"
[0m11:12:09.834407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:09.836411 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m11:12:09.837414 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:12:09.838409 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m11:12:09.840407 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:09.843415 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:12:09.844414 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
drop view if exists "instagrid"."public"."testprod__dbt_backup" cascade
[0m11:12:09.845406 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:12:09.848974 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (execute): 11:12:09.738743 => 11:12:09.847808
[0m11:12:09.849986 [debug] [Thread-2 (]: On model.instagrid.testprod: Close
[0m11:12:09.850987 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc3e1560-fcd5-4f19-ab26-1b4897b5fd21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD1DEB30>]}
[0m11:12:09.852985 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.testprod ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m11:12:09.854989 [debug] [Thread-2 (]: Finished running node model.instagrid.testprod
[0m11:12:09.858336 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:09.859345 [debug] [MainThread]: On master: BEGIN
[0m11:12:09.860317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:10.035383 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:10.036393 [debug] [MainThread]: On master: COMMIT
[0m11:12:10.036393 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:10.037825 [debug] [MainThread]: On master: COMMIT
[0m11:12:10.038836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:10.039837 [debug] [MainThread]: On master: Close
[0m11:12:10.040838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:10.041840 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m11:12:10.042841 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m11:12:10.043836 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m11:12:10.044848 [debug] [MainThread]: Connection 'model.instagrid.testprod' was properly closed.
[0m11:12:10.045856 [info ] [MainThread]: 
[0m11:12:10.046835 [info ] [MainThread]: Finished running 5 table models, 4 view models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m11:12:10.052840 [debug] [MainThread]: Command end result
[0m11:12:10.066260 [info ] [MainThread]: 
[0m11:12:10.068253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:10.077870 [info ] [MainThread]: 
[0m11:12:10.083972 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:12:10.087989 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:10.086986 after 2.26 seconds
[0m11:12:10.088993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DA704A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DCC61D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207DD1B1210>]}
[0m11:12:10.091536 [debug] [MainThread]: Flushing usage events
[0m11:30:40.057531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DB1F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DD577F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DD577E20>]}


============================== 11:30:40.080512 | 1e863990-d46b-4c15-9b7c-69392a4d2239 ==============================
[0m11:30:40.080512 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:30:40.085067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:30:40.308139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DD577EE0>]}
[0m11:30:40.331013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DD695810>]}
[0m11:30:40.351016 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:30:40.692289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:40.693299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:40.713489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDB26230>]}
[0m11:30:40.730070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDAFB220>]}
[0m11:30:40.732586 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m11:30:40.737621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDAFB3D0>]}
[0m11:30:40.741727 [info ] [MainThread]: 
[0m11:30:40.755309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:30:40.762018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m11:30:40.794086 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m11:30:40.800554 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m11:30:40.803231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:41.064573 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:30:41.070665 [debug] [ThreadPool]: On list_instagrid: Close
[0m11:30:41.075611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m11:30:41.090170 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:30:41.091681 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m11:30:41.092690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:41.200839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:30:41.202354 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m11:30:41.203364 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m11:30:41.224027 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:30:41.226034 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m11:30:41.227028 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m11:30:41.244172 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:41.245185 [debug] [MainThread]: On master: BEGIN
[0m11:30:41.246183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:41.309623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:41.310620 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:41.310620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:30:41.341112 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:30:41.344180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDB5A500>]}
[0m11:30:41.346204 [debug] [MainThread]: On master: ROLLBACK
[0m11:30:41.348198 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:41.349197 [debug] [MainThread]: On master: BEGIN
[0m11:30:41.351684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:41.351684 [debug] [MainThread]: On master: COMMIT
[0m11:30:41.353698 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:41.353698 [debug] [MainThread]: On master: COMMIT
[0m11:30:41.354709 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:30:41.355715 [debug] [MainThread]: On master: Close
[0m11:30:41.356710 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m11:30:41.358834 [info ] [MainThread]: 
[0m11:30:41.416702 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m11:30:41.418680 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m11:30:41.419677 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_date ................................... [RUN]
[0m11:30:41.421683 [info ] [Thread-2 (]: 2 of 9 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m11:30:41.424208 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m11:30:41.425208 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m11:30:41.426225 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m11:30:41.427206 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m11:30:41.436163 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m11:30:41.447260 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m11:30:41.452816 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 11:30:41.439157 => 11:30:41.451800
[0m11:30:41.454834 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 11:30:41.433138 => 11:30:41.453818
[0m11:30:41.455838 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m11:30:41.457912 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m11:30:41.542396 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m11:30:41.545475 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m11:30:41.548482 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:30:41.550632 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m11:30:41.551651 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:30:41.556029 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:30:41.557048 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m11:30:41.559044 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:30:41.723744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:41.723744 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:30:41.724740 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m11:30:41.726115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:41.727125 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:30:41.728147 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m11:30:41.744970 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m11:30:41.755511 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:30:41.757517 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m11:30:41.789680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:41.793206 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:30:41.794216 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m11:30:41.797223 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:41.814176 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m11:30:41.836470 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:30:41.839473 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:30:41.840474 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m11:30:41.841985 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:30:41.844001 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m11:30:41.844996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:41.853066 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:30:41.854082 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:30:41.856379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:41.861774 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m11:30:41.863793 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:30:41.864809 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m11:30:41.878875 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:41.889418 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m11:30:41.889418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:41.891168 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m11:30:41.897741 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m11:30:41.899852 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m11:30:41.916085 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:30:41.917079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:30:41.920077 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 11:30:41.457912 => 11:30:41.920077
[0m11:30:41.923894 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 11:30:41.533844 => 11:30:41.922620
[0m11:30:41.924909 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m11:30:41.925912 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m11:30:41.927912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDBA41C0>]}
[0m11:30:41.929275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDC322C0>]}
[0m11:30:41.931802 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.50s]
[0m11:30:41.935832 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m11:30:41.933817 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.51s]
[0m11:30:41.936829 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m11:30:41.938827 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m11:30:41.941838 [info ] [Thread-2 (]: 3 of 9 START sql table model public.sg_production_plan ......................... [RUN]
[0m11:30:41.943370 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m11:30:41.946444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m11:30:41.948440 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m11:30:41.950440 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m11:30:41.952981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m11:30:41.959475 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m11:30:41.961613 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m11:30:41.974417 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m11:30:41.979753 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 11:30:41.969876 => 11:30:41.977735
[0m11:30:41.981917 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m11:30:41.996523 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m11:30:41.998526 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 11:30:41.953998 => 11:30:41.998526
[0m11:30:42.000524 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m11:30:42.002043 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:30:42.018051 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m11:30:42.019056 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m11:30:42.021043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:42.022556 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:30:42.023575 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m11:30:42.024604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:30:42.080851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.081853 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:30:42.082375 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m11:30:42.102129 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m11:30:42.106168 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:30:42.107141 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m11:30:42.108654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.115245 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:30:42.116250 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m11:30:42.117238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.121696 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:30:42.121696 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:30:42.122735 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m11:30:42.134942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:42.137941 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m11:30:42.138941 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m11:30:42.152008 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:30:42.155432 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 11:30:41.984891 => 11:30:42.154430
[0m11:30:42.157651 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m11:30:42.158894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDC775E0>]}
[0m11:30:42.161974 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.21s]
[0m11:30:42.166025 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m11:30:42.169021 [debug] [Thread-1 (]: Began running node model.instagrid.test
[0m11:30:42.171023 [info ] [Thread-1 (]: 5 of 9 START sql view model public.test ........................................ [RUN]
[0m11:30:42.173551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.test)
[0m11:30:42.175042 [debug] [Thread-1 (]: Began compiling node model.instagrid.test
[0m11:30:42.182583 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.test"
[0m11:30:42.186034 [debug] [Thread-1 (]: Timing info for model.instagrid.test (compile): 11:30:42.176054 => 11:30:42.186034
[0m11:30:42.188039 [debug] [Thread-1 (]: Began executing node model.instagrid.test
[0m11:30:42.240906 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.test"
[0m11:30:42.241903 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.243425 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:30:42.246955 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m11:30:42.255869 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:30:42.257154 [debug] [Thread-1 (]: On model.instagrid.test: BEGIN
[0m11:30:42.258167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:42.280865 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m11:30:42.287754 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:30:42.288749 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m11:30:42.289751 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.294276 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:30:42.295281 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m11:30:42.297473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.302431 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:30:42.304445 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:30:42.305443 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m11:30:42.312236 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:42.318272 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m11:30:42.320270 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m11:30:42.326804 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:30:42.331985 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 11:30:42.003520 => 11:30:42.330985
[0m11:30:42.333582 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m11:30:42.335795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDB73C40>]}
[0m11:30:42.336800 [info ] [Thread-2 (]: 3 of 9 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.39s]
[0m11:30:42.339799 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m11:30:42.345037 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m11:30:42.347211 [info ] [Thread-2 (]: 6 of 9 START sql table model public.dim_production_plan ........................ [RUN]
[0m11:30:42.356263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m11:30:42.359834 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m11:30:42.360830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.366407 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m11:30:42.368405 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:30:42.369403 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */

  create view "instagrid"."public"."test__dbt_tmp"
    
    
  as (
    select * from

"instagrid"."public"."dim_manufactured_units"
  );
[0m11:30:42.372940 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 11:30:42.360830 => 11:30:42.371926
[0m11:30:42.373944 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m11:30:42.387099 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m11:30:42.400443 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:30:42.401954 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:30:42.406000 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:30:42.406975 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m11:30:42.407974 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
alter table "instagrid"."public"."test__dbt_tmp" rename to "test"
[0m11:30:42.408975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:30:42.410977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.418537 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m11:30:42.419536 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:30:42.420538 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m11:30:42.448708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:42.452228 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m11:30:42.456181 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
drop view if exists "instagrid"."public"."test__dbt_backup" cascade
[0m11:30:42.459213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:42.462722 [debug] [Thread-1 (]: Timing info for model.instagrid.test (execute): 11:30:42.190036 => 11:30:42.462722
[0m11:30:42.464742 [debug] [Thread-1 (]: On model.instagrid.test: Close
[0m11:30:42.466744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDC937C0>]}
[0m11:30:42.468743 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.test ................................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:30:42.470742 [debug] [Thread-1 (]: Finished running node model.instagrid.test
[0m11:30:42.485329 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.486243 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:30:42.487235 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m11:30:42.508755 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m11:30:42.517298 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:30:42.519322 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m11:30:42.522060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.528018 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:30:42.530056 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m11:30:42.532531 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.538686 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:30:42.538686 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:30:42.539689 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m11:30:42.545441 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:42.550452 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m11:30:42.551967 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m11:30:42.559899 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:30:42.563438 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 11:30:42.375225 => 11:30:42.562424
[0m11:30:42.564449 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m11:30:42.566453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDC913C0>]}
[0m11:30:42.567450 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.21s]
[0m11:30:42.569779 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m11:30:42.577285 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m11:30:42.579295 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m11:30:42.580299 [info ] [Thread-1 (]: 7 of 9 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m11:30:42.582850 [info ] [Thread-2 (]: 8 of 9 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m11:30:42.587344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.test, now model.instagrid.obt_manufactured_units_permonth)
[0m11:30:42.589330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m11:30:42.590328 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m11:30:42.592851 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m11:30:42.598856 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.602379 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.605391 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 11:30:42.593855 => 11:30:42.604390
[0m11:30:42.606392 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m11:30:42.607396 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 11:30:42.598856 => 11:30:42.607396
[0m11:30:42.623776 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.624788 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m11:30:42.636555 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.642372 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.638834 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.645388 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m11:30:42.646929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:42.643388 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m11:30:42.649346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:30:42.726210 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.727211 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.729216 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m11:30:42.730218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.732754 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.733759 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select distinct month_name,product_type,monthly_manufactured_units,monthy_production_planned,
sum(monthly_manufactured_units) over(partition by product_type order by date) as monthy_manufactured_runningtotal from cte
order by monthy_manufactured_runningtotal
  );
[0m11:30:42.747414 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:30:42.751969 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.752929 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:30:42.754108 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m11:30:42.758119 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.759961 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m11:30:42.759961 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.765617 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:30:42.766591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.767594 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.770593 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:30:42.771592 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m11:30:42.772100 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.774120 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m11:30:42.775126 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:42.777123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:42.781667 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m11:30:42.784681 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m11:30:42.785675 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m11:30:42.786678 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m11:30:42.788683 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:42.789678 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:42.792192 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 11:30:42.625807 => 11:30:42.792192
[0m11:30:42.796220 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 11:30:42.608392 => 11:30:42.795219
[0m11:30:42.797216 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m11:30:42.798220 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m11:30:42.800776 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDCE0400>]}
[0m11:30:42.802801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDBA41C0>]}
[0m11:30:42.803804 [info ] [Thread-2 (]: 8 of 9 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.21s]
[0m11:30:42.805818 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.22s]
[0m11:30:42.809328 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m11:30:42.814963 [debug] [Thread-2 (]: Began running node model.instagrid.testprod
[0m11:30:42.812925 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m11:30:42.816950 [info ] [Thread-2 (]: 9 of 9 START sql view model public.testprod .................................... [RUN]
[0m11:30:42.819944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_perweek, now model.instagrid.testprod)
[0m11:30:42.820945 [debug] [Thread-2 (]: Began compiling node model.instagrid.testprod
[0m11:30:42.829495 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.testprod"
[0m11:30:42.838190 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (compile): 11:30:42.822461 => 11:30:42.838190
[0m11:30:42.839181 [debug] [Thread-2 (]: Began executing node model.instagrid.testprod
[0m11:30:42.858055 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.testprod"
[0m11:30:42.860053 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:30:42.863648 [debug] [Thread-2 (]: On model.instagrid.testprod: BEGIN
[0m11:30:42.864649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:30:42.970501 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:30:42.973039 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:30:42.975030 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */

  create view "instagrid"."public"."testprod__dbt_tmp"
    
    
  as (
    select * from
"instagrid"."public"."dim_production_plan"
  );
[0m11:30:42.985086 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:30:42.991945 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:30:42.992479 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
alter table "instagrid"."public"."testprod__dbt_tmp" rename to "testprod"
[0m11:30:42.994836 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:42.999383 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m11:30:43.000378 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:30:43.001891 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m11:30:43.433034 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:30:43.440077 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m11:30:43.442056 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
drop view if exists "instagrid"."public"."testprod__dbt_backup" cascade
[0m11:30:43.444586 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:43.450604 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (execute): 11:30:42.840175 => 11:30:43.449624
[0m11:30:43.450604 [debug] [Thread-2 (]: On model.instagrid.testprod: Close
[0m11:30:43.454151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e863990-d46b-4c15-9b7c-69392a4d2239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDBA41C0>]}
[0m11:30:43.456342 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.testprod ............................... [[32mCREATE VIEW[0m in 0.63s]
[0m11:30:44.068371 [debug] [Thread-2 (]: Finished running node model.instagrid.testprod
[0m11:30:44.075936 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.077933 [debug] [MainThread]: On master: BEGIN
[0m11:30:44.079939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:44.148575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:30:44.149584 [debug] [MainThread]: On master: COMMIT
[0m11:30:44.150575 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:44.150575 [debug] [MainThread]: On master: COMMIT
[0m11:30:44.152178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:30:44.153108 [debug] [MainThread]: On master: Close
[0m11:30:44.155120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:44.156124 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m11:30:44.157122 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m11:30:44.157122 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m11:30:44.158612 [debug] [MainThread]: Connection 'model.instagrid.testprod' was properly closed.
[0m11:30:44.162502 [info ] [MainThread]: 
[0m11:30:44.164788 [info ] [MainThread]: Finished running 5 table models, 4 view models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m11:30:44.171806 [debug] [MainThread]: Command end result
[0m11:30:44.184911 [info ] [MainThread]: 
[0m11:30:44.186920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:30:44.189908 [info ] [MainThread]: 
[0m11:30:44.193467 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m11:30:44.198491 [debug] [MainThread]: Command `dbt run` succeeded at 11:30:44.198491 after 4.33 seconds
[0m11:30:44.199494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DB1F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DD695810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163DDB72650>]}
[0m11:30:44.200854 [debug] [MainThread]: Flushing usage events
[0m12:01:49.949074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F41EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44257F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44257EE0>]}


============================== 12:01:49.959849 | f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69 ==============================
[0m12:01:49.959849 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:01:49.963323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:01:50.318378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44257FA0>]}
[0m12:01:50.362102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44365E10>]}
[0m12:01:50.411217 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:01:50.674714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:50.675712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:50.692491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4472A2F0>]}
[0m12:01:50.708942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F446FB2E0>]}
[0m12:01:50.709956 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m12:01:50.711956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F446FB490>]}
[0m12:01:50.717480 [info ] [MainThread]: 
[0m12:01:50.721510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:01:50.725512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m12:01:50.796968 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m12:01:50.798499 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m12:01:50.799497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:50.905599 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m12:01:50.909181 [debug] [ThreadPool]: On list_instagrid: Close
[0m12:01:50.921940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m12:01:50.937458 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:01:50.939487 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m12:01:50.941490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:51.014460 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:01:51.015438 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m12:01:51.015438 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:01:51.030181 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m12:01:51.032189 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m12:01:51.033181 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m12:01:51.045641 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:51.047173 [debug] [MainThread]: On master: BEGIN
[0m12:01:51.048185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:51.102092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:01:51.103094 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:51.105094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:01:51.141050 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m12:01:51.146050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4475E5C0>]}
[0m12:01:51.147563 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:51.148574 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:51.149588 [debug] [MainThread]: On master: BEGIN
[0m12:01:51.151583 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:01:51.152848 [debug] [MainThread]: On master: COMMIT
[0m12:01:51.153867 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:51.154867 [debug] [MainThread]: On master: COMMIT
[0m12:01:51.156866 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:01:51.158392 [debug] [MainThread]: On master: Close
[0m12:01:51.161405 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:01:51.174648 [info ] [MainThread]: 
[0m12:01:51.194198 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m12:01:51.195201 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m12:01:51.197201 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_date ................................... [RUN]
[0m12:01:51.198728 [info ] [Thread-2 (]: 2 of 9 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m12:01:51.211413 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m12:01:51.213427 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m12:01:51.214911 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m12:01:51.215930 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m12:01:51.220464 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m12:01:51.230483 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m12:01:51.234480 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 12:01:51.216928 => 12:01:51.234480
[0m12:01:51.236997 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 12:01:51.223608 => 12:01:51.236997
[0m12:01:51.238057 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m12:01:51.239073 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m12:01:51.425353 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m12:01:51.429457 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m12:01:51.430495 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m12:01:51.432444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:01:51.469552 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m12:01:51.511780 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:01:51.512781 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m12:01:51.515784 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:01:51.645543 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:51.647061 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:01:51.649074 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m12:01:51.673003 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m12:01:51.685652 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:01:51.687163 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m12:01:51.691229 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:51.696940 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:01:51.699322 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m12:01:51.701437 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:51.738612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:51.752172 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m12:01:51.754170 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m12:01:51.786266 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m12:01:51.791811 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:01:51.798830 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m12:01:51.803688 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m12:01:51.801318 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:01:51.805845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:51.807385 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m12:01:51.814650 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m12:01:51.818089 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:01:51.822390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:51.820374 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:51.828111 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m12:01:51.844618 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m12:01:51.849369 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m12:01:51.845711 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m12:01:51.855382 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m12:01:51.857904 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:01:51.862111 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 12:01:51.287723 => 12:01:51.861106
[0m12:01:51.863108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:51.864110 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m12:01:51.870635 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m12:01:51.872633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F42486A70>]}
[0m12:01:51.873632 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m12:01:51.876034 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.66s]
[0m12:01:51.878059 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m12:01:51.879061 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m12:01:51.883421 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:01:51.890143 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 12:01:51.241101 => 12:01:51.889111
[0m12:01:51.891288 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m12:01:51.893829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F447A99C0>]}
[0m12:01:51.885581 [info ] [Thread-2 (]: 3 of 9 START sql table model public.sg_production_plan ......................... [RUN]
[0m12:01:51.897322 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.68s]
[0m12:01:51.914220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m12:01:51.918775 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m12:01:51.923335 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m12:01:51.922318 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m12:01:51.943197 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m12:01:51.925340 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m12:01:51.946220 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 12:01:51.937000 => 12:01:51.945222
[0m12:01:51.948238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m12:01:51.949687 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m12:01:51.952771 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m12:01:51.963730 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m12:01:51.973006 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m12:01:51.976815 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 12:01:51.965735 => 12:01:51.975297
[0m12:01:51.978202 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m12:01:51.979225 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:01:51.992599 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m12:01:52.029046 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m12:01:52.031060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:01:52.032059 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:01:52.034059 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m12:01:52.037058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:52.253675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:52.255669 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:01:52.257712 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m12:01:52.278806 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m12:01:52.285821 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:01:52.287335 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m12:01:52.289593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:52.295613 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:01:52.297124 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m12:01:52.299145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:52.305886 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:01:52.306889 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:01:52.308427 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m12:01:52.310438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:52.315758 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m12:01:52.319342 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m12:01:52.327225 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:01:52.331333 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 12:01:51.979740 => 12:01:52.331333
[0m12:01:52.333517 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m12:01:52.335537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44876B30>]}
[0m12:01:52.336892 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.39s]
[0m12:01:52.339920 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m12:01:52.341983 [debug] [Thread-1 (]: Began running node model.instagrid.test
[0m12:01:52.344082 [info ] [Thread-1 (]: 5 of 9 START sql view model public.test ........................................ [RUN]
[0m12:01:52.347051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.test)
[0m12:01:52.349068 [debug] [Thread-1 (]: Began compiling node model.instagrid.test
[0m12:01:52.358182 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.test"
[0m12:01:52.360185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:52.361184 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:01:52.363179 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m12:01:52.366085 [debug] [Thread-1 (]: Timing info for model.instagrid.test (compile): 12:01:52.351230 => 12:01:52.364310
[0m12:01:52.370389 [debug] [Thread-1 (]: Began executing node model.instagrid.test
[0m12:01:52.441038 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.test"
[0m12:01:52.442449 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m12:01:52.450022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:01:52.451116 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m12:01:52.453500 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:52.454938 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m12:01:52.461496 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:01:52.462495 [debug] [Thread-1 (]: On model.instagrid.test: BEGIN
[0m12:01:52.464494 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m12:01:52.465496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:52.468019 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:52.474417 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:01:52.475413 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:01:52.476874 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m12:01:52.478887 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:52.485216 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m12:01:52.486969 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m12:01:52.495082 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:01:52.498600 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 12:01:51.953788 => 12:01:52.498600
[0m12:01:52.500617 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m12:01:52.503616 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44837D90>]}
[0m12:01:52.505617 [info ] [Thread-2 (]: 3 of 9 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.59s]
[0m12:01:52.508161 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m12:01:52.511177 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m12:01:52.512177 [info ] [Thread-2 (]: 6 of 9 START sql table model public.dim_production_plan ........................ [RUN]
[0m12:01:52.515579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m12:01:52.518104 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m12:01:52.525515 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m12:01:52.528502 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 12:01:52.520496 => 12:01:52.527041
[0m12:01:52.529524 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m12:01:52.541201 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m12:01:52.544211 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:01:52.545522 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m12:01:52.545522 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:01:52.849439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:52.850440 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m12:01:52.852446 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */

  create view "instagrid"."public"."test__dbt_tmp"
    
    
  as (
    select 
cast(date as date) as date,
year_week,
month_name,
cast(product_type as varchar(50)) as product_type,
cast(plan as integer) as plan 
from

"instagrid"."public"."dim_manufactured_units"
  );
[0m12:01:52.864258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:01:52.870800 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m12:01:52.872801 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
alter table "instagrid"."public"."test__dbt_tmp" rename to "test"
[0m12:01:52.874802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:52.878328 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m12:01:52.880342 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m12:01:52.881339 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m12:01:52.883610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:52.889174 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m12:01:52.890677 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
drop view if exists "instagrid"."public"."test__dbt_backup" cascade
[0m12:01:52.893348 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:01:52.901789 [debug] [Thread-1 (]: Timing info for model.instagrid.test (execute): 12:01:52.372430 => 12:01:52.900535
[0m12:01:52.902296 [debug] [Thread-1 (]: On model.instagrid.test: Close
[0m12:01:52.905442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F448402B0>]}
[0m12:01:52.908231 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.test ................................... [[32mCREATE VIEW[0m in 0.56s]
[0m12:01:52.911159 [debug] [Thread-1 (]: Finished running node model.instagrid.test
[0m12:01:52.993307 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:52.995321 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:01:52.995321 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m12:01:53.024609 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m12:01:53.030153 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:01:53.033153 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m12:01:53.035384 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:53.041943 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:01:53.042948 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m12:01:53.044943 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:53.052487 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:01:53.053495 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:01:53.054488 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m12:01:53.057560 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:53.062743 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m12:01:53.064910 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m12:01:53.072882 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:01:53.076797 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 12:01:52.530829 => 12:01:53.076284
[0m12:01:53.078813 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m12:01:53.079828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44893040>]}
[0m12:01:53.081830 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.56s]
[0m12:01:53.084825 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m12:01:53.092162 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m12:01:53.093184 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m12:01:53.095760 [info ] [Thread-1 (]: 7 of 9 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m12:01:53.098296 [info ] [Thread-2 (]: 8 of 9 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m12:01:53.101295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.test, now model.instagrid.obt_manufactured_units_permonth)
[0m12:01:53.102303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m12:01:53.103300 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m12:01:53.105300 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m12:01:53.111775 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.119067 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.122266 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 12:01:53.106042 => 12:01:53.121244
[0m12:01:53.124261 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m12:01:53.126267 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 12:01:53.113016 => 12:01:53.125260
[0m12:01:53.134831 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.137355 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m12:01:53.151032 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.153045 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.178985 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.180988 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m12:01:53.184343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:01:53.156052 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m12:01:53.191656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:53.296849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:53.297869 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.300043 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select distinct month_name,product_type,monthly_manufactured_units,monthy_production_planned,
sum(monthly_manufactured_units) over(partition by product_type order by date) as monthy_manufactured_runningtotal from cte
order by monthy_manufactured_runningtotal
  );
[0m12:01:53.313605 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:01:53.320527 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.321543 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m12:01:53.323542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:53.328086 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:01:53.329082 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.330093 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m12:01:53.333093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:53.338848 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m12:01:53.339862 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m12:01:53.341859 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:01:53.347752 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 12:01:53.126267 => 12:01:53.347241
[0m12:01:53.348261 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m12:01:53.351846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F448E4250>]}
[0m12:01:53.353858 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.25s]
[0m12:01:53.357375 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m12:01:53.360404 [debug] [Thread-1 (]: Began running node model.instagrid.testprod
[0m12:01:53.364401 [info ] [Thread-1 (]: 9 of 9 START sql view model public.testprod .................................... [RUN]
[0m12:01:53.403184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.testprod)
[0m12:01:53.405338 [debug] [Thread-1 (]: Began compiling node model.instagrid.testprod
[0m12:01:53.423025 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.testprod"
[0m12:01:53.426071 [debug] [Thread-1 (]: Timing info for model.instagrid.testprod (compile): 12:01:53.411496 => 12:01:53.426071
[0m12:01:53.427574 [debug] [Thread-1 (]: Began executing node model.instagrid.testprod
[0m12:01:53.441358 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.testprod"
[0m12:01:53.465269 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.testprod"
[0m12:01:53.472972 [debug] [Thread-1 (]: On model.instagrid.testprod: BEGIN
[0m12:01:53.475607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:53.512570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:53.513574 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.515573 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m12:01:53.527825 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:01:53.535607 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.537122 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m12:01:53.539247 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:53.554548 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:01:53.555542 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.558089 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m12:01:53.561110 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:53.566115 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m12:01:53.568632 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m12:01:53.570645 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:01:53.575648 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 12:01:53.138369 => 12:01:53.572653
[0m12:01:53.575648 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m12:01:53.579177 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F447FDE40>]}
[0m12:01:53.580188 [info ] [Thread-2 (]: 8 of 9 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.48s]
[0m12:01:53.582221 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m12:01:53.740058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:01:53.740910 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.testprod"
[0m12:01:53.742419 [debug] [Thread-1 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */

  create view "instagrid"."public"."testprod__dbt_tmp"
    
    
  as (
    select * from
"instagrid"."public"."dim_production_plan"
  );
[0m12:01:53.751211 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:01:53.758212 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.testprod"
[0m12:01:53.760473 [debug] [Thread-1 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
alter table "instagrid"."public"."testprod__dbt_tmp" rename to "testprod"
[0m12:01:53.762476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:01:53.765480 [debug] [Thread-1 (]: On model.instagrid.testprod: COMMIT
[0m12:01:53.768003 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.testprod"
[0m12:01:53.769482 [debug] [Thread-1 (]: On model.instagrid.testprod: COMMIT
[0m12:01:53.771678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:01:53.778258 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.testprod"
[0m12:01:53.779269 [debug] [Thread-1 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
drop view if exists "instagrid"."public"."testprod__dbt_backup" cascade
[0m12:01:53.781934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:01:53.788199 [debug] [Thread-1 (]: Timing info for model.instagrid.testprod (execute): 12:01:53.429605 => 12:01:53.788199
[0m12:01:53.790407 [debug] [Thread-1 (]: On model.instagrid.testprod: Close
[0m12:01:53.793379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f67a5c-b9d1-45d9-b9e0-6a7fa54a0b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44837D90>]}
[0m12:01:53.795834 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.testprod ............................... [[32mCREATE VIEW[0m in 0.39s]
[0m12:01:53.798875 [debug] [Thread-1 (]: Finished running node model.instagrid.testprod
[0m12:01:53.809669 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:53.811109 [debug] [MainThread]: On master: BEGIN
[0m12:01:53.813125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:01:53.975171 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:01:53.976193 [debug] [MainThread]: On master: COMMIT
[0m12:01:53.977704 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:53.978720 [debug] [MainThread]: On master: COMMIT
[0m12:01:53.980168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:01:53.981666 [debug] [MainThread]: On master: Close
[0m12:01:53.984681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:53.985684 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m12:01:53.987199 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m12:01:53.988215 [debug] [MainThread]: Connection 'model.instagrid.testprod' was properly closed.
[0m12:01:53.989221 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m12:01:53.990222 [info ] [MainThread]: 
[0m12:01:53.992223 [info ] [MainThread]: Finished running 5 table models, 4 view models in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m12:01:53.997732 [debug] [MainThread]: Command end result
[0m12:01:54.011851 [info ] [MainThread]: 
[0m12:01:54.018899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:54.024192 [info ] [MainThread]: 
[0m12:01:54.065615 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:01:54.070161 [debug] [MainThread]: Command `dbt run` succeeded at 12:01:54.070161 after 4.19 seconds
[0m12:01:54.071150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F41EF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F448E4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F44715810>]}
[0m12:01:54.073157 [debug] [MainThread]: Flushing usage events
[0m15:24:06.772330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200E9F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010D5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010D5BEB0>]}


============================== 15:24:06.773196 | d990a4d1-5365-4851-920c-4793f3bca707 ==============================
[0m15:24:06.773196 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:24:06.773196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:24:06.901158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010D5BF70>]}
[0m15:24:06.916806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010E66500>]}
[0m15:24:06.933183 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:24:07.052799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:24:07.052799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:24:07.067817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022011226320>]}
[0m15:24:07.083854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010FFB3A0>]}
[0m15:24:07.083854 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:24:07.083854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022010FFB400>]}
[0m15:24:07.083854 [info ] [MainThread]: 
[0m15:24:07.083854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:24:07.099497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:24:07.099497 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:24:07.099497 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:24:07.099497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:07.213276 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:24:07.213276 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:24:07.228542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:24:07.244186 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:24:07.244186 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:24:07.244186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:07.315234 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:24:07.315234 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:24:07.315234 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:24:07.339464 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m15:24:07.339464 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:24:07.339464 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:24:07.354309 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:07.354309 [debug] [MainThread]: On master: BEGIN
[0m15:24:07.354309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:07.436503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:24:07.436503 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:07.436503 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:24:07.472166 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m15:24:07.472166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201125E5F0>]}
[0m15:24:07.472166 [debug] [MainThread]: On master: ROLLBACK
[0m15:24:07.480994 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:07.481835 [debug] [MainThread]: On master: BEGIN
[0m15:24:07.484734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:24:07.484734 [debug] [MainThread]: On master: COMMIT
[0m15:24:07.484734 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:07.484734 [debug] [MainThread]: On master: COMMIT
[0m15:24:07.484734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:24:07.484734 [debug] [MainThread]: On master: Close
[0m15:24:07.490403 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:24:07.490403 [info ] [MainThread]: 
[0m15:24:07.496222 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m15:24:07.496222 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:24:07.496222 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_date ................................... [RUN]
[0m15:24:07.513579 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m15:24:07.511868 [info ] [Thread-2 (]: 2 of 9 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:24:07.515660 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m15:24:07.520172 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:24:07.528219 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m15:24:07.532155 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:24:07.537021 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:24:07.544038 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 15:24:07.524701 => 15:24:07.544038
[0m15:24:07.544038 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m15:24:07.617223 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:24:07.534556 => 15:24:07.617223
[0m15:24:07.625251 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m15:24:07.625251 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:24:07.640428 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:24:07.640428 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:24:07.640428 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m15:24:07.640428 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:07.649512 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:24:07.649512 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:24:07.653058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:24:07.740170 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:07.744936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:07.744936 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:24:07.746735 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:24:07.749289 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m15:24:07.750561 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m15:24:07.775280 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m15:24:07.789259 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:24:07.789259 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:24:07.789259 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m15:24:07.797297 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:24:07.797297 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:24:07.797297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:07.797297 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:07.805297 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:24:07.813296 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:24:07.813296 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:24:07.813296 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:24:07.819693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:07.821713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:07.918554 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:24:07.909978 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:24:07.919760 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:24:07.919760 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:24:07.919760 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:24:07.919760 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:24:07.926281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:07.929606 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:07.936367 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:24:07.947400 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:24:07.948779 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m15:24:07.951292 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:24:07.957345 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:24:07.959371 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:24:07.625251 => 15:24:07.959371
[0m15:24:07.959371 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:24:07.959371 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:24:07.967433 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 15:24:07.544038 => 15:24:07.967433
[0m15:24:07.969209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201124D060>]}
[0m15:24:07.969209 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m15:24:07.972747 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.45s]
[0m15:24:07.975765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220112AA4A0>]}
[0m15:24:07.975765 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:24:07.980684 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:24:07.980684 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.46s]
[0m15:24:07.984882 [info ] [Thread-2 (]: 3 of 9 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:24:07.997867 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m15:24:08.000892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m15:24:08.003241 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:24:08.003241 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:24:08.009264 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:24:08.003241 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:24:08.017915 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:24:08.009264 => 15:24:08.017915
[0m15:24:08.017915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m15:24:08.017915 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:24:08.017915 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:24:08.033450 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:24:08.041441 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:24:08.041441 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:24:08.033450 => 15:24:08.041441
[0m15:24:08.041441 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:24:08.041441 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:24:08.057449 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:24:08.057449 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:24:08.057449 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:08.057449 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:24:08.066223 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:24:08.067907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:08.173809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.173809 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:24:08.173809 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m15:24:08.178876 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.180478 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:24:08.180478 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m15:24:08.194937 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:24:08.203153 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:24:08.203153 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:24:08.203153 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:24:08.203153 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:24:08.211332 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:24:08.211332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.211332 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.217690 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:24:08.226704 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:24:08.226704 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:24:08.226704 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:24:08.226704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.226704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.235234 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:24:08.235234 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:24:08.242785 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:24:08.242785 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:24:08.242785 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:24:08.242785 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:24:08.242785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.252978 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:24:08.252978 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:24:08.258541 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.258541 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:24:08.258541 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:24:08.258541 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:24:08.270457 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:24:08.049445 => 15:24:08.270457
[0m15:24:08.270457 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:24:08.273472 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:24:08.274484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022011227DF0>]}
[0m15:24:08.274484 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:24:08.025426 => 15:24:08.274484
[0m15:24:08.274484 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.26s]
[0m15:24:08.274484 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:24:08.282760 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:24:08.286514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022011344040>]}
[0m15:24:08.288761 [info ] [Thread-2 (]: 3 of 9 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.29s]
[0m15:24:08.291213 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:24:08.294595 [debug] [Thread-1 (]: Began running node model.instagrid.test
[0m15:24:08.294595 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:24:08.294595 [info ] [Thread-1 (]: 5 of 9 START sql view model public.test ........................................ [RUN]
[0m15:24:08.299611 [info ] [Thread-2 (]: 6 of 9 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:24:08.302295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.test)
[0m15:24:08.302973 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:24:08.302973 [debug] [Thread-1 (]: Began compiling node model.instagrid.test
[0m15:24:08.307990 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:24:08.309497 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.test"
[0m15:24:08.317774 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:24:08.324296 [debug] [Thread-1 (]: Timing info for model.instagrid.test (compile): 15:24:08.309497 => 15:24:08.324296
[0m15:24:08.324296 [debug] [Thread-1 (]: Began executing node model.instagrid.test
[0m15:24:08.332688 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:24:08.316020 => 15:24:08.332688
[0m15:24:08.357021 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.test"
[0m15:24:08.357021 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:24:08.365008 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:24:08.375658 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:24:08.375658 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:24:08.375658 [debug] [Thread-1 (]: On model.instagrid.test: BEGIN
[0m15:24:08.380019 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:24:08.381974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:08.381974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:08.448595 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.448595 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:24:08.458124 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m15:24:08.459879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.459879 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:24:08.462413 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */

  create view "instagrid"."public"."test__dbt_tmp"
    
    
  as (
    select 
cast(date as date) as date,
year_week,
month_name,
cast(product_type as varchar(50)) as product_type,
cast(plan as integer) as plan 
from

"instagrid"."public"."dim_manufactured_units"
  );
[0m15:24:08.473907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:24:08.478424 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:24:08.478424 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m15:24:08.478424 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
alter table "instagrid"."public"."test__dbt_tmp" rename to "test"
[0m15:24:08.478424 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:24:08.478424 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:24:08.478424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.494066 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.494651 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m15:24:08.494651 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:24:08.494651 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:24:08.494651 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:24:08.494651 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m15:24:08.494651 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.506208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.511169 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:24:08.511169 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:24:08.511169 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:24:08.511169 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
drop view if exists "instagrid"."public"."test__dbt_backup" cascade
[0m15:24:08.511169 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:24:08.511169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:24:08.511169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.525682 [debug] [Thread-1 (]: Timing info for model.instagrid.test (execute): 15:24:08.324296 => 15:24:08.525682
[0m15:24:08.529350 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:24:08.529350 [debug] [Thread-1 (]: On model.instagrid.test: Close
[0m15:24:08.529350 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:24:08.529350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022011399C00>]}
[0m15:24:08.540861 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.test ................................... [[32mCREATE VIEW[0m in 0.23s]
[0m15:24:08.540861 [debug] [Thread-1 (]: Finished running node model.instagrid.test
[0m15:24:08.546268 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:24:08.549871 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:24:08.365008 => 15:24:08.549871
[0m15:24:08.556343 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:24:08.557419 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220113CA800>]}
[0m15:24:08.557419 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.25s]
[0m15:24:08.557419 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:24:08.565843 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m15:24:08.565843 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m15:24:08.571013 [info ] [Thread-2 (]: 8 of 9 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m15:24:08.573280 [info ] [Thread-1 (]: 7 of 9 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m15:24:08.573795 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m15:24:08.573795 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m15:24:08.573795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.test, now model.instagrid.obt_manufactured_units_permonth)
[0m15:24:08.586463 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.590481 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m15:24:08.598592 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.598592 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 15:24:08.573795 => 15:24:08.598592
[0m15:24:08.603988 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m15:24:08.615256 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.615256 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 15:24:08.591939 => 15:24:08.615256
[0m15:24:08.615256 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m15:24:08.626860 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.631874 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.631874 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m15:24:08.631874 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:08.631874 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.631874 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m15:24:08.639892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:08.698353 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.703007 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.703007 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m15:24:08.713445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.713445 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.713445 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select date,product_type,monthly_manufactured_units,monthy_production_planned,
sum(monthly_manufactured_units) over(partition by product_type order by date) as monthy_manufactured_runningtotal from cte
order by monthy_manufactured_runningtotal
  );
[0m15:24:08.716463 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:24:08.716463 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.716463 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m15:24:08.716463 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.728480 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m15:24:08.728480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:24:08.728480 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.728480 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.728480 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m15:24:08.728480 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m15:24:08.728480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.728480 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.744928 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m15:24:08.744928 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:24:08.744928 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.744928 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m15:24:08.752916 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m15:24:08.752916 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:24:08.755755 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 15:24:08.603988 => 15:24:08.755755
[0m15:24:08.759789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.759789 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m15:24:08.759789 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:24:08.768599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220113DE800>]}
[0m15:24:08.768599 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m15:24:08.771266 [info ] [Thread-2 (]: 8 of 9 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.19s]
[0m15:24:08.771266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:24:08.774869 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m15:24:08.782010 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 15:24:08.615256 => 15:24:08.782010
[0m15:24:08.782010 [debug] [Thread-2 (]: Began running node model.instagrid.testprod
[0m15:24:08.782010 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m15:24:08.790380 [info ] [Thread-2 (]: 9 of 9 START sql view model public.testprod .................................... [RUN]
[0m15:24:08.790380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201137F7F0>]}
[0m15:24:08.790380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_perweek, now model.instagrid.testprod)
[0m15:24:08.798585 [debug] [Thread-2 (]: Began compiling node model.instagrid.testprod
[0m15:24:08.797064 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.22s]
[0m15:24:08.806734 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.testprod"
[0m15:24:08.806734 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m15:24:08.806734 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (compile): 15:24:08.798585 => 15:24:08.806734
[0m15:24:08.814776 [debug] [Thread-2 (]: Began executing node model.instagrid.testprod
[0m15:24:08.822802 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.testprod"
[0m15:24:08.830923 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:24:08.832918 [debug] [Thread-2 (]: On model.instagrid.testprod: BEGIN
[0m15:24:08.832918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:24:08.897450 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:24:08.899637 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:24:08.899637 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */

  create view "instagrid"."public"."testprod__dbt_tmp"
    
    
  as (
    select full_date,plan,pn,monthy_production_planned
from
"instagrid"."public"."dim_production_plan" as prodplan
join "instagrid"."public"."dim_date" as dimdate
on prodplan.month_name=dimdate.month_name
  );
[0m15:24:08.911809 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:24:08.911809 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:24:08.911809 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
alter table "instagrid"."public"."testprod__dbt_tmp" rename to "testprod"
[0m15:24:08.911809 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:24:08.927460 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m15:24:08.927460 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:24:08.927460 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m15:24:08.927460 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:24:08.927460 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:24:08.927460 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
drop view if exists "instagrid"."public"."testprod__dbt_backup" cascade
[0m15:24:08.943081 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:24:08.944855 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (execute): 15:24:08.814776 => 15:24:08.944855
[0m15:24:08.944855 [debug] [Thread-2 (]: On model.instagrid.testprod: Close
[0m15:24:08.944855 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd990a4d1-5365-4851-920c-4793f3bca707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022011623B20>]}
[0m15:24:08.951227 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.testprod ............................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:24:08.952359 [debug] [Thread-2 (]: Finished running node model.instagrid.testprod
[0m15:24:08.955095 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:08.955095 [debug] [MainThread]: On master: BEGIN
[0m15:24:08.955095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:24:09.036036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:24:09.036036 [debug] [MainThread]: On master: COMMIT
[0m15:24:09.036036 [debug] [MainThread]: Using postgres connection "master"
[0m15:24:09.036036 [debug] [MainThread]: On master: COMMIT
[0m15:24:09.036036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:24:09.036036 [debug] [MainThread]: On master: Close
[0m15:24:09.044042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:09.044042 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:24:09.044042 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:24:09.051164 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m15:24:09.053249 [debug] [MainThread]: Connection 'model.instagrid.testprod' was properly closed.
[0m15:24:09.053920 [info ] [MainThread]: 
[0m15:24:09.056603 [info ] [MainThread]: Finished running 5 table models, 4 view models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m15:24:09.062790 [debug] [MainThread]: Command end result
[0m15:24:09.076831 [info ] [MainThread]: 
[0m15:24:09.082344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:09.087350 [info ] [MainThread]: 
[0m15:24:09.087350 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:24:09.094110 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:09.094110 after 2.37 seconds
[0m15:24:09.094110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200E9F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220112F7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200F22AD70>]}
[0m15:24:09.094110 [debug] [MainThread]: Flushing usage events
[0m15:26:02.597594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DC0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE467FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE467EB0>]}


============================== 15:26:02.606838 | e29b9e1f-7425-4b53-bd10-339ad0ce28da ==============================
[0m15:26:02.606838 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:26:02.622199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:26:02.863063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE467F10>]}
[0m15:26:02.894599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE584CA0>]}
[0m15:26:02.942217 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:26:03.162777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:26:03.162777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:26:03.180430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEA2A320>]}
[0m15:26:03.198741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE71B310>]}
[0m15:26:03.198741 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:26:03.210729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE71B4C0>]}
[0m15:26:03.215745 [info ] [MainThread]: 
[0m15:26:03.220888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:26:03.226906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:26:03.264364 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:26:03.268391 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:26:03.268391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:03.365972 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:26:03.365972 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:26:03.385434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:26:03.396532 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:26:03.396532 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:26:03.396532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:03.490953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:26:03.490953 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:26:03.490953 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:26:03.517292 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m15:26:03.521851 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:26:03.521851 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:26:03.539120 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:03.539120 [debug] [MainThread]: On master: BEGIN
[0m15:26:03.539120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:03.633923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:26:03.633923 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:03.639797 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:26:03.684404 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:26:03.684404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEA5E5F0>]}
[0m15:26:03.684404 [debug] [MainThread]: On master: ROLLBACK
[0m15:26:03.684404 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:03.684404 [debug] [MainThread]: On master: BEGIN
[0m15:26:03.696919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:26:03.698038 [debug] [MainThread]: On master: COMMIT
[0m15:26:03.700220 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:03.700220 [debug] [MainThread]: On master: COMMIT
[0m15:26:03.704520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:26:03.704520 [debug] [MainThread]: On master: Close
[0m15:26:03.708713 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:26:03.710355 [info ] [MainThread]: 
[0m15:26:03.761051 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m15:26:03.762007 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:26:03.764028 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_date ................................... [RUN]
[0m15:26:03.768557 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m15:26:03.772076 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m15:26:03.778652 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m15:26:03.780172 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 15:26:03.772076 => 15:26:03.780172
[0m15:26:03.780172 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m15:26:03.768557 [info ] [Thread-2 (]: 2 of 9 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:26:03.836763 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:26:03.877806 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:26:03.942538 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m15:26:03.950928 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:26:03.950928 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:26:03.958949 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:26:03.942538 => 15:26:03.958949
[0m15:26:03.958949 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:26:03.966957 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:26:03.974950 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:26:03.974950 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:26:03.974950 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m15:26:03.991525 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:26:03.983997 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:26:04.098391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:04.098391 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:26:04.098391 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m15:26:04.098391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:04.102853 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:26:04.102853 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m15:26:04.116103 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:26:04.116103 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:26:04.116103 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m15:26:04.127045 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:26:04.129060 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:26:04.134949 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m15:26:04.134949 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.137811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.138844 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:26:04.146109 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:26:04.146109 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:26:04.146109 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:26:04.152118 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.152118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.177156 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:26:04.177156 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:26:04.177156 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:26:04.177156 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:26:04.192703 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:26:04.194333 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:26:04.194333 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:04.199166 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:04.216235 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:26:04.216235 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:26:04.225323 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:26:04.225323 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m15:26:04.225323 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:26:04.241862 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:26:03.958949 => 15:26:04.241862
[0m15:26:04.244612 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:26:04.244612 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:26:04.244612 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 15:26:03.788195 => 15:26:04.244612
[0m15:26:04.256663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEB2CB50>]}
[0m15:26:04.256663 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m15:26:04.260704 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.41s]
[0m15:26:04.266441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE59B670>]}
[0m15:26:04.270727 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:26:04.274507 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.50s]
[0m15:26:04.274507 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:26:04.283661 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m15:26:04.285307 [info ] [Thread-2 (]: 3 of 9 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:26:04.287557 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:26:04.290300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m15:26:04.292754 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:26:04.292754 [info ] [Thread-1 (]: 4 of 9 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:26:04.307130 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:26:04.307130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m15:26:04.315379 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:26:04.307130 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:26:04.292754 => 15:26:04.307130
[0m15:26:04.323424 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:26:04.323424 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:26:04.339697 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:26:04.339697 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:26:04.316393 => 15:26:04.339697
[0m15:26:04.345104 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:26:04.347613 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:26:04.348250 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:26:04.355770 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:26:04.360534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:04.362758 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:26:04.364271 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:26:04.366594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:04.445523 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:04.446036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:04.446958 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:26:04.446958 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:26:04.446958 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m15:26:04.446958 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m15:26:04.478564 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:26:04.487803 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:26:04.487803 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:26:04.487803 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:26:04.493814 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:26:04.499024 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.499658 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:26:04.504400 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:26:04.504400 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:26:04.504400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.516698 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:26:04.516698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.516698 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:26:04.524036 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:26:04.524036 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:26:04.524036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.524036 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:26:04.524036 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:26:04.536963 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:26:04.536963 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:04.540776 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:26:04.540776 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:26:04.540776 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:26:04.540776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:04.558135 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:26:04.558135 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:26:04.560913 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:26:04.560913 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:26:04.323424 => 15:26:04.560913
[0m15:26:04.560913 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:26:04.568636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEB66800>]}
[0m15:26:04.575416 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:26:04.579247 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:26:04.348250 => 15:26:04.579247
[0m15:26:04.579247 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:26:04.571064 [info ] [Thread-2 (]: 3 of 9 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.28s]
[0m15:26:04.579247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEB66920>]}
[0m15:26:04.585808 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:26:04.587833 [info ] [Thread-1 (]: 4 of 9 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.27s]
[0m15:26:04.591078 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:26:04.597537 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:26:04.597537 [debug] [Thread-1 (]: Began running node model.instagrid.test
[0m15:26:04.597537 [info ] [Thread-2 (]: 5 of 9 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:26:04.597537 [info ] [Thread-1 (]: 6 of 9 START sql view model public.test ........................................ [RUN]
[0m15:26:04.604049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:26:04.604049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.test)
[0m15:26:04.604049 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:26:04.612175 [debug] [Thread-1 (]: Began compiling node model.instagrid.test
[0m15:26:04.628556 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.test"
[0m15:26:04.634126 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:26:04.636161 [debug] [Thread-1 (]: Timing info for model.instagrid.test (compile): 15:26:04.621044 => 15:26:04.636161
[0m15:26:04.639081 [debug] [Thread-1 (]: Began executing node model.instagrid.test
[0m15:26:04.652823 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:26:04.612909 => 15:26:04.652823
[0m15:26:04.678170 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:26:04.694190 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.test"
[0m15:26:04.704430 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:26:04.704430 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:26:04.709448 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:26:04.711964 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:26:04.709448 [debug] [Thread-1 (]: On model.instagrid.test: BEGIN
[0m15:26:04.711964 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:04.714669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:04.853855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:04.855371 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:26:04.855371 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m15:26:04.866697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:04.866697 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:26:04.872214 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */

  create view "instagrid"."public"."test__dbt_tmp"
    
    
  as (
    select 
cast(date as date) as date,
year_week,
month_name,
cast(product_type as varchar(50)) as product_type,
cast(plan as integer) as plan 
from

"instagrid"."public"."dim_manufactured_units"
  );
[0m15:26:04.880232 [debug] [Thread-2 (]: SQL status: SELECT 126 in 0.0 seconds
[0m15:26:04.887691 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:26:04.888710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:26:04.888710 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:26:04.896731 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:26:04.900727 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.900727 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
alter table "instagrid"."public"."test__dbt_tmp" rename to "test"
[0m15:26:04.905247 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:26:04.905247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.905247 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:26:04.916809 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m15:26:04.919319 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:26:04.921605 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:04.921605 [debug] [Thread-1 (]: On model.instagrid.test: COMMIT
[0m15:26:04.921605 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:26:04.929620 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:26:04.929620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:04.931674 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:26:04.937870 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.test"
[0m15:26:04.937870 [debug] [Thread-1 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
drop view if exists "instagrid"."public"."test__dbt_backup" cascade
[0m15:26:04.937870 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:04.944365 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:26:04.946091 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:26:04.952498 [debug] [Thread-1 (]: Timing info for model.instagrid.test (execute): 15:26:04.639081 => 15:26:04.952498
[0m15:26:04.954299 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:26:04.956246 [debug] [Thread-1 (]: On model.instagrid.test: Close
[0m15:26:04.959680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEB5DA80>]}
[0m15:26:04.962201 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:26:04.962201 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:26:04.695600 => 15:26:04.962201
[0m15:26:04.962201 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.test ................................... [[32mCREATE VIEW[0m in 0.36s]
[0m15:26:04.967782 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:26:04.970780 [debug] [Thread-1 (]: Finished running node model.instagrid.test
[0m15:26:04.974110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEB65F60>]}
[0m15:26:04.978623 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.37s]
[0m15:26:04.980479 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:26:04.984161 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m15:26:04.984161 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m15:26:04.986678 [info ] [Thread-1 (]: 7 of 9 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m15:26:04.988230 [info ] [Thread-2 (]: 8 of 9 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m15:26:05.004204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m15:26:05.004204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.test, now model.instagrid.obt_manufactured_units_permonth)
[0m15:26:05.004204 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m15:26:05.017267 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m15:26:05.027770 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.033643 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.037463 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 15:26:05.019280 => 15:26:05.037463
[0m15:26:05.037463 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m15:26:05.037463 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 15:26:05.027770 => 15:26:05.037463
[0m15:26:05.044478 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.044478 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m15:26:05.060505 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.060505 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m15:26:05.052494 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.082125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:05.082125 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.086640 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m15:26:05.086640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:05.205196 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:05.206144 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.207143 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m15:26:05.211969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:05.214483 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.214483 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select date,product_type,monthly_manufactured_units,monthy_production_planned
 from cte
  );
[0m15:26:05.220638 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:26:05.220638 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.230150 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m15:26:05.232065 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:26:05.239609 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.239609 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:05.239609 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m15:26:05.239609 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m15:26:05.239609 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.246758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:05.246758 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m15:26:05.249394 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m15:26:05.253025 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.253740 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:05.253740 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m15:26:05.259786 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:26:05.261798 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m15:26:05.262872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:05.262872 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:26:05.265210 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:26:05.271073 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 15:26:05.037463 => 15:26:05.271073
[0m15:26:05.271073 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m15:26:05.271073 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m15:26:05.271073 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:26:05.277590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEBEC130>]}
[0m15:26:05.277590 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 15:26:05.052494 => 15:26:05.277590
[0m15:26:05.283787 [info ] [Thread-2 (]: 8 of 9 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.27s]
[0m15:26:05.286572 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m15:26:05.287576 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m15:26:05.291239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEBA1ED0>]}
[0m15:26:05.291239 [debug] [Thread-2 (]: Began running node model.instagrid.testprod
[0m15:26:05.294252 [info ] [Thread-1 (]: 7 of 9 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.29s]
[0m15:26:05.294252 [info ] [Thread-2 (]: 9 of 9 START sql view model public.testprod .................................... [RUN]
[0m15:26:05.298863 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m15:26:05.301846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_perweek, now model.instagrid.testprod)
[0m15:26:05.304285 [debug] [Thread-2 (]: Began compiling node model.instagrid.testprod
[0m15:26:05.310308 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.testprod"
[0m15:26:05.311266 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (compile): 15:26:05.304285 => 15:26:05.311266
[0m15:26:05.311266 [debug] [Thread-2 (]: Began executing node model.instagrid.testprod
[0m15:26:05.334742 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.testprod"
[0m15:26:05.337673 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:26:05.343229 [debug] [Thread-2 (]: On model.instagrid.testprod: BEGIN
[0m15:26:05.344779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:26:05.433856 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:26:05.433856 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:26:05.433856 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */

  create view "instagrid"."public"."testprod__dbt_tmp"
    
    
  as (
    select full_date,plan,pn,monthy_production_planned
from
"instagrid"."public"."dim_production_plan" as prodplan
join "instagrid"."public"."dim_date" as dimdate
on prodplan.month_name=dimdate.month_name
  );
[0m15:26:05.448885 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:26:05.450400 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:26:05.458480 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
alter table "instagrid"."public"."testprod__dbt_tmp" rename to "testprod"
[0m15:26:05.458480 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:26:05.467463 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m15:26:05.469050 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:26:05.469050 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m15:26:05.478111 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:26:05.488106 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:26:05.488106 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
drop view if exists "instagrid"."public"."testprod__dbt_backup" cascade
[0m15:26:05.490850 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:26:05.494723 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (execute): 15:26:05.311266 => 15:26:05.494723
[0m15:26:05.496516 [debug] [Thread-2 (]: On model.instagrid.testprod: Close
[0m15:26:05.499030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b9e1f-7425-4b53-bd10-339ad0ce28da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEBFBD60>]}
[0m15:26:05.500791 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.testprod ............................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:26:05.504558 [debug] [Thread-2 (]: Finished running node model.instagrid.testprod
[0m15:26:05.508357 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:05.508953 [debug] [MainThread]: On master: BEGIN
[0m15:26:05.511059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:26:05.630500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:26:05.630500 [debug] [MainThread]: On master: COMMIT
[0m15:26:05.632344 [debug] [MainThread]: Using postgres connection "master"
[0m15:26:05.633559 [debug] [MainThread]: On master: COMMIT
[0m15:26:05.633559 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:26:05.633559 [debug] [MainThread]: On master: Close
[0m15:26:05.633559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:05.638575 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:26:05.638575 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:26:05.641744 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_permonth' was properly closed.
[0m15:26:05.642782 [debug] [MainThread]: Connection 'model.instagrid.testprod' was properly closed.
[0m15:26:05.645215 [info ] [MainThread]: 
[0m15:26:05.646728 [info ] [MainThread]: Finished running 5 table models, 4 view models in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m15:26:05.648695 [debug] [MainThread]: Command end result
[0m15:26:05.663232 [info ] [MainThread]: 
[0m15:26:05.663232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:05.671231 [info ] [MainThread]: 
[0m15:26:05.671231 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:26:05.679235 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:05.679235 after 3.33 seconds
[0m15:26:05.679235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DC0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DE584CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B0DEB42860>]}
[0m15:26:05.706511 [debug] [MainThread]: Flushing usage events
[0m15:28:40.223571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9ACCF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF077FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF077EB0>]}


============================== 15:28:40.223571 | f1957f9c-3d09-468b-aae0-1d3e84062773 ==============================
[0m15:28:40.223571 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:28:40.239858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:28:40.377324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF077F10>]}
[0m15:28:40.391860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF190CA0>]}
[0m15:28:40.409471 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:28:40.534251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:40.534251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:40.550762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF62A320>]}
[0m15:28:40.577490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF32B310>]}
[0m15:28:40.577490 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:28:40.581508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF32B4C0>]}
[0m15:28:40.597126 [info ] [MainThread]: 
[0m15:28:40.598159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:28:40.607088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:28:40.622621 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:28:40.630627 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:28:40.630627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:40.725993 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:28:40.729509 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:28:40.737775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:28:40.753937 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:28:40.757534 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:28:40.758247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:40.853857 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:28:40.853857 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:28:40.853857 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:28:40.872127 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m15:28:40.874150 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:28:40.878162 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:28:40.890284 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:40.890284 [debug] [MainThread]: On master: BEGIN
[0m15:28:40.890284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:40.946657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:28:40.946657 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:40.946657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:28:40.993609 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:28:40.993609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF65E5F0>]}
[0m15:28:40.993609 [debug] [MainThread]: On master: ROLLBACK
[0m15:28:40.993609 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:40.993609 [debug] [MainThread]: On master: BEGIN
[0m15:28:40.993609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:28:40.993609 [debug] [MainThread]: On master: COMMIT
[0m15:28:40.993609 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:40.993609 [debug] [MainThread]: On master: COMMIT
[0m15:28:40.993609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:41.009239 [debug] [MainThread]: On master: Close
[0m15:28:41.009239 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:28:41.013870 [info ] [MainThread]: 
[0m15:28:41.025794 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m15:28:41.025794 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:28:41.033814 [info ] [Thread-1 (]: 1 of 9 START sql table model public.dim_date ................................... [RUN]
[0m15:28:41.042431 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m15:28:41.033814 [info ] [Thread-2 (]: 2 of 9 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:28:41.042431 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m15:28:41.050234 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:28:41.058246 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m15:28:41.058246 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:28:41.067059 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:28:41.074580 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 15:28:41.050234 => 15:28:41.067059
[0m15:28:41.077188 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:28:41.058246 => 15:28:41.076364
[0m15:28:41.078208 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m15:28:41.078208 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:28:41.211256 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:28:41.211256 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m15:28:41.224129 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:28:41.224129 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:28:41.227148 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:28:41.227148 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:28:41.229471 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m15:28:41.229471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:41.307031 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:41.307031 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:28:41.307031 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,
product1,
product2
from source
  );
  
[0m15:28:41.314307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:41.314307 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:28:41.314307 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with final as
(
SELECT t.date::date 
FROM   generate_series(timestamp '2022-01-01'
                     , timestamp '2023-01-01'
                     , interval  '1 day') AS t(date)
)
select 
date as full_date,
EXTRACT(day from date) as year_day,
TO_CHAR(date, 'MON')  as month_name,
EXTRACT(week from date) as year_week
from final
  );
  
[0m15:28:41.322826 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:28:41.324505 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:28:41.334379 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:28:41.334379 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m15:28:41.338837 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:28:41.338837 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.338837 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m15:28:41.338837 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:28:41.338837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.338837 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:28:41.354489 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:28:41.354489 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:28:41.361146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.385913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.409000 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:28:41.409000 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:28:41.417025 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:28:41.417025 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:28:41.421568 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:28:41.421568 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:28:41.427350 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:41.427350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:41.434010 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:28:41.450954 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:28:41.450954 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:28:41.450954 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m15:28:41.466558 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:28:41.469393 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:28:41.115664 => 15:28:41.469393
[0m15:28:41.469393 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:28:41.469393 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:28:41.483891 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 15:28:41.078208 => 15:28:41.480925
[0m15:28:41.483891 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF7047F0>]}
[0m15:28:41.483891 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m15:28:41.496971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF704C40>]}
[0m15:28:41.493615 [info ] [Thread-2 (]: 2 of 9 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.43s]
[0m15:28:41.502376 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.45s]
[0m15:28:41.522143 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m15:28:41.518614 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:28:41.522143 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m15:28:41.522143 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:28:41.530177 [info ] [Thread-1 (]: 3 of 9 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:28:41.530177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m15:28:41.530177 [info ] [Thread-2 (]: 4 of 9 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:28:41.538403 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:28:41.538403 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:28:41.553388 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:28:41.554915 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:28:41.563853 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:28:41.566759 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:28:41.538403 => 15:28:41.566759
[0m15:28:41.566759 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:28:41.558087 => 15:28:41.566759
[0m15:28:41.571282 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m15:28:41.571282 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:28:41.588734 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:28:41.593779 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:28:41.600296 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:28:41.604006 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:28:41.607751 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:28:41.608767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:28:41.608767 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:28:41.612514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:41.687435 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:41.687435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:41.687435 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:28:41.687435 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:28:41.695457 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
SPLIT_PART(product_type,'-',2) as plan
from final
  );
  
[0m15:28:41.695457 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan
from source
  );
  
[0m15:28:41.718275 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:28:41.718275 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:28:41.722790 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:28:41.730812 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:28:41.730812 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:28:41.730812 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:28:41.730812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.746820 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.738812 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:28:41.750022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:28:41.755036 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:28:41.756138 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:28:41.756138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.759709 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:41.763232 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:28:41.763232 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:28:41.771254 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:28:41.771254 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:28:41.771254 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:28:41.771254 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:28:41.779296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:41.779296 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:28:41.787316 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:41.787850 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:28:41.787850 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:28:41.795367 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:28:41.803093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:28:41.805203 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:28:41.571282 => 15:28:41.805203
[0m15:28:41.805203 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:28:41.805203 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m15:28:41.811789 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:28:41.588734 => 15:28:41.811789
[0m15:28:41.811789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF784070>]}
[0m15:28:41.811789 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:28:41.811789 [info ] [Thread-1 (]: 3 of 9 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.28s]
[0m15:28:41.819307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF72BA30>]}
[0m15:28:41.819307 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m15:28:41.819307 [info ] [Thread-2 (]: 4 of 9 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.28s]
[0m15:28:41.827331 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:28:41.827331 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m15:28:41.827331 [debug] [Thread-2 (]: Began running node model.instagrid.test
[0m15:28:41.835356 [info ] [Thread-1 (]: 5 of 9 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:28:41.835356 [info ] [Thread-2 (]: 6 of 9 START sql view model public.test ........................................ [RUN]
[0m15:28:41.840146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:28:41.840146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.test)
[0m15:28:41.843664 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:28:41.843664 [debug] [Thread-2 (]: Began compiling node model.instagrid.test
[0m15:28:41.851687 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:28:41.860196 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.test"
[0m15:28:41.860196 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:28:41.843664 => 15:28:41.860196
[0m15:28:41.868221 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m15:28:41.868221 [debug] [Thread-2 (]: Timing info for model.instagrid.test (compile): 15:28:41.851687 => 15:28:41.868221
[0m15:28:41.881647 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:28:41.882636 [debug] [Thread-2 (]: Began executing node model.instagrid.test
[0m15:28:41.891499 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:28:41.933037 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:28:41.941129 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.test"
[0m15:28:41.941129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:41.941129 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.test"
[0m15:28:41.941129 [debug] [Thread-2 (]: On model.instagrid.test: BEGIN
[0m15:28:41.949150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:28:42.021471 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:42.021471 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.test"
[0m15:28:42.021471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:42.021471 [debug] [Thread-2 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */

  create view "instagrid"."public"."test__dbt_tmp"
    
    
  as (
    select 
cast(date as date) as date,
year_week,
month_name,
cast(product_type as varchar(50)) as product_type,
cast(plan as integer) as plan 
from

"instagrid"."public"."dim_manufactured_units"
  );
[0m15:28:42.021471 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:28:42.027982 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select week,pn,plan,month_name
from 
"instagrid"."public"."dim_date" as dim_date
left join "instagrid"."public"."sg_production_plan" as prodplan
on cast(replace(week,'W','') as integer)=dim_date.year_week
),
cte as
(
select distinct week,pn,plan,month_name
from final

)

select week,pn,plan,month_name, sum(plan) over(partition by month_name,pn) as monthy_production_planned
from cte
  );
  
[0m15:28:42.035359 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:28:42.039011 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.test"
[0m15:28:42.039011 [debug] [Thread-2 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
alter table "instagrid"."public"."test__dbt_tmp" rename to "test"
[0m15:28:42.044020 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:42.044020 [debug] [Thread-2 (]: On model.instagrid.test: COMMIT
[0m15:28:42.050560 [debug] [Thread-1 (]: SQL status: SELECT 126 in 0.0 seconds
[0m15:28:42.050560 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.test"
[0m15:28:42.050560 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:28:42.050560 [debug] [Thread-2 (]: On model.instagrid.test: COMMIT
[0m15:28:42.060723 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:28:42.060723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:42.060723 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:42.067293 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:28:42.075820 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.test"
[0m15:28:42.075820 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:28:42.078342 [debug] [Thread-2 (]: On model.instagrid.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.test"} */
drop view if exists "instagrid"."public"."test__dbt_backup" cascade
[0m15:28:42.078342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:42.078342 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:28:42.078342 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:28:42.078342 [debug] [Thread-2 (]: Timing info for model.instagrid.test (execute): 15:28:41.893019 => 15:28:42.078342
[0m15:28:42.078342 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:28:42.093360 [debug] [Thread-2 (]: On model.instagrid.test: Close
[0m15:28:42.096639 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:28:42.096639 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF7B2AA0>]}
[0m15:28:42.101442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:42.101442 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.test ................................... [[32mCREATE VIEW[0m in 0.26s]
[0m15:28:42.111172 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:28:42.111172 [debug] [Thread-2 (]: Finished running node model.instagrid.test
[0m15:28:42.117383 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:28:42.122901 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:28:42.122901 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:28:41.868221 => 15:28:42.122901
[0m15:28:42.130937 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m15:28:42.132920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF7A3790>]}
[0m15:28:42.136307 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.dim_production_plan ................... [[32mSELECT 126[0m in 0.30s]
[0m15:28:42.139081 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m15:28:42.139081 [debug] [Thread-2 (]: Began running node model.instagrid.obt_manufactured_units_permonth
[0m15:28:42.139081 [debug] [Thread-1 (]: Began running node model.instagrid.obt_manufactured_units_perweek
[0m15:28:42.139081 [info ] [Thread-2 (]: 7 of 9 START sql view model public.obt_manufactured_units_permonth ............. [RUN]
[0m15:28:42.147104 [info ] [Thread-1 (]: 8 of 9 START sql view model public.obt_manufactured_units_perweek .............. [RUN]
[0m15:28:42.155106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt_manufactured_units_perweek)
[0m15:28:42.155106 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt_manufactured_units_perweek
[0m15:28:42.155106 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.147104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.test, now model.instagrid.obt_manufactured_units_permonth)
[0m15:28:42.171131 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt_manufactured_units_permonth
[0m15:28:42.163107 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (compile): 15:28:42.155106 => 15:28:42.163107
[0m15:28:42.178655 [debug] [Thread-1 (]: Began executing node model.instagrid.obt_manufactured_units_perweek
[0m15:28:42.178655 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.191838 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.195357 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (compile): 15:28:42.171131 => 15:28:42.195357
[0m15:28:42.195357 [debug] [Thread-2 (]: Began executing node model.instagrid.obt_manufactured_units_permonth
[0m15:28:42.203395 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.211875 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.217270 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: BEGIN
[0m15:28:42.221098 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.221098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:42.221098 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: BEGIN
[0m15:28:42.228623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:28:42.309788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:42.309788 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.309788 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */

  create view "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select date,month_name,product_type,sum(cast(plan as integer)) over(partition by month_name,product_type) as monthly_manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
),

cte as

(
select  distinct production_plan.month_name as month_name,date,product_type,coalesce(monthly_manufactured_units,0) as monthly_manufactured_units,
monthy_production_planned
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on
 production_plan.pn=manufactured_units.product_type
 and manufactured_units.month_name=production_plan.month_name
)

select distinct month_name,product_type,monthly_manufactured_units,monthy_production_planned
from cte
  );
[0m15:28:42.326192 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:28:42.326192 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.332304 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
alter table "instagrid"."public"."obt_manufactured_units_permonth__dbt_tmp" rename to "obt_manufactured_units_permonth"
[0m15:28:42.332304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:42.332304 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.332304 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:42.332304 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */

  create view "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp"
    
    
  as (
    with manufactured_units as
(
select year_week,product_type,sum(cast(plan as integer)) as manufactured_units
from "instagrid"."public"."dim_manufactured_units" as manufactured_units
group by year_week,product_type

)

select production_plan.week,product_type,coalesce(manufactured_units,0) as manufactured_units ,plan as production_plan
,sum(manufactured_units) over(partition by product_type order by cast(replace(week,'W','') as integer)) as weekly_manufactured_runningtotal
from manufactured_units
right join
 "instagrid"."public"."dim_production_plan" as production_plan
 on production_plan.week=manufactured_units.year_week and 
 production_plan.pn=manufactured_units.product_type
  );
[0m15:28:42.340322 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m15:28:42.340322 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.340322 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: COMMIT
[0m15:28:42.340322 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:42.351427 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt_manufactured_units_permonth"
[0m15:28:42.351427 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:28:42.356443 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_permonth"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_permonth__dbt_backup" cascade
[0m15:28:42.356443 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.356443 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:28:42.356443 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
alter table "instagrid"."public"."obt_manufactured_units_perweek__dbt_tmp" rename to "obt_manufactured_units_perweek"
[0m15:28:42.356443 [debug] [Thread-2 (]: Timing info for model.instagrid.obt_manufactured_units_permonth (execute): 15:28:42.203395 => 15:28:42.356443
[0m15:28:42.356443 [debug] [Thread-2 (]: On model.instagrid.obt_manufactured_units_permonth: Close
[0m15:28:42.356443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:42.356443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AFA0C0A0>]}
[0m15:28:42.373856 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m15:28:42.378783 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.381232 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: COMMIT
[0m15:28:42.377767 [info ] [Thread-2 (]: 7 of 9 OK created sql view model public.obt_manufactured_units_permonth ........ [[32mCREATE VIEW[0m in 0.21s]
[0m15:28:42.384282 [debug] [Thread-2 (]: Finished running node model.instagrid.obt_manufactured_units_permonth
[0m15:28:42.384282 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:42.387156 [debug] [Thread-2 (]: Began running node model.instagrid.testprod
[0m15:28:42.394160 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt_manufactured_units_perweek"
[0m15:28:42.394160 [info ] [Thread-2 (]: 9 of 9 START sql view model public.testprod .................................... [RUN]
[0m15:28:42.399551 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt_manufactured_units_perweek"} */
drop view if exists "instagrid"."public"."obt_manufactured_units_perweek__dbt_backup" cascade
[0m15:28:42.402332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.obt_manufactured_units_permonth, now model.instagrid.testprod)
[0m15:28:42.402332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:28:42.406861 [debug] [Thread-2 (]: Began compiling node model.instagrid.testprod
[0m15:28:42.406861 [debug] [Thread-1 (]: Timing info for model.instagrid.obt_manufactured_units_perweek (execute): 15:28:42.178655 => 15:28:42.406861
[0m15:28:42.415793 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.testprod"
[0m15:28:42.417227 [debug] [Thread-1 (]: On model.instagrid.obt_manufactured_units_perweek: Close
[0m15:28:42.423250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AFA038B0>]}
[0m15:28:42.423250 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (compile): 15:28:42.406861 => 15:28:42.423250
[0m15:28:42.423250 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.obt_manufactured_units_perweek ......... [[32mCREATE VIEW[0m in 0.28s]
[0m15:28:42.431268 [debug] [Thread-1 (]: Finished running node model.instagrid.obt_manufactured_units_perweek
[0m15:28:42.423250 [debug] [Thread-2 (]: Began executing node model.instagrid.testprod
[0m15:28:42.447353 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.testprod"
[0m15:28:42.458221 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:28:42.458221 [debug] [Thread-2 (]: On model.instagrid.testprod: BEGIN
[0m15:28:42.458221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:28:42.520905 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:28:42.520905 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:28:42.520905 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */

  create view "instagrid"."public"."testprod__dbt_tmp"
    
    
  as (
    select full_date,plan,pn,monthy_production_planned
from
"instagrid"."public"."dim_production_plan" as prodplan
join "instagrid"."public"."dim_date" as dimdate
on prodplan.month_name=dimdate.month_name
  );
[0m15:28:42.533362 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:28:42.544889 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:28:42.544889 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
alter table "instagrid"."public"."testprod__dbt_tmp" rename to "testprod"
[0m15:28:42.544889 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:28:42.560587 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m15:28:42.560587 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:28:42.567086 [debug] [Thread-2 (]: On model.instagrid.testprod: COMMIT
[0m15:28:42.567086 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:28:42.576615 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.testprod"
[0m15:28:42.579135 [debug] [Thread-2 (]: On model.instagrid.testprod: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.testprod"} */
drop view if exists "instagrid"."public"."testprod__dbt_backup" cascade
[0m15:28:42.579135 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:28:42.585647 [debug] [Thread-2 (]: Timing info for model.instagrid.testprod (execute): 15:28:42.439306 => 15:28:42.585647
[0m15:28:42.585647 [debug] [Thread-2 (]: On model.instagrid.testprod: Close
[0m15:28:42.592669 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1957f9c-3d09-468b-aae0-1d3e84062773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF718EB0>]}
[0m15:28:42.592669 [info ] [Thread-2 (]: 9 of 9 OK created sql view model public.testprod ............................... [[32mCREATE VIEW[0m in 0.19s]
[0m15:28:42.600102 [debug] [Thread-2 (]: Finished running node model.instagrid.testprod
[0m15:28:42.609972 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:42.609972 [debug] [MainThread]: On master: BEGIN
[0m15:28:42.609972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:42.707110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:28:42.707110 [debug] [MainThread]: On master: COMMIT
[0m15:28:42.714630 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:42.714630 [debug] [MainThread]: On master: COMMIT
[0m15:28:42.714630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:28:42.722657 [debug] [MainThread]: On master: Close
[0m15:28:42.727535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:42.727535 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:28:42.731054 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:28:42.731054 [debug] [MainThread]: Connection 'model.instagrid.obt_manufactured_units_perweek' was properly closed.
[0m15:28:42.731054 [debug] [MainThread]: Connection 'model.instagrid.testprod' was properly closed.
[0m15:28:42.731054 [info ] [MainThread]: 
[0m15:28:42.739075 [info ] [MainThread]: Finished running 5 table models, 4 view models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m15:28:42.783743 [debug] [MainThread]: Command end result
[0m15:28:42.814976 [info ] [MainThread]: 
[0m15:28:42.820892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:42.829287 [info ] [MainThread]: 
[0m15:28:42.829287 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:28:42.837695 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:42.837695 after 2.66 seconds
[0m15:28:42.837695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9ACCF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF190CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AF32B340>]}
[0m15:28:42.845715 [debug] [MainThread]: Flushing usage events
[0m18:04:56.333636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A7F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93CB57E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93CB57D00>]}


============================== 18:04:56.345655 | f5e4972f-c810-4d6f-a246-19a2c5019e3f ==============================
[0m18:04:56.345655 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:04:56.345655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:04:56.350890 [info ] [MainThread]: dbt version: 1.5.1
[0m18:04:56.353101 [info ] [MainThread]: python version: 3.10.11
[0m18:04:56.356444 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m18:04:56.360952 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m18:04:56.365124 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m18:04:56.365124 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m18:04:56.371233 [info ] [MainThread]: Configuration:
[0m18:04:56.533541 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:04:56.581555 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:04:56.581555 [info ] [MainThread]: Required dependencies:
[0m18:04:56.581555 [debug] [MainThread]: Executing "git --help"
[0m18:04:56.689512 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:04:56.697081 [debug] [MainThread]: STDERR: "b''"
[0m18:04:56.697081 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:04:56.697081 [info ] [MainThread]: Connection:
[0m18:04:56.705219 [info ] [MainThread]:   host: localhost
[0m18:04:56.706205 [info ] [MainThread]:   port: 5435
[0m18:04:56.706205 [info ] [MainThread]:   user: postgres
[0m18:04:56.713232 [info ] [MainThread]:   database: instagrid
[0m18:04:56.716078 [info ] [MainThread]:   schema: public
[0m18:04:56.716078 [info ] [MainThread]:   search_path: None
[0m18:04:56.726165 [info ] [MainThread]:   keepalives_idle: 0
[0m18:04:56.729626 [info ] [MainThread]:   sslmode: None
[0m18:04:56.729626 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:04:56.729626 [debug] [MainThread]: Using postgres connection "debug"
[0m18:04:56.729626 [debug] [MainThread]: On debug: select 1 as id
[0m18:04:56.729626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:56.827649 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:04:56.827649 [debug] [MainThread]: On debug: Close
[0m18:04:56.835640 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:04:56.840907 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:04:56.849215 [debug] [MainThread]: Command `dbt debug` succeeded at 18:04:56.843939 after 0.58 seconds
[0m18:04:56.850860 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:04:56.852397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A7F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93B091840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93CC64A30>]}
[0m18:04:56.852397 [debug] [MainThread]: Flushing usage events
[0m20:28:03.817028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD64F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD885BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD885BCA0>]}


============================== 20:28:03.817028 | 456df74a-e2d6-4539-b5ac-6e1842f5c460 ==============================
[0m20:28:03.817028 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:03.817028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:03.830040 [info ] [MainThread]: dbt version: 1.5.1
[0m20:28:03.831431 [info ] [MainThread]: python version: 3.10.11
[0m20:28:03.831431 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m20:28:03.831431 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m20:28:03.847674 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m20:28:03.872087 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m20:28:03.879143 [info ] [MainThread]: Configuration:
[0m20:28:04.002096 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:28:04.055590 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:28:04.055590 [info ] [MainThread]: Required dependencies:
[0m20:28:04.063619 [debug] [MainThread]: Executing "git --help"
[0m20:28:04.179982 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:28:04.179982 [debug] [MainThread]: STDERR: "b''"
[0m20:28:04.179982 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:28:04.189363 [info ] [MainThread]: Connection:
[0m20:28:04.192489 [info ] [MainThread]:   host: localhost
[0m20:28:04.200390 [info ] [MainThread]:   port: 5435
[0m20:28:04.204220 [info ] [MainThread]:   user: postgres
[0m20:28:04.208120 [info ] [MainThread]:   database: instagrid
[0m20:28:04.213082 [info ] [MainThread]:   schema: public
[0m20:28:04.216846 [info ] [MainThread]:   search_path: None
[0m20:28:04.222393 [info ] [MainThread]:   keepalives_idle: 0
[0m20:28:04.230866 [info ] [MainThread]:   sslmode: None
[0m20:28:04.241126 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:28:04.248047 [debug] [MainThread]: Using postgres connection "debug"
[0m20:28:04.251665 [debug] [MainThread]: On debug: select 1 as id
[0m20:28:04.255191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:04.352360 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:28:04.354887 [debug] [MainThread]: On debug: Close
[0m20:28:04.354887 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:28:04.360995 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:28:04.367617 [debug] [MainThread]: Command `dbt debug` succeeded at 20:28:04.366046 after 0.59 seconds
[0m20:28:04.369706 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:28:04.370728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD64F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD691C220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011DD89649A0>]}
[0m20:28:04.370728 [debug] [MainThread]: Flushing usage events
[0m15:11:30.775811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198147F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019816B57F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019816B57D30>]}


============================== 15:11:30.821171 | 75b48953-bf5e-4753-b26d-6a8d883803e8 ==============================
[0m15:11:30.821171 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:11:30.825692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:11:30.832597 [info ] [MainThread]: dbt version: 1.5.1
[0m15:11:30.835012 [info ] [MainThread]: python version: 3.10.11
[0m15:11:30.842539 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m15:11:30.842539 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:11:30.851598 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m15:11:30.860032 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m15:11:30.867092 [info ] [MainThread]: Configuration:
[0m15:11:31.335785 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:11:31.456866 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:11:31.464864 [info ] [MainThread]: Required dependencies:
[0m15:11:31.471379 [debug] [MainThread]: Executing "git --help"
[0m15:11:31.612547 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:11:31.612547 [debug] [MainThread]: STDERR: "b''"
[0m15:11:31.618114 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:11:31.623915 [info ] [MainThread]: Connection:
[0m15:11:31.630296 [info ] [MainThread]:   host: localhost
[0m15:11:31.634883 [info ] [MainThread]:   port: 5435
[0m15:11:31.645685 [info ] [MainThread]:   user: postgres
[0m15:11:31.653724 [info ] [MainThread]:   database: instagrid
[0m15:11:31.661718 [info ] [MainThread]:   schema: public
[0m15:11:31.674162 [info ] [MainThread]:   search_path: None
[0m15:11:31.678184 [info ] [MainThread]:   keepalives_idle: 0
[0m15:11:31.678184 [info ] [MainThread]:   sslmode: None
[0m15:11:31.694487 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:11:31.707481 [debug] [MainThread]: Using postgres connection "debug"
[0m15:11:31.711007 [debug] [MainThread]: On debug: select 1 as id
[0m15:11:31.711007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:31.850402 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:11:31.851469 [debug] [MainThread]: On debug: Close
[0m15:11:31.858143 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:11:31.866201 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:11:31.872089 [debug] [MainThread]: Command `dbt debug` succeeded at 15:11:31.872089 after 1.38 seconds
[0m15:11:31.874611 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:11:31.877851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198147F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019815093DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019816C62A70>]}
[0m15:11:31.879363 [debug] [MainThread]: Flushing usage events
[0m15:11:43.024930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53D1F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53F557FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53F557E50>]}


============================== 15:11:43.037472 | ab793c77-a772-454f-b958-54eb61abe63f ==============================
[0m15:11:43.037472 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:11:43.037472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:11:43.203835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab793c77-a772-454f-b958-54eb61abe63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53F557F10>]}
[0m15:11:43.230146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab793c77-a772-454f-b958-54eb61abe63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53F664B20>]}
[0m15:11:43.260233 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:11:43.420450 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 1 files added, 0 files changed.
[0m15:11:43.420450 [debug] [MainThread]: Partial parsing: added file: instagrid://models\Analystics-OBT\obt.sql
[0m15:11:43.420450 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m15:11:43.420450 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\warehouse\dim_date.sql
[0m15:11:43.420450 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\warehouse\dim_new.sql
[0m15:11:43.420450 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\testprod.sql
[0m15:11:43.428462 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\test.sql
[0m15:11:43.428462 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m15:11:43.468789 [debug] [MainThread]: 1699: static parser successfully parsed Analystics-OBT\obt.sql
[0m15:11:43.524742 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_production_plan.sql
[0m15:11:43.538276 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instagrid.dim_production_plan' (models\warehouse\dim_production_plan.sql) depends on a node named 'dim_date' which was not found
[0m15:11:43.543055 [debug] [MainThread]: Command `dbt run` failed at 15:11:43.543055 after 0.55 seconds
[0m15:11:43.543055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53D1F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53FA09540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F53FA094E0>]}
[0m15:11:43.549082 [debug] [MainThread]: Flushing usage events
[0m15:14:10.668312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8F4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B9185BF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B9185BE20>]}


============================== 15:14:10.670352 | 5af456ec-9def-4082-8c2a-f047b1b98236 ==============================
[0m15:14:10.670352 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:14:10.670352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:10.808735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af456ec-9def-4082-8c2a-f047b1b98236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B9185BEE0>]}
[0m15:14:10.825176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af456ec-9def-4082-8c2a-f047b1b98236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B91965810>]}
[0m15:14:10.841164 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:14:10.957141 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 1 files added, 0 files changed.
[0m15:14:10.962176 [debug] [MainThread]: Partial parsing: added file: instagrid://models\Analystics-OBT\obt.sql
[0m15:14:10.962176 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\warehouse\dim_date.sql
[0m15:14:10.962176 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\warehouse\dim_new.sql
[0m15:14:10.962176 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\test.sql
[0m15:14:10.970253 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\obt_manufactured_units_permonth.sql
[0m15:14:10.970253 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\testprod.sql
[0m15:14:10.970253 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\obt_manufactured_units_perweek.sql
[0m15:14:11.003157 [debug] [MainThread]: 1699: static parser successfully parsed Analystics-OBT\obt.sql
[0m15:14:11.027127 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_production_plan.sql
[0m15:14:11.035636 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.instagrid.dim_production_plan' (models\warehouse\dim_production_plan.sql) depends on a node named 'dim_date' which was not found
[0m15:14:11.040139 [debug] [MainThread]: Command `dbt run` failed at 15:14:11.040139 after 0.41 seconds
[0m15:14:11.047131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B8F4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B91D09510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B91D094B0>]}
[0m15:14:11.052151 [debug] [MainThread]: Flushing usage events
[0m15:14:43.893925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603ECF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041057FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041057E80>]}


============================== 15:14:43.910069 | 65157776-4f1b-418d-a37d-f903d87fdd4e ==============================
[0m15:14:43.910069 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:14:43.914115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:14:44.112639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041057F40>]}
[0m15:14:44.144705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041161FC0>]}
[0m15:14:44.176736 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:14:44.345198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:44.353221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:44.361240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041510EB0>]}
[0m15:14:44.377249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041451E10>]}
[0m15:14:44.385219 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:14:44.388644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041451F90>]}
[0m15:14:44.397032 [info ] [MainThread]: 
[0m15:14:44.402478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:44.409602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:14:44.448237 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:14:44.451079 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:14:44.451079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:44.531192 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:14:44.540289 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:14:44.549072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:14:44.566091 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:14:44.568083 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:14:44.569761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:44.629009 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:14:44.629009 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:14:44.629009 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:14:44.661360 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m15:14:44.670144 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:14:44.670144 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:14:44.679978 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:44.685987 [debug] [MainThread]: On master: BEGIN
[0m15:14:44.685987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:44.751511 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:44.751511 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:44.751511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:44.784094 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:14:44.793458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604155D570>]}
[0m15:14:44.793458 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:44.795962 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:44.797694 [debug] [MainThread]: On master: BEGIN
[0m15:14:44.799218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:44.800229 [debug] [MainThread]: On master: COMMIT
[0m15:14:44.801617 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:44.801617 [debug] [MainThread]: On master: COMMIT
[0m15:14:44.804180 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:44.805191 [debug] [MainThread]: On master: Close
[0m15:14:44.805191 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:14:44.832066 [info ] [MainThread]: 
[0m15:14:44.859335 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:14:44.859335 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:14:44.859335 [info ] [Thread-1 (]: 1 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:14:44.874684 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:14:44.874684 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:14:44.866561 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:14:44.882103 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:14:44.882103 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:14:44.892296 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:14:44.892296 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:14:44.874684 => 15:14:44.892296
[0m15:14:44.897841 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:14:44.906067 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:14:44.938851 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:14:44.892296 => 15:14:44.938851
[0m15:14:44.946880 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:14:45.077793 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:14:45.069512 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:14:45.083456 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:14:45.085967 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:14:45.085967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:45.085967 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:14:45.085967 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:14:45.118797 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:14:45.197826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:45.197826 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:45.197826 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:14:45.201498 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:14:45.201498 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:14:45.204380 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:14:45.249600 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:14:45.267447 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:14:45.267447 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:14:45.267447 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:14:45.274114 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:14:45.281070 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:14:45.282583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.286032 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:14:45.286032 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.291553 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:14:45.298323 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:14:45.299347 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:14:45.299347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.307403 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.339745 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:14:45.347793 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:14:45.347793 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:14:45.350691 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:14:45.350691 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:14:45.350691 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:14:45.359327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:45.364267 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:14:45.364267 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:45.372287 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:14:45.376682 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:14:45.380711 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:14:45.396804 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:45.396804 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:14:44.910688 => 15:14:45.396804
[0m15:14:45.396804 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:45.402056 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:14:45.405580 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:14:44.946880 => 15:14:45.402056
[0m15:14:45.405580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260418235E0>]}
[0m15:14:45.408719 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:14:45.408719 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.53s]
[0m15:14:45.411944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260418226B0>]}
[0m15:14:45.415211 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:14:45.415211 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.53s]
[0m15:14:45.415211 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:14:45.422225 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:14:45.422225 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:14:45.430263 [info ] [Thread-1 (]: 3 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:14:45.430263 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:14:45.430263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:14:45.438602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:14:45.438602 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:14:45.440420 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:14:45.449549 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:14:45.455060 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:14:45.457610 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:14:45.442908 => 15:14:45.457610
[0m15:14:45.463302 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:14:45.466672 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:14:45.449549 => 15:14:45.465840
[0m15:14:45.479968 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:14:45.482567 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:14:45.487599 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:14:45.487599 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:14:45.495709 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:14:45.495709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:45.498367 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:14:45.501175 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:14:45.501175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:14:45.561794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:45.561794 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:14:45.569301 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan
from final
  );
  
[0m15:14:45.577638 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:45.577638 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:14:45.577638 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:14:45.594258 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:14:45.599112 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:14:45.602133 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:14:45.603666 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:14:45.605544 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:14:45.610571 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:14:45.613083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.619034 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:14:45.619034 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.619034 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:14:45.619034 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:14:45.626433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.619034 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:14:45.629883 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:14:45.629883 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:14:45.629883 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.635337 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:14:45.637472 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:14:45.642745 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:14:45.643758 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:14:45.643758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:45.652966 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:14:45.654564 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:45.654564 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:14:45.660435 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:14:45.660435 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:14:45.677039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:45.677039 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:14:45.467429 => 15:14:45.677039
[0m15:14:45.677039 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:45.682669 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:14:45.685187 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:14:45.482567 => 15:14:45.685187
[0m15:14:45.685187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041879ED0>]}
[0m15:14:45.689392 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:14:45.692566 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.25s]
[0m15:14:45.694130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604188D300>]}
[0m15:14:45.694130 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:14:45.694130 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.26s]
[0m15:14:45.701648 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:14:45.709781 [debug] [Thread-1 (]: Began running node model.instagrid.obt
[0m15:14:45.709781 [info ] [Thread-1 (]: 5 of 5 START sql table model public.obt ........................................ [RUN]
[0m15:14:45.717895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt)
[0m15:14:45.717895 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt
[0m15:14:45.726043 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt"
[0m15:14:45.726043 [debug] [Thread-1 (]: Timing info for model.instagrid.obt (compile): 15:14:45.717895 => 15:14:45.726043
[0m15:14:45.731972 [debug] [Thread-1 (]: Began executing node model.instagrid.obt
[0m15:14:45.747722 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt"
[0m15:14:45.751239 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:14:45.751239 [debug] [Thread-1 (]: On model.instagrid.obt: BEGIN
[0m15:14:45.755676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:45.816737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:14:45.816737 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:14:45.816737 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */

  
    

  create  table "instagrid"."public"."obt__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,p.plan as plan,m.plan as dailymanufactured,week,pn 
from "instagrid"."public"."sg_production_plan" as p
left join  "instagrid"."public"."dim_manufactured_units"  as m
on 
concat('W',EXTRACT(week from date) )= week 
and 
m.product_type=p.pn

)


select distinct date,plan as weeklyplanned,week,pn,plan/7 as dailyplanned,dailymanufactured
from final
where week='W1'
  );
  
[0m15:14:45.841243 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m15:14:45.849281 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:14:45.849281 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt__dbt_tmp" rename to "obt"
[0m15:14:45.849281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:14:45.860301 [debug] [Thread-1 (]: On model.instagrid.obt: COMMIT
[0m15:14:45.860301 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:14:45.860301 [debug] [Thread-1 (]: On model.instagrid.obt: COMMIT
[0m15:14:45.866005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:14:45.866005 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:14:45.866005 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
drop table if exists "instagrid"."public"."obt__dbt_backup" cascade
[0m15:14:45.873524 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:14:45.875949 [debug] [Thread-1 (]: Timing info for model.instagrid.obt (execute): 15:14:45.734484 => 15:14:45.875949
[0m15:14:45.875949 [debug] [Thread-1 (]: On model.instagrid.obt: Close
[0m15:14:45.881960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65157776-4f1b-418d-a37d-f903d87fdd4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260418180A0>]}
[0m15:14:45.881960 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.obt ................................... [[32mSELECT 14[0m in 0.17s]
[0m15:14:45.885143 [debug] [Thread-1 (]: Finished running node model.instagrid.obt
[0m15:14:45.890338 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:45.898395 [debug] [MainThread]: On master: BEGIN
[0m15:14:45.901436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:45.971553 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:14:45.971553 [debug] [MainThread]: On master: COMMIT
[0m15:14:45.971553 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:45.971553 [debug] [MainThread]: On master: COMMIT
[0m15:14:45.979545 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:14:45.979545 [debug] [MainThread]: On master: Close
[0m15:14:45.979545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:45.979545 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:14:45.987547 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:14:45.988883 [debug] [MainThread]: Connection 'model.instagrid.obt' was properly closed.
[0m15:14:45.989449 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m15:14:45.989449 [info ] [MainThread]: 
[0m15:14:45.992211 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m15:14:45.998525 [debug] [MainThread]: Command end result
[0m15:14:46.016174 [info ] [MainThread]: 
[0m15:14:46.017371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:46.020889 [info ] [MainThread]: 
[0m15:14:46.024446 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:14:46.030343 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:46.029157 after 2.18 seconds
[0m15:14:46.030904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002603ECF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041161FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026041879ED0>]}
[0m15:14:46.030904 [debug] [MainThread]: Flushing usage events
[0m15:31:04.602201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA89F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAD57FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAD57E80>]}


============================== 15:31:04.633514 | 40056b83-941a-46a7-b4f1-5464d98aa369 ==============================
[0m15:31:04.633514 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:31:04.643233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:31:04.958161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAD57EE0>]}
[0m15:31:04.982254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAE65D50>]}
[0m15:31:05.014823 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:31:05.459430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:05.467461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:05.493747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAB210EB0>]}
[0m15:31:05.524387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAF4DE70>]}
[0m15:31:05.524387 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:31:05.530411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAF4E050>]}
[0m15:31:05.547951 [info ] [MainThread]: 
[0m15:31:05.548977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:05.571528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:31:05.623228 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:31:05.623228 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:31:05.623228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:05.726641 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:31:05.731690 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:31:05.745597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:31:05.753957 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:31:05.753957 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:31:05.753957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:05.843884 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:31:05.843884 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:31:05.847928 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:31:05.876459 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m15:31:05.884599 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:31:05.884599 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:31:05.909144 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:05.909144 [debug] [MainThread]: On master: BEGIN
[0m15:31:05.917164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:05.990982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:05.990982 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:05.990982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:06.056117 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:31:06.064151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAB25D570>]}
[0m15:31:06.067191 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:06.073021 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:06.073021 [debug] [MainThread]: On master: BEGIN
[0m15:31:06.073021 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:06.081988 [debug] [MainThread]: On master: COMMIT
[0m15:31:06.081988 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:06.089557 [debug] [MainThread]: On master: COMMIT
[0m15:31:06.102921 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:06.105435 [debug] [MainThread]: On master: Close
[0m15:31:06.105435 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:31:06.113476 [info ] [MainThread]: 
[0m15:31:06.163089 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:31:06.163089 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:31:06.167607 [info ] [Thread-1 (]: 1 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:31:06.173950 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:31:06.186360 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:31:06.187915 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:31:06.187915 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:31:06.187915 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:31:06.198502 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:31:06.220064 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:31:06.187915 => 15:31:06.216520
[0m15:31:06.220064 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:31:06.214149 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:31:06.236158 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:31:06.203639 => 15:31:06.236158
[0m15:31:06.246483 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:31:06.415459 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:31:06.407437 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:31:06.432175 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:31:06.432175 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:31:06.432175 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:31:06.442958 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:31:06.442958 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:31:06.442958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:06.538452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:06.538452 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:31:06.538452 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:31:06.559129 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:06.563173 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:31:06.563173 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:31:06.636668 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:31:06.652977 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:31:06.658544 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:31:06.669510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:06.677612 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:31:06.677612 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:31:06.690004 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:31:06.690004 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:31:06.690004 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:31:06.694571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:06.694571 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:06.746756 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:31:06.750119 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:31:06.754239 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:31:06.754239 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:31:06.757667 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:31:06.757667 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:06.765681 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:31:06.765681 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:31:06.765681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:06.768881 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:31:06.784593 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:31:06.786050 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:31:06.786050 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:06.798107 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:31:06.798107 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:31:06.822511 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:06.822511 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:31:06.220064 => 15:31:06.822511
[0m15:31:06.830540 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:06.832323 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:31:06.832323 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:31:06.247704 => 15:31:06.832323
[0m15:31:06.839926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAE7B700>]}
[0m15:31:06.842799 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:31:06.843985 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.67s]
[0m15:31:06.847830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAB32C1C0>]}
[0m15:31:06.847830 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:31:06.852263 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.67s]
[0m15:31:06.855228 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:31:06.865365 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:31:06.866709 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:31:06.866709 [info ] [Thread-1 (]: 3 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:31:06.869730 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:31:06.872961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:31:06.872961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:31:06.872961 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:31:06.872961 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:31:06.879972 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:31:06.889745 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:31:06.896477 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:31:06.879972 => 15:31:06.896477
[0m15:31:06.903142 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:31:06.904698 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:31:06.879972 => 15:31:06.903688
[0m15:31:06.918785 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:31:06.920126 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:31:06.929525 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:31:06.938696 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:31:06.938696 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:31:06.938696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:31:06.938696 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:31:06.946712 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:31:06.946712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:07.054772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:07.059455 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:31:07.060972 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan
from final
  );
  
[0m15:31:07.070628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:07.070628 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:31:07.070628 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:31:07.101490 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:31:07.113067 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:31:07.114625 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:31:07.117752 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:31:07.125858 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:31:07.129755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.129755 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:31:07.134269 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:31:07.134269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.140752 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:31:07.147836 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:31:07.150852 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:31:07.150852 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.158868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.150852 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:31:07.158868 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:31:07.166882 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:31:07.166882 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:31:07.169895 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:31:07.169895 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:31:07.191079 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:07.200451 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:31:07.200451 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:07.200451 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:31:07.208015 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:31:07.214672 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:31:07.223165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:07.223998 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:07.223998 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:31:06.921686 => 15:31:07.223998
[0m15:31:07.223998 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:31:06.905379 => 15:31:07.223998
[0m15:31:07.232012 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:31:07.232012 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:31:07.232012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAB342AA0>]}
[0m15:31:07.237131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAB38B850>]}
[0m15:31:07.240464 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.36s]
[0m15:31:07.242456 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.36s]
[0m15:31:07.245576 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:31:07.245576 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:31:07.251214 [debug] [Thread-1 (]: Began running node model.instagrid.obt
[0m15:31:07.251214 [info ] [Thread-1 (]: 5 of 5 START sql table model public.obt ........................................ [RUN]
[0m15:31:07.258932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.obt)
[0m15:31:07.265243 [debug] [Thread-1 (]: Began compiling node model.instagrid.obt
[0m15:31:07.274353 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.obt"
[0m15:31:07.288309 [debug] [Thread-1 (]: Timing info for model.instagrid.obt (compile): 15:31:07.269755 => 15:31:07.288309
[0m15:31:07.290683 [debug] [Thread-1 (]: Began executing node model.instagrid.obt
[0m15:31:07.304859 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.obt"
[0m15:31:07.314845 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:31:07.318381 [debug] [Thread-1 (]: On model.instagrid.obt: BEGIN
[0m15:31:07.319782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:07.389804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:31:07.390608 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:31:07.393399 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */

  
    

  create  table "instagrid"."public"."obt__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,p.plan as plan,m.plan as dailymanufactured,week,pn 
from "instagrid"."public"."sg_production_plan" as p
left join  "instagrid"."public"."dim_manufactured_units"  as m
on 
concat('W',EXTRACT(week from date) )= week 
and 
m.product_type=p.pn

)


select distinct date,plan as weeklyplanned,week,pn,plan/7 as dailyplanned,dailymanufactured
from final
where week='W1'
  );
  
[0m15:31:07.449659 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m15:31:07.460582 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:31:07.460582 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt" rename to "obt__dbt_backup"
[0m15:31:07.463992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.472017 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:31:07.472017 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt__dbt_tmp" rename to "obt"
[0m15:31:07.472017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.480030 [debug] [Thread-1 (]: On model.instagrid.obt: COMMIT
[0m15:31:07.480030 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:31:07.487000 [debug] [Thread-1 (]: On model.instagrid.obt: COMMIT
[0m15:31:07.488508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:07.496572 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.obt"
[0m15:31:07.497872 [debug] [Thread-1 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
drop table if exists "instagrid"."public"."obt__dbt_backup" cascade
[0m15:31:07.512925 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:07.520933 [debug] [Thread-1 (]: Timing info for model.instagrid.obt (execute): 15:31:07.292352 => 15:31:07.520933
[0m15:31:07.522759 [debug] [Thread-1 (]: On model.instagrid.obt: Close
[0m15:31:07.526511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40056b83-941a-46a7-b4f1-5464d98aa369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAB38B850>]}
[0m15:31:07.529020 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.obt ................................... [[32mSELECT 14[0m in 0.26s]
[0m15:31:07.532058 [debug] [Thread-1 (]: Finished running node model.instagrid.obt
[0m15:31:07.537501 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:07.537501 [debug] [MainThread]: On master: BEGIN
[0m15:31:07.537501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:07.644489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:07.644489 [debug] [MainThread]: On master: COMMIT
[0m15:31:07.644489 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:07.644489 [debug] [MainThread]: On master: COMMIT
[0m15:31:07.644489 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:07.652549 [debug] [MainThread]: On master: Close
[0m15:31:07.654347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:07.656537 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:31:07.656537 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:31:07.656537 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m15:31:07.660543 [debug] [MainThread]: Connection 'model.instagrid.obt' was properly closed.
[0m15:31:07.669851 [info ] [MainThread]: 
[0m15:31:07.678665 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m15:31:07.680230 [debug] [MainThread]: Command end result
[0m15:31:07.703245 [info ] [MainThread]: 
[0m15:31:07.711416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:07.727848 [info ] [MainThread]: 
[0m15:31:07.750045 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:31:07.762103 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:07.762103 after 3.28 seconds
[0m15:31:07.770008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA89F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAE65D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CAAF4DF30>]}
[0m15:31:07.775073 [debug] [MainThread]: Flushing usage events
[0m15:33:48.625497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F54F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F795BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F795BEB0>]}


============================== 15:33:48.635619 | 551a8157-59e4-410d-a178-9d83645fabe2 ==============================
[0m15:33:48.635619 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:33:48.647423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:33:48.847376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F795BF10>]}
[0m15:33:48.863443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7A64CA0>]}
[0m15:33:48.879899 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:33:49.170202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:49.170202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:49.178204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7E10EE0>]}
[0m15:33:49.202301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7B5DEA0>]}
[0m15:33:49.202301 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:33:49.210574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7B5E080>]}
[0m15:33:49.210574 [info ] [MainThread]: 
[0m15:33:49.218595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:49.226747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:33:49.267603 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:33:49.267603 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:33:49.267603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:49.340321 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:33:49.340321 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:33:49.351607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:33:49.364705 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:33:49.364705 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:33:49.364705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:49.461807 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:33:49.461807 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:33:49.461807 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:33:49.477935 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m15:33:49.485947 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:33:49.485947 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:33:49.496153 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:49.502162 [debug] [MainThread]: On master: BEGIN
[0m15:33:49.502162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:49.567795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:33:49.567795 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:49.575798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:49.631986 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:33:49.631986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7E5D5A0>]}
[0m15:33:49.639976 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:49.639976 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:49.639976 [debug] [MainThread]: On master: BEGIN
[0m15:33:49.647977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:33:49.647977 [debug] [MainThread]: On master: COMMIT
[0m15:33:49.658936 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:49.658936 [debug] [MainThread]: On master: COMMIT
[0m15:33:49.667171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:33:49.671417 [debug] [MainThread]: On master: Close
[0m15:33:49.675158 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:33:49.681176 [info ] [MainThread]: 
[0m15:33:49.753822 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:33:49.745820 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:33:49.761980 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:33:49.761980 [info ] [Thread-1 (]: 1 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:33:49.770017 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:33:49.778247 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:33:49.786362 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:33:49.783668 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:33:49.796722 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:33:49.803256 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:33:49.811503 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:33:49.786362 => 15:33:49.811503
[0m15:33:49.811503 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:33:49.917449 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:33:49.917449 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:33:49.797245 => 15:33:49.917449
[0m15:33:49.917449 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:33:49.934608 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:33:49.934608 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:33:49.934608 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:33:49.934608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:49.941622 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:33:49.941622 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:33:49.941622 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:33:50.019771 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:33:50.019771 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:33:50.023782 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:33:50.043074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:33:50.043074 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:33:50.043074 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:33:50.076033 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:33:50.089452 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:33:50.089452 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:33:50.097072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.108383 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:33:50.108383 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:33:50.108383 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:33:50.114560 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:33:50.122074 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:33:50.122074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.122074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.154387 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:33:50.162422 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:33:50.162422 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:33:50.162422 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:33:50.168170 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:33:50.168170 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.170683 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:33:50.178696 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:33:50.178696 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:33:50.182362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:33:50.185612 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:33:50.197148 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:33:50.203375 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:33:50.203375 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:33:50.203375 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:33:50.236882 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:33:50.244907 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:33:49.811503 => 15:33:50.244907
[0m15:33:50.244907 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:33:50.244907 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:33:50.252922 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:33:49.917449 => 15:33:50.252922
[0m15:33:50.252922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7B5DB40>]}
[0m15:33:50.262611 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:33:50.263629 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.47s]
[0m15:33:50.269168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7E49C60>]}
[0m15:33:50.272401 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:33:50.276931 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.50s]
[0m15:33:50.276931 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:33:50.287268 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:33:50.291081 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:33:50.293109 [info ] [Thread-1 (]: 3 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:33:50.297131 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:33:50.301156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:33:50.301156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:33:50.309188 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:33:50.317187 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:33:50.326838 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:33:50.333867 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:33:50.344117 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:33:50.326838 => 15:33:50.344117
[0m15:33:50.344117 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:33:50.317187 => 15:33:50.344117
[0m15:33:50.350135 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:33:50.350135 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:33:50.366422 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:33:50.374446 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:33:50.382448 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:33:50.382448 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:33:50.382448 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:33:50.382448 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:50.382448 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:33:50.390465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:50.457229 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:33:50.458962 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:33:50.459577 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:33:50.480314 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:33:50.480314 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:33:50.480314 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:33:50.488330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:33:50.488897 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.491297 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:33:50.496572 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:33:50.497580 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan
from final
  );
  
[0m15:33:50.497580 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:33:50.497580 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.505058 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:33:50.505058 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:33:50.508521 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:33:50.513203 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:33:50.521217 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:33:50.521217 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:33:50.524443 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:33:50.529483 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:33:50.529483 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:33:50.529483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.537513 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:33:50.537513 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:33:50.545514 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:33:50.545514 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:33:50.350135 => 15:33:50.545514
[0m15:33:50.545514 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:33:50.545514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.554278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7E68310>]}
[0m15:33:50.560154 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:33:50.561881 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.25s]
[0m15:33:50.563341 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:33:50.564915 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:33:50.564915 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:33:50.570107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:33:50.578197 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:33:50.578197 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:33:50.587092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:33:50.594605 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:33:50.366422 => 15:33:50.594605
[0m15:33:50.597641 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:33:50.597641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7F2FDC0>]}
[0m15:33:50.602109 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.30s]
[0m15:33:50.605016 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:33:50.614067 [debug] [Thread-2 (]: Began running node model.instagrid.obt
[0m15:33:50.614067 [info ] [Thread-2 (]: 5 of 5 START sql table model public.obt ........................................ [RUN]
[0m15:33:50.619848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt)
[0m15:33:50.620413 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt
[0m15:33:50.627018 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt"
[0m15:33:50.627018 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (compile): 15:33:50.620413 => 15:33:50.627018
[0m15:33:50.627018 [debug] [Thread-2 (]: Began executing node model.instagrid.obt
[0m15:33:50.644721 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt"
[0m15:33:50.644721 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:33:50.651753 [debug] [Thread-2 (]: On model.instagrid.obt: BEGIN
[0m15:33:50.653450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:33:50.708932 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:33:50.708932 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:33:50.708932 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */

  
    

  create  table "instagrid"."public"."obt__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,p.plan as plan,m.plan as dailymanufactured,week,pn 
from "instagrid"."public"."sg_production_plan" as p
left join  "instagrid"."public"."dim_manufactured_units"  as m
on 
concat('W',EXTRACT(week from date) )= week 
and 
m.product_type=p.pn

)


select distinct date,plan as weeklyplanned,week,pn,plan/7 as dailyplanned,dailymanufactured
from final
where week='W1'
  );
  
[0m15:33:50.732936 [debug] [Thread-2 (]: SQL status: SELECT 14 in 0.0 seconds
[0m15:33:50.741783 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:33:50.741783 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt" rename to "obt__dbt_backup"
[0m15:33:50.741783 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.749296 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:33:50.757319 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt__dbt_tmp" rename to "obt"
[0m15:33:50.757319 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:33:50.765322 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m15:33:50.765322 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:33:50.775773 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m15:33:50.781790 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:33:50.781790 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:33:50.789812 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
drop table if exists "instagrid"."public"."obt__dbt_backup" cascade
[0m15:33:50.798176 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:33:50.808762 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (execute): 15:33:50.635040 => 15:33:50.806203
[0m15:33:50.808762 [debug] [Thread-2 (]: On model.instagrid.obt: Close
[0m15:33:50.815081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551a8157-59e4-410d-a178-9d83645fabe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7F355D0>]}
[0m15:33:50.815081 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.obt ................................... [[32mSELECT 14[0m in 0.20s]
[0m15:33:50.824068 [debug] [Thread-2 (]: Finished running node model.instagrid.obt
[0m15:33:50.838716 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:50.838716 [debug] [MainThread]: On master: BEGIN
[0m15:33:50.842442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:50.921072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:33:50.929030 [debug] [MainThread]: On master: COMMIT
[0m15:33:50.931319 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:50.931319 [debug] [MainThread]: On master: COMMIT
[0m15:33:50.931319 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:33:50.937344 [debug] [MainThread]: On master: Close
[0m15:33:50.937344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:50.942296 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:33:50.945821 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:33:50.947485 [debug] [MainThread]: Connection 'model.instagrid.obt' was properly closed.
[0m15:33:50.947485 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m15:33:50.954004 [info ] [MainThread]: 
[0m15:33:50.954004 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m15:33:50.966596 [debug] [MainThread]: Command end result
[0m15:33:50.987148 [info ] [MainThread]: 
[0m15:33:50.990556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:50.998383 [info ] [MainThread]: 
[0m15:33:51.003408 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:33:51.003408 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:51.003408 after 2.47 seconds
[0m15:33:51.011433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F54F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7F44B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133F7F52320>]}
[0m15:33:51.011433 [debug] [MainThread]: Flushing usage events
[0m15:55:44.656942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029346DF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349257FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349257EB0>]}


============================== 15:55:44.683528 | 25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3 ==============================
[0m15:55:44.683528 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:55:44.699214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:55:45.188969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349257F10>]}
[0m15:55:45.267650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349360CA0>]}
[0m15:55:45.315032 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:55:45.629613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:45.629613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:45.676572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349710EE0>]}
[0m15:55:45.740703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349661EA0>]}
[0m15:55:45.740703 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:55:45.745096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349662080>]}
[0m15:55:45.765733 [info ] [MainThread]: 
[0m15:55:45.777573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:45.803903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:55:45.882700 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:55:45.882700 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:55:45.899371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:46.008577 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:55:46.012064 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:55:46.024451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:55:46.055268 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:55:46.058040 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:55:46.058040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:46.239320 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:55:46.240262 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:55:46.245279 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:55:46.280389 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m15:55:46.295443 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:55:46.300957 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:55:46.329479 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:46.329479 [debug] [MainThread]: On master: BEGIN
[0m15:55:46.342998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:46.426838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:46.437863 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:46.437863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:46.517434 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:55:46.517434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934975D5A0>]}
[0m15:55:46.532948 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:46.532948 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:46.549065 [debug] [MainThread]: On master: BEGIN
[0m15:55:46.553267 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:46.564809 [debug] [MainThread]: On master: COMMIT
[0m15:55:46.574921 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:46.580943 [debug] [MainThread]: On master: COMMIT
[0m15:55:46.580943 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:55:46.625955 [debug] [MainThread]: On master: Close
[0m15:55:46.645964 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:55:46.725134 [info ] [MainThread]: 
[0m15:55:46.935972 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:55:46.935972 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:55:46.941415 [info ] [Thread-1 (]: 1 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:55:46.959368 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:55:46.959368 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:55:46.944601 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:55:46.974890 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:55:46.974890 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:55:46.974890 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:55:46.990548 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:55:47.006181 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:55:46.959368 => 15:55:47.006181
[0m15:55:47.006181 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:55:47.006181 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:55:46.974890 => 15:55:47.006181
[0m15:55:47.133530 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:55:47.307083 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:55:47.322998 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:55:47.338007 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:55:47.338007 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:55:47.338007 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:55:47.338007 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:55:47.338007 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:47.353658 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:55:47.435884 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:55:47.435884 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:55:47.435884 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:55:47.453412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:55:47.464921 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:55:47.464921 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:55:47.641442 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:55:47.656849 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:55:47.672566 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:55:47.675275 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:55:47.676350 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:55:47.690960 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:55:47.694432 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:47.694432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:47.703647 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:55:47.719401 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:55:47.719401 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:55:47.735060 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:55:47.735060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:47.735060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:47.876308 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:55:47.878866 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:55:47.894522 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:55:47.894522 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:55:47.894522 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:55:47.894522 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:55:47.911481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:55:47.912030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:55:47.926063 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:55:47.941729 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:55:47.941729 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:55:47.957349 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:55:47.989593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:55:48.005238 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:55:47.006181 => 15:55:48.005238
[0m15:55:48.005238 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:55:48.005238 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:55:48.021171 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:55:47.164672 => 15:55:48.020147
[0m15:55:48.026791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293493CD120>]}
[0m15:55:48.026791 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:55:48.033776 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 1.07s]
[0m15:55:48.036989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349A1BDF0>]}
[0m15:55:48.036989 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:55:48.036989 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 1.06s]
[0m15:55:48.054181 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:55:48.054181 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:55:48.065764 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:55:48.068762 [info ] [Thread-1 (]: 3 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:55:48.071989 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:55:48.076514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:55:48.083934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:55:48.083934 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:55:48.083934 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:55:48.104100 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:55:48.123974 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:55:48.138361 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:55:48.110558 => 15:55:48.131494
[0m15:55:48.138361 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:55:48.083934 => 15:55:48.138361
[0m15:55:48.160355 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:55:48.164944 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:55:48.200922 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:55:48.227182 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:55:48.234804 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:55:48.236402 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:55:48.236402 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:55:48.242722 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:55:48.242722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:48.248374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:55:48.323621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:55:48.324607 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:55:48.330115 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:55:48.354473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:55:48.359728 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:55:48.359728 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:55:48.376776 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:55:48.376776 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan
from final
  );
  
[0m15:55:48.382183 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:55:48.385740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:48.401257 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:55:48.401257 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:55:48.407688 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:48.417861 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:55:48.417861 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:55:48.417861 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:55:48.436104 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:55:48.448631 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:55:48.449593 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:55:48.464655 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:55:48.464655 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:55:48.470517 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:55:48.470517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:48.485385 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:55:48.485385 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:55:48.496424 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:55:48.500759 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:55:48.164944 => 15:55:48.500759
[0m15:55:48.500759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:48.500759 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:55:48.519827 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:55:48.526380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934975C580>]}
[0m15:55:48.528419 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:55:48.529744 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.44s]
[0m15:55:48.533484 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:55:48.533484 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:55:48.544305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:55:48.561092 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:55:48.561092 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:55:48.576858 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:55:48.582942 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:55:48.178983 => 15:55:48.582942
[0m15:55:48.589813 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:55:48.593734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293497EC1F0>]}
[0m15:55:48.596297 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.52s]
[0m15:55:48.604169 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:55:48.609839 [debug] [Thread-2 (]: Began running node model.instagrid.obt
[0m15:55:48.624273 [info ] [Thread-2 (]: 5 of 5 START sql table model public.obt ........................................ [RUN]
[0m15:55:48.624273 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt)
[0m15:55:48.624273 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt
[0m15:55:48.639679 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt"
[0m15:55:48.677094 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (compile): 15:55:48.638632 => 15:55:48.672562
[0m15:55:48.677094 [debug] [Thread-2 (]: Began executing node model.instagrid.obt
[0m15:55:48.707246 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt"
[0m15:55:48.718792 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:55:48.718792 [debug] [Thread-2 (]: On model.instagrid.obt: BEGIN
[0m15:55:48.732752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:55:48.957063 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:55:48.957063 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:55:48.957063 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */

  
    

  create  table "instagrid"."public"."obt__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,p.plan as plan,m.plan as dailymanufactured,week,pn 
from "instagrid"."public"."sg_production_plan" as p
left join  "instagrid"."public"."dim_manufactured_units"  as m
on 
concat('W',EXTRACT(week from date) )= week 
and 
m.product_type=p.pn

)


select distinct date,plan as weeklyplanned,week,pn,plan/7 as dailyplanned,coalesce(dailymanufactured,0) as dailymanufactured
from final
  );
  
[0m15:55:49.019130 [debug] [Thread-2 (]: SQL status: SELECT 674 in 0.0 seconds
[0m15:55:49.034808 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:55:49.038404 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt" rename to "obt__dbt_backup"
[0m15:55:49.038404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:49.050918 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:55:49.050918 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt__dbt_tmp" rename to "obt"
[0m15:55:49.050918 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:55:49.066558 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m15:55:49.066558 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:55:49.066558 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m15:55:49.078071 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:55:49.082584 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:55:49.082584 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
drop table if exists "instagrid"."public"."obt__dbt_backup" cascade
[0m15:55:49.102613 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:55:49.102613 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (execute): 15:55:48.677094 => 15:55:49.102613
[0m15:55:49.102613 [debug] [Thread-2 (]: On model.instagrid.obt: Close
[0m15:55:49.117340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e1b7bf-3ccb-4e66-b1c0-93cbb49585f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349A911E0>]}
[0m15:55:49.121150 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.obt ................................... [[32mSELECT 674[0m in 0.49s]
[0m15:55:49.127340 [debug] [Thread-2 (]: Finished running node model.instagrid.obt
[0m15:55:49.136246 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:49.136780 [debug] [MainThread]: On master: BEGIN
[0m15:55:49.140785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:49.307810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:55:49.307810 [debug] [MainThread]: On master: COMMIT
[0m15:55:49.307810 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:49.307810 [debug] [MainThread]: On master: COMMIT
[0m15:55:49.320842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:55:49.323213 [debug] [MainThread]: On master: Close
[0m15:55:49.323213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:49.368616 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:55:49.390893 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:55:49.418763 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m15:55:49.418763 [debug] [MainThread]: Connection 'model.instagrid.obt' was properly closed.
[0m15:55:49.418763 [info ] [MainThread]: 
[0m15:55:49.431795 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 3.64 seconds (3.64s).
[0m15:55:49.478514 [debug] [MainThread]: Command end result
[0m15:55:49.578797 [info ] [MainThread]: 
[0m15:55:49.578797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:49.588820 [info ] [MainThread]: 
[0m15:55:49.588820 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:55:49.588820 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:49.588820 after 5.11 seconds
[0m15:55:49.588820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029346DF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349360CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029349661F60>]}
[0m15:55:49.604483 [debug] [MainThread]: Flushing usage events
[0m15:58:07.221836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3E0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40457FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40457E80>]}


============================== 15:58:07.221836 | 052070a9-9b9c-4bfc-a162-b8ebcce0b493 ==============================
[0m15:58:07.221836 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:58:07.230974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:07.369764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40457F40>]}
[0m15:58:07.384689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40565D50>]}
[0m15:58:07.393707 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:58:07.535474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:07.535474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:07.535474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40910EB0>]}
[0m15:58:07.551110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4085DE70>]}
[0m15:58:07.551110 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:58:07.565130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4085E050>]}
[0m15:58:07.565130 [info ] [MainThread]: 
[0m15:58:07.573198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:07.579446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:58:07.622651 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:58:07.622651 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:58:07.622651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:07.711305 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:58:07.711305 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:58:07.711305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:58:07.741997 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:58:07.741997 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:58:07.741997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:07.913846 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:58:07.913846 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:58:07.913846 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:58:07.930777 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m15:58:07.930777 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:58:07.930777 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:58:07.945295 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:07.945295 [debug] [MainThread]: On master: BEGIN
[0m15:58:07.945295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:07.993031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:07.993031 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.008728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:08.024867 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:58:08.024867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4095D570>]}
[0m15:58:08.035828 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:08.035828 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.035828 [debug] [MainThread]: On master: BEGIN
[0m15:58:08.035828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:08.040844 [debug] [MainThread]: On master: COMMIT
[0m15:58:08.040844 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:08.040844 [debug] [MainThread]: On master: COMMIT
[0m15:58:08.040844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:08.040844 [debug] [MainThread]: On master: Close
[0m15:58:08.047578 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:58:08.048988 [info ] [MainThread]: 
[0m15:58:08.078577 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:58:08.087318 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:58:08.087318 [info ] [Thread-1 (]: 1 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:58:08.090301 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:58:08.094815 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:58:08.090301 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:58:08.103883 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:58:08.103883 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:58:08.113656 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:58:08.113656 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:58:08.094815 => 15:58:08.113656
[0m15:58:08.119176 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:58:08.119176 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:58:08.168400 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:58:08.113656 => 15:58:08.168400
[0m15:58:08.232691 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:58:08.233471 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:58:08.233471 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:58:08.250834 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:58:08.250834 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:58:08.254648 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:58:08.254648 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:58:08.257616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:08.261283 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:08.344929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:08.344929 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:58:08.358300 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:58:08.367962 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:08.367962 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:58:08.367962 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:58:08.383498 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:58:08.401273 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:58:08.401273 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:58:08.401273 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:58:08.401273 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:58:08.415315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.418632 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:58:08.432032 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:58:08.432032 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.432032 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:58:08.447068 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:58:08.453316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.453316 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:58:08.510831 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:58:08.510831 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.510831 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:58:08.526481 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:58:08.526481 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:58:08.526481 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:58:08.535443 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:58:08.542467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:08.559246 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:08.559246 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:58:08.583687 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:58:08.583687 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:58:08.583687 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:58:08.596042 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:08.605563 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:08.605563 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:58:08.127993 => 15:58:08.596042
[0m15:58:08.605563 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:58:08.233471 => 15:58:08.605563
[0m15:58:08.605563 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:58:08.621211 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:58:08.621211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40944AF0>]}
[0m15:58:08.621211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40A10DC0>]}
[0m15:58:08.621211 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.53s]
[0m15:58:08.640517 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:58:08.636846 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.52s]
[0m15:58:08.645954 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:58:08.648934 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:58:08.652522 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:58:08.652522 [info ] [Thread-1 (]: 3 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:58:08.660546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:58:08.660546 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:58:08.660546 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:58:08.668986 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:58:08.668986 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:58:08.668986 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:58:08.685928 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:58:08.693480 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:58:08.677773 => 15:58:08.685928
[0m15:58:08.693480 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:58:08.668986 => 15:58:08.693480
[0m15:58:08.693480 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:58:08.693480 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:58:08.709787 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:58:08.726131 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:58:08.731192 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:58:08.731192 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:58:08.735370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:08.735370 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:58:08.735370 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:58:08.742386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:08.798698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:08.798698 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:58:08.798698 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:58:08.814340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:08.814340 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:58:08.814340 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan
from final
  );
  
[0m15:58:08.824376 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:58:08.830788 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:58:08.830788 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:58:08.830788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.839036 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:58:08.839036 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:58:08.844754 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.845767 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:58:08.845767 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:58:08.845767 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:58:08.854277 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:58:08.854277 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:58:08.854277 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:08.861789 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:58:08.866256 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:58:08.866256 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:58:08.866256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.878746 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:58:08.878746 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:08.878746 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:58:08.884549 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:58:08.717805 => 15:58:08.884549
[0m15:58:08.884549 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:58:08.884549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:08.890901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40A6CBE0>]}
[0m15:58:08.897913 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:58:08.897913 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.23s]
[0m15:58:08.901427 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:58:08.901427 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:58:08.901427 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:58:08.909707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:08.918044 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:58:08.918044 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:58:08.926067 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:08.934066 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:58:08.693480 => 15:58:08.934066
[0m15:58:08.934066 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:58:08.934066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40A6CBE0>]}
[0m15:58:08.942265 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.27s]
[0m15:58:08.946389 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:58:08.946389 [debug] [Thread-2 (]: Began running node model.instagrid.obt
[0m15:58:08.952156 [info ] [Thread-2 (]: 5 of 5 START sql table model public.obt ........................................ [RUN]
[0m15:58:08.952156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt)
[0m15:58:08.952156 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt
[0m15:58:08.961729 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt"
[0m15:58:08.967979 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (compile): 15:58:08.958669 => 15:58:08.966761
[0m15:58:08.967979 [debug] [Thread-2 (]: Began executing node model.instagrid.obt
[0m15:58:08.976922 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt"
[0m15:58:08.984955 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:58:08.991515 [debug] [Thread-2 (]: On model.instagrid.obt: BEGIN
[0m15:58:08.991515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:09.050806 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:58:09.050806 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:58:09.050806 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */

  
    

  create  table "instagrid"."public"."obt__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,p.plan as plan,m.plan as dailymanufactured,week,pn 
from "instagrid"."public"."sg_production_plan" as p
left join  "instagrid"."public"."dim_manufactured_units"  as m
on 
concat('W',EXTRACT(week from date) )= week 
and 
m.product_type=p.pn

)


select distinct date,plan as weeklyplanned,week,pn,plan/7 as dailyplanned,coalesce(dailymanufactured,0) as dailymanufactured
from final
  );
  
[0m15:58:09.084021 [debug] [Thread-2 (]: SQL status: SELECT 674 in 0.0 seconds
[0m15:58:09.095562 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:58:09.095562 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt" rename to "obt__dbt_backup"
[0m15:58:09.101989 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:09.101989 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:58:09.111504 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt__dbt_tmp" rename to "obt"
[0m15:58:09.111504 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:58:09.111504 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m15:58:09.111504 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:58:09.127171 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m15:58:09.127171 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:58:09.144554 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m15:58:09.151095 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
drop table if exists "instagrid"."public"."obt__dbt_backup" cascade
[0m15:58:09.158612 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:58:09.158612 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (execute): 15:58:08.971055 => 15:58:09.158612
[0m15:58:09.158612 [debug] [Thread-2 (]: On model.instagrid.obt: Close
[0m15:58:09.173436 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '052070a9-9b9c-4bfc-a162-b8ebcce0b493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B409FB5E0>]}
[0m15:58:09.174454 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.obt ................................... [[32mSELECT 674[0m in 0.22s]
[0m15:58:09.174454 [debug] [Thread-2 (]: Finished running node model.instagrid.obt
[0m15:58:09.190821 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:09.198845 [debug] [MainThread]: On master: BEGIN
[0m15:58:09.198845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:09.288217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:09.288217 [debug] [MainThread]: On master: COMMIT
[0m15:58:09.288217 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:09.288217 [debug] [MainThread]: On master: COMMIT
[0m15:58:09.296233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:09.296233 [debug] [MainThread]: On master: Close
[0m15:58:09.298355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:09.301610 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:58:09.303207 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:58:09.303207 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m15:58:09.307501 [debug] [MainThread]: Connection 'model.instagrid.obt' was properly closed.
[0m15:58:09.309051 [info ] [MainThread]: 
[0m15:58:09.312939 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m15:58:09.319066 [debug] [MainThread]: Command end result
[0m15:58:09.328357 [info ] [MainThread]: 
[0m15:58:09.336376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:09.346411 [info ] [MainThread]: 
[0m15:58:09.346411 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:58:09.358512 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:09.358512 after 2.17 seconds
[0m15:58:09.361035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B3E0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B40565D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B4085DF30>]}
[0m15:58:09.362996 [debug] [MainThread]: Flushing usage events
[0m16:01:42.112107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC4BF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7057FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7057E50>]}


============================== 16:01:42.122632 | 4b51de3e-a7a6-434e-bd27-d55e336d7134 ==============================
[0m16:01:42.122632 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:01:42.130513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:01:42.332513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7057EB0>]}
[0m16:01:42.373349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7165D80>]}
[0m16:01:42.394445 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:01:42.567973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:42.567973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:42.583625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7510E80>]}
[0m16:01:42.626666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7461E40>]}
[0m16:01:42.632182 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:01:42.642513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7462020>]}
[0m16:01:42.650763 [info ] [MainThread]: 
[0m16:01:42.654189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:42.656854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:01:42.680674 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:01:42.680674 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:01:42.680674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:42.802927 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:01:42.819312 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:01:42.831570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:01:42.850486 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:01:42.850486 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:01:42.850486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:42.929746 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:01:42.945429 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:01:42.945429 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:01:42.961009 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m16:01:42.973786 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:01:42.976806 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:01:42.992576 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:42.992576 [debug] [MainThread]: On master: BEGIN
[0m16:01:42.992576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:43.086955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:43.086955 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:43.086955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:43.123759 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:01:43.123759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC755D540>]}
[0m16:01:43.135449 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:43.135449 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:43.135449 [debug] [MainThread]: On master: BEGIN
[0m16:01:43.142491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:43.142491 [debug] [MainThread]: On master: COMMIT
[0m16:01:43.142491 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:43.142491 [debug] [MainThread]: On master: COMMIT
[0m16:01:43.150515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:01:43.150515 [debug] [MainThread]: On master: Close
[0m16:01:43.157735 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:01:43.160206 [info ] [MainThread]: 
[0m16:01:43.182889 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m16:01:43.182889 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m16:01:43.191833 [info ] [Thread-1 (]: 1 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m16:01:43.191833 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m16:01:43.199349 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m16:01:43.199349 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m16:01:43.215384 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m16:01:43.207363 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m16:01:43.231924 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m16:01:43.239922 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m16:01:43.247953 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 16:01:43.215384 => 16:01:43.247953
[0m16:01:43.255923 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m16:01:43.239922 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 16:01:43.231924 => 16:01:43.239922
[0m16:01:43.321490 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m16:01:43.416127 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m16:01:43.424406 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m16:01:43.424406 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:01:43.424406 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m16:01:43.424406 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:01:43.431937 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:01:43.434130 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m16:01:43.434130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:01:43.759466 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:43.759466 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:01:43.759466 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m16:01:43.778655 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:01:43.789984 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:01:43.794683 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m16:01:43.796074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:43.798084 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:01:43.798084 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m16:01:43.809510 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:43.865905 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:01:43.869107 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:01:43.870241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:43.870241 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:01:43.872428 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:01:43.872428 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m16:01:43.875890 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:43.885029 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:01:43.885029 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m16:01:43.885029 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m16:01:43.893702 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:01:43.893702 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m16:01:43.897776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:43.898924 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:01:43.898924 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:01:43.898924 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m16:01:43.898924 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 16:01:43.258745 => 16:01:43.898924
[0m16:01:43.908935 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m16:01:43.911288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:43.911288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC75A8B50>]}
[0m16:01:43.914074 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:01:43.914074 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.71s]
[0m16:01:43.922344 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:01:43.923793 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m16:01:43.924811 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:01:43.924811 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m16:01:43.931833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:43.934142 [info ] [Thread-2 (]: 3 of 5 START sql table model public.dim_production_plan ........................ [RUN]
[0m16:01:43.940215 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:01:43.940215 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m16:01:43.940215 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m16:01:43.940215 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m16:01:43.955327 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m16:01:43.957900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:01:43.964445 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 16:01:43.337823 => 16:01:43.964445
[0m16:01:43.964445 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m16:01:43.972468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC762A5C0>]}
[0m16:01:43.964445 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 16:01:43.948230 => 16:01:43.964445
[0m16:01:43.980469 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.77s]
[0m16:01:43.980469 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m16:01:43.986062 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m16:01:44.004822 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m16:01:44.011008 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:01:44.012445 [info ] [Thread-1 (]: 4 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m16:01:44.015916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m16:01:44.015916 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:01:44.028385 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:01:44.028385 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:01:44.020860 => 16:01:44.028385
[0m16:01:44.036404 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:01:44.050497 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:01:44.054138 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:01:44.056558 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m16:01:44.060392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:44.061413 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:01:44.065187 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:01:44.067761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:44.156015 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:44.156015 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:01:44.156015 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m16:01:44.162079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:44.166783 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:01:44.169212 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
)

select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan
from final
  );
  
[0m16:01:44.184558 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:01:44.195288 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:01:44.196527 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m16:01:44.197235 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m16:01:44.204055 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:01:44.205609 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m16:01:44.205609 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:44.213067 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:01:44.214571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:44.214571 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m16:01:44.223018 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:01:44.226426 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:01:44.226426 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:44.234179 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m16:01:44.234919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:44.234919 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:01:44.241289 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:01:44.241289 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m16:01:44.245579 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:01:44.245579 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:01:44.264243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:44.264243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:44.264243 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m16:01:44.279860 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:01:44.279860 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:01:44.279860 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m16:01:44.327068 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:01:44.328720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:01:44.330146 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 16:01:43.988577 => 16:01:44.330146
[0m16:01:44.343086 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m16:01:44.343086 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:01:44.036404 => 16:01:44.342068
[0m16:01:44.346121 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC76593C0>]}
[0m16:01:44.346121 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:01:44.346121 [info ] [Thread-2 (]: 3 of 5 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.41s]
[0m16:01:44.346121 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m16:01:44.346121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7644970>]}
[0m16:01:44.358189 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.33s]
[0m16:01:44.363565 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:01:44.366208 [debug] [Thread-2 (]: Began running node model.instagrid.obt
[0m16:01:44.369291 [info ] [Thread-2 (]: 5 of 5 START sql table model public.obt ........................................ [RUN]
[0m16:01:44.372180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_production_plan, now model.instagrid.obt)
[0m16:01:44.372850 [debug] [Thread-2 (]: Began compiling node model.instagrid.obt
[0m16:01:44.380344 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.obt"
[0m16:01:44.380344 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (compile): 16:01:44.374329 => 16:01:44.380344
[0m16:01:44.387101 [debug] [Thread-2 (]: Began executing node model.instagrid.obt
[0m16:01:44.396786 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.obt"
[0m16:01:44.396786 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m16:01:44.404808 [debug] [Thread-2 (]: On model.instagrid.obt: BEGIN
[0m16:01:44.408587 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:44.512357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:01:44.512357 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m16:01:44.512357 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */

  
    

  create  table "instagrid"."public"."obt__dbt_tmp"
  
  
    as
  
  (
    with final as
(
select date,p.plan as plan,m.plan as dailymanufactured,week,pn 
from "instagrid"."public"."sg_production_plan" as p
right join  "instagrid"."public"."dim_manufactured_units"  as m
on 
concat('W',EXTRACT(week from date) )= week 
and 
m.product_type=p.pn

)


select distinct date,plan as weeklyplanned,week,pn,plan/7 as dailyplanned,coalesce(dailymanufactured,0) as dailymanufactured
from final
  );
  
[0m16:01:44.549939 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m16:01:44.556747 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m16:01:44.556747 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt" rename to "obt__dbt_backup"
[0m16:01:44.561812 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:44.566062 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m16:01:44.566062 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
alter table "instagrid"."public"."obt__dbt_tmp" rename to "obt"
[0m16:01:44.573057 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:01:44.573057 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m16:01:44.573057 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m16:01:44.573057 [debug] [Thread-2 (]: On model.instagrid.obt: COMMIT
[0m16:01:44.587850 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:01:44.594939 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.obt"
[0m16:01:44.597992 [debug] [Thread-2 (]: On model.instagrid.obt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.obt"} */
drop table if exists "instagrid"."public"."obt__dbt_backup" cascade
[0m16:01:44.608098 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:01:44.614114 [debug] [Thread-2 (]: Timing info for model.instagrid.obt (execute): 16:01:44.390378 => 16:01:44.614114
[0m16:01:44.614114 [debug] [Thread-2 (]: On model.instagrid.obt: Close
[0m16:01:44.614114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b51de3e-a7a6-434e-bd27-d55e336d7134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7627880>]}
[0m16:01:44.614114 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.obt ................................... [[32mSELECT 668[0m in 0.24s]
[0m16:01:44.622887 [debug] [Thread-2 (]: Finished running node model.instagrid.obt
[0m16:01:44.625899 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:44.625899 [debug] [MainThread]: On master: BEGIN
[0m16:01:44.630743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:44.724330 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:01:44.724330 [debug] [MainThread]: On master: COMMIT
[0m16:01:44.725874 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:44.725874 [debug] [MainThread]: On master: COMMIT
[0m16:01:44.728532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:01:44.730511 [debug] [MainThread]: On master: Close
[0m16:01:44.730511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:44.730511 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:01:44.734954 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:01:44.734954 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m16:01:44.736964 [debug] [MainThread]: Connection 'model.instagrid.obt' was properly closed.
[0m16:01:44.736964 [info ] [MainThread]: 
[0m16:01:44.736964 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m16:01:44.745939 [debug] [MainThread]: Command end result
[0m16:01:44.771035 [info ] [MainThread]: 
[0m16:01:44.785886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:44.796469 [info ] [MainThread]: 
[0m16:01:44.807786 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:01:44.812558 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:44.812558 after 2.77 seconds
[0m16:01:44.819183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC4BF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7165D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FC7572290>]}
[0m16:01:44.819183 [debug] [MainThread]: Flushing usage events
[0m13:13:26.572293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A573BF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A575F57FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A575F57CD0>]}


============================== 13:13:26.581308 | f1d66f3a-effb-4cf4-9fd9-311aad8ed265 ==============================
[0m13:13:26.581308 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:13:26.583312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:13:26.584312 [info ] [MainThread]: dbt version: 1.5.1
[0m13:13:26.587319 [info ] [MainThread]: python version: 3.10.11
[0m13:13:26.588310 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m13:13:26.590312 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m13:13:26.591310 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m13:13:26.592334 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m13:13:26.594310 [info ] [MainThread]: Configuration:
[0m13:13:26.704731 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:26.750751 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:13:26.755737 [info ] [MainThread]: Required dependencies:
[0m13:13:26.757745 [debug] [MainThread]: Executing "git --help"
[0m13:13:26.845576 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:13:26.848097 [debug] [MainThread]: STDERR: "b''"
[0m13:13:26.849094 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:26.851098 [info ] [MainThread]: Connection:
[0m13:13:26.853101 [info ] [MainThread]:   host: localhost
[0m13:13:26.856103 [info ] [MainThread]:   port: 5435
[0m13:13:26.857097 [info ] [MainThread]:   user: postgres
[0m13:13:26.860098 [info ] [MainThread]:   database: instagrid
[0m13:13:26.863110 [info ] [MainThread]:   schema: public
[0m13:13:26.865111 [info ] [MainThread]:   search_path: None
[0m13:13:26.867111 [info ] [MainThread]:   keepalives_idle: 0
[0m13:13:26.868109 [info ] [MainThread]:   sslmode: None
[0m13:13:26.870109 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:13:26.871112 [debug] [MainThread]: Using postgres connection "debug"
[0m13:13:26.872116 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:26.873109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:26.966766 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:13:26.967803 [debug] [MainThread]: On debug: Close
[0m13:13:26.968797 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:26.970936 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:13:26.973957 [debug] [MainThread]: Command `dbt debug` succeeded at 13:13:26.973957 after 0.44 seconds
[0m13:13:26.975466 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:26.976478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A573BF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A573D768C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A576076A70>]}
[0m13:13:26.977478 [debug] [MainThread]: Flushing usage events
[0m13:14:59.060903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D113F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1375BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1375BE80>]}


============================== 13:14:59.064906 | 0a8f41be-8775-4deb-b359-4236395a6db9 ==============================
[0m13:14:59.064906 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:14:59.067905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:14:59.191594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D1375BF40>]}
[0m13:14:59.215609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13865DB0>]}
[0m13:14:59.229613 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:14:59.346033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:59.347033 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:59.349521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m13:14:59.364529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13C17EB0>]}
[0m13:14:59.385090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D139E5930>]}
[0m13:14:59.386091 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:14:59.388093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D139E5B10>]}
[0m13:14:59.392807 [info ] [MainThread]: 
[0m13:14:59.395888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:14:59.405201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m13:14:59.428647 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m13:14:59.429657 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m13:14:59.431840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:59.490560 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m13:14:59.492558 [debug] [ThreadPool]: On list_instagrid: Close
[0m13:14:59.497677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m13:14:59.506688 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m13:14:59.507678 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m13:14:59.508675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:59.552219 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:14:59.553224 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m13:14:59.554226 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:14:59.574034 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:14:59.576032 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m13:14:59.578033 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m13:14:59.588278 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:59.589290 [debug] [MainThread]: On master: BEGIN
[0m13:14:59.590290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:59.639286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:14:59.640283 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:59.641284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:14:59.683463 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:14:59.684480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13C50FA0>]}
[0m13:14:59.685470 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:59.687552 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:59.687552 [debug] [MainThread]: On master: BEGIN
[0m13:14:59.689006 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:14:59.690455 [debug] [MainThread]: On master: COMMIT
[0m13:14:59.691466 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:59.692467 [debug] [MainThread]: On master: COMMIT
[0m13:14:59.693465 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:14:59.694467 [debug] [MainThread]: On master: Close
[0m13:14:59.696469 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:14:59.701088 [info ] [MainThread]: 
[0m13:14:59.729717 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m13:14:59.731716 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m13:14:59.730716 [info ] [Thread-1 (]: 1 of 4 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m13:14:59.744591 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m13:14:59.745588 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m13:14:59.734140 [info ] [Thread-2 (]: 2 of 4 START sql table model public.sg_production_plan ......................... [RUN]
[0m13:14:59.753294 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m13:14:59.751295 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m13:14:59.754294 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m13:14:59.769656 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m13:14:59.773652 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 13:14:59.746587 => 13:14:59.772654
[0m13:14:59.774652 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m13:14:59.785650 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 13:14:59.762639 => 13:14:59.785650
[0m13:14:59.786655 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m13:14:59.890148 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m13:14:59.891148 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m13:14:59.897369 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:14:59.899365 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m13:14:59.900367 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:59.901364 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:14:59.903367 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m13:14:59.904389 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:59.967629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:14:59.968642 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:14:59.970009 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m13:14:59.972026 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:14:59.973023 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:14:59.974346 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m13:14:59.991205 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m13:15:00.001994 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:15:00.002995 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:15:00.002995 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m13:15:00.009984 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:15:00.011988 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m13:15:00.013987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.014986 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.021438 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:15:00.029657 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:15:00.030655 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m13:15:00.031674 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m13:15:00.034332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.076423 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m13:15:00.077422 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.078424 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:15:00.082424 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m13:15:00.083425 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m13:15:00.084424 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:15:00.086423 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m13:15:00.088424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:15:00.089425 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:15:00.096434 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:15:00.101440 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:15:00.102440 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m13:15:00.104424 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m13:15:00.112423 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:15:00.115426 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 13:14:59.775652 => 13:15:00.115426
[0m13:15:00.116493 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:15:00.117503 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m13:15:00.121501 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 13:14:59.788653 => 13:15:00.120502
[0m13:15:00.122504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13D1C700>]}
[0m13:15:00.124503 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m13:15:00.127505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13D1CFA0>]}
[0m13:15:00.125504 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.38s]
[0m13:15:00.129966 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.38s]
[0m13:15:00.132966 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m13:15:00.134972 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m13:15:00.136991 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m13:15:00.141178 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m13:15:00.142202 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m13:15:00.146650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m13:15:00.147649 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m13:15:00.154186 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m13:15:00.144636 [info ] [Thread-2 (]: 4 of 4 START sql table model public.dim_production_plan ........................ [RUN]
[0m13:15:00.156169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m13:15:00.158171 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m13:15:00.159170 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 13:15:00.148650 => 13:15:00.158171
[0m13:15:00.164495 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m13:15:00.165494 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m13:15:00.174494 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m13:15:00.179067 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 13:15:00.159170 => 13:15:00.178013
[0m13:15:00.181029 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m13:15:00.191526 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:15:00.195377 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m13:15:00.194361 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m13:15:00.196378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:00.201384 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:15:00.202384 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m13:15:00.203379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:15:00.268593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:15:00.269594 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:15:00.270595 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date, year_week,product_type,plan
from base
  );
  
[0m13:15:00.276344 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:15:00.277348 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:15:00.278346 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m13:15:00.289291 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m13:15:00.294806 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:15:00.295808 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:15:00.297082 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m13:15:00.302342 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:15:00.304336 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m13:15:00.305336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.311347 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:15:00.311347 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.312337 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m13:15:00.318338 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:15:00.320340 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m13:15:00.320340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.326696 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m13:15:00.326696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:15:00.327688 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:15:00.331238 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m13:15:00.332237 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m13:15:00.333234 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:15:00.335232 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m13:15:00.336254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:15:00.337243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:15:00.342273 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:15:00.346239 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:15:00.347250 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m13:15:00.348242 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m13:15:00.356134 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:15:00.357135 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:15:00.359144 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 13:15:00.166496 => 13:15:00.358137
[0m13:15:00.362135 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 13:15:00.183039 => 13:15:00.362135
[0m13:15:00.363141 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m13:15:00.364135 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m13:15:00.366137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13D8B610>]}
[0m13:15:00.368468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8f41be-8775-4deb-b359-4236395a6db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13D08880>]}
[0m13:15:00.369539 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.22s]
[0m13:15:00.371605 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.21s]
[0m13:15:00.374800 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m13:15:00.376811 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m13:15:00.385111 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:00.386107 [debug] [MainThread]: On master: BEGIN
[0m13:15:00.388110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:00.463049 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:15:00.464031 [debug] [MainThread]: On master: COMMIT
[0m13:15:00.464031 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:00.466020 [debug] [MainThread]: On master: COMMIT
[0m13:15:00.467031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:15:00.468127 [debug] [MainThread]: On master: Close
[0m13:15:00.469138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:00.470142 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m13:15:00.471140 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m13:15:00.473289 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m13:15:00.474302 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m13:15:00.475303 [info ] [MainThread]: 
[0m13:15:00.477301 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m13:15:00.480407 [debug] [MainThread]: Command end result
[0m13:15:00.496534 [info ] [MainThread]: 
[0m13:15:00.499529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:00.501533 [info ] [MainThread]: 
[0m13:15:00.507815 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:15:00.515246 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:00.515246 after 1.49 seconds
[0m13:15:00.517410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D113F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13865DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D13D0BFD0>]}
[0m13:15:00.518645 [debug] [MainThread]: Flushing usage events
[0m13:18:07.082141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1EAF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C20E57F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C20E57EE0>]}


============================== 13:18:07.087147 | 390980cf-75ed-4891-9b8b-3e989195bab8 ==============================
[0m13:18:07.087147 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:18:07.089053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:18:07.223243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C20E57FA0>]}
[0m13:18:07.243437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C20F65E10>]}
[0m13:18:07.260965 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:18:07.373559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:07.378678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:07.380696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m13:18:07.396720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C213109D0>]}
[0m13:18:07.484805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C212E5990>]}
[0m13:18:07.485814 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m13:18:07.496248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C212E5B70>]}
[0m13:18:07.499266 [info ] [MainThread]: 
[0m13:18:07.501264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:07.537800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m13:18:07.583144 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m13:18:07.584142 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m13:18:07.593153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:07.717945 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m13:18:07.720961 [debug] [ThreadPool]: On list_instagrid: Close
[0m13:18:07.727808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m13:18:07.747706 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m13:18:07.749707 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m13:18:07.753115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:07.830473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:18:07.831475 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m13:18:07.832475 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:18:07.848987 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:18:07.850986 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m13:18:07.851987 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m13:18:07.863471 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:07.865471 [debug] [MainThread]: On master: BEGIN
[0m13:18:07.866473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:07.919228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:07.919228 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:07.920229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:18:07.940227 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:18:07.943732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C213511B0>]}
[0m13:18:07.944731 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:07.945731 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:07.946729 [debug] [MainThread]: On master: BEGIN
[0m13:18:07.947731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:07.948729 [debug] [MainThread]: On master: COMMIT
[0m13:18:07.949732 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:07.949732 [debug] [MainThread]: On master: COMMIT
[0m13:18:07.951730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:07.951730 [debug] [MainThread]: On master: Close
[0m13:18:07.953731 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:18:07.956250 [info ] [MainThread]: 
[0m13:18:07.968832 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m13:18:07.969832 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m13:18:07.970832 [info ] [Thread-1 (]: 1 of 4 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m13:18:07.974840 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m13:18:07.976834 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m13:18:07.981836 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m13:18:07.972837 [info ] [Thread-2 (]: 2 of 4 START sql table model public.sg_production_plan ......................... [RUN]
[0m13:18:07.983835 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m13:18:07.984835 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m13:18:07.985833 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 13:18:07.976834 => 13:18:07.985833
[0m13:18:07.995074 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m13:18:07.996073 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m13:18:08.043329 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 13:18:07.986834 => 13:18:08.042816
[0m13:18:08.046344 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m13:18:08.097957 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m13:18:08.098960 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m13:18:08.101958 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:18:08.102960 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m13:18:08.104059 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:18:08.105069 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:18:08.106385 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m13:18:08.107398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:18:08.169763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:18:08.170764 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:18:08.171764 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m13:18:08.183518 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m13:18:08.196294 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:18:08.197296 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m13:18:08.198297 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:18:08.199300 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:18:08.200763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.201779 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m13:18:08.208983 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:18:08.210983 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m13:18:08.213316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.242329 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:18:08.250357 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m13:18:08.255870 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:18:08.256868 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:18:08.257870 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m13:18:08.258867 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m13:18:08.259870 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.264919 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:18:08.264919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:18:08.265915 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m13:18:08.272911 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m13:18:08.274917 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m13:18:08.274917 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.280551 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m13:18:08.281545 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:08.281931 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:18:08.284936 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 13:18:07.997074 => 13:18:08.283935
[0m13:18:08.285614 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m13:18:08.286348 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m13:18:08.288814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C213BD1B0>]}
[0m13:18:08.289824 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:18:08.301163 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m13:18:08.290826 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.31s]
[0m13:18:08.302531 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m13:18:08.305289 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m13:18:08.308301 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m13:18:08.309303 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m13:18:08.312303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m13:18:08.313305 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:08.314444 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m13:18:08.318463 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 13:18:08.047342 => 13:18:08.318463
[0m13:18:08.327634 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m13:18:08.329613 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m13:18:08.331613 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C21347220>]}
[0m13:18:08.333617 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.35s]
[0m13:18:08.339818 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m13:18:08.342833 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m13:18:08.345286 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 13:18:08.319783 => 13:18:08.344270
[0m13:18:08.346286 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m13:18:08.359818 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m13:18:08.344270 [info ] [Thread-2 (]: 4 of 4 START sql table model public.dim_production_plan ........................ [RUN]
[0m13:18:08.362818 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m13:18:08.363823 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m13:18:08.364819 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:18:08.369977 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m13:18:08.372987 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m13:18:08.377983 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 13:18:08.364819 => 13:18:08.376984
[0m13:18:08.378983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:08.380979 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m13:18:08.397612 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m13:18:08.402618 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:18:08.403610 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m13:18:08.405689 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:18:08.471603 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:18:08.472608 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:18:08.473604 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m13:18:08.484052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:18:08.485054 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:18:08.487051 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date, year_week,product_type,plan
from base
  );
  
[0m13:18:08.488051 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:18:08.495252 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:18:08.496252 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m13:18:08.497256 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.503252 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:18:08.504252 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m13:18:08.506399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.511764 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m13:18:08.512765 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m13:18:08.513766 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:18:08.520762 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:18:08.521760 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m13:18:08.522761 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m13:18:08.524764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.530768 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:18:08.531761 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:18:08.532761 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m13:18:08.537844 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m13:18:08.540701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:08.541717 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m13:18:08.546719 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m13:18:08.549209 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:18:08.550225 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m13:18:08.553225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:18:08.554738 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:08.558746 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m13:18:08.561775 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 13:18:08.385134 => 13:18:08.561775
[0m13:18:08.562749 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m13:18:08.563745 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m13:18:08.567043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C21649660>]}
[0m13:18:08.568046 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.20s]
[0m13:18:08.572199 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m13:18:08.572199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:08.578507 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 13:18:08.347284 => 13:18:08.577502
[0m13:18:08.580493 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m13:18:08.582487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390980cf-75ed-4891-9b8b-3e989195bab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C21663400>]}
[0m13:18:08.584489 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.27s]
[0m13:18:08.586491 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m13:18:08.589485 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:08.590486 [debug] [MainThread]: On master: BEGIN
[0m13:18:08.591489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:08.651655 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:08.651655 [debug] [MainThread]: On master: COMMIT
[0m13:18:08.652678 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:08.653655 [debug] [MainThread]: On master: COMMIT
[0m13:18:08.655165 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:08.655674 [debug] [MainThread]: On master: Close
[0m13:18:08.657686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:08.657686 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m13:18:08.660022 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m13:18:08.662058 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m13:18:08.663070 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m13:18:08.664074 [info ] [MainThread]: 
[0m13:18:08.666070 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m13:18:08.669161 [debug] [MainThread]: Command end result
[0m13:18:08.677251 [info ] [MainThread]: 
[0m13:18:08.679252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:08.681250 [info ] [MainThread]: 
[0m13:18:08.682250 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:18:08.687256 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:08.685249 after 1.63 seconds
[0m13:18:08.689651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C1EAF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C21351000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C20F78AC0>]}
[0m13:18:08.691703 [debug] [MainThread]: Flushing usage events
[0m15:12:38.109509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029100DF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029103157F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029103157D60>]}


============================== 15:12:38.114529 | 88b92aab-ebae-4c55-a3a0-fdb689e120e7 ==============================
[0m15:12:38.114529 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:12:38.116039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:12:38.118140 [info ] [MainThread]: dbt version: 1.5.1
[0m15:12:38.119664 [info ] [MainThread]: python version: 3.10.11
[0m15:12:38.120663 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m15:12:38.123074 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:12:38.126062 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m15:12:38.127076 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m15:12:38.128095 [info ] [MainThread]: Configuration:
[0m15:12:38.218081 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:12:38.248081 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:12:38.248934 [info ] [MainThread]: Required dependencies:
[0m15:12:38.254770 [debug] [MainThread]: Executing "git --help"
[0m15:12:38.330027 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:12:38.331037 [debug] [MainThread]: STDERR: "b''"
[0m15:12:38.331037 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:12:38.332039 [info ] [MainThread]: Connection:
[0m15:12:38.333042 [info ] [MainThread]:   host: localhost
[0m15:12:38.334039 [info ] [MainThread]:   port: 5435
[0m15:12:38.336041 [info ] [MainThread]:   user: postgres
[0m15:12:38.337059 [info ] [MainThread]:   database: instagrid
[0m15:12:38.340075 [info ] [MainThread]:   schema: public
[0m15:12:38.342541 [info ] [MainThread]:   search_path: None
[0m15:12:38.344542 [info ] [MainThread]:   keepalives_idle: 0
[0m15:12:38.346055 [info ] [MainThread]:   sslmode: None
[0m15:12:38.349104 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:12:38.350121 [debug] [MainThread]: Using postgres connection "debug"
[0m15:12:38.351121 [debug] [MainThread]: On debug: select 1 as id
[0m15:12:38.352124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:38.475017 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:12:38.478068 [debug] [MainThread]: On debug: Close
[0m15:12:38.479082 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:12:38.480079 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:12:38.483473 [debug] [MainThread]: Command `dbt debug` succeeded at 15:12:38.482477 after 0.41 seconds
[0m15:12:38.484480 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:12:38.487552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029100DF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029101693C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291032676D0>]}
[0m15:12:38.490008 [debug] [MainThread]: Flushing usage events
[0m15:15:23.657838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B5F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999D957FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999D957EB0>]}


============================== 15:15:23.662841 | 138fd5cf-2b33-4adc-ba8a-1b35d2122cf4 ==============================
[0m15:15:23.662841 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:15:23.665144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:15:23.820476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999D957F70>]}
[0m15:15:23.839734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DA66500>]}
[0m15:15:23.856236 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:15:23.955439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:15:23.956417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:15:23.957940 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m15:15:23.977124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DE109A0>]}
[0m15:15:24.002137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DBE5900>]}
[0m15:15:24.003154 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:15:24.022998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DBE5A80>]}
[0m15:15:24.027051 [info ] [MainThread]: 
[0m15:15:24.032209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:24.046268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:15:24.080387 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:15:24.081371 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:15:24.084376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:24.169026 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:15:24.171220 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:15:24.176392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:15:24.190817 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:15:24.192819 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:15:24.193817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:24.354909 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:15:24.356415 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:15:24.356939 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:15:24.380285 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m15:15:24.382294 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:15:24.384771 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:15:24.395284 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:24.395284 [debug] [MainThread]: On master: BEGIN
[0m15:15:24.396816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:24.442986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:15:24.443997 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:24.443997 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:24.474544 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:15:24.476057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DE51180>]}
[0m15:15:24.477581 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:24.478589 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:24.479592 [debug] [MainThread]: On master: BEGIN
[0m15:15:24.480592 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:15:24.481602 [debug] [MainThread]: On master: COMMIT
[0m15:15:24.481602 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:24.483673 [debug] [MainThread]: On master: COMMIT
[0m15:15:24.484691 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:24.486300 [debug] [MainThread]: On master: Close
[0m15:15:24.488828 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:15:24.490832 [info ] [MainThread]: 
[0m15:15:24.510998 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:15:24.512031 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m15:15:24.514000 [info ] [Thread-1 (]: 1 of 4 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:15:24.516002 [info ] [Thread-2 (]: 2 of 4 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:15:24.524659 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:15:24.526168 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m15:15:24.528702 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:15:24.530711 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:15:24.539792 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:15:24.546850 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:15:24.562614 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:15:24.532705 => 15:15:24.561610
[0m15:15:24.563607 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:15:24.541792 => 15:15:24.563607
[0m15:15:24.564608 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:15:24.566261 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m15:15:24.830091 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:15:24.834093 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:15:24.882574 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:15:24.885151 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:15:24.887172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:15:24.910114 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:15:24.913126 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:15:24.914117 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:25.476130 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:15:25.477660 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:15:25.478676 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:15:25.518756 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:15:25.538071 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:15:25.538914 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m15:15:25.539910 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:15:25.541911 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:15:25.542912 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:15:25.544910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:25.553412 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:15:25.554414 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:15:25.569094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:25.641704 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:15:25.644706 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:15:25.647890 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:15:25.655269 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:15:25.657282 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:15:25.658294 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:15:25.671221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:25.678870 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:15:25.680870 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:15:25.683869 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:25.690120 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:15:25.691134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:25.692318 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:15:25.705300 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:15:25.706300 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:15:25.707944 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:15:25.726714 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:25.739768 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:15:25.741764 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:15:25.747821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:15:25.752860 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:15:24.571821 => 15:15:25.751250
[0m15:15:25.754964 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:15:25.758253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DF26950>]}
[0m15:15:25.760215 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 1.24s]
[0m15:15:25.773220 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:15:25.779215 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:15:25.781433 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:15:25.785686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:15:25.787228 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:15:25.794821 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:15:25.810276 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:15:25.789818 => 15:15:25.809282
[0m15:15:25.811279 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:15:25.812310 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:15:25.856026 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:15:25.860342 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:15:24.598675 => 15:15:25.859344
[0m15:15:25.868442 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m15:15:25.873445 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DE70520>]}
[0m15:15:25.874622 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:15:25.890978 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 1.35s]
[0m15:15:25.893187 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:15:25.894201 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m15:15:25.897240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:25.904948 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m15:15:25.907565 [info ] [Thread-2 (]: 4 of 4 START sql table model public.dim_production_plan ........................ [RUN]
[0m15:15:25.912013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m15:15:25.913016 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m15:15:25.921832 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m15:15:25.924826 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 15:15:25.914263 => 15:15:25.924826
[0m15:15:25.926861 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m15:15:25.963587 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m15:15:25.976018 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:15:25.977545 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m15:15:25.979379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:15:26.063207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:15:26.064207 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:15:26.065208 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date, year_week,product_type,plan
from base
  );
  
[0m15:15:26.067235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:15:26.069261 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:15:26.071273 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:15:26.086089 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:15:26.092684 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:15:26.094084 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:15:26.095099 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m15:15:26.104118 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:15:26.107149 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:15:26.108160 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:26.115159 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:15:26.115159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:26.117273 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m15:15:26.124452 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:15:26.127070 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:15:26.128086 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:26.134098 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:15:26.135098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:15:26.136611 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:15:26.142154 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:15:26.144233 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m15:15:26.145345 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:15:26.147261 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:15:26.149274 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:26.150273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:15:26.159594 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m15:15:26.165111 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:15:26.167129 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m15:15:26.169364 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:15:26.176962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:15:26.176962 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:15:26.181476 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:15:25.815284 => 15:15:26.180465
[0m15:15:26.186434 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 15:15:25.928012 => 15:15:26.184916
[0m15:15:26.187036 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:15:26.188168 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m15:15:26.190983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DF9CBE0>]}
[0m15:15:26.192999 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '138fd5cf-2b33-4adc-ba8a-1b35d2122cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DF79450>]}
[0m15:15:26.194235 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.41s]
[0m15:15:26.196252 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.28s]
[0m15:15:26.198286 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:15:26.200297 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m15:15:26.208229 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:26.208934 [debug] [MainThread]: On master: BEGIN
[0m15:15:26.209967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:26.321933 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:15:26.322932 [debug] [MainThread]: On master: COMMIT
[0m15:15:26.323933 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:26.324933 [debug] [MainThread]: On master: COMMIT
[0m15:15:26.327057 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:15:26.329064 [debug] [MainThread]: On master: Close
[0m15:15:26.331149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:26.332518 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:15:26.333531 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:15:26.334842 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m15:15:26.336356 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m15:15:26.337913 [info ] [MainThread]: 
[0m15:15:26.340327 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m15:15:26.344348 [debug] [MainThread]: Command end result
[0m15:15:26.361547 [info ] [MainThread]: 
[0m15:15:26.363537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:26.366246 [info ] [MainThread]: 
[0m15:15:26.373939 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:15:26.377805 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:26.377805 after 2.75 seconds
[0m15:15:26.379825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999B5F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DF79450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002999DE12140>]}
[0m15:15:26.380820 [debug] [MainThread]: Flushing usage events
[0m19:16:15.253691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDB9F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDDD67E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDDD67D00>]}


============================== 19:16:15.258527 | 12aafe6a-d3ae-4468-9fd0-f19710d8662b ==============================
[0m19:16:15.258527 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:16:15.260541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:16:15.263057 [info ] [MainThread]: dbt version: 1.5.1
[0m19:16:15.265075 [info ] [MainThread]: python version: 3.10.11
[0m19:16:15.269239 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m19:16:15.273273 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m19:16:15.275246 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m19:16:15.278249 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m19:16:15.280248 [info ] [MainThread]: Configuration:
[0m19:16:15.406423 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:16:15.446207 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:16:15.449212 [info ] [MainThread]: Required dependencies:
[0m19:16:15.453334 [debug] [MainThread]: Executing "git --help"
[0m19:16:15.530836 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:16:15.532374 [debug] [MainThread]: STDERR: "b''"
[0m19:16:15.533381 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:16:15.536981 [info ] [MainThread]: Connection:
[0m19:16:15.538997 [info ] [MainThread]:   host: localhost
[0m19:16:15.543036 [info ] [MainThread]:   port: 5435
[0m19:16:15.544199 [info ] [MainThread]:   user: postgres
[0m19:16:15.546948 [info ] [MainThread]:   database: instagrid
[0m19:16:15.547952 [info ] [MainThread]:   schema: public
[0m19:16:15.549952 [info ] [MainThread]:   search_path: None
[0m19:16:15.551642 [info ] [MainThread]:   keepalives_idle: 0
[0m19:16:15.556246 [info ] [MainThread]:   sslmode: None
[0m19:16:15.563258 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:16:15.565271 [debug] [MainThread]: Using postgres connection "debug"
[0m19:16:15.566774 [debug] [MainThread]: On debug: select 1 as id
[0m19:16:15.567784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:15.646877 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:16:15.648903 [debug] [MainThread]: On debug: Close
[0m19:16:15.649879 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:16:15.653909 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:16:15.658927 [debug] [MainThread]: Command `dbt debug` succeeded at 19:16:15.658927 after 0.43 seconds
[0m19:16:15.661010 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:16:15.663073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDB9F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDC291840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDDE84A30>]}
[0m19:16:15.665119 [debug] [MainThread]: Flushing usage events
[0m19:16:25.688194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6F2F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71657FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71657E50>]}


============================== 19:16:25.693286 | f8b2db04-7965-4aff-ba8d-07b4210d2100 ==============================
[0m19:16:25.693286 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:16:25.695294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:16:25.818052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71657F10>]}
[0m19:16:25.834756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71764B20>]}
[0m19:16:25.850436 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:16:25.959869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:25.959869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:25.960871 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:16:25.976647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71B15240>]}
[0m19:16:26.005250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71A4E200>]}
[0m19:16:26.006238 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:16:26.008232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71A4E3E0>]}
[0m19:16:26.013405 [info ] [MainThread]: 
[0m19:16:26.015424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:16:26.022435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:16:26.046284 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:16:26.047283 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:16:26.048282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:26.114153 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:16:26.117074 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:16:26.123926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:16:26.129959 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:16:26.130965 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:16:26.133001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:26.177994 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.178996 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:16:26.179993 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:16:26.194517 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:16:26.196540 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:16:26.197540 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:16:26.212608 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:26.213124 [debug] [MainThread]: On master: BEGIN
[0m19:16:26.214135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:26.274065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.275072 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:26.276074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:16:26.310930 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:16:26.312436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71B597E0>]}
[0m19:16:26.313956 [debug] [MainThread]: On master: ROLLBACK
[0m19:16:26.315964 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:26.317379 [debug] [MainThread]: On master: BEGIN
[0m19:16:26.319915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.320740 [debug] [MainThread]: On master: COMMIT
[0m19:16:26.323823 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:26.324830 [debug] [MainThread]: On master: COMMIT
[0m19:16:26.326833 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:16:26.326833 [debug] [MainThread]: On master: Close
[0m19:16:26.328831 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:16:26.331766 [info ] [MainThread]: 
[0m19:16:26.355780 [debug] [Thread-1 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:16:26.355780 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:16:26.357778 [info ] [Thread-1 (]: 1 of 4 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:16:26.369841 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:16:26.358779 [info ] [Thread-2 (]: 2 of 4 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:16:26.376015 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_production_plan'
[0m19:16:26.377964 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:16:26.374917 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:16:26.384022 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:16:26.396831 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:16:26.411042 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:16:26.386045 => 19:16:26.411042
[0m19:16:26.415548 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:16:26.412556 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:16:26.377964 => 19:16:26.412556
[0m19:16:26.440287 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:16:26.509874 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:16:26.515952 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:16:26.524124 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:16:26.525124 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:16:26.526124 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:16:26.527125 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:16:26.528124 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:26.530128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:16:26.607814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.608812 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:16:26.609811 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.610814 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:16:26.612327 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:16:26.613851 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:16:26.644195 [debug] [Thread-1 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:16:26.655274 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:16:26.655274 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:16:26.656269 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:16:26.661268 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:16:26.663014 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:16:26.664169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.672166 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:16:26.673179 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.673687 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:16:26.680218 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:16:26.682223 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:16:26.683240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.702896 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.714601 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:16:26.720549 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:16:26.722506 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:16:26.723022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:16:26.724037 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:16:26.725029 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:16:26.728520 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:26.729515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:26.738434 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:16:26.743420 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:16:26.744557 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:16:26.745569 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:16:26.756092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:26.759088 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:16:26.418949 => 19:16:26.759088
[0m19:16:26.759088 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:26.760090 [debug] [Thread-1 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:16:26.762422 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:16:26.509874 => 19:16:26.762422
[0m19:16:26.764951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71B6C940>]}
[0m19:16:26.766103 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:16:26.771096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71C02F50>]}
[0m19:16:26.768706 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.40s]
[0m19:16:26.773130 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.40s]
[0m19:16:26.775141 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:16:26.777669 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:16:26.778665 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:16:26.780948 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m19:16:26.780948 [info ] [Thread-1 (]: 3 of 4 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:16:26.785035 [info ] [Thread-2 (]: 4 of 4 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:16:26.789034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m19:16:26.790030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:16:26.794231 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:16:26.792547 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:16:26.805498 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:16:26.812437 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:16:26.819862 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:16:26.795092 => 19:16:26.815734
[0m19:16:26.822296 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m19:16:26.825600 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:16:26.807641 => 19:16:26.824382
[0m19:16:26.835154 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:16:26.837154 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:16:26.860395 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:16:26.862395 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:16:26.863202 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:16:26.865223 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:16:26.867229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:16:26.870227 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:16:26.873277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:26.933152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.936151 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:16:26.937549 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:16:26.943303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:26.945358 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:16:26.946117 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date, year_week,product_type,plan
from base
  );
  
[0m19:16:26.954240 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:16:26.960771 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:16:26.960771 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:16:26.963297 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.969499 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:16:26.970508 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:16:26.970880 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:16:26.975491 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:16:26.976485 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:16:26.977997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.981192 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:16:26.982186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.983182 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:16:26.989214 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:16:26.990247 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:16:26.991078 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:16:26.993639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:26.994754 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:26.998761 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:16:27.003790 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:16:27.004479 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:16:27.005247 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:16:27.006244 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:16:27.009647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:27.016136 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:16:27.017230 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:27.018255 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:16:27.021252 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:16:26.826616 => 19:16:27.020257
[0m19:16:27.022766 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m19:16:27.024580 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71B15210>]}
[0m19:16:27.025905 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.23s]
[0m19:16:27.029023 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m19:16:27.042266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:27.045295 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:16:26.841517 => 19:16:27.045295
[0m19:16:27.046294 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:16:27.048295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8b2db04-7965-4aff-ba8d-07b4210d2100', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71BF80A0>]}
[0m19:16:27.055763 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.26s]
[0m19:16:27.058748 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:16:27.063870 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:27.065055 [debug] [MainThread]: On master: BEGIN
[0m19:16:27.068074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:27.137915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:27.139890 [debug] [MainThread]: On master: COMMIT
[0m19:16:27.139890 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:27.141341 [debug] [MainThread]: On master: COMMIT
[0m19:16:27.143363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:16:27.143872 [debug] [MainThread]: On master: Close
[0m19:16:27.144881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:27.145882 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:16:27.146885 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:16:27.147883 [debug] [MainThread]: Connection 'model.instagrid.dim_manufactured_units' was properly closed.
[0m19:16:27.149149 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:16:27.150163 [info ] [MainThread]: 
[0m19:16:27.153135 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m19:16:27.157632 [debug] [MainThread]: Command end result
[0m19:16:27.168169 [info ] [MainThread]: 
[0m19:16:27.170175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:27.171171 [info ] [MainThread]: 
[0m19:16:27.173190 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:16:27.176739 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:27.175724 after 1.51 seconds
[0m19:16:27.177741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F6F2F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71C02F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F71C870D0>]}
[0m19:16:27.180603 [debug] [MainThread]: Flushing usage events
[0m19:18:34.265889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC25CF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2805BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2805BEB0>]}


============================== 19:18:34.275260 | 4e2b1288-9bae-4178-a963-1dd8491f0f02 ==============================
[0m19:18:34.275260 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:18:34.278262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:18:34.425368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2805BF70>]}
[0m19:18:34.454345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC28164CA0>]}
[0m19:18:34.475025 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:18:34.711511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:18:34.714189 [debug] [MainThread]: Partial parsing: updated file: instagrid://models\warehouse\dim_manufactured_units.sql
[0m19:18:34.856080 [debug] [MainThread]: 1699: static parser successfully parsed warehouse\dim_manufactured_units.sql
[0m19:18:34.979559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:18:35.094393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2857DE40>]}
[0m19:18:35.243111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2845E2C0>]}
[0m19:18:35.245229 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:18:35.318977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2845E500>]}
[0m19:18:35.347146 [info ] [MainThread]: 
[0m19:18:35.368762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:35.489996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:18:35.524910 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:18:35.527072 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:18:35.528074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:35.677213 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:18:35.680537 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:18:35.702194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:18:35.721277 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:18:35.725325 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:18:35.727559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:35.799342 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:18:35.800343 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:18:35.802853 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:18:35.821170 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:18:35.823186 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:18:35.824204 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:18:35.838003 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.839000 [debug] [MainThread]: On master: BEGIN
[0m19:18:35.841201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:35.907028 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:35.908053 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.909053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:35.939756 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:18:35.940755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC285AE2F0>]}
[0m19:18:35.942264 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:35.943307 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.944635 [debug] [MainThread]: On master: BEGIN
[0m19:18:35.945336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:35.946723 [debug] [MainThread]: On master: COMMIT
[0m19:18:35.947741 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:35.948739 [debug] [MainThread]: On master: COMMIT
[0m19:18:35.950967 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:18:35.951655 [debug] [MainThread]: On master: Close
[0m19:18:35.953205 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:18:35.962558 [info ] [MainThread]: 
[0m19:18:35.994175 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:18:35.995029 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:18:35.996102 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:18:36.000026 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:18:36.002534 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:18:36.009638 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:18:36.013141 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:18:36.005619 => 19:18:36.012632
[0m19:18:36.014223 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:18:35.998025 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:18:36.101063 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:18:36.128843 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:18:36.137349 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:18:36.143371 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:18:36.147394 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:18:36.138354 => 19:18:36.146394
[0m19:18:36.148393 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:18:36.164438 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:18:36.166847 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:18:36.190786 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:18:36.192298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:18:36.207462 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:18:36.208480 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:18:36.211536 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:18:36.379285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:36.380285 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:18:36.381286 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:18:36.395344 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:18:36.414159 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:18:36.416047 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:18:36.420486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.427050 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:18:36.429050 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:18:36.431049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.463128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:36.480020 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:18:36.493154 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:18:36.491110 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:18:36.495828 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:18:36.497009 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:18:36.508061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:18:36.523190 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:18:36.524265 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:18:36.536299 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:18:36.545071 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:18:36.547121 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:18:36.549497 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.559504 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:18:36.560019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:18:36.561657 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:18:36.566637 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:18:36.018649 => 19:18:36.564416
[0m19:18:36.569650 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.571668 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:18:36.579074 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:18:36.585230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC286126B0>]}
[0m19:18:36.588509 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:18:36.590999 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.59s]
[0m19:18:36.593116 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:18:36.595695 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:18:36.597164 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m19:18:36.598177 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:18:36.610650 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:18:36.600680 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:18:36.612792 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:18:36.614582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m19:18:36.622596 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:18:36.625180 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:18:36.630433 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:18:36.148393 => 19:18:36.630433
[0m19:18:36.640479 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:18:36.641482 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:18:36.646025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC28641F00>]}
[0m19:18:36.651178 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.55s]
[0m19:18:36.655523 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:18:36.631434 => 19:18:36.654836
[0m19:18:36.656363 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:18:36.657867 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m19:18:36.659881 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:18:36.676493 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:18:36.679971 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:18:36.690383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m19:18:36.691381 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:18:36.714210 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:18:36.718157 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:18:36.725912 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:18:36.726912 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:18:36.693412 => 19:18:36.726912
[0m19:18:36.728911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:36.730908 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:18:36.755612 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:18:36.760615 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:18:36.770333 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:18:36.772454 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:18:36.826894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:36.827896 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:18:36.829894 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:18:36.844206 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:36.846127 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:18:36.847137 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:18:36.848139 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:18:36.856765 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:18:36.858279 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:18:36.860296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.867043 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:18:36.869059 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:18:36.871060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.875971 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:18:36.876973 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:18:36.878391 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:18:36.886460 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:18:36.892456 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:18:36.894489 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.890458 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:18:36.901199 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:18:36.903306 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:18:36.905331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:18:36.911597 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:18:36.911597 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:36.913108 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:18:36.917647 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:18:36.919644 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:18:36.920645 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:18:36.924213 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:18:36.924213 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:18:36.929520 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:18:36.932490 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:18:36.662360 => 19:18:36.931491
[0m19:18:36.934011 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:18:36.936013 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m19:18:36.940015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC285D5AB0>]}
[0m19:18:36.941011 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.33s]
[0m19:18:36.943045 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m19:18:36.945306 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:18:36.946561 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m19:18:36.950842 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:18:36.736955 => 19:18:36.949833
[0m19:18:36.953358 [info ] [Thread-1 (]: 5 of 6 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:18:36.956087 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:18:36.959694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:18:36.960830 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2857C7F0>]}
[0m19:18:36.962343 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:18:36.964877 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.27s]
[0m19:18:36.974312 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:18:36.976326 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:18:36.978323 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m19:18:36.985738 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:18:36.965877 => 19:18:36.984741
[0m19:18:36.980654 [info ] [Thread-2 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:18:36.988736 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m19:18:36.991167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:18:37.006867 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:18:37.008859 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m19:18:37.013394 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:18:37.019734 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:18:37.024888 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:18:37.025890 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 19:18:37.009868 => 19:18:37.025890
[0m19:18:37.026889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:37.028888 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m19:18:37.047111 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:18:37.054422 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:18:37.056850 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:18:37.057860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:18:37.125699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:37.126719 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:18:37.127696 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:18:37.137341 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:18:37.139392 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:18:37.141342 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    select * from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dim_date=m.date
  );
  
[0m19:18:37.143530 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column d.dim_date does not exist
LINE 15: on d.dim_date=m.date
            ^
HINT:  Perhaps you meant to reference the column "d.dimdate".

[0m19:18:37.145551 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: ROLLBACK
[0m19:18:37.147554 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 19:18:37.030894 => 19:18:37.146557
[0m19:18:37.148555 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m19:18:37.149787 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:18:37.157119 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:18:37.158141 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:18:37.159463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:37.165041 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:18:37.165041 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:18:37.168499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:18:37.171502 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:18:37.173010 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:18:37.174021 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:18:37.176030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:18:37.178030 [debug] [Thread-2 (]: Database Error in model manufactured_final (models\warehouse\manufactured_final.sql)
  column d.dim_date does not exist
  LINE 15: on d.dim_date=m.date
              ^
  HINT:  Perhaps you meant to reference the column "d.dimdate".
  compiled Code at target\run\instagrid\models\warehouse\manufactured_final.sql
[0m19:18:37.180584 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:18:37.181591 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC28676BC0>]}
[0m19:18:37.184186 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:18:37.185766 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model public.manufactured_final ................ [[31mERROR[0m in 0.19s]
[0m19:18:37.190758 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m19:18:37.193796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:18:37.200177 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:18:36.992176 => 19:18:37.199165
[0m19:18:37.203090 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m19:18:37.207129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2b1288-9bae-4178-a963-1dd8491f0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC286A4A90>]}
[0m19:18:37.208129 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.25s]
[0m19:18:37.211128 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m19:18:37.215193 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:37.218743 [debug] [MainThread]: On master: BEGIN
[0m19:18:37.220721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:18:37.290665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:37.293186 [debug] [MainThread]: On master: COMMIT
[0m19:18:37.294646 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:37.294646 [debug] [MainThread]: On master: COMMIT
[0m19:18:37.296944 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:18:37.297945 [debug] [MainThread]: On master: Close
[0m19:18:37.300956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:37.303001 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:18:37.304016 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:18:37.305031 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:18:37.307027 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:18:37.308027 [info ] [MainThread]: 
[0m19:18:37.310343 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m19:18:37.314508 [debug] [MainThread]: Command end result
[0m19:18:37.330987 [info ] [MainThread]: 
[0m19:18:37.336599 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:18:37.347050 [info ] [MainThread]: 
[0m19:18:37.348049 [error] [MainThread]: [33mDatabase Error in model manufactured_final (models\warehouse\manufactured_final.sql)[0m
[0m19:18:37.354286 [error] [MainThread]:   column d.dim_date does not exist
[0m19:18:37.361090 [error] [MainThread]:   LINE 15: on d.dim_date=m.date
[0m19:18:37.363143 [error] [MainThread]:               ^
[0m19:18:37.365168 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "d.dimdate".
[0m19:18:37.376109 [error] [MainThread]:   compiled Code at target\run\instagrid\models\warehouse\manufactured_final.sql
[0m19:18:37.380110 [info ] [MainThread]: 
[0m19:18:37.381110 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m19:18:37.390670 [debug] [MainThread]: Command `dbt run` failed at 19:18:37.389654 after 3.16 seconds
[0m19:18:37.394771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC25CF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC28164CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2845DA50>]}
[0m19:18:37.395779 [debug] [MainThread]: Flushing usage events
[0m19:18:59.014732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CD4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CF857F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CF857E20>]}


============================== 19:18:59.019754 | 11754651-188d-45ec-accd-2b39cda1d04e ==============================
[0m19:18:59.019754 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:18:59.022269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:18:59.140578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CF857EE0>]}
[0m19:18:59.164396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CF965810>]}
[0m19:18:59.183085 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:18:59.271090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:59.272596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:59.274126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:18:59.295937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFD152D0>]}
[0m19:18:59.322295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFC5E290>]}
[0m19:18:59.324832 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:18:59.327831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFC5E470>]}
[0m19:18:59.334930 [info ] [MainThread]: 
[0m19:18:59.336931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:18:59.341300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:18:59.370313 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:18:59.372309 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:18:59.372819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:59.545171 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:18:59.548167 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:18:59.553191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:18:59.565297 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:18:59.566288 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:18:59.569305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:59.754453 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:18:59.754453 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:18:59.755959 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:18:59.767625 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m19:18:59.768654 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:18:59.770625 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:18:59.778842 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:59.779816 [debug] [MainThread]: On master: BEGIN
[0m19:18:59.780816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:18:59.826291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:59.827301 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:59.828292 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:18:59.846001 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:18:59.848210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFD598A0>]}
[0m19:18:59.849190 [debug] [MainThread]: On master: ROLLBACK
[0m19:18:59.850191 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:59.851190 [debug] [MainThread]: On master: BEGIN
[0m19:18:59.852718 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:18:59.853277 [debug] [MainThread]: On master: COMMIT
[0m19:18:59.854241 [debug] [MainThread]: Using postgres connection "master"
[0m19:18:59.855756 [debug] [MainThread]: On master: COMMIT
[0m19:18:59.856776 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:18:59.857772 [debug] [MainThread]: On master: Close
[0m19:18:59.858771 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:18:59.864850 [info ] [MainThread]: 
[0m19:18:59.878601 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:18:59.878601 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:18:59.881605 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:18:59.890588 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:18:59.893091 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:18:59.897561 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:18:59.901581 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:18:59.904478 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:18:59.908145 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:18:59.918915 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:18:59.925049 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:18:59.909148 => 19:18:59.924539
[0m19:18:59.926069 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:18:59.905148 => 19:18:59.925049
[0m19:18:59.927064 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:18:59.928070 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:19:00.005232 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:19:00.015948 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:19:00.018951 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:19:00.019953 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:19:00.020952 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:19:00.022561 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:19:00.025634 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:19:00.028008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:00.111725 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:00.113241 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:19:00.115774 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:19:00.122879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:00.124401 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:19:00.125724 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:19:00.126742 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:19:00.143747 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:19:00.144757 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:19:00.145759 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:19:00.154379 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:19:00.156391 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:19:00.157391 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.167385 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:19:00.168398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.169400 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:19:00.175455 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:19:00.177455 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:19:00.177968 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.181401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.243280 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:19:00.243790 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:19:00.244363 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:19:00.246795 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:19:00.250378 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:19:00.252319 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:19:00.255238 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:00.256237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:00.267412 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:19:00.272915 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:19:00.273433 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:19:00.274444 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:19:00.280268 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:00.282343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:00.285442 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:18:59.930206 => 19:19:00.285442
[0m19:19:00.288451 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:19:00.005232 => 19:19:00.288451
[0m19:19:00.289445 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:19:00.290441 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:19:00.292441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFE0C040>]}
[0m19:19:00.294471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFD5A9E0>]}
[0m19:19:00.295473 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.40s]
[0m19:19:00.304308 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:19:00.305711 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:19:00.302785 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.40s]
[0m19:19:00.327528 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:19:00.336117 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:19:00.307732 [info ] [Thread-2 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:19:00.339124 [info ] [Thread-1 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:19:00.342632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m19:19:00.344472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m19:19:00.345492 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:19:00.350790 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:19:00.358855 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:19:00.371412 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:19:00.375470 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:19:00.360841 => 19:19:00.374532
[0m19:19:00.376471 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:19:00.408297 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:19:00.411298 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:19:00.350790 => 19:19:00.410299
[0m19:19:00.412297 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:19:00.425677 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:19:00.427676 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:19:00.434484 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:19:00.436501 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:19:00.437499 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:19:00.438502 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:19:00.440726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:00.517821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:00.520819 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:19:00.522331 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:19:00.526864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:00.527862 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:19:00.529865 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:19:00.539178 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:19:00.545213 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:19:00.546215 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:19:00.550382 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.558137 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:19:00.558137 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:19:00.559132 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:19:00.567116 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:19:00.568071 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:19:00.569074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.573918 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:19:00.573918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.575022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:19:00.579254 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:19:00.581237 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:19:00.584426 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:19:00.586464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.591481 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:19:00.593003 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:00.594014 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:19:00.601013 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:19:00.603051 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:19:00.604091 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:19:00.606928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:00.610930 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:19:00.612472 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:00.614007 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:19:00.619023 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:19:00.414336 => 19:19:00.617003
[0m19:19:00.620001 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:19:00.622515 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFE6CEE0>]}
[0m19:19:00.624054 [info ] [Thread-2 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.28s]
[0m19:19:00.626350 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:00.628365 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:19:00.634865 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:19:00.377987 => 19:19:00.632258
[0m19:19:00.636863 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m19:19:00.638851 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:19:00.639257 [info ] [Thread-2 (]: 5 of 6 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:19:00.642382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFE7A980>]}
[0m19:19:00.643948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:19:00.644963 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.30s]
[0m19:19:00.647977 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:19:00.650987 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:19:00.658431 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:19:00.660795 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_final
[0m19:19:00.665869 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:19:00.652576 => 19:19:00.664863
[0m19:19:00.668860 [info ] [Thread-1 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:19:00.670864 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m19:19:00.672378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:19:00.684375 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:19:00.687407 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_final
[0m19:19:00.694589 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:19:00.697600 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:19:00.703180 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:19:00.705207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:19:00.725753 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (compile): 19:19:00.689904 => 19:19:00.725753
[0m19:19:00.727764 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_final
[0m19:19:00.743274 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:19:00.745799 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:19:00.747800 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:19:00.750815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:00.812964 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:00.814492 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:19:00.816502 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:19:00.834093 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:19:00.839090 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:19:00.840094 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:19:00.841093 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.843128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:00.849011 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:19:00.849998 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:19:00.850992 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:19:00.852499 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    select * from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
  );
  
[0m19:19:00.854027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.859155 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:19:00.860155 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:19:00.861156 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:19:00.864643 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:00.872633 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:19:00.873142 [debug] [Thread-1 (]: SQL status: SELECT 700 in 0.0 seconds
[0m19:19:00.874154 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:19:00.880902 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:19:00.882466 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m19:19:00.884949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:00.888475 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:19:00.889933 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:00.890945 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:19:00.893975 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:19:00.673900 => 19:19:00.893975
[0m19:19:00.894982 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:19:00.896991 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m19:19:00.900159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFE95A50>]}
[0m19:19:00.902758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:00.904368 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.26s]
[0m19:19:00.910619 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:19:00.915074 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m19:19:00.916076 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m19:19:00.920068 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:00.924225 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (execute): 19:19:00.734806 => 19:19:00.923118
[0m19:19:00.925146 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: Close
[0m19:19:00.927148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11754651-188d-45ec-accd-2b39cda1d04e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFEB5AB0>]}
[0m19:19:00.929142 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 700[0m in 0.26s]
[0m19:19:00.933213 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_final
[0m19:19:00.955355 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:00.956353 [debug] [MainThread]: On master: BEGIN
[0m19:19:00.957354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:01.051337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:01.052828 [debug] [MainThread]: On master: COMMIT
[0m19:19:01.054347 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:01.054505 [debug] [MainThread]: On master: COMMIT
[0m19:19:01.056356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:01.057351 [debug] [MainThread]: On master: Close
[0m19:19:01.058348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:01.059350 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:19:01.060349 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:19:01.061843 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:19:01.063363 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:19:01.064894 [info ] [MainThread]: 
[0m19:19:01.066894 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m19:19:01.073129 [debug] [MainThread]: Command end result
[0m19:19:01.088196 [info ] [MainThread]: 
[0m19:19:01.090200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:01.097950 [info ] [MainThread]: 
[0m19:19:01.100963 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:19:01.106131 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:01.105131 after 2.12 seconds
[0m19:19:01.107131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CD4F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFEB5AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146CFD5A9E0>]}
[0m19:19:01.108128 [debug] [MainThread]: Flushing usage events
[0m19:19:07.222262 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:23:52.473369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2E47BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2E47BEB0>]}


============================== 19:23:52.483255 | 61eddafa-2868-41a9-bd7b-18c37501d932 ==============================
[0m19:23:52.483255 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:23:52.485417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:23:52.621053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2E47BF70>]}
[0m19:23:52.639225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2E596500>]}
[0m19:23:52.668470 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:23:52.767856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:52.768871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:52.770849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:23:52.785263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EA15360>]}
[0m19:23:52.819083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2E67E2C0>]}
[0m19:23:52.820083 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:23:52.823761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2E67E440>]}
[0m19:23:52.833087 [info ] [MainThread]: 
[0m19:23:52.836099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:23:52.838101 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:23:52.866178 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:23:52.868177 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:23:52.869190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:52.931943 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:23:52.934042 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:23:52.938701 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:23:52.945768 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:23:52.946768 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:23:52.948772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:52.992984 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:23:52.994018 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:23:52.994999 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:23:53.021100 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:23:53.023152 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:23:53.024342 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:23:53.035706 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:53.036707 [debug] [MainThread]: On master: BEGIN
[0m19:23:53.036707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:53.086854 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:23:53.087853 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:53.088855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:23:53.115002 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:23:53.117014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EA59930>]}
[0m19:23:53.118007 [debug] [MainThread]: On master: ROLLBACK
[0m19:23:53.119010 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:53.120019 [debug] [MainThread]: On master: BEGIN
[0m19:23:53.121212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:23:53.122561 [debug] [MainThread]: On master: COMMIT
[0m19:23:53.123086 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:53.125113 [debug] [MainThread]: On master: COMMIT
[0m19:23:53.126126 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:23:53.128123 [debug] [MainThread]: On master: Close
[0m19:23:53.132123 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:23:53.137677 [info ] [MainThread]: 
[0m19:23:53.154407 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:23:53.154407 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:23:53.155409 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:23:53.162212 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:23:53.156409 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:23:53.163732 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:23:53.165746 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:23:53.170679 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:23:53.175328 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:23:53.184020 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:23:53.185034 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:23:53.168171 => 19:23:53.185034
[0m19:23:53.186034 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:23:53.275330 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:23:53.178979 => 19:23:53.275330
[0m19:23:53.276332 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:23:53.277331 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:23:53.285026 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:23:53.287036 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:23:53.288037 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:23:53.289035 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:23:53.292551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:53.290035 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:23:53.297650 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:23:53.369279 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:53.370787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:53.370787 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:23:53.372320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:23:53.373838 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:23:53.376329 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:23:53.387907 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:23:53.398127 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:23:53.399135 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:23:53.400140 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:23:53.406195 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:23:53.408512 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:23:53.409526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.412525 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.418972 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:23:53.423076 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:23:53.424116 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:23:53.425241 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:23:53.427251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.428251 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.460045 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:23:53.465126 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:23:53.465998 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:23:53.467030 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:23:53.468013 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:23:53.469015 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:23:53.472375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:53.473388 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:53.480538 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:23:53.484104 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:23:53.486070 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:23:53.487070 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:23:53.492301 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:53.493843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:53.497863 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:23:53.279416 => 19:23:53.496915
[0m19:23:53.500884 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:23:53.187035 => 19:23:53.499859
[0m19:23:53.500884 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:23:53.502392 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:23:53.504636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EA581F0>]}
[0m19:23:53.506642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EA493F0>]}
[0m19:23:53.508677 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.34s]
[0m19:23:53.513030 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:23:53.509693 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.35s]
[0m19:23:53.514174 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:23:53.516064 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:23:53.519059 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:23:53.517071 [info ] [Thread-2 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:23:53.522593 [info ] [Thread-1 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:23:53.525510 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m19:23:53.528524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m19:23:53.529528 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:23:53.530744 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:23:53.538615 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:23:53.547706 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:23:53.550836 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:23:53.532263 => 19:23:53.550836
[0m19:23:53.553360 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:23:53.540625 => 19:23:53.552407
[0m19:23:53.554470 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:23:53.554885 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:23:53.566401 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:23:53.582746 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:23:53.588549 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:23:53.605012 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:23:53.606013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:23:53.608016 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:23:53.646374 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:23:53.648377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:53.755423 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:53.756422 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:23:53.757420 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:23:53.773139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:53.774723 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:23:53.775739 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:23:53.777905 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:23:53.782410 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:23:53.783435 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:23:53.785576 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.790591 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:23:53.793139 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:23:53.796338 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.801333 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:23:53.803354 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:23:53.804366 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:23:53.813403 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:23:53.820230 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:23:53.821231 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:53.822220 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:23:53.828059 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:23:53.829058 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:23:53.830436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.838191 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:23:53.838191 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:53.839150 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:23:53.842291 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:23:53.555883 => 19:23:53.842291
[0m19:23:53.846865 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:23:53.846865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:53.849243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EB71720>]}
[0m19:23:53.853030 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:23:53.855219 [info ] [Thread-2 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.33s]
[0m19:23:53.856320 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:23:53.859652 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:23:53.862145 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:23:53.865698 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m19:23:53.866743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:53.867759 [info ] [Thread-2 (]: 5 of 6 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:23:53.872276 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:23:53.873299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:23:53.878747 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:23:53.875356 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:23:53.885054 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:23:53.888442 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:23:53.880483 => 19:23:53.887423
[0m19:23:53.890441 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m19:23:53.892886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:53.912362 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:23:53.569410 => 19:23:53.910566
[0m19:23:53.918483 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:23:53.919497 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:23:53.922498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EB000D0>]}
[0m19:23:53.924807 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:23:53.939006 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:23:53.940129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:23:53.936949 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.39s]
[0m19:23:53.952505 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:23:53.953567 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_final
[0m19:23:53.955724 [info ] [Thread-1 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:23:53.959979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:23:53.963087 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_final
[0m19:23:53.973228 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:23:54.003773 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (compile): 19:23:53.964711 => 19:23:54.002315
[0m19:23:54.004786 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_final
[0m19:23:54.033228 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:23:54.037250 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:23:54.038252 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:23:54.039252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:54.067682 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:54.068681 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:23:54.070685 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:23:54.084925 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:23:54.094022 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:23:54.096337 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:23:54.099047 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:54.104623 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:23:54.105767 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:23:54.107623 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:54.114738 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:23:54.115749 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:23:54.116745 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:23:54.119749 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:54.125444 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:23:54.128656 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:23:54.129602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:23:54.131604 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:23:54.132599 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
)

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,plan
 from base
  );
  
[0m19:23:54.135310 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:54.138117 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:23:53.899010 => 19:23:54.138117
[0m19:23:54.139118 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m19:23:54.141119 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EB60C40>]}
[0m19:23:54.146293 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.27s]
[0m19:23:54.148563 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m19:23:54.156115 [debug] [Thread-1 (]: SQL status: SELECT 700 in 0.0 seconds
[0m19:23:54.167247 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:23:54.168151 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m19:23:54.169219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:54.177137 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:23:54.179166 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m19:23:54.182695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:23:54.188274 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:23:54.189274 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:23:54.191284 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:23:54.199126 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:23:54.204661 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:23:54.205637 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m19:23:54.216707 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:23:54.219711 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (execute): 19:23:54.005784 => 19:23:54.218715
[0m19:23:54.220693 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: Close
[0m19:23:54.222283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61eddafa-2868-41a9-bd7b-18c37501d932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EB971C0>]}
[0m19:23:54.224558 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 700[0m in 0.27s]
[0m19:23:54.232836 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_final
[0m19:23:54.237482 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:54.239487 [debug] [MainThread]: On master: BEGIN
[0m19:23:54.240482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:54.326811 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:23:54.328806 [debug] [MainThread]: On master: COMMIT
[0m19:23:54.330942 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:54.332997 [debug] [MainThread]: On master: COMMIT
[0m19:23:54.335050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:23:54.336058 [debug] [MainThread]: On master: Close
[0m19:23:54.339056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:54.339056 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:23:54.341247 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:23:54.343306 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:23:54.345337 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:23:54.349339 [info ] [MainThread]: 
[0m19:23:54.363084 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m19:23:54.388999 [debug] [MainThread]: Command end result
[0m19:23:54.425316 [info ] [MainThread]: 
[0m19:23:54.429315 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:54.431318 [info ] [MainThread]: 
[0m19:23:54.433337 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:23:54.435923 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:54.435923 after 1.99 seconds
[0m19:23:54.436923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C0F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2EB971C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E2C72AD70>]}
[0m19:23:54.437925 [debug] [MainThread]: Flushing usage events
[0m19:24:26.486304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CF1F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D165BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D165BE50>]}


============================== 19:24:26.493904 | cf46c64d-43d2-4a29-a74d-01ea21fbbe93 ==============================
[0m19:24:26.493904 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:24:26.496013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:24:26.630349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D165BEB0>]}
[0m19:24:26.649254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1765D80>]}
[0m19:24:26.666423 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:24:26.765368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:26.766365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:26.767349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:24:26.796691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1B19300>]}
[0m19:24:26.819280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1A662C0>]}
[0m19:24:26.823802 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:24:26.827959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1A664A0>]}
[0m19:24:26.830978 [info ] [MainThread]: 
[0m19:24:26.834150 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:26.844073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:24:26.878281 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:24:26.880288 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:24:26.880288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:27.004459 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:24:27.007992 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:24:27.019254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:24:27.030280 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:24:27.034017 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:24:27.049224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:27.116840 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:27.116840 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:24:27.117843 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:24:27.133243 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:24:27.136256 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:24:27.137449 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:24:27.149635 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:27.150635 [debug] [MainThread]: On master: BEGIN
[0m19:24:27.150635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:27.197074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:27.198098 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:27.198098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:27.223002 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:24:27.225022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1B598D0>]}
[0m19:24:27.226015 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:27.228009 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:27.228009 [debug] [MainThread]: On master: BEGIN
[0m19:24:27.230008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:27.231016 [debug] [MainThread]: On master: COMMIT
[0m19:24:27.231016 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:27.232528 [debug] [MainThread]: On master: COMMIT
[0m19:24:27.233054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:27.234064 [debug] [MainThread]: On master: Close
[0m19:24:27.236066 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:24:27.245990 [info ] [MainThread]: 
[0m19:24:27.263076 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:24:27.264202 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:24:27.265088 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:24:27.269941 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:24:27.272999 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:24:27.267086 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:24:27.278770 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:24:27.282344 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:24:27.285883 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:24:27.297535 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:24:27.276380 => 19:24:27.297535
[0m19:24:27.298835 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:24:27.299851 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:24:27.361093 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:24:27.289439 => 19:24:27.360108
[0m19:24:27.383873 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:24:27.384880 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:24:27.392839 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:24:27.394351 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:27.394885 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:24:27.396064 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:27.397075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:27.398075 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:24:27.400075 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:24:27.463720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:27.466116 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:27.467136 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:24:27.481242 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:24:27.495200 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:27.497200 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:24:27.498698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:27.506777 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:27.507773 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:24:27.510771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:27.544218 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:27.547145 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:24:27.548143 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:27.549185 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:27.550145 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:24:27.551261 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:24:27.559338 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:24:27.563332 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:27.564449 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:24:27.565351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:27.574089 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:24:27.575096 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:27.575096 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:24:27.580103 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:27.581097 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:24:27.584132 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:27.589880 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:24:27.590870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:27.592378 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:27.596595 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:24:27.300850 => 19:24:27.596595
[0m19:24:27.597594 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:24:27.598592 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:24:27.602360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1B48AC0>]}
[0m19:24:27.602360 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:27.614614 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:24:27.605407 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.33s]
[0m19:24:27.616627 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:24:27.618893 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:24:27.624301 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m19:24:27.627031 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:27.629023 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:24:27.633072 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:24:27.386884 => 19:24:27.633072
[0m19:24:27.635277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m19:24:27.637277 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:24:27.639276 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:24:27.641448 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1B58B50>]}
[0m19:24:27.647493 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:24:27.649494 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.36s]
[0m19:24:27.658435 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:24:27.660432 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:24:27.642959 => 19:24:27.659431
[0m19:24:27.661433 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m19:24:27.674476 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:24:27.678310 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:27.679309 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:24:27.680308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:27.688300 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:24:27.689833 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:24:27.693451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m19:24:27.694974 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:24:27.701350 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:24:27.706433 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:24:27.695975 => 19:24:27.705420
[0m19:24:27.710322 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:24:27.721342 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:24:27.723883 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:27.724902 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:24:27.725898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:27.817893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:27.820910 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:27.823945 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:24:27.846546 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:24:27.857875 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:27.860297 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:24:27.862902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:27.873513 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:27.876855 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:24:27.880931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:27.888621 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:24:27.891634 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:27.893148 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:24:27.901193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:27.909892 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:24:27.911999 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:24:27.918821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:27.925085 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:24:27.662941 => 19:24:27.923926
[0m19:24:27.926947 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m19:24:27.928989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1E1FE80>]}
[0m19:24:27.930987 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.29s]
[0m19:24:27.944449 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m19:24:27.946464 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m19:24:27.947464 [info ] [Thread-1 (]: 5 of 6 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:24:27.949464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:24:27.950460 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:24:27.960264 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:24:27.965860 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:24:27.952740 => 19:24:27.965860
[0m19:24:27.971130 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m19:24:27.998151 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:24:27.999152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:28.000154 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:28.001152 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:24:28.007639 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:28.008621 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:24:28.011073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:28.086023 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:24:28.095238 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:28.096240 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:24:28.098236 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:28.111407 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:28.113441 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:24:28.116053 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:28.123882 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:24:28.126849 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:28.127944 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:24:28.134999 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:28.143093 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:24:28.145116 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:24:28.150248 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:28.155901 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:24:27.711290 => 19:24:28.154732
[0m19:24:28.157916 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:24:28.157916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:28.159918 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1B6C850>]}
[0m19:24:28.165181 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:28.166203 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.47s]
[0m19:24:28.170890 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:24:28.168594 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:24:28.176008 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m19:24:28.178010 [info ] [Thread-2 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:24:28.181235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:24:28.182227 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m19:24:28.192997 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:24:28.196027 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:24:28.202534 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:28.204199 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:24:28.206097 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 19:24:28.184322 => 19:24:28.205089
[0m19:24:28.208114 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m19:24:28.209335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:28.220844 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:24:28.230419 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:28.232419 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:24:28.264296 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:24:28.265147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:28.266148 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:24:28.275788 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:24:28.277709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:28.279720 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:28.282234 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:24:28.285775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:28.294726 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:24:28.295739 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:24:28.303320 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:28.310356 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:24:27.980422 => 19:24:28.308340
[0m19:24:28.313380 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m19:24:28.315400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1BAF790>]}
[0m19:24:28.317405 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.37s]
[0m19:24:28.324710 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m19:24:28.417885 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:28.418889 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:24:28.421371 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
)

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,plan as manufacturedplan
 from base
  );
  
[0m19:24:28.460714 [debug] [Thread-2 (]: SQL status: SELECT 700 in 0.0 seconds
[0m19:24:28.467779 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:24:28.468771 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m19:24:28.470774 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:28.478948 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:24:28.479949 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m19:24:28.480951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:28.489312 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:24:28.491307 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:24:28.492872 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:24:28.496399 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:28.502299 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:24:28.506012 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m19:24:28.513083 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:28.515102 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 19:24:28.210351 => 19:24:28.515102
[0m19:24:28.516103 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m19:24:28.517102 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf46c64d-43d2-4a29-a74d-01ea21fbbe93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1AFFF40>]}
[0m19:24:28.519520 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 700[0m in 0.34s]
[0m19:24:28.526472 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m19:24:28.530737 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:28.534031 [debug] [MainThread]: On master: BEGIN
[0m19:24:28.535040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:28.598493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:28.599982 [debug] [MainThread]: On master: COMMIT
[0m19:24:28.600989 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:28.602498 [debug] [MainThread]: On master: COMMIT
[0m19:24:28.604150 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:28.605051 [debug] [MainThread]: On master: Close
[0m19:24:28.609061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:28.611051 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:24:28.612566 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:24:28.614134 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:24:28.616236 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:24:28.617144 [info ] [MainThread]: 
[0m19:24:28.619144 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m19:24:28.624822 [debug] [MainThread]: Command end result
[0m19:24:28.638304 [info ] [MainThread]: 
[0m19:24:28.645194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:28.647212 [info ] [MainThread]: 
[0m19:24:28.649670 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:24:28.656361 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:28.656361 after 2.20 seconds
[0m19:24:28.658367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213CF1F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1765D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D1AFDF00>]}
[0m19:24:28.659358 [debug] [MainThread]: Flushing usage events
[0m19:25:04.339860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001440F3F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411757FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411757EB0>]}


============================== 19:25:04.345531 | 40e286ce-e51d-4dde-be98-2996a58cde28 ==============================
[0m19:25:04.345531 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:25:04.347534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:25:04.494378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411757F10>]}
[0m19:25:04.517919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411862500>]}
[0m19:25:04.536025 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:25:04.656378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:04.657384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:04.659588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:25:04.676268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411C19360>]}
[0m19:25:04.692471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144119622C0>]}
[0m19:25:04.694031 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:25:04.697043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411962440>]}
[0m19:25:04.704685 [info ] [MainThread]: 
[0m19:25:04.709077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:04.725478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:25:04.749278 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:25:04.752295 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:25:04.754328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:04.818712 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:25:04.820712 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:25:04.825726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:25:04.835779 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:25:04.838828 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:25:04.839943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:04.995540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:25:04.995540 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:25:04.996564 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:25:05.008593 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:25:05.010906 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:25:05.010906 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:25:05.021592 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:05.023125 [debug] [MainThread]: On master: BEGIN
[0m19:25:05.024227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:05.189169 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:05.190170 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:05.191165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:05.218028 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:25:05.220033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411C65930>]}
[0m19:25:05.221029 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:05.222537 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:05.223058 [debug] [MainThread]: On master: BEGIN
[0m19:25:05.224067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:05.225068 [debug] [MainThread]: On master: COMMIT
[0m19:25:05.226068 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:05.227380 [debug] [MainThread]: On master: COMMIT
[0m19:25:05.228393 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:25:05.229392 [debug] [MainThread]: On master: Close
[0m19:25:05.231393 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:25:05.236956 [info ] [MainThread]: 
[0m19:25:05.252460 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:25:05.253485 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:25:05.255529 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:25:05.260575 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:25:05.261589 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:25:05.267248 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:25:05.257533 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:25:05.269766 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:25:05.270767 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:25:05.264116 => 19:25:05.270767
[0m19:25:05.270767 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:25:05.273807 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:25:05.282552 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:25:05.307088 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:25:05.274822 => 19:25:05.306089
[0m19:25:05.308088 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:25:05.423964 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:25:05.428970 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:25:05.430971 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:25:05.433041 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:25:05.438073 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:25:05.439072 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:25:05.440072 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:25:05.441073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:05.508966 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:25:05.509976 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:25:05.511337 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:25:05.524449 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:25:05.532427 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:25:05.534887 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:25:05.536471 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.542530 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:25:05.544050 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:25:05.545064 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.576494 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:25:05.577499 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:25:05.577499 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:25:05.581830 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:25:05.593918 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:25:05.594928 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:25:05.600185 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:25:05.606686 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:25:05.309085 => 19:25:05.605825
[0m19:25:05.607683 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:25:05.609696 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411C1B190>]}
[0m19:25:05.611685 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.34s]
[0m19:25:05.614209 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:25:05.617237 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m19:25:05.620223 [info ] [Thread-2 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:25:05.629323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m19:25:05.630324 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:25:05.645228 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:25:05.647528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:25:05.649543 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:25:05.651550 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:25:05.656144 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:25:05.641646 => 19:25:05.655162
[0m19:25:05.660233 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m19:25:05.676246 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:25:05.676246 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:25:05.686377 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:25:05.688393 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:25:05.690415 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:25:05.693410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.693410 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:25:05.699420 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:25:05.704370 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:25:05.705494 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:25:05.707170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.712577 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:25:05.714629 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:25:05.718856 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:25:05.723408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:25:05.728432 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:25:05.730428 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:25:05.736479 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:25:05.739768 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:25:05.284271 => 19:25:05.739768
[0m19:25:05.741333 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:25:05.743859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411CC1D20>]}
[0m19:25:05.745322 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.48s]
[0m19:25:05.748339 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:25:05.751353 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:25:05.753389 [info ] [Thread-1 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:25:05.756412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m19:25:05.757500 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:25:05.763562 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:25:05.772330 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:25:05.758510 => 19:25:05.771325
[0m19:25:05.773355 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:25:05.791402 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:25:05.794512 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:25:05.795453 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:25:05.796451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:05.858312 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:25:05.859306 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:25:05.860309 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:25:05.879227 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:25:05.888605 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:25:05.889586 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:25:05.891587 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.896123 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:25:05.897127 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:25:05.900413 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.905722 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:25:05.906736 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:25:05.907738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:25:05.908735 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:25:05.909740 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:25:05.910734 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:25:05.913255 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:25:05.920779 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:25:05.922291 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:25:05.928823 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:25:05.932338 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:25:05.661237 => 19:25:05.932338
[0m19:25:05.933863 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:25:05.936889 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m19:25:05.940874 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:25:05.943903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411C18A30>]}
[0m19:25:05.944917 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:25:05.946427 [info ] [Thread-2 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.32s]
[0m19:25:05.948780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.951247 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m19:25:05.964554 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:25:05.968489 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:25:05.971495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:05.978056 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:25:05.979056 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:25:05.985652 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:25:05.987650 [debug] [Thread-2 (]: Began running node model.instagrid.dim_production_plan
[0m19:25:05.989651 [info ] [Thread-2 (]: 5 of 6 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:25:05.993166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:25:05.995204 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:25:06.008067 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:25:06.009592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:25:06.017643 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:25:06.019647 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:25:06.025058 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:25:05.997192 => 19:25:06.022666
[0m19:25:06.026299 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_production_plan
[0m19:25:06.043130 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:25:06.046164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:25:06.059253 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:25:06.063074 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:25:05.774454 => 19:25:06.062549
[0m19:25:06.067091 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:25:06.064086 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:25:06.072403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411D6C880>]}
[0m19:25:06.073417 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:25:06.075464 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.32s]
[0m19:25:06.078304 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:25:06.080526 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_final
[0m19:25:06.081539 [info ] [Thread-1 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:25:06.092816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:25:06.094418 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_final
[0m19:25:06.101434 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:25:06.107180 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (compile): 19:25:06.094875 => 19:25:06.106034
[0m19:25:06.109195 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_final
[0m19:25:06.127720 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:25:06.130714 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:25:06.137149 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:25:06.143149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:06.199720 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:25:06.200725 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:25:06.202255 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan as productionplan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:25:06.218532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:25:06.219535 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:25:06.220537 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:25:06.227125 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:25:06.228124 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
)

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,plan as manufacturedplan
 from base
  );
  
[0m19:25:06.230250 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:25:06.233155 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:06.239167 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:25:06.240166 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:25:06.242677 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:06.247220 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:25:06.248220 [debug] [Thread-1 (]: SQL status: SELECT 700 in 0.0 seconds
[0m19:25:06.249492 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:25:06.257789 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:25:06.258790 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:25:06.259791 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m19:25:06.262306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:06.268837 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:25:06.269834 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:25:06.270833 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m19:25:06.275964 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:25:06.276970 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:25:06.278236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:25:06.285323 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:25:06.286325 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:25:06.289317 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:25:06.292833 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:25:06.028299 => 19:25:06.292320
[0m19:25:06.293349 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:25:06.294381 [debug] [Thread-2 (]: On model.instagrid.dim_production_plan: Close
[0m19:25:06.297359 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411D868F0>]}
[0m19:25:06.299687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:25:06.298674 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.30s]
[0m19:25:06.307760 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:25:06.308792 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_production_plan
[0m19:25:06.310791 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m19:25:06.318834 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:25:06.320838 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (execute): 19:25:06.111198 => 19:25:06.320838
[0m19:25:06.323357 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: Close
[0m19:25:06.324937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40e286ce-e51d-4dde-be98-2996a58cde28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411D1CD30>]}
[0m19:25:06.326289 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 700[0m in 0.23s]
[0m19:25:06.329810 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_final
[0m19:25:06.332287 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:06.334854 [debug] [MainThread]: On master: BEGIN
[0m19:25:06.335845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:25:06.504320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:25:06.505303 [debug] [MainThread]: On master: COMMIT
[0m19:25:06.506808 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:06.507822 [debug] [MainThread]: On master: COMMIT
[0m19:25:06.508824 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:25:06.509824 [debug] [MainThread]: On master: Close
[0m19:25:06.510823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:06.512331 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:25:06.513376 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:25:06.514459 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:25:06.515642 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:25:06.516651 [info ] [MainThread]: 
[0m19:25:06.518658 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m19:25:06.523178 [debug] [MainThread]: Command end result
[0m19:25:06.536251 [info ] [MainThread]: 
[0m19:25:06.540244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:06.542248 [info ] [MainThread]: 
[0m19:25:06.544283 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:25:06.548380 [debug] [MainThread]: Command `dbt run` succeeded at 19:25:06.547282 after 2.25 seconds
[0m19:25:06.551408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001440F3F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411862500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014411961D50>]}
[0m19:25:06.553436 [debug] [MainThread]: Flushing usage events
[0m19:40:27.707626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C844DF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84717BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84717BE80>]}


============================== 19:40:27.713161 | 61753787-3915-491e-b593-ceb0d787fff2 ==============================
[0m19:40:27.713161 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:40:27.717413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:40:27.829731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84717BEE0>]}
[0m19:40:27.849796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847295D50>]}
[0m19:40:27.867461 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:40:27.972291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:27.973261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:27.975271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.instagrid.Analystics-OBT
[0m19:40:27.989116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847719330>]}
[0m19:40:28.009871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84764E2F0>]}
[0m19:40:28.015006 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:40:28.018952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84764E4D0>]}
[0m19:40:28.022988 [info ] [MainThread]: 
[0m19:40:28.025123 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:28.034389 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:40:28.054517 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:40:28.056312 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:40:28.057311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:28.130794 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:40:28.134834 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:40:28.149543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:40:28.161093 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:40:28.166095 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:40:28.168102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:28.237054 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:40:28.238058 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:40:28.238058 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:40:28.256072 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:40:28.258073 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:40:28.260073 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:40:28.274207 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:28.275226 [debug] [MainThread]: On master: BEGIN
[0m19:40:28.277392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:28.367104 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:28.368101 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:28.370102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:28.408994 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:40:28.411504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847765900>]}
[0m19:40:28.414377 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:28.416107 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:28.418129 [debug] [MainThread]: On master: BEGIN
[0m19:40:28.420552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:28.421567 [debug] [MainThread]: On master: COMMIT
[0m19:40:28.422573 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:28.424100 [debug] [MainThread]: On master: COMMIT
[0m19:40:28.425115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:40:28.427111 [debug] [MainThread]: On master: Close
[0m19:40:28.431112 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:40:28.437455 [info ] [MainThread]: 
[0m19:40:28.469193 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:40:28.470645 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:40:28.472164 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:40:28.476203 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:40:28.477201 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:40:28.483214 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:40:28.473684 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:40:28.485537 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:40:28.486553 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:40:28.479205 => 19:40:28.486553
[0m19:40:28.487552 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:40:28.488551 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:40:28.495033 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:40:28.573723 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:40:28.489551 => 19:40:28.573723
[0m19:40:28.574741 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:40:28.642372 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:40:28.645165 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:40:28.648180 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:40:28.649177 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:40:28.650179 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:40:28.651177 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:40:28.652685 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:40:28.654281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:28.726188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:28.727189 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:40:28.728585 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:40:28.738482 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:40:28.753671 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:40:28.754339 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:28.755569 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:40:28.756583 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:40:28.758585 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:40:28.758585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:28.765476 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:40:28.767476 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:40:28.769903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:28.785741 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:40:28.813135 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:40:28.816146 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:40:28.817142 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:40:28.818149 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:40:28.819148 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:40:28.821146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:28.825169 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:40:28.826169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:28.827173 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:40:28.836762 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:40:28.838987 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:40:28.838987 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:28.845057 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:40:28.846056 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:28.846056 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:40:28.849018 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:40:28.497058 => 19:40:28.849018
[0m19:40:28.850019 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:40:28.851035 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:40:28.854082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8472FD150>]}
[0m19:40:28.855094 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:28.856094 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.38s]
[0m19:40:28.863352 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:40:28.864452 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:40:28.865241 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:40:28.866274 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m19:40:28.868589 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:40:28.870591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m19:40:28.870591 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:28.871586 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:40:28.874116 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:40:28.576734 => 19:40:28.874116
[0m19:40:28.877131 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:40:28.879104 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:40:28.884457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847765CF0>]}
[0m19:40:28.887419 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:40:28.875110 => 19:40:28.887419
[0m19:40:28.888419 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m19:40:28.886413 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.40s]
[0m19:40:28.904873 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:40:28.905890 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:40:28.908926 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:40:28.911590 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:40:28.913178 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:40:28.915243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:28.910581 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:40:28.925133 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m19:40:28.928164 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:40:28.940393 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:40:28.943041 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:40:28.930133 => 19:40:28.943041
[0m19:40:28.945101 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:40:28.958104 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:40:28.960468 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:40:28.963473 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:40:28.965894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:40:29.012504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:29.014720 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:40:29.016173 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:40:29.032665 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:40:29.036732 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:40:29.038713 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:40:29.038713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:29.040715 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:40:29.040715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.042223 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:40:29.048180 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:40:29.051194 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:40:29.053061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.057084 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:40:29.058087 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:40:29.060086 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:40:29.063124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:29.069267 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:40:29.070147 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:40:29.071181 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:40:29.075218 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:40:29.077196 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:40:29.079656 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.087779 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:40:29.088782 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:29.088782 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:40:29.092292 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:40:28.890756 => 19:40:29.090781
[0m19:40:29.093310 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m19:40:29.094437 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.096371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C84785BA60>]}
[0m19:40:29.101371 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:40:29.104410 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:40:29.106416 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:40:29.103399 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.23s]
[0m19:40:29.112243 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m19:40:29.113764 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:29.115777 [debug] [Thread-1 (]: Began running node model.instagrid.dim_production_plan
[0m19:40:29.122104 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:40:29.123143 [info ] [Thread-1 (]: 5 of 6 START sql table model public.dim_production_plan ........................ [RUN]
[0m19:40:29.124218 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:40:29.126307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.dim_production_plan)
[0m19:40:29.128722 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_production_plan
[0m19:40:29.136047 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_production_plan"
[0m19:40:29.138052 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:29.140044 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (compile): 19:40:29.129938 => 19:40:29.139048
[0m19:40:29.145410 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_production_plan
[0m19:40:29.143888 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:40:28.946534 => 19:40:29.143375
[0m19:40:29.162610 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_production_plan"
[0m19:40:29.171232 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:40:29.168265 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:40:29.172742 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: BEGIN
[0m19:40:29.174263 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847861060>]}
[0m19:40:29.175270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:29.177265 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.25s]
[0m19:40:29.191432 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:40:29.192940 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m19:40:29.194461 [info ] [Thread-2 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:40:29.200707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:40:29.203784 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m19:40:29.209800 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:40:29.217361 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 19:40:29.204801 => 19:40:29.214794
[0m19:40:29.218376 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m19:40:29.236388 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:40:29.238388 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:40:29.239392 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:40:29.240619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:40:29.286056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:29.287057 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:40:29.288456 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */

  
    

  create  table "instagrid"."public"."dim_production_plan__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan as productionplan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:40:29.305145 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:40:29.312201 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:40:29.316750 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan" rename to "dim_production_plan__dbt_backup"
[0m19:40:29.318802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.323841 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:40:29.324855 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
alter table "instagrid"."public"."dim_production_plan__dbt_tmp" rename to "dim_production_plan"
[0m19:40:29.325855 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:40:29.327856 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:40:29.329859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.332347 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m19:40:29.336886 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:40:29.339292 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:40:29.341564 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: COMMIT
[0m19:40:29.349290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:29.354912 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_production_plan"
[0m19:40:29.355862 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_production_plan"} */
drop table if exists "instagrid"."public"."dim_production_plan__dbt_backup" cascade
[0m19:40:29.360863 [debug] [Thread-2 (]: SQL status: SELECT 732 in 0.0 seconds
[0m19:40:29.367575 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:40:29.368582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:29.369576 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m19:40:29.374134 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_production_plan (execute): 19:40:29.147431 => 19:40:29.373104
[0m19:40:29.375113 [debug] [Thread-1 (]: On model.instagrid.dim_production_plan: Close
[0m19:40:29.376116 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.377114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8476FE7D0>]}
[0m19:40:29.385286 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:40:29.386284 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.dim_production_plan ................... [[32mSELECT 104[0m in 0.25s]
[0m19:40:29.387284 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m19:40:29.389289 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_production_plan
[0m19:40:29.391347 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:40:29.401606 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:40:29.404174 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:40:29.404174 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:40:29.408053 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:40:29.412597 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:40:29.416671 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m19:40:29.424716 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:40:29.430850 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 19:40:29.219374 => 19:40:29.429828
[0m19:40:29.433085 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m19:40:29.437173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61753787-3915-491e-b593-ceb0d787fff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847798AF0>]}
[0m19:40:29.439143 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.24s]
[0m19:40:29.442653 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m19:40:29.448806 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:29.449839 [debug] [MainThread]: On master: BEGIN
[0m19:40:29.452351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:29.619369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:29.619369 [debug] [MainThread]: On master: COMMIT
[0m19:40:29.620403 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:29.621370 [debug] [MainThread]: On master: COMMIT
[0m19:40:29.623026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:40:29.624036 [debug] [MainThread]: On master: Close
[0m19:40:29.625036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:29.626037 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:40:29.627038 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:40:29.629593 [debug] [MainThread]: Connection 'model.instagrid.dim_production_plan' was properly closed.
[0m19:40:29.631625 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:40:29.632615 [info ] [MainThread]: 
[0m19:40:29.634216 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m19:40:29.639172 [debug] [MainThread]: Command end result
[0m19:40:29.656635 [info ] [MainThread]: 
[0m19:40:29.667193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:29.670338 [info ] [MainThread]: 
[0m19:40:29.672337 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:40:29.675387 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:29.675387 after 2.00 seconds
[0m19:40:29.676489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C844DF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847295D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C847823CD0>]}
[0m19:40:29.681506 [debug] [MainThread]: Flushing usage events
[0m19:49:03.803142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D8F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181FC5BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181FC5BE50>]}


============================== 19:49:03.807660 | c3c53659-1c0b-4216-bf68-b8ecd0bde614 ==============================
[0m19:49:03.807660 [info ] [MainThread]: Running with dbt=1.5.1
[0m19:49:03.810024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:49:03.973381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181FC5BEB0>]}
[0m19:49:04.002298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181FD675E0>]}
[0m19:49:04.022633 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m19:49:04.139479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:49:04.140482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:49:04.155249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021820115300>]}
[0m19:49:04.166484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182004E260>]}
[0m19:49:04.169645 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m19:49:04.170548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182004E3E0>]}
[0m19:49:04.173663 [info ] [MainThread]: 
[0m19:49:04.178924 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:04.183958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m19:49:04.221837 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m19:49:04.222835 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m19:49:04.223826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:04.299722 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m19:49:04.301734 [debug] [ThreadPool]: On list_instagrid: Close
[0m19:49:04.306719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m19:49:04.319849 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:49:04.320801 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m19:49:04.321801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:04.376478 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:49:04.378564 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m19:49:04.379769 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:49:04.392824 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m19:49:04.397110 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m19:49:04.401184 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m19:49:04.414238 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:04.415236 [debug] [MainThread]: On master: BEGIN
[0m19:49:04.416237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:04.492277 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:49:04.493280 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:04.494282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:04.518720 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m19:49:04.519737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218201658D0>]}
[0m19:49:04.520748 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:04.522745 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:04.522745 [debug] [MainThread]: On master: BEGIN
[0m19:49:04.524748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:49:04.525747 [debug] [MainThread]: On master: COMMIT
[0m19:49:04.526747 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:04.527748 [debug] [MainThread]: On master: COMMIT
[0m19:49:04.528772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:49:04.530844 [debug] [MainThread]: On master: Close
[0m19:49:04.534844 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:49:04.537844 [info ] [MainThread]: 
[0m19:49:04.572116 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m19:49:04.576356 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m19:49:04.574338 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m19:49:04.584422 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m19:49:04.578896 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m19:49:04.587604 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m19:49:04.590131 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m19:49:04.594135 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m19:49:04.596133 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m19:49:04.603464 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m19:49:04.606501 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 19:49:04.591134 => 19:49:04.605499
[0m19:49:04.606501 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m19:49:04.608541 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 19:49:04.597647 => 19:49:04.608541
[0m19:49:04.657870 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m19:49:04.710672 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m19:49:04.719703 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m19:49:04.721853 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:49:04.722854 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m19:49:04.723852 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:49:04.724857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:49:04.725857 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m19:49:04.729118 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:49:04.818162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:49:04.819686 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:49:04.820687 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m19:49:04.830836 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:49:04.830836 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:49:04.848881 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m19:49:04.849394 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m19:49:04.863284 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:49:04.864271 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m19:49:04.866288 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m19:49:04.871478 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:49:04.873351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:04.874351 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m19:49:04.880897 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:49:04.883283 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m19:49:04.884283 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:04.890845 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:49:04.891945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:04.892963 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m19:49:04.935987 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:49:04.937976 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:04.938484 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:49:04.942503 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:49:04.943496 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m19:49:04.947007 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:49:04.948514 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m19:49:04.978267 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:49:04.989594 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m19:49:04.989594 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:49:04.990606 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m19:49:04.998483 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m19:49:05.000502 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m19:49:05.013191 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:49:05.016191 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 19:49:04.618490 => 19:49:05.016191
[0m19:49:05.016191 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m19:49:05.019232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182021B130>]}
[0m19:49:05.020752 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.44s]
[0m19:49:05.023216 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m19:49:05.024232 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m19:49:05.027650 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:49:05.026236 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m19:49:05.034230 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 19:49:04.712013 => 19:49:05.034230
[0m19:49:05.036233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m19:49:05.037756 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m19:49:05.039275 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m19:49:05.041287 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218202195D0>]}
[0m19:49:05.051415 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m19:49:05.054549 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.45s]
[0m19:49:05.056566 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m19:49:05.059625 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 19:49:05.042286 => 19:49:05.058612
[0m19:49:05.066662 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m19:49:05.068156 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m19:49:05.069684 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m19:49:05.085843 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m19:49:05.088503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m19:49:05.090525 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m19:49:05.091530 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:49:05.100705 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m19:49:05.102230 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m19:49:05.103252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:05.105265 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 19:49:05.092533 => 19:49:05.104267
[0m19:49:05.106266 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m19:49:05.120397 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m19:49:05.124398 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:49:05.126398 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m19:49:05.130377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:05.226508 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:49:05.230006 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:49:05.231617 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m19:49:05.237705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:49:05.238717 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:49:05.240237 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m19:49:05.281958 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m19:49:05.282952 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:49:05.288465 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:49:05.297592 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:49:05.299910 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m19:49:05.300925 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m19:49:05.302927 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.303923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.308473 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:49:05.315483 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:49:05.316485 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m19:49:05.316485 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m19:49:05.319655 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.320546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.324545 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:49:05.332927 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:49:05.333932 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:49:05.335936 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:49:05.335936 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m19:49:05.338151 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m19:49:05.351688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:49:05.352650 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:49:05.356654 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m19:49:05.362861 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m19:49:05.363862 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m19:49:05.364854 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m19:49:05.384173 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:49:05.386170 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 19:49:05.071698 => 19:49:05.386170
[0m19:49:05.387679 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:49:05.388695 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m19:49:05.392228 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 19:49:05.106266 => 19:49:05.391220
[0m19:49:05.394220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021820283EE0>]}
[0m19:49:05.396240 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m19:49:05.398798 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.36s]
[0m19:49:05.401321 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218201EFD30>]}
[0m19:49:05.405332 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m19:49:05.408067 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.31s]
[0m19:49:05.410652 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m19:49:05.414659 [debug] [Thread-1 (]: Began running node model.instagrid.production_final
[0m19:49:05.416684 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m19:49:05.421756 [info ] [Thread-1 (]: 5 of 6 START sql table model public.production_final ........................... [RUN]
[0m19:49:05.422755 [info ] [Thread-2 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m19:49:05.431455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.production_final)
[0m19:49:05.432982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m19:49:05.434995 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m19:49:05.433993 [debug] [Thread-1 (]: Began compiling node model.instagrid.production_final
[0m19:49:05.442650 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m19:49:05.451627 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.production_final"
[0m19:49:05.454631 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 19:49:05.436001 => 19:49:05.454631
[0m19:49:05.455630 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m19:49:05.470070 [debug] [Thread-1 (]: Timing info for model.instagrid.production_final (compile): 19:49:05.447042 => 19:49:05.470070
[0m19:49:05.472961 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m19:49:05.475997 [debug] [Thread-1 (]: Began executing node model.instagrid.production_final
[0m19:49:05.490024 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.production_final"
[0m19:49:05.491347 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:49:05.492348 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m19:49:05.493348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:05.496372 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m19:49:05.504861 [debug] [Thread-1 (]: On model.instagrid.production_final: BEGIN
[0m19:49:05.505857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:05.601639 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m19:49:05.602649 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:49:05.603640 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m19:49:05.604815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:49:05.605831 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m19:49:05.606826 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */

  
    

  create  table "instagrid"."public"."production_final__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan as productionplan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m19:49:05.642479 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m19:49:05.651710 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m19:49:05.652708 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final__dbt_tmp" rename to "production_final"
[0m19:49:05.653710 [debug] [Thread-2 (]: SQL status: SELECT 732 in 0.0 seconds
[0m19:49:05.661451 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:49:05.662448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.663448 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m19:49:05.666448 [debug] [Thread-1 (]: On model.instagrid.production_final: COMMIT
[0m19:49:05.668504 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m19:49:05.669725 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.670736 [debug] [Thread-1 (]: On model.instagrid.production_final: COMMIT
[0m19:49:05.677900 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:49:05.678925 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m19:49:05.681015 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:49:05.687014 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:49:05.687014 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:49:05.688530 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m19:49:05.710145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:49:05.715169 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m19:49:05.716168 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m19:49:05.717732 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
drop table if exists "instagrid"."public"."production_final__dbt_backup" cascade
[0m19:49:05.722225 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m19:49:05.723220 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m19:49:05.725594 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:49:05.730631 [debug] [Thread-1 (]: Timing info for model.instagrid.production_final (execute): 19:49:05.480723 => 19:49:05.730631
[0m19:49:05.732641 [debug] [Thread-1 (]: On model.instagrid.production_final: Close
[0m19:49:05.735849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218202B6E90>]}
[0m19:49:05.736865 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.production_final ...................... [[32mSELECT 104[0m in 0.31s]
[0m19:49:05.738892 [debug] [Thread-1 (]: Finished running node model.instagrid.production_final
[0m19:49:05.746398 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:49:05.751212 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 19:49:05.456630 => 19:49:05.751212
[0m19:49:05.752210 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m19:49:05.754207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3c53659-1c0b-4216-bf68-b8ecd0bde614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002182029BC40>]}
[0m19:49:05.756210 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.32s]
[0m19:49:05.758738 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m19:49:05.762780 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:05.763774 [debug] [MainThread]: On master: BEGIN
[0m19:49:05.765778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:05.848712 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:49:05.849789 [debug] [MainThread]: On master: COMMIT
[0m19:49:05.850724 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:05.851728 [debug] [MainThread]: On master: COMMIT
[0m19:49:05.852725 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:49:05.853728 [debug] [MainThread]: On master: Close
[0m19:49:05.855725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:05.856727 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m19:49:05.858235 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m19:49:05.858865 [debug] [MainThread]: Connection 'model.instagrid.production_final' was properly closed.
[0m19:49:05.859755 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m19:49:05.862074 [info ] [MainThread]: 
[0m19:49:05.864100 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m19:49:05.870133 [debug] [MainThread]: Command end result
[0m19:49:05.884719 [info ] [MainThread]: 
[0m19:49:05.885719 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:05.889865 [info ] [MainThread]: 
[0m19:49:05.895801 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m19:49:05.902905 [debug] [MainThread]: Command `dbt run` succeeded at 19:49:05.901904 after 2.18 seconds
[0m19:49:05.906905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181D8F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002181FD675E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218202B5660>]}
[0m19:49:05.908919 [debug] [MainThread]: Flushing usage events
[0m15:39:34.280100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219240F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926457F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926457D60>]}


============================== 15:39:34.280100 | 2c61dd14-bc4b-46fe-95a6-e9da1d22a5a1 ==============================
[0m15:39:34.280100 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:39:34.294637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:39:34.296788 [info ] [MainThread]: dbt version: 1.5.1
[0m15:39:34.298105 [info ] [MainThread]: python version: 3.10.11
[0m15:39:34.300116 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m15:39:34.302116 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:39:34.304114 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m15:39:34.305623 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m15:39:34.307635 [info ] [MainThread]: Configuration:
[0m15:39:34.402325 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:39:34.443759 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:39:34.446766 [info ] [MainThread]: Required dependencies:
[0m15:39:34.449759 [debug] [MainThread]: Executing "git --help"
[0m15:39:34.524131 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:39:34.525165 [debug] [MainThread]: STDERR: "b''"
[0m15:39:34.526162 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:39:34.528168 [info ] [MainThread]: Connection:
[0m15:39:34.531166 [info ] [MainThread]:   host: localhost
[0m15:39:34.533185 [info ] [MainThread]:   port: 5435
[0m15:39:34.535201 [info ] [MainThread]:   user: postgres
[0m15:39:34.536200 [info ] [MainThread]:   database: instagrid
[0m15:39:34.538202 [info ] [MainThread]:   schema: public
[0m15:39:34.540197 [info ] [MainThread]:   search_path: None
[0m15:39:34.543206 [info ] [MainThread]:   keepalives_idle: 0
[0m15:39:34.548159 [info ] [MainThread]:   sslmode: None
[0m15:39:34.551137 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:39:34.552139 [debug] [MainThread]: Using postgres connection "debug"
[0m15:39:34.553146 [debug] [MainThread]: On debug: select 1 as id
[0m15:39:34.554641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:34.866879 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:39:34.883128 [debug] [MainThread]: On debug: Close
[0m15:39:34.883128 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:39:34.883128 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:39:34.893699 [debug] [MainThread]: Command `dbt debug` succeeded at 15:39:34.892704 after 0.65 seconds
[0m15:39:34.894702 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:39:34.895700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219240F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021924793C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021926565F90>]}
[0m15:39:34.897911 [debug] [MainThread]: Flushing usage events
[0m15:40:50.755053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F3ECF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F41057F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F41057E20>]}


============================== 15:40:50.755053 | 2d2110cd-d38a-4e5c-9e03-77491a42b5aa ==============================
[0m15:40:50.755053 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:40:50.763184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:40:50.894404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F41057EE0>]}
[0m15:40:50.919691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F41165810>]}
[0m15:40:50.941879 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:40:51.039433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:51.039433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:51.039433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F415152D0>]}
[0m15:40:51.054514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4144E290>]}
[0m15:40:51.054514 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m15:40:51.073516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4144E470>]}
[0m15:40:51.078518 [info ] [MainThread]: 
[0m15:40:51.081838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:40:51.089285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m15:40:51.111845 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m15:40:51.113843 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m15:40:51.114842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:51.189432 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:40:51.189432 [debug] [ThreadPool]: On list_instagrid: Close
[0m15:40:51.201512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m15:40:51.206538 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:40:51.206538 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m15:40:51.206538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:51.252979 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:40:51.254594 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m15:40:51.254594 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:40:51.311463 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:40:51.316725 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m15:40:51.331312 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m15:40:51.356496 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:51.361735 [debug] [MainThread]: On master: BEGIN
[0m15:40:51.362735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:51.508104 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:40:51.509118 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:51.511117 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:40:51.581182 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m15:40:51.584183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F415658D0>]}
[0m15:40:51.585183 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:51.587193 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:51.588196 [debug] [MainThread]: On master: BEGIN
[0m15:40:51.589197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:40:51.590197 [debug] [MainThread]: On master: COMMIT
[0m15:40:51.591191 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:51.592194 [debug] [MainThread]: On master: COMMIT
[0m15:40:51.593193 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:40:51.594192 [debug] [MainThread]: On master: Close
[0m15:40:51.595192 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m15:40:51.603625 [info ] [MainThread]: 
[0m15:40:51.671293 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m15:40:51.672296 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m15:40:51.673293 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m15:40:51.676290 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m15:40:51.682776 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m15:40:51.688075 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m15:40:51.685044 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m15:40:51.692074 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m15:40:51.693075 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m15:40:51.703646 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m15:40:51.706110 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 15:40:51.689077 => 15:40:51.705094
[0m15:40:51.707639 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m15:40:51.727081 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 15:40:51.696071 => 15:40:51.727081
[0m15:40:51.732091 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m15:40:51.897860 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m15:40:51.903385 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m15:40:51.910456 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:40:51.911449 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m15:40:51.912452 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:40:51.922454 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:40:51.923453 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m15:40:51.925878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:52.031391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:40:52.032393 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:40:52.033394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:40:52.034392 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m15:40:52.036396 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:40:52.039445 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m15:40:52.151520 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m15:40:52.164663 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:40:52.165665 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m15:40:52.166957 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m15:40:52.174486 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:40:52.177363 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m15:40:52.190074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.192089 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.198738 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:40:52.210018 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:40:52.211014 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:40:52.214465 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m15:40:52.220685 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.234847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.284594 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:40:52.289794 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:40:52.291793 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:40:52.293794 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:40:52.295791 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m15:40:52.294796 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m15:40:52.303564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:40:52.316940 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m15:40:52.317938 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:40:52.318942 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m15:40:52.329071 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m15:40:52.331320 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m15:40:52.370070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:40:52.371072 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:40:52.374069 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 15:40:51.708632 => 15:40:52.374069
[0m15:40:52.378065 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 15:40:51.733416 => 15:40:52.378065
[0m15:40:52.379069 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m15:40:52.381072 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m15:40:52.383070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4181B6A0>]}
[0m15:40:52.385068 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4117B4F0>]}
[0m15:40:52.389092 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.70s]
[0m15:40:52.392087 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m15:40:52.391092 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.70s]
[0m15:40:52.395088 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m15:40:52.397089 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m15:40:52.398093 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m15:40:52.401089 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m15:40:52.403625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m15:40:52.404624 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m15:40:52.409633 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m15:40:52.412625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m15:40:52.420563 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m15:40:52.429092 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m15:40:52.435098 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m15:40:52.439095 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 15:40:52.421635 => 15:40:52.438094
[0m15:40:52.449097 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m15:40:52.462098 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m15:40:52.494259 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:40:52.495259 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m15:40:52.497259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:52.464094 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 15:40:52.414624 => 15:40:52.463090
[0m15:40:52.506778 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m15:40:52.547884 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m15:40:52.556418 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:40:52.557416 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m15:40:52.558417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:52.655362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:40:52.655885 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:40:52.657457 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m15:40:52.673151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:40:52.673938 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:40:52.673938 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as plan

from source
  );
  
[0m15:40:52.696886 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m15:40:52.703295 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:40:52.704313 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m15:40:52.706752 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.713749 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:40:52.713749 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:40:52.715753 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m15:40:52.722897 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:40:52.725249 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m15:40:52.726249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.731247 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:40:52.732247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.733246 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:40:52.741418 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:40:52.743414 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m15:40:52.744413 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m15:40:52.747417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:52.748413 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:40:52.753414 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:40:52.761415 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:40:52.763413 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m15:40:52.765414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:40:52.760412 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m15:40:52.782416 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m15:40:52.784413 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m15:40:52.785413 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m15:40:52.798541 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:40:52.802373 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 15:40:52.452108 => 15:40:52.800362
[0m15:40:52.802373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:40:52.804002 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m15:40:52.806069 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 15:40:52.508779 => 15:40:52.806069
[0m15:40:52.806069 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4156BF10>]}
[0m15:40:52.810631 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m15:40:52.810631 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.39s]
[0m15:40:52.814586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4188FC70>]}
[0m15:40:52.815715 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m15:40:52.817517 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.41s]
[0m15:40:52.821034 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m15:40:52.826036 [debug] [Thread-2 (]: Began running node model.instagrid.production_final
[0m15:40:52.827089 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_final
[0m15:40:52.828099 [info ] [Thread-2 (]: 5 of 6 START sql table model public.production_final ........................... [RUN]
[0m15:40:52.830101 [info ] [Thread-1 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m15:40:52.832103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.production_final)
[0m15:40:52.834102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.manufactured_final)
[0m15:40:52.835100 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_final
[0m15:40:52.836583 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_final
[0m15:40:52.843601 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_final"
[0m15:40:52.847676 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m15:40:52.856261 [debug] [Thread-2 (]: Timing info for model.instagrid.production_final (compile): 15:40:52.838605 => 15:40:52.855250
[0m15:40:52.857251 [debug] [Thread-2 (]: Began executing node model.instagrid.production_final
[0m15:40:52.858251 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (compile): 15:40:52.844601 => 15:40:52.858251
[0m15:40:52.866391 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_final
[0m15:40:52.873391 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_final"
[0m15:40:52.881472 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m15:40:52.890659 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m15:40:52.891658 [debug] [Thread-2 (]: On model.instagrid.production_final: BEGIN
[0m15:40:52.893652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:40:52.894654 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m15:40:52.896656 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: BEGIN
[0m15:40:52.897653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:52.971629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m15:40:52.973631 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m15:40:52.974626 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */

  
    

  create  table "instagrid"."public"."production_final__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan as productionplan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m15:40:52.989630 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:40:52.995626 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m15:40:52.997628 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final" rename to "production_final__dbt_backup"
[0m15:40:52.999103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:53.006170 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m15:40:53.006881 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final__dbt_tmp" rename to "production_final"
[0m15:40:53.006881 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:53.006881 [debug] [Thread-2 (]: On model.instagrid.production_final: COMMIT
[0m15:40:53.006881 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m15:40:53.006881 [debug] [Thread-2 (]: On model.instagrid.production_final: COMMIT
[0m15:40:53.006881 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m15:40:53.021391 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m15:40:53.021391 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
drop table if exists "instagrid"."public"."production_final__dbt_backup" cascade
[0m15:40:53.037030 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:40:53.037030 [debug] [Thread-2 (]: Timing info for model.instagrid.production_final (execute): 15:40:52.860393 => 15:40:53.037030
[0m15:40:53.037030 [debug] [Thread-2 (]: On model.instagrid.production_final: Close
[0m15:40:53.037030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:40:53.037030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F41535660>]}
[0m15:40:53.037030 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m15:40:53.048576 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m15:40:53.048576 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.production_final ...................... [[32mSELECT 104[0m in 0.21s]
[0m15:40:53.048576 [debug] [Thread-2 (]: Finished running node model.instagrid.production_final
[0m15:40:53.084035 [debug] [Thread-1 (]: SQL status: SELECT 732 in 0.0 seconds
[0m15:40:53.094600 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m15:40:53.096604 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m15:40:53.102129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:53.110072 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m15:40:53.111070 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m15:40:53.113073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:40:53.118072 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m15:40:53.119073 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m15:40:53.121071 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m15:40:53.124071 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:40:53.131074 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m15:40:53.132076 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m15:40:53.144430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:40:53.147427 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (execute): 15:40:52.874389 => 15:40:53.147427
[0m15:40:53.148431 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: Close
[0m15:40:53.150429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d2110cd-d38a-4e5c-9e03-77491a42b5aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F41862260>]}
[0m15:40:53.152430 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.32s]
[0m15:40:53.155429 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_final
[0m15:40:53.157518 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:53.158717 [debug] [MainThread]: On master: BEGIN
[0m15:40:53.159732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:53.226570 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:40:53.227675 [debug] [MainThread]: On master: COMMIT
[0m15:40:53.229692 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:53.230689 [debug] [MainThread]: On master: COMMIT
[0m15:40:53.231692 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:40:53.232689 [debug] [MainThread]: On master: Close
[0m15:40:53.234864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:53.236157 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m15:40:53.237490 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m15:40:53.238504 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m15:40:53.238504 [debug] [MainThread]: Connection 'model.instagrid.production_final' was properly closed.
[0m15:40:53.242503 [info ] [MainThread]: 
[0m15:40:53.244501 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m15:40:53.248138 [debug] [MainThread]: Command end result
[0m15:40:53.262608 [info ] [MainThread]: 
[0m15:40:53.266888 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:53.271875 [info ] [MainThread]: 
[0m15:40:53.280920 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:40:53.288968 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:53.287954 after 2.57 seconds
[0m15:40:53.291209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F3ECF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F415C1CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F418005B0>]}
[0m15:40:53.292287 [debug] [MainThread]: Flushing usage events
[0m16:09:38.246255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A25D04A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28157E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28157D00>]}


============================== 16:09:38.254366 | 5b6075cc-a092-4740-9b23-850e5a5e7b5a ==============================
[0m16:09:38.254366 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:09:38.256381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:09:38.257785 [info ] [MainThread]: dbt version: 1.5.1
[0m16:09:38.260369 [info ] [MainThread]: python version: 3.10.11
[0m16:09:38.262428 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m16:09:38.264854 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m16:09:38.267089 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m16:09:38.269104 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\instagrid\dbt_project.yml
[0m16:09:38.272184 [info ] [MainThread]: Configuration:
[0m16:09:38.573157 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:09:38.605148 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:09:38.608122 [info ] [MainThread]: Required dependencies:
[0m16:09:38.609123 [debug] [MainThread]: Executing "git --help"
[0m16:09:38.736303 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:09:38.737300 [debug] [MainThread]: STDERR: "b''"
[0m16:09:38.738299 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:09:38.739299 [info ] [MainThread]: Connection:
[0m16:09:38.741319 [info ] [MainThread]:   host: localhost
[0m16:09:38.742328 [info ] [MainThread]:   port: 5435
[0m16:09:38.744327 [info ] [MainThread]:   user: postgres
[0m16:09:38.746538 [info ] [MainThread]:   database: instagrid
[0m16:09:38.749573 [info ] [MainThread]:   schema: public
[0m16:09:38.752207 [info ] [MainThread]:   search_path: None
[0m16:09:38.754124 [info ] [MainThread]:   keepalives_idle: 0
[0m16:09:38.756440 [info ] [MainThread]:   sslmode: None
[0m16:09:38.760491 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:09:38.762020 [debug] [MainThread]: Using postgres connection "debug"
[0m16:09:38.766044 [debug] [MainThread]: On debug: select 1 as id
[0m16:09:38.767034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:38.863149 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:09:38.866271 [debug] [MainThread]: On debug: Close
[0m16:09:38.868422 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:09:38.870432 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:09:38.874076 [debug] [MainThread]: Command `dbt debug` succeeded at 16:09:38.874076 after 0.68 seconds
[0m16:09:38.875278 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:09:38.876290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A25D04A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A26691840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A282664D0>]}
[0m16:09:38.877291 [debug] [MainThread]: Flushing usage events
[0m16:09:50.685681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD69F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD8D67F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD8D67E20>]}


============================== 16:09:50.691356 | 6220718e-3088-4b27-a6f2-b33f5df03b8c ==============================
[0m16:09:50.691356 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:09:50.692711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:09:50.818295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD8D67E80>]}
[0m16:09:50.833807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD8E84B20>]}
[0m16:09:50.851419 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:09:51.113462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:51.113462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:51.122656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD93192D0>]}
[0m16:09:51.145720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD924E230>]}
[0m16:09:51.145720 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:09:51.150729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD924E3B0>]}
[0m16:09:51.151251 [info ] [MainThread]: 
[0m16:09:51.156754 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:51.167741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:09:51.187148 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:09:51.189149 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:09:51.191203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:51.269381 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:09:51.271462 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:09:51.274889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:09:51.281512 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:09:51.281512 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:09:51.285540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:51.329421 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:09:51.330421 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:09:51.331534 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:09:51.343420 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:09:51.347080 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:09:51.347080 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:09:51.360646 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.361760 [debug] [MainThread]: On master: BEGIN
[0m16:09:51.363960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:51.413716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:51.413716 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.413716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:51.450240 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:09:51.451260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD93658A0>]}
[0m16:09:51.451260 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:51.454454 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.454454 [debug] [MainThread]: On master: BEGIN
[0m16:09:51.454454 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:51.454454 [debug] [MainThread]: On master: COMMIT
[0m16:09:51.454454 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.454454 [debug] [MainThread]: On master: COMMIT
[0m16:09:51.454454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:51.460463 [debug] [MainThread]: On master: Close
[0m16:09:51.462614 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:09:51.466858 [info ] [MainThread]: 
[0m16:09:51.487813 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m16:09:51.487813 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m16:09:51.491366 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m16:09:51.496751 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m16:09:51.507792 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m16:09:51.512579 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m16:09:51.510406 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m16:09:51.518596 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m16:09:51.519592 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m16:09:51.526138 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m16:09:51.532183 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 16:09:51.515592 => 16:09:51.531159
[0m16:09:51.535197 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m16:09:51.557405 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 16:09:51.522122 => 16:09:51.556405
[0m16:09:51.558403 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m16:09:51.669225 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m16:09:51.670736 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m16:09:51.674258 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:09:51.676258 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:09:51.676258 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m16:09:51.678260 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m16:09:51.679264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:51.680777 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:09:51.761759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:51.763283 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:09:51.764282 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m16:09:51.773346 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:51.774346 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:09:51.776349 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m16:09:51.789512 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m16:09:51.790553 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m16:09:51.802735 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:09:51.810323 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:09:51.811782 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m16:09:51.813103 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m16:09:51.814049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:51.814049 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:51.824512 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:09:51.830268 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:09:51.831791 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:09:51.832802 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m16:09:51.834801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:51.835803 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:51.870544 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m16:09:51.873725 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:09:51.874702 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:09:51.875701 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:09:51.876705 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m16:09:51.876705 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:09:51.881846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:51.887879 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:09:51.889421 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:51.889421 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m16:09:51.896910 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:09:51.897887 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m16:09:51.903761 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:51.904769 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:51.906759 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 16:09:51.559404 => 16:09:51.905760
[0m16:09:51.910299 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 16:09:51.537193 => 16:09:51.908761
[0m16:09:51.911308 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m16:09:51.912897 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m16:09:51.912897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD941DF90>]}
[0m16:09:51.917206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD9411BD0>]}
[0m16:09:51.917206 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.40s]
[0m16:09:51.920374 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.41s]
[0m16:09:51.922080 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m16:09:51.923259 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m16:09:51.923259 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m16:09:51.923259 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:09:51.927689 [info ] [Thread-2 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m16:09:51.929358 [info ] [Thread-1 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m16:09:51.932401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m16:09:51.933587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m16:09:51.934610 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m16:09:51.936608 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:09:51.942244 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m16:09:51.952828 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:09:51.958214 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 16:09:51.937610 => 16:09:51.955830
[0m16:09:51.960833 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m16:09:51.962593 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:09:51.943257 => 16:09:51.961342
[0m16:09:51.971134 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m16:09:51.972283 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:09:51.990256 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:09:51.991498 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:09:51.992802 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m16:09:51.993309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:51.998535 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:09:52.000535 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:09:52.002067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:52.063620 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:52.064621 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:09:52.065623 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as productionplan

from source
  );
  
[0m16:09:52.074483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:52.074483 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:09:52.076478 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m16:09:52.084176 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:09:52.089693 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:09:52.091224 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m16:09:52.092614 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:52.099248 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:09:52.099248 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m16:09:52.100400 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m16:09:52.105061 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:09:52.106046 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m16:09:52.107039 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:52.113587 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:09:52.113587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:52.116928 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:09:52.121235 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:09:52.122272 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:09:52.122272 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:09:52.127291 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:52.127291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:52.135407 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:09:52.138393 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:09:52.139385 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m16:09:52.140389 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:09:52.142526 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:09:52.146059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:52.151147 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:09:52.151147 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:52.151147 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:09:52.151147 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 16:09:51.964609 => 16:09:52.151147
[0m16:09:52.160330 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m16:09:52.165278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD947A710>]}
[0m16:09:52.167493 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:52.167493 [info ] [Thread-2 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.23s]
[0m16:09:52.172212 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:09:51.975295 => 16:09:52.171333
[0m16:09:52.173246 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m16:09:52.174302 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:09:52.175312 [debug] [Thread-2 (]: Began running node model.instagrid.production_final
[0m16:09:52.177312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD947A860>]}
[0m16:09:52.179273 [info ] [Thread-2 (]: 5 of 6 START sql table model public.production_final ........................... [RUN]
[0m16:09:52.186937 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.production_final)
[0m16:09:52.188973 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_final
[0m16:09:52.202023 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_final"
[0m16:09:52.182379 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.24s]
[0m16:09:52.205034 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:09:52.208359 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_final
[0m16:09:52.211461 [debug] [Thread-2 (]: Timing info for model.instagrid.production_final (compile): 16:09:52.189489 => 16:09:52.210925
[0m16:09:52.210354 [info ] [Thread-1 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m16:09:52.215256 [debug] [Thread-2 (]: Began executing node model.instagrid.production_final
[0m16:09:52.216555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m16:09:52.238419 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_final"
[0m16:09:52.240420 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_final
[0m16:09:52.252845 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m16:09:52.255172 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:09:52.256254 [debug] [Thread-2 (]: On model.instagrid.production_final: BEGIN
[0m16:09:52.256254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:52.256254 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (compile): 16:09:52.243315 => 16:09:52.256254
[0m16:09:52.263997 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_final
[0m16:09:52.286467 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m16:09:52.289455 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:09:52.290474 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: BEGIN
[0m16:09:52.292516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:52.345437 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:52.345437 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:09:52.345437 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */

  
    

  create  table "instagrid"."public"."production_final__dbt_tmp"
  
  
    as
  
  (
    select week,pn,plan as productionplan
from 
 "instagrid"."public"."sg_production_plan" as prodplan
  );
  
[0m16:09:52.351468 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "plan" does not exist
LINE 12:     select week,pn,plan as productionplan
                            ^
HINT:  Perhaps you meant to reference the column "prodplan.pn".

[0m16:09:52.351468 [debug] [Thread-2 (]: On model.instagrid.production_final: ROLLBACK
[0m16:09:52.351468 [debug] [Thread-2 (]: Timing info for model.instagrid.production_final (execute): 16:09:52.218579 => 16:09:52.351468
[0m16:09:52.351468 [debug] [Thread-2 (]: On model.instagrid.production_final: Close
[0m16:09:52.362357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:09:52.363703 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:09:52.365970 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m16:09:52.382511 [debug] [Thread-1 (]: SQL status: SELECT 732 in 0.0 seconds
[0m16:09:52.382511 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:09:52.389536 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m16:09:52.391101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:52.398482 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:09:52.399483 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m16:09:52.401498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:09:52.406528 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m16:09:52.407529 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:09:52.408534 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m16:09:52.412511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:09:52.415407 [debug] [Thread-2 (]: Database Error in model production_final (models\Analystics-OBT\production_final.sql)
  column "plan" does not exist
  LINE 12:     select week,pn,plan as productionplan
                              ^
  HINT:  Perhaps you meant to reference the column "prodplan.pn".
  compiled Code at target\run\instagrid\models\Analystics-OBT\production_final.sql
[0m16:09:52.415407 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:09:52.415407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD93D87C0>]}
[0m16:09:52.420417 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m16:09:52.421593 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model public.production_final .................. [[31mERROR[0m in 0.23s]
[0m16:09:52.422901 [debug] [Thread-2 (]: Finished running node model.instagrid.production_final
[0m16:09:52.432046 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:09:52.435055 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (execute): 16:09:52.265013 => 16:09:52.434061
[0m16:09:52.436056 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: Close
[0m16:09:52.438059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6220718e-3088-4b27-a6f2-b33f5df03b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD941D120>]}
[0m16:09:52.439057 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.22s]
[0m16:09:52.442452 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_final
[0m16:09:52.456236 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:52.457242 [debug] [MainThread]: On master: BEGIN
[0m16:09:52.458229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:52.571918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:09:52.572931 [debug] [MainThread]: On master: COMMIT
[0m16:09:52.573449 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:52.574820 [debug] [MainThread]: On master: COMMIT
[0m16:09:52.575831 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:09:52.576838 [debug] [MainThread]: On master: Close
[0m16:09:52.579545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:52.581180 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:09:52.582243 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:09:52.583428 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m16:09:52.583428 [debug] [MainThread]: Connection 'model.instagrid.production_final' was properly closed.
[0m16:09:52.586088 [info ] [MainThread]: 
[0m16:09:52.587088 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m16:09:52.591118 [debug] [MainThread]: Command end result
[0m16:09:52.605227 [info ] [MainThread]: 
[0m16:09:52.609161 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:09:52.612282 [info ] [MainThread]: 
[0m16:09:52.615038 [error] [MainThread]: [33mDatabase Error in model production_final (models\Analystics-OBT\production_final.sql)[0m
[0m16:09:52.617335 [error] [MainThread]:   column "plan" does not exist
[0m16:09:52.627780 [error] [MainThread]:   LINE 12:     select week,pn,plan as productionplan
[0m16:09:52.635828 [error] [MainThread]:                               ^
[0m16:09:52.649364 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "prodplan.pn".
[0m16:09:52.652916 [error] [MainThread]:   compiled Code at target\run\instagrid\models\Analystics-OBT\production_final.sql
[0m16:09:52.654917 [info ] [MainThread]: 
[0m16:09:52.657918 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:09:52.660432 [debug] [MainThread]: Command `dbt run` failed at 16:09:52.660432 after 2.00 seconds
[0m16:09:52.663533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD69F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD94991B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FD949B490>]}
[0m16:09:52.672073 [debug] [MainThread]: Flushing usage events
[0m16:11:36.389078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BC3F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE757EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE757DF0>]}


============================== 16:11:36.395148 | def39d47-9e77-4c53-b85a-ed54234d9ecc ==============================
[0m16:11:36.395148 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:11:36.397148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:11:36.541341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE757FD0>]}
[0m16:11:36.561308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE865810>]}
[0m16:11:36.582616 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:11:36.684927 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m16:11:36.685929 [debug] [MainThread]: Partial parsing: deleted file: instagrid://models\Analystics-OBT\production_final.sql
[0m16:11:36.702542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BEC24F40>]}
[0m16:11:36.723649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE94E110>]}
[0m16:11:36.726647 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:11:36.728652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE94E350>]}
[0m16:11:36.733090 [info ] [MainThread]: 
[0m16:11:36.736829 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:36.743069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:11:36.772924 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:11:36.774923 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:11:36.777141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:36.993797 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:11:36.995798 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:11:37.002469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:11:37.011435 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:11:37.013465 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:11:37.015187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:37.071198 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.071198 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:11:37.071198 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:11:37.084910 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:11:37.086903 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:11:37.087897 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:11:37.102500 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.102500 [debug] [MainThread]: On master: BEGIN
[0m16:11:37.102500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:37.154529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.155577 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.156587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:37.181083 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:11:37.183868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BEC6D5A0>]}
[0m16:11:37.185869 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:37.187284 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.188299 [debug] [MainThread]: On master: BEGIN
[0m16:11:37.190298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.191317 [debug] [MainThread]: On master: COMMIT
[0m16:11:37.192453 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:37.193340 [debug] [MainThread]: On master: COMMIT
[0m16:11:37.194342 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:11:37.195340 [debug] [MainThread]: On master: Close
[0m16:11:37.197341 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:11:37.201092 [info ] [MainThread]: 
[0m16:11:37.211072 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m16:11:37.212578 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m16:11:37.212578 [info ] [Thread-1 (]: 1 of 5 START sql table model public.dim_date ................................... [RUN]
[0m16:11:37.215639 [info ] [Thread-2 (]: 2 of 5 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m16:11:37.223195 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m16:11:37.221150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m16:11:37.225195 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m16:11:37.228191 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m16:11:37.240395 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m16:11:37.244957 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m16:11:37.252702 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 16:11:37.234888 => 16:11:37.251277
[0m16:11:37.253314 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m16:11:37.278307 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 16:11:37.241935 => 16:11:37.276307
[0m16:11:37.279304 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m16:11:37.369449 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m16:11:37.371491 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m16:11:37.373502 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:11:37.374505 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m16:11:37.375505 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:11:37.376705 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:37.377718 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m16:11:37.379597 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:37.447933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.448994 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:11:37.450508 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m16:11:37.458361 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.459364 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:11:37.460877 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m16:11:37.461391 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m16:11:37.474448 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:11:37.475448 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m16:11:37.477450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.485219 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:11:37.487560 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:11:37.489575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.512886 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m16:11:37.532263 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m16:11:37.532263 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:11:37.541329 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:11:37.541329 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m16:11:37.542863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.542863 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m16:11:37.552525 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:11:37.553857 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m16:11:37.554858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:11:37.561902 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.565632 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:11:37.571178 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:11:37.572279 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m16:11:37.574146 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:11:37.576222 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:11:37.577903 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:11:37.585233 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:11:37.585233 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:11:37.586251 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m16:11:37.589259 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 16:11:37.283579 => 16:11:37.589259
[0m16:11:37.591795 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m16:11:37.593807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BED14F10>]}
[0m16:11:37.595807 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:11:37.595807 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.37s]
[0m16:11:37.600322 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 16:11:37.255309 => 16:11:37.598809
[0m16:11:37.602222 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m16:11:37.605094 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m16:11:37.606740 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m16:11:37.609101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BEC78B20>]}
[0m16:11:37.611862 [info ] [Thread-1 (]: 3 of 5 START sql table model public.sg_production_plan ......................... [RUN]
[0m16:11:37.614270 [info ] [Thread-2 (]: 2 of 5 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.39s]
[0m16:11:37.621760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m16:11:37.624524 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m16:11:37.625639 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m16:11:37.635016 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m16:11:37.636025 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:11:37.638789 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m16:11:37.641829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m16:11:37.642842 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 16:11:37.627987 => 16:11:37.642842
[0m16:11:37.643841 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:11:37.644839 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m16:11:37.651847 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:11:37.677454 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m16:11:37.680455 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:11:37.645848 => 16:11:37.679455
[0m16:11:37.681994 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:11:37.684021 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:11:37.688008 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m16:11:37.702808 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:11:37.704757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:37.708155 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:11:37.710232 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:11:37.711280 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:37.781733 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.782746 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:11:37.783747 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m16:11:37.793773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:11:37.794770 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:11:37.796770 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as productionplan

from source
  );
  
[0m16:11:37.810322 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m16:11:37.816860 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:11:37.818290 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:11:37.820300 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m16:11:37.825737 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:11:37.828222 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m16:11:37.828222 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.832864 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:11:37.832864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.832864 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:11:37.842082 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:11:37.849453 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m16:11:37.850453 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.855493 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:11:37.856495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:37.857498 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:11:37.863360 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:11:37.864371 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:11:37.866372 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:11:37.867668 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:11:37.869104 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:11:37.875162 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:11:37.876167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:11:37.878391 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:11:37.885002 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:11:37.887013 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m16:11:37.893067 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:11:37.894066 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:11:37.897063 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:11:37.689641 => 16:11:37.897063
[0m16:11:37.901333 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 16:11:37.652865 => 16:11:37.901333
[0m16:11:37.901333 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:11:37.901333 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m16:11:37.901333 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BEDA6530>]}
[0m16:11:37.901333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BED5CAC0>]}
[0m16:11:37.908777 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.26s]
[0m16:11:37.911322 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.28s]
[0m16:11:37.912514 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:11:37.916020 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m16:11:37.918018 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m16:11:37.919017 [info ] [Thread-2 (]: 5 of 5 START sql table model public.manufactured_final ......................... [RUN]
[0m16:11:37.922075 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m16:11:37.923087 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m16:11:37.930252 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m16:11:37.934784 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 16:11:37.924322 => 16:11:37.933800
[0m16:11:37.935786 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m16:11:37.954035 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m16:11:37.958037 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:11:37.959037 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m16:11:37.960551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:38.032851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:11:38.034959 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:11:38.034959 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m16:11:38.054910 [debug] [Thread-2 (]: SQL status: SELECT 732 in 0.0 seconds
[0m16:11:38.061206 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:11:38.062306 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m16:11:38.065013 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:38.072443 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:11:38.072443 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m16:11:38.072443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:11:38.081124 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m16:11:38.083472 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:11:38.084745 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m16:11:38.088802 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:11:38.092893 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:11:38.093869 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m16:11:38.102143 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:11:38.102143 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 16:11:37.938797 => 16:11:38.102143
[0m16:11:38.102143 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m16:11:38.102143 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'def39d47-9e77-4c53-b85a-ed54234d9ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BED48550>]}
[0m16:11:38.102143 [info ] [Thread-2 (]: 5 of 5 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.18s]
[0m16:11:38.111189 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m16:11:38.115032 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:38.116428 [debug] [MainThread]: On master: BEGIN
[0m16:11:38.118442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:38.207945 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:11:38.208951 [debug] [MainThread]: On master: COMMIT
[0m16:11:38.208951 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:38.210462 [debug] [MainThread]: On master: COMMIT
[0m16:11:38.211475 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:11:38.211988 [debug] [MainThread]: On master: Close
[0m16:11:38.214000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:38.215999 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:11:38.217002 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:11:38.218699 [debug] [MainThread]: Connection 'model.instagrid.sg_production_plan' was properly closed.
[0m16:11:38.220211 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m16:11:38.221731 [info ] [MainThread]: 
[0m16:11:38.223747 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m16:11:38.226841 [debug] [MainThread]: Command end result
[0m16:11:38.240575 [info ] [MainThread]: 
[0m16:11:38.244349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:38.247354 [info ] [MainThread]: 
[0m16:11:38.254462 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:11:38.260950 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:38.260950 after 1.91 seconds
[0m16:11:38.263483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BC3F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BE865810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234BEDB73D0>]}
[0m16:11:38.268983 [debug] [MainThread]: Flushing usage events
[0m16:14:35.398763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41CFF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F35BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F35BEE0>]}


============================== 16:14:35.406973 | 069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742 ==============================
[0m16:14:35.406973 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:14:35.412274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:14:35.793794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F35BF40>]}
[0m16:14:35.833104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F465480>]}
[0m16:14:35.880398 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:14:36.060443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:36.061481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:36.070420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F815390>]}
[0m16:14:36.080651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F55E2F0>]}
[0m16:14:36.082195 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m16:14:36.083491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F55E470>]}
[0m16:14:36.086520 [info ] [MainThread]: 
[0m16:14:36.088502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:36.094730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m16:14:36.122550 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m16:14:36.123541 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m16:14:36.133017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:36.487308 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:14:36.490306 [debug] [ThreadPool]: On list_instagrid: Close
[0m16:14:36.535635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m16:14:36.562918 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:14:36.565921 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m16:14:36.571984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:36.734035 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:14:36.735425 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m16:14:36.737739 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:14:36.754722 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m16:14:36.762206 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m16:14:36.763209 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m16:14:36.790714 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:36.797519 [debug] [MainThread]: On master: BEGIN
[0m16:14:36.806279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:37.028606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:37.031407 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.032512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:37.086476 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:14:37.094571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F855960>]}
[0m16:14:37.096569 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:37.098770 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.101861 [debug] [MainThread]: On master: BEGIN
[0m16:14:37.103959 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:37.104960 [debug] [MainThread]: On master: COMMIT
[0m16:14:37.104960 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.105960 [debug] [MainThread]: On master: COMMIT
[0m16:14:37.108040 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:37.109051 [debug] [MainThread]: On master: Close
[0m16:14:37.111091 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:14:37.120342 [info ] [MainThread]: 
[0m16:14:37.139598 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m16:14:37.141142 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m16:14:37.144281 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m16:14:37.150699 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m16:14:37.151234 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m16:14:37.155247 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m16:14:37.164785 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 16:14:37.152244 => 16:14:37.163779
[0m16:14:37.167092 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m16:14:37.147689 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m16:14:37.188259 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m16:14:37.232498 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m16:14:37.290036 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m16:14:37.332375 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 16:14:37.280906 => 16:14:37.329256
[0m16:14:37.333385 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m16:14:37.322992 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m16:14:37.348894 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:14:37.350406 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m16:14:37.352529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:37.363591 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m16:14:37.371338 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:14:37.372676 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m16:14:37.375010 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:14:37.555201 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:14:37.556347 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:14:37.557867 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m16:14:37.574653 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m16:14:37.596154 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:14:37.598447 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m16:14:37.599452 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:37.606583 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:14:37.611089 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m16:14:37.614132 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:37.686943 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:14:37.689102 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:14:37.693126 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m16:14:37.704487 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:37.718449 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m16:14:37.719490 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m16:14:37.720684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:14:37.722336 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:14:37.727452 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:37.729695 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m16:14:37.734420 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 16:14:37.335384 => 16:14:37.734420
[0m16:14:37.737003 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m16:14:37.739015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F835180>]}
[0m16:14:37.741591 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.55s]
[0m16:14:37.744621 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m16:14:37.745737 [debug] [Thread-2 (]: Began running node model.instagrid.sg_production_plan
[0m16:14:37.747619 [info ] [Thread-2 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m16:14:37.749738 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m16:14:37.751339 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.sg_production_plan)
[0m16:14:37.759736 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:14:37.762260 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_production_plan
[0m16:14:37.773421 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m16:14:37.781071 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m16:14:37.782740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:37.791280 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:14:37.796508 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m16:14:37.797493 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (compile): 16:14:37.774707 => 16:14:37.797493
[0m16:14:37.799493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:37.800491 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_production_plan
[0m16:14:37.810547 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m16:14:37.834525 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m16:14:37.836523 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:14:37.838851 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m16:14:37.842514 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:14:37.844131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:37.845151 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: BEGIN
[0m16:14:37.851203 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m16:14:37.853250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.854271 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m16:14:37.861307 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:37.866097 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 16:14:37.168087 => 16:14:37.864018
[0m16:14:37.868212 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m16:14:37.870537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F9428C0>]}
[0m16:14:37.872110 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.72s]
[0m16:14:37.874845 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m16:14:37.878751 [debug] [Thread-1 (]: Began running node model.instagrid.dim_manufactured_units
[0m16:14:37.880696 [info ] [Thread-1 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m16:14:37.884446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.dim_manufactured_units)
[0m16:14:37.886444 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m16:14:37.897637 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m16:14:37.902272 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 16:14:37.889001 => 16:14:37.901158
[0m16:14:37.903179 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_manufactured_units
[0m16:14:37.915655 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m16:14:37.930366 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:14:37.931894 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m16:14:37.935971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:38.031101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:14:38.032366 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:14:38.034129 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m16:14:38.057642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:14:38.059660 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:14:38.062226 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as productionplan

from source
  );
  
[0m16:14:38.063675 [debug] [Thread-1 (]: SQL status: SELECT 668 in 0.0 seconds
[0m16:14:38.070409 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:14:38.071935 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m16:14:38.076197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.083664 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:14:38.086663 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m16:14:38.098290 [debug] [Thread-2 (]: SQL status: SELECT 104 in 0.0 seconds
[0m16:14:38.111349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.113562 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:14:38.118429 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:14:38.120429 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m16:14:38.121986 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:14:38.123001 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m16:14:38.125377 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.132368 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:14:38.133370 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m16:14:38.135548 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.139081 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:14:38.141184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:38.143347 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:14:38.148354 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m16:14:38.149356 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: COMMIT
[0m16:14:38.151138 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m16:14:38.154166 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:38.164292 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m16:14:38.164292 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:38.165295 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m16:14:38.169757 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 16:14:37.904658 => 16:14:38.169241
[0m16:14:38.171282 [debug] [Thread-1 (]: On model.instagrid.dim_manufactured_units: Close
[0m16:14:38.173622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F93A4D0>]}
[0m16:14:38.176329 [info ] [Thread-1 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.29s]
[0m16:14:38.178343 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_manufactured_units
[0m16:14:38.179348 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:38.181363 [debug] [Thread-1 (]: Began running node model.instagrid.manufactured_final
[0m16:14:38.184589 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_production_plan (execute): 16:14:37.812320 => 16:14:38.184589
[0m16:14:38.185590 [info ] [Thread-1 (]: 5 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m16:14:38.187587 [debug] [Thread-2 (]: On model.instagrid.sg_production_plan: Close
[0m16:14:38.189589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m16:14:38.192116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F93B400>]}
[0m16:14:38.194115 [debug] [Thread-1 (]: Began compiling node model.instagrid.manufactured_final
[0m16:14:38.197681 [info ] [Thread-2 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.44s]
[0m16:14:38.205925 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m16:14:38.208026 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_production_plan
[0m16:14:38.214511 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (compile): 16:14:38.200221 => 16:14:38.213271
[0m16:14:38.215533 [debug] [Thread-2 (]: Began running node model.instagrid.production_final
[0m16:14:38.216529 [debug] [Thread-1 (]: Began executing node model.instagrid.manufactured_final
[0m16:14:38.217527 [info ] [Thread-2 (]: 6 of 6 START sql table model public.production_final ........................... [RUN]
[0m16:14:38.232465 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.production_final)
[0m16:14:38.230425 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m16:14:38.235500 [debug] [Thread-2 (]: Began compiling node model.instagrid.production_final
[0m16:14:38.250498 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:14:38.253561 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.production_final"
[0m16:14:38.255991 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: BEGIN
[0m16:14:38.271468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:38.274001 [debug] [Thread-2 (]: Timing info for model.instagrid.production_final (compile): 16:14:38.239478 => 16:14:38.273141
[0m16:14:38.278894 [debug] [Thread-2 (]: Began executing node model.instagrid.production_final
[0m16:14:38.297574 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.production_final"
[0m16:14:38.299573 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:14:38.302629 [debug] [Thread-2 (]: On model.instagrid.production_final: BEGIN
[0m16:14:38.305641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:38.409816 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:14:38.411344 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:14:38.411857 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */

  
    

  create  table "instagrid"."public"."production_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select * from  "instagrid"."public"."sg_production_plan"
join dim_date on concat('W',extract(week from dimdate))=week

	order by dimdate
	),
final as
(
select *, extract(month from dimdate) as months,count(dimdate) over(partition by week,extract(month from dimdate)) as dayscount
from base
),

highrank as
(
select *,max(dayscount) over(partition by week)  as ranks from 
final
)
	
select week,pn,productionplan,dimdate
from highrank
where dayscount=ranks
  );
  
[0m16:14:38.418696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:14:38.419710 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:14:38.421242 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m16:14:38.452430 [debug] [Thread-2 (]: SQL status: SELECT 688 in 0.0 seconds
[0m16:14:38.458512 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:14:38.461215 [debug] [Thread-1 (]: SQL status: SELECT 732 in 0.0 seconds
[0m16:14:38.462236 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final" rename to "production_final__dbt_backup"
[0m16:14:38.468241 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:14:38.470219 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m16:14:38.471740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.479016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.480527 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:14:38.486599 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:14:38.487598 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final__dbt_tmp" rename to "production_final"
[0m16:14:38.488597 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m16:14:38.491696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.493717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:38.498699 [debug] [Thread-2 (]: On model.instagrid.production_final: COMMIT
[0m16:14:38.504757 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m16:14:38.506754 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:14:38.509370 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:14:38.511143 [debug] [Thread-2 (]: On model.instagrid.production_final: COMMIT
[0m16:14:38.513254 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: COMMIT
[0m16:14:38.517776 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:38.529369 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.production_final"
[0m16:14:38.531935 [debug] [Thread-2 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
drop table if exists "instagrid"."public"."production_final__dbt_backup" cascade
[0m16:14:38.555227 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:38.560248 [debug] [Thread-2 (]: Timing info for model.instagrid.production_final (execute): 16:14:38.284669 => 16:14:38.558736
[0m16:14:38.561772 [debug] [Thread-2 (]: On model.instagrid.production_final: Close
[0m16:14:38.562784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F924E50>]}
[0m16:14:38.564784 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.production_final ...................... [[32mSELECT 688[0m in 0.33s]
[0m16:14:38.591396 [debug] [Thread-2 (]: Finished running node model.instagrid.production_final
[0m16:14:38.701059 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:38.712837 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m16:14:38.713858 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m16:14:38.732399 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:38.735398 [debug] [Thread-1 (]: Timing info for model.instagrid.manufactured_final (execute): 16:14:38.219528 => 16:14:38.735398
[0m16:14:38.737401 [debug] [Thread-1 (]: On model.instagrid.manufactured_final: Close
[0m16:14:38.739400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '069dfc6d-ee60-4d6e-bf9c-b4aa17b9a742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F99F970>]}
[0m16:14:38.741477 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.55s]
[0m16:14:38.744443 [debug] [Thread-1 (]: Finished running node model.instagrid.manufactured_final
[0m16:14:38.747897 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.748896 [debug] [MainThread]: On master: BEGIN
[0m16:14:38.748896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:38.880415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:38.880415 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.881942 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.883461 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.884476 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:38.885477 [debug] [MainThread]: On master: Close
[0m16:14:38.887478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:38.888475 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m16:14:38.889475 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m16:14:38.890476 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m16:14:38.892022 [debug] [MainThread]: Connection 'model.instagrid.production_final' was properly closed.
[0m16:14:38.894035 [info ] [MainThread]: 
[0m16:14:38.895286 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m16:14:38.898899 [debug] [MainThread]: Command end result
[0m16:14:38.911478 [info ] [MainThread]: 
[0m16:14:38.925558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:38.931469 [info ] [MainThread]: 
[0m16:14:38.940280 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:14:38.963232 [debug] [MainThread]: Command `dbt run` succeeded at 16:14:38.955594 after 3.64 seconds
[0m16:14:38.965235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41CFF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F99F970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A41F969AB0>]}
[0m16:14:38.979990 [debug] [MainThread]: Flushing usage events
[0m18:20:38.165234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DAAF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DCF5BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DCF5BE80>]}


============================== 18:20:38.176236 | 84f36f1c-befe-40d0-ab41-d85da1e36daa ==============================
[0m18:20:38.176236 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:20:38.179690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\instagrid\\logs', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:20:38.414360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DCF5BF40>]}
[0m18:20:38.444982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD065FC0>]}
[0m18:20:38.461243 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:20:38.649636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:20:38.650639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:20:38.667841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD415330>]}
[0m18:20:38.687474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD15E290>]}
[0m18:20:38.689720 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m18:20:38.691976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD15E410>]}
[0m18:20:38.694995 [info ] [MainThread]: 
[0m18:20:38.697425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:38.702952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m18:20:38.721898 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m18:20:38.723900 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m18:20:38.724902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:38.811748 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:20:38.814744 [debug] [ThreadPool]: On list_instagrid: Close
[0m18:20:38.822366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m18:20:38.834374 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:20:38.835823 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m18:20:38.835823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:38.888256 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:20:38.889267 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m18:20:38.891270 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:20:38.909440 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:20:38.911928 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m18:20:38.912921 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m18:20:38.927921 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:38.928921 [debug] [MainThread]: On master: BEGIN
[0m18:20:38.929919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:38.985055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:38.986065 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:38.987064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:39.011564 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:20:39.013560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD455900>]}
[0m18:20:39.015562 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:39.016563 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:39.017566 [debug] [MainThread]: On master: BEGIN
[0m18:20:39.020562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:39.021563 [debug] [MainThread]: On master: COMMIT
[0m18:20:39.022846 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:39.023856 [debug] [MainThread]: On master: COMMIT
[0m18:20:39.025165 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:39.026176 [debug] [MainThread]: On master: Close
[0m18:20:39.028175 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:20:39.030370 [info ] [MainThread]: 
[0m18:20:39.046132 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m18:20:39.047137 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m18:20:39.047137 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m18:20:39.051131 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m18:20:39.049130 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m18:20:39.053635 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m18:20:39.055634 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m18:20:39.058633 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m18:20:39.059632 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m18:20:39.063839 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m18:20:39.067920 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 18:20:39.060630 => 18:20:39.066829
[0m18:20:39.069936 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 18:20:39.056631 => 18:20:39.068936
[0m18:20:39.071543 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m18:20:39.072606 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m18:20:39.136635 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m18:20:39.148065 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m18:20:39.153564 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:20:39.154562 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:20:39.155563 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m18:20:39.156565 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m18:20:39.158438 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:20:39.159447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:20:39.237846 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:39.238845 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:20:39.239847 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m18:20:39.243856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:39.244846 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:20:39.245848 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m18:20:39.260175 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m18:20:39.261682 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m18:20:39.271035 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:20:39.275018 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:20:39.276013 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m18:20:39.277209 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m18:20:39.280551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.281554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.287553 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:20:39.291552 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:20:39.292552 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m18:20:39.293552 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m18:20:39.295553 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.296553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.333331 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:20:39.336329 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:20:39.337332 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:20:39.338333 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:20:39.339330 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m18:20:39.340332 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m18:20:39.344273 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:39.345277 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:39.353296 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m18:20:39.357271 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m18:20:39.359274 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m18:20:39.360273 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m18:20:39.368274 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:39.369278 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:39.370951 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 18:20:39.137633 => 18:20:39.370951
[0m18:20:39.373870 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 18:20:39.074045 => 18:20:39.373870
[0m18:20:39.375354 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m18:20:39.376365 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m18:20:39.378367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD51A1D0>]}
[0m18:20:39.380363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD507FA0>]}
[0m18:20:39.382499 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.33s]
[0m18:20:39.384512 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.33s]
[0m18:20:39.386761 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m18:20:39.388773 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m18:20:39.389775 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m18:20:39.392775 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m18:20:39.393776 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m18:20:39.397826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m18:20:39.395815 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m18:20:39.400830 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m18:20:39.403577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m18:20:39.409568 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m18:20:39.410573 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m18:20:39.416914 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m18:20:39.418911 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 18:20:39.404754 => 18:20:39.417915
[0m18:20:39.420421 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 18:20:39.411897 => 18:20:39.420421
[0m18:20:39.421434 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m18:20:39.423435 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m18:20:39.430431 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m18:20:39.437447 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m18:20:39.439720 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:20:39.441737 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m18:20:39.442883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:39.443896 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:20:39.445893 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m18:20:39.447895 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:20:39.632396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:39.634411 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:20:39.635410 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as productionplan

from source
  );
  
[0m18:20:39.669349 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:20:39.676899 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:20:39.677898 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m18:20:39.679636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.689294 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:20:39.692365 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m18:20:39.695390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.701050 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:20:39.702066 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:20:39.704068 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m18:20:39.707065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:39.713825 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m18:20:39.714836 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m18:20:39.724297 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:39.728294 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 18:20:39.423435 => 18:20:39.728294
[0m18:20:39.730296 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m18:20:39.732295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD55A8F0>]}
[0m18:20:39.736449 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.33s]
[0m18:20:39.740442 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m18:20:39.742445 [debug] [Thread-1 (]: Began running node model.instagrid.production_final
[0m18:20:39.744445 [info ] [Thread-1 (]: 5 of 6 START sql table model public.production_final ........................... [RUN]
[0m18:20:39.746710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.production_final)
[0m18:20:39.747713 [debug] [Thread-1 (]: Began compiling node model.instagrid.production_final
[0m18:20:39.755710 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.production_final"
[0m18:20:39.761710 [debug] [Thread-1 (]: Timing info for model.instagrid.production_final (compile): 18:20:39.750711 => 18:20:39.761710
[0m18:20:39.763709 [debug] [Thread-1 (]: Began executing node model.instagrid.production_final
[0m18:20:39.781708 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.production_final"
[0m18:20:39.787755 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m18:20:39.793108 [debug] [Thread-1 (]: On model.instagrid.production_final: BEGIN
[0m18:20:39.796108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:39.799295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:39.801268 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:20:39.802286 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m18:20:39.826009 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m18:20:39.833009 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:20:39.834009 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m18:20:39.837011 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.844566 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:20:39.845801 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m18:20:39.848270 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:39.853541 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:20:39.854551 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:20:39.856563 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m18:20:39.859023 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:39.865546 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m18:20:39.867545 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m18:20:39.874481 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:39.877481 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 18:20:39.430929 => 18:20:39.877481
[0m18:20:39.884437 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m18:20:39.887467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD1DDF30>]}
[0m18:20:39.889467 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.48s]
[0m18:20:39.894467 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m18:20:39.897464 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m18:20:39.898466 [info ] [Thread-2 (]: 6 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m18:20:39.901978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m18:20:39.903002 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m18:20:39.909994 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m18:20:39.921444 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 18:20:39.903994 => 18:20:39.920443
[0m18:20:39.922592 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m18:20:39.931829 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m18:20:39.933828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:39.934828 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m18:20:39.936827 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */

  
    

  create  table "instagrid"."public"."production_final__dbt_tmp"
  
  
    as
  
  (
    select * from  "instagrid"."public"."sg_production_plan"
  );
  
[0m18:20:39.939832 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m18:20:39.940829 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m18:20:39.941832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:20:39.962675 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:20:39.973741 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m18:20:40.002911 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final" rename to "production_final__dbt_backup"
[0m18:20:40.004914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.012912 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m18:20:40.013913 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final__dbt_tmp" rename to "production_final"
[0m18:20:40.015909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.021915 [debug] [Thread-1 (]: On model.instagrid.production_final: COMMIT
[0m18:20:40.022908 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m18:20:40.024914 [debug] [Thread-1 (]: On model.instagrid.production_final: COMMIT
[0m18:20:40.026908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.032907 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m18:20:40.034910 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
drop table if exists "instagrid"."public"."production_final__dbt_backup" cascade
[0m18:20:40.041907 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:40.045906 [debug] [Thread-1 (]: Timing info for model.instagrid.production_final (execute): 18:20:39.764707 => 18:20:40.044908
[0m18:20:40.046909 [debug] [Thread-1 (]: On model.instagrid.production_final: Close
[0m18:20:40.048909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD4146A0>]}
[0m18:20:40.049911 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.production_final ...................... [[32mSELECT 104[0m in 0.30s]
[0m18:20:40.053384 [debug] [Thread-1 (]: Finished running node model.instagrid.production_final
[0m18:20:40.112557 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.113556 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m18:20:40.114557 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m18:20:40.134773 [debug] [Thread-2 (]: SQL status: SELECT 732 in 0.0 seconds
[0m18:20:40.141771 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m18:20:40.142772 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m18:20:40.144776 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.150773 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m18:20:40.151781 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m18:20:40.154845 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:20:40.158857 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m18:20:40.159855 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m18:20:40.161856 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m18:20:40.163854 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.170328 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m18:20:40.172342 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m18:20:40.179821 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:20:40.182822 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 18:20:39.923813 => 18:20:40.181823
[0m18:20:40.183821 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m18:20:40.185822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84f36f1c-befe-40d0-ab41-d85da1e36daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD5A0190>]}
[0m18:20:40.186830 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.28s]
[0m18:20:40.189088 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m18:20:40.192088 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.193114 [debug] [MainThread]: On master: BEGIN
[0m18:20:40.194088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:20:40.369535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:20:40.370709 [debug] [MainThread]: On master: COMMIT
[0m18:20:40.371724 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:40.372731 [debug] [MainThread]: On master: COMMIT
[0m18:20:40.373740 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:20:40.374720 [debug] [MainThread]: On master: Close
[0m18:20:40.376723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:40.377861 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m18:20:40.379231 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m18:20:40.380243 [debug] [MainThread]: Connection 'model.instagrid.production_final' was properly closed.
[0m18:20:40.381241 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m18:20:40.382240 [info ] [MainThread]: 
[0m18:20:40.384270 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m18:20:40.387258 [debug] [MainThread]: Command end result
[0m18:20:40.398323 [info ] [MainThread]: 
[0m18:20:40.401834 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:40.402843 [info ] [MainThread]: 
[0m18:20:40.405179 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:20:40.407198 [debug] [MainThread]: Command `dbt run` succeeded at 18:20:40.407198 after 2.30 seconds
[0m18:20:40.408199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DAAF4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DD5A0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230DB10AC20>]}
[0m18:20:40.409189 [debug] [MainThread]: Flushing usage events
[0m17:33:45.773350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7C7F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7EC5BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7EC5BD00>]}


============================== 17:33:45.779602 | e316e6fd-23fb-4faf-8dbe-5e863ab0308d ==============================
[0m17:33:45.779602 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:33:45.781495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\ProductionBacklogAnalysis\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:33:45.783600 [info ] [MainThread]: dbt version: 1.5.1
[0m17:33:45.784547 [info ] [MainThread]: python version: 3.10.11
[0m17:33:45.786969 [info ] [MainThread]: python path: C:\Users\Acer\OneDrive\Desktop\Job\job\dbt-bigquery\dbt-env\Scripts\python.exe
[0m17:33:45.789495 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m17:33:45.790495 [info ] [MainThread]: Using profiles.yml file at C:\Users\Acer\.dbt\profiles.yml
[0m17:33:45.792525 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Acer\OneDrive\Desktop\Job\Job\dbt-bigquery\ProductionBacklogAnalysis\dbt_project.yml
[0m17:33:45.793537 [info ] [MainThread]: Configuration:
[0m17:33:45.913843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:33:45.948545 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:33:45.950555 [info ] [MainThread]: Required dependencies:
[0m17:33:45.953823 [debug] [MainThread]: Executing "git --help"
[0m17:33:46.043817 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:33:46.044829 [debug] [MainThread]: STDERR: "b''"
[0m17:33:46.045826 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:33:46.046828 [info ] [MainThread]: Connection:
[0m17:33:46.047831 [info ] [MainThread]:   host: localhost
[0m17:33:46.048830 [info ] [MainThread]:   port: 5435
[0m17:33:46.049827 [info ] [MainThread]:   user: postgres
[0m17:33:46.051700 [info ] [MainThread]:   database: instagrid
[0m17:33:46.053826 [info ] [MainThread]:   schema: public
[0m17:33:46.055234 [info ] [MainThread]:   search_path: None
[0m17:33:46.056238 [info ] [MainThread]:   keepalives_idle: 0
[0m17:33:46.059238 [info ] [MainThread]:   sslmode: None
[0m17:33:46.061751 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:33:46.061751 [debug] [MainThread]: Using postgres connection "debug"
[0m17:33:46.063285 [debug] [MainThread]: On debug: select 1 as id
[0m17:33:46.065298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:46.179793 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:33:46.180825 [debug] [MainThread]: On debug: Close
[0m17:33:46.182330 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:33:46.184346 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:33:46.187341 [debug] [MainThread]: Command `dbt debug` succeeded at 17:33:46.186343 after 0.45 seconds
[0m17:33:46.188341 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:33:46.189340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7C7F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7CEA2E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7ED64B20>]}
[0m17:33:46.190341 [debug] [MainThread]: Flushing usage events
[0m17:33:53.902880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D88F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAC6BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAC6BEB0>]}


============================== 17:33:53.907888 | e6317f68-498f-4873-9345-c6e3f08edc25 ==============================
[0m17:33:53.907888 [info ] [MainThread]: Running with dbt=1.5.1
[0m17:33:53.909703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Acer\\.dbt', 'log_path': 'C:\\Users\\Acer\\OneDrive\\Desktop\\Job\\Job\\dbt-bigquery\\ProductionBacklogAnalysis\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:33:54.027776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAC6BF10>]}
[0m17:33:54.044536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAD84CA0>]}
[0m17:33:54.059939 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m17:33:54.155051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:54.155051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:54.163841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB219360>]}
[0m17:33:54.176379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAE6E320>]}
[0m17:33:54.177386 [info ] [MainThread]: Found 6 models, 0 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics, 0 groups
[0m17:33:54.179381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAE6E500>]}
[0m17:33:54.182424 [info ] [MainThread]: 
[0m17:33:54.185447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:54.192493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid'
[0m17:33:54.214612 [debug] [ThreadPool]: Using postgres connection "list_instagrid"
[0m17:33:54.215577 [debug] [ThreadPool]: On list_instagrid: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid"} */

    select distinct nspname from pg_namespace
  
[0m17:33:54.216586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:54.299051 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m17:33:54.301584 [debug] [ThreadPool]: On list_instagrid: Close
[0m17:33:54.306075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_instagrid_public'
[0m17:33:54.314093 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m17:33:54.315097 [debug] [ThreadPool]: On list_instagrid_public: BEGIN
[0m17:33:54.315097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:54.464528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:33:54.464528 [debug] [ThreadPool]: Using postgres connection "list_instagrid_public"
[0m17:33:54.465534 [debug] [ThreadPool]: On list_instagrid_public: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "list_instagrid_public"} */
select
      'instagrid' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'instagrid' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:33:54.478192 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m17:33:54.480173 [debug] [ThreadPool]: On list_instagrid_public: ROLLBACK
[0m17:33:54.480173 [debug] [ThreadPool]: On list_instagrid_public: Close
[0m17:33:54.491736 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:54.491736 [debug] [MainThread]: On master: BEGIN
[0m17:33:54.493250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:54.535832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:33:54.536864 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:54.537832 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:33:54.559301 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:33:54.560330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB265930>]}
[0m17:33:54.562389 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:54.563398 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:54.564403 [debug] [MainThread]: On master: BEGIN
[0m17:33:54.565401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:33:54.566404 [debug] [MainThread]: On master: COMMIT
[0m17:33:54.567403 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:54.567403 [debug] [MainThread]: On master: COMMIT
[0m17:33:54.569400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:33:54.570421 [debug] [MainThread]: On master: Close
[0m17:33:54.572470 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:33:54.574493 [info ] [MainThread]: 
[0m17:33:54.589089 [debug] [Thread-1 (]: Began running node model.instagrid.dim_date
[0m17:33:54.590091 [debug] [Thread-2 (]: Began running node model.instagrid.sg_manufactured_units
[0m17:33:54.590091 [info ] [Thread-1 (]: 1 of 6 START sql table model public.dim_date ................................... [RUN]
[0m17:33:54.596152 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.instagrid.dim_date'
[0m17:33:54.592613 [info ] [Thread-2 (]: 2 of 6 START sql table model public.sg_manufactured_units ...................... [RUN]
[0m17:33:54.597172 [debug] [Thread-1 (]: Began compiling node model.instagrid.dim_date
[0m17:33:54.599600 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.instagrid.sg_manufactured_units'
[0m17:33:54.605370 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.dim_date"
[0m17:33:54.607406 [debug] [Thread-2 (]: Began compiling node model.instagrid.sg_manufactured_units
[0m17:33:54.615555 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.sg_manufactured_units"
[0m17:33:54.616528 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (compile): 17:33:54.600609 => 17:33:54.616528
[0m17:33:54.618526 [debug] [Thread-1 (]: Began executing node model.instagrid.dim_date
[0m17:33:54.684465 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (compile): 17:33:54.610385 => 17:33:54.684465
[0m17:33:54.697555 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.dim_date"
[0m17:33:54.698136 [debug] [Thread-2 (]: Began executing node model.instagrid.sg_manufactured_units
[0m17:33:54.708504 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.sg_manufactured_units"
[0m17:33:54.709501 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m17:33:54.710855 [debug] [Thread-1 (]: On model.instagrid.dim_date: BEGIN
[0m17:33:54.711868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:54.712396 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m17:33:54.714420 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: BEGIN
[0m17:33:54.715417 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:33:54.775447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:33:54.776447 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:33:54.777447 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m17:33:54.778445 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m17:33:54.779445 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */

  
    

  create  table "instagrid"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    with base as
(
  select
    *
  from
generate_series('2021-12-31', '2022-12-31', INTERVAL '1 day') as d

)


select cast(d as date) as dimdate from base
  );
  
[0m17:33:54.780447 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */

  
    

  create  table "instagrid"."public"."sg_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."manufactured_units"
)

select 
cast(date as Date) as date,

product1,
product2
from source
  );
  
[0m17:33:54.799345 [debug] [Thread-2 (]: SQL status: SELECT 334 in 0.0 seconds
[0m17:33:54.799345 [debug] [Thread-1 (]: SQL status: SELECT 366 in 0.0 seconds
[0m17:33:54.809336 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m17:33:54.813385 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m17:33:54.814395 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units" rename to "sg_manufactured_units__dbt_backup"
[0m17:33:54.815414 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m17:33:54.819403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:54.825421 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m17:33:54.826420 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:54.827420 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
alter table "instagrid"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m17:33:54.834086 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m17:33:54.836085 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
alter table "instagrid"."public"."sg_manufactured_units__dbt_tmp" rename to "sg_manufactured_units"
[0m17:33:54.837135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:54.854683 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:54.865219 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m17:33:54.867910 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m17:33:54.868909 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m17:33:54.869939 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m17:33:54.870910 [debug] [Thread-1 (]: On model.instagrid.dim_date: COMMIT
[0m17:33:54.872426 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: COMMIT
[0m17:33:54.874332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:33:54.875350 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:33:54.881847 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.dim_date"
[0m17:33:54.888384 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.sg_manufactured_units"
[0m17:33:54.889379 [debug] [Thread-1 (]: On model.instagrid.dim_date: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_date"} */
drop table if exists "instagrid"."public"."dim_date__dbt_backup" cascade
[0m17:33:54.890380 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_manufactured_units"} */
drop table if exists "instagrid"."public"."sg_manufactured_units__dbt_backup" cascade
[0m17:33:54.896704 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:33:54.897712 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:33:54.899703 [debug] [Thread-1 (]: Timing info for model.instagrid.dim_date (execute): 17:33:54.619541 => 17:33:54.898704
[0m17:33:54.901728 [debug] [Thread-2 (]: Timing info for model.instagrid.sg_manufactured_units (execute): 17:33:54.699159 => 17:33:54.901728
[0m17:33:54.902671 [debug] [Thread-1 (]: On model.instagrid.dim_date: Close
[0m17:33:54.903679 [debug] [Thread-2 (]: On model.instagrid.sg_manufactured_units: Close
[0m17:33:54.905688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB303C40>]}
[0m17:33:54.907685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB302D10>]}
[0m17:33:54.909680 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.dim_date .............................. [[32mSELECT 366[0m in 0.31s]
[0m17:33:54.910683 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.sg_manufactured_units ................. [[32mSELECT 334[0m in 0.31s]
[0m17:33:54.912627 [debug] [Thread-1 (]: Finished running node model.instagrid.dim_date
[0m17:33:54.913771 [debug] [Thread-2 (]: Finished running node model.instagrid.sg_manufactured_units
[0m17:33:54.914800 [debug] [Thread-1 (]: Began running node model.instagrid.sg_production_plan
[0m17:33:54.915779 [debug] [Thread-2 (]: Began running node model.instagrid.dim_manufactured_units
[0m17:33:54.916807 [info ] [Thread-1 (]: 3 of 6 START sql table model public.sg_production_plan ......................... [RUN]
[0m17:33:54.919068 [info ] [Thread-2 (]: 4 of 6 START sql table model public.dim_manufactured_units ..................... [RUN]
[0m17:33:54.922609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_date, now model.instagrid.sg_production_plan)
[0m17:33:54.923119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_manufactured_units, now model.instagrid.dim_manufactured_units)
[0m17:33:54.924580 [debug] [Thread-1 (]: Began compiling node model.instagrid.sg_production_plan
[0m17:33:54.925591 [debug] [Thread-2 (]: Began compiling node model.instagrid.dim_manufactured_units
[0m17:33:54.932621 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.sg_production_plan"
[0m17:33:54.943375 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.dim_manufactured_units"
[0m17:33:54.946371 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (compile): 17:33:54.927088 => 17:33:54.945371
[0m17:33:54.947367 [debug] [Thread-1 (]: Began executing node model.instagrid.sg_production_plan
[0m17:33:54.949368 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (compile): 17:33:54.937159 => 17:33:54.948369
[0m17:33:54.961576 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.sg_production_plan"
[0m17:33:54.962594 [debug] [Thread-2 (]: Began executing node model.instagrid.dim_manufactured_units
[0m17:33:54.979628 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.dim_manufactured_units"
[0m17:33:54.981624 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m17:33:54.982646 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: BEGIN
[0m17:33:54.983659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:54.988980 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m17:33:54.991476 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: BEGIN
[0m17:33:54.992490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:33:55.049490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:33:55.050494 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m17:33:55.051495 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */

  
    

  create  table "instagrid"."public"."dim_manufactured_units__dbt_tmp"
  
  
    as
  
  (
    with final as
(

select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product1-',product1) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 

union all 
select
date,
concat('W',extract(week from date)) as year_week,
TO_CHAR(date, 'MON')  as month_name,
concat('product2-',product2) as product_type
 from
"instagrid"."public"."sg_manufactured_units" 
),

base as
(
select date,year_week,month_name,
SPLIT_PART(product_type,'-',1) as product_type,
cast(SPLIT_PART(product_type,'-',2) as integer) as plan

from final
)

select distinct date as date, year_week,product_type,plan
from base
  );
  
[0m17:33:55.065757 [debug] [Thread-2 (]: SQL status: SELECT 668 in 0.0 seconds
[0m17:33:55.069761 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m17:33:55.070763 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units" rename to "dim_manufactured_units__dbt_backup"
[0m17:33:55.072265 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.075785 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m17:33:55.076784 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
alter table "instagrid"."public"."dim_manufactured_units__dbt_tmp" rename to "dim_manufactured_units"
[0m17:33:55.078794 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.081794 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m17:33:55.082818 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m17:33:55.083909 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: COMMIT
[0m17:33:55.087177 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:33:55.090158 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.dim_manufactured_units"
[0m17:33:55.091669 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.dim_manufactured_units"} */
drop table if exists "instagrid"."public"."dim_manufactured_units__dbt_backup" cascade
[0m17:33:55.096867 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:33:55.098870 [debug] [Thread-2 (]: Timing info for model.instagrid.dim_manufactured_units (execute): 17:33:54.965945 => 17:33:55.098870
[0m17:33:55.099871 [debug] [Thread-2 (]: On model.instagrid.dim_manufactured_units: Close
[0m17:33:55.102377 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB2EC700>]}
[0m17:33:55.104389 [info ] [Thread-2 (]: 4 of 6 OK created sql table model public.dim_manufactured_units ................ [[32mSELECT 668[0m in 0.18s]
[0m17:33:55.106389 [debug] [Thread-2 (]: Finished running node model.instagrid.dim_manufactured_units
[0m17:33:55.108391 [debug] [Thread-2 (]: Began running node model.instagrid.manufactured_final
[0m17:33:55.109390 [info ] [Thread-2 (]: 5 of 6 START sql table model public.manufactured_final ......................... [RUN]
[0m17:33:55.111910 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.instagrid.dim_manufactured_units, now model.instagrid.manufactured_final)
[0m17:33:55.113456 [debug] [Thread-2 (]: Began compiling node model.instagrid.manufactured_final
[0m17:33:55.123607 [debug] [Thread-2 (]: Writing injected SQL for node "model.instagrid.manufactured_final"
[0m17:33:55.126641 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (compile): 17:33:55.114486 => 17:33:55.125628
[0m17:33:55.127644 [debug] [Thread-2 (]: Began executing node model.instagrid.manufactured_final
[0m17:33:55.139350 [debug] [Thread-2 (]: Writing runtime sql for node "model.instagrid.manufactured_final"
[0m17:33:55.143479 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m17:33:55.144401 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: BEGIN
[0m17:33:55.147411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:33:55.150847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:33:55.153450 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m17:33:55.155463 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */

  
    

  create  table "instagrid"."public"."sg_production_plan__dbt_tmp"
  
  
    as
  
  (
    with source as
(

    select * from  "instagrid"."public"."production_plan"
)

select 
week,
cast(lower(replace(pn,' ',''))  as varchar(50)) as pn,
cast(plan as integer) as productionplan

from source
  );
  
[0m17:33:55.181702 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:33:55.190048 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m17:33:55.190048 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan" rename to "sg_production_plan__dbt_backup"
[0m17:33:55.192574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.197100 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m17:33:55.198100 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
alter table "instagrid"."public"."sg_production_plan__dbt_tmp" rename to "sg_production_plan"
[0m17:33:55.200098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.206296 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m17:33:55.207315 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m17:33:55.208313 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: COMMIT
[0m17:33:55.210309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:33:55.217384 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.sg_production_plan"
[0m17:33:55.218996 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.sg_production_plan"} */
drop table if exists "instagrid"."public"."sg_production_plan__dbt_backup" cascade
[0m17:33:55.221517 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:33:55.222526 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m17:33:55.223801 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */

  
    

  create  table "instagrid"."public"."manufactured_final__dbt_tmp"
  
  
    as
  
  (
    with base as
(
select dimdate,product_type,plan from 
"instagrid"."public"."dim_date" as d
left join "instagrid"."public"."dim_manufactured_units"  as m 
on d.dimdate=m.date
),

first1 as
(

select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is not null
),

nullvalues as
(
    select dimdate, concat('W',extract('week' from dimdate)) as year_week,product_type,coalesce(plan,0) as manufacturedplan
 from base
 where product_type is null
),

products as
(
select distinct product_type from first1
where product_type is not null
),

decembervalues as
(
select dimdate,year_week,products.product_type as product_type , manufacturedplan from products 
cross join nullvalues 
),

final as
(
select * from first1
union all
select * from  decembervalues
)

select * from final
  );
  
[0m17:33:55.225801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:33:55.228803 [debug] [Thread-1 (]: Timing info for model.instagrid.sg_production_plan (execute): 17:33:54.949368 => 17:33:55.228803
[0m17:33:55.229803 [debug] [Thread-1 (]: On model.instagrid.sg_production_plan: Close
[0m17:33:55.232314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB332B60>]}
[0m17:33:55.233883 [info ] [Thread-1 (]: 3 of 6 OK created sql table model public.sg_production_plan .................... [[32mSELECT 104[0m in 0.31s]
[0m17:33:55.237844 [debug] [Thread-1 (]: Finished running node model.instagrid.sg_production_plan
[0m17:33:55.240124 [debug] [Thread-1 (]: Began running node model.instagrid.production_final
[0m17:33:55.240124 [info ] [Thread-1 (]: 6 of 6 START sql table model public.production_final ........................... [RUN]
[0m17:33:55.242659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.instagrid.sg_production_plan, now model.instagrid.production_final)
[0m17:33:55.243793 [debug] [Thread-1 (]: Began compiling node model.instagrid.production_final
[0m17:33:55.247798 [debug] [Thread-1 (]: Writing injected SQL for node "model.instagrid.production_final"
[0m17:33:55.248797 [debug] [Thread-2 (]: SQL status: SELECT 732 in 0.0 seconds
[0m17:33:55.253624 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m17:33:55.254532 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final" rename to "manufactured_final__dbt_backup"
[0m17:33:55.255537 [debug] [Thread-1 (]: Timing info for model.instagrid.production_final (compile): 17:33:55.244804 => 17:33:55.255537
[0m17:33:55.256536 [debug] [Thread-1 (]: Began executing node model.instagrid.production_final
[0m17:33:55.257554 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.265996 [debug] [Thread-1 (]: Writing runtime sql for node "model.instagrid.production_final"
[0m17:33:55.275216 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m17:33:55.277207 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
alter table "instagrid"."public"."manufactured_final__dbt_tmp" rename to "manufactured_final"
[0m17:33:55.279628 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m17:33:55.280628 [debug] [Thread-1 (]: On model.instagrid.production_final: BEGIN
[0m17:33:55.281627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.282140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:55.290334 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m17:33:55.292366 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m17:33:55.294391 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: COMMIT
[0m17:33:55.297391 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:33:55.308376 [debug] [Thread-2 (]: Using postgres connection "model.instagrid.manufactured_final"
[0m17:33:55.310373 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.manufactured_final"} */
drop table if exists "instagrid"."public"."manufactured_final__dbt_backup" cascade
[0m17:33:55.317446 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:33:55.324529 [debug] [Thread-2 (]: Timing info for model.instagrid.manufactured_final (execute): 17:33:55.128653 => 17:33:55.324529
[0m17:33:55.326536 [debug] [Thread-2 (]: On model.instagrid.manufactured_final: Close
[0m17:33:55.328534 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB38E110>]}
[0m17:33:55.329804 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.manufactured_final .................... [[32mSELECT 732[0m in 0.22s]
[0m17:33:55.332824 [debug] [Thread-2 (]: Finished running node model.instagrid.manufactured_final
[0m17:33:55.378475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:33:55.379475 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m17:33:55.381472 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */

  
    

  create  table "instagrid"."public"."production_final__dbt_tmp"
  
  
    as
  
  (
    select * from  "instagrid"."public"."sg_production_plan"
  );
  
[0m17:33:55.397796 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:33:55.409841 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m17:33:55.411040 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final" rename to "production_final__dbt_backup"
[0m17:33:55.412564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.416078 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m17:33:55.417078 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
alter table "instagrid"."public"."production_final__dbt_tmp" rename to "production_final"
[0m17:33:55.419081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:33:55.426161 [debug] [Thread-1 (]: On model.instagrid.production_final: COMMIT
[0m17:33:55.427161 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m17:33:55.428162 [debug] [Thread-1 (]: On model.instagrid.production_final: COMMIT
[0m17:33:55.430160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:33:55.433906 [debug] [Thread-1 (]: Using postgres connection "model.instagrid.production_final"
[0m17:33:55.434910 [debug] [Thread-1 (]: On model.instagrid.production_final: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "instagrid", "target_name": "dev", "node_id": "model.instagrid.production_final"} */
drop table if exists "instagrid"."public"."production_final__dbt_backup" cascade
[0m17:33:55.442957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:33:55.445074 [debug] [Thread-1 (]: Timing info for model.instagrid.production_final (execute): 17:33:55.259061 => 17:33:55.445074
[0m17:33:55.446048 [debug] [Thread-1 (]: On model.instagrid.production_final: Close
[0m17:33:55.447088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6317f68-498f-4873-9345-c6e3f08edc25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DB30CEE0>]}
[0m17:33:55.449050 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.production_final ...................... [[32mSELECT 104[0m in 0.20s]
[0m17:33:55.451557 [debug] [Thread-1 (]: Finished running node model.instagrid.production_final
[0m17:33:55.454088 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:55.455097 [debug] [MainThread]: On master: BEGIN
[0m17:33:55.456114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:55.534368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:33:55.536841 [debug] [MainThread]: On master: COMMIT
[0m17:33:55.539122 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:55.540101 [debug] [MainThread]: On master: COMMIT
[0m17:33:55.540905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:33:55.541912 [debug] [MainThread]: On master: Close
[0m17:33:55.543465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:55.544478 [debug] [MainThread]: Connection 'list_instagrid' was properly closed.
[0m17:33:55.545907 [debug] [MainThread]: Connection 'list_instagrid_public' was properly closed.
[0m17:33:55.547163 [debug] [MainThread]: Connection 'model.instagrid.production_final' was properly closed.
[0m17:33:55.548193 [debug] [MainThread]: Connection 'model.instagrid.manufactured_final' was properly closed.
[0m17:33:55.549202 [info ] [MainThread]: 
[0m17:33:55.550206 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m17:33:55.554727 [debug] [MainThread]: Command end result
[0m17:33:55.563587 [info ] [MainThread]: 
[0m17:33:55.565648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:55.567647 [info ] [MainThread]: 
[0m17:33:55.571768 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:33:55.574360 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:55.574360 after 1.70 seconds
[0m17:33:55.575370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170D88F4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAD84CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170DAE6E3E0>]}
[0m17:33:55.577370 [debug] [MainThread]: Flushing usage events
